[0m16:26:51.276227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079fc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108833c50>]}


============================== 16:26:51.278564 | c6ebbe3f-f36b-4127-817e-5fccaa850784 ==============================
[0m16:26:51.278564 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:26:51.278814 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'partial_parse': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug --profile sumup', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'debug': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'version_check': 'True', 'use_colors': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'log_cache_events': 'False', 'static_parser': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'fail_fast': 'False', 'target_path': 'None', 'empty': 'None'}
[0m16:26:51.290127 [info ] [MainThread]: dbt version: 1.10.13
[0m16:26:51.290340 [info ] [MainThread]: python version: 3.13.3
[0m16:26:51.290458 [info ] [MainThread]: python path: /Users/andre/Desktop/sumup/venv/bin/python3.13
[0m16:26:51.290563 [info ] [MainThread]: os info: macOS-15.4.1-arm64-arm-64bit-Mach-O
[0m16:26:51.337119 [info ] [MainThread]: Using profiles dir at /Users/andre/Desktop/sumup/sumup
[0m16:26:51.337348 [info ] [MainThread]: Using profiles.yml file at /Users/andre/Desktop/sumup/sumup/profiles.yml
[0m16:26:51.337461 [info ] [MainThread]: Using dbt_project.yml file at /Users/andre/Desktop/sumup/sumup/dbt_project.yml
[0m16:26:51.337715 [info ] [MainThread]: adapter type: postgres
[0m16:26:51.337820 [info ] [MainThread]: adapter version: 1.9.1
[0m16:26:51.375594 [info ] [MainThread]: Configuration:
[0m16:26:51.375830 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:26:51.375958 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:26:51.376071 [info ] [MainThread]: Required dependencies:
[0m16:26:51.376249 [debug] [MainThread]: Executing "git --help"
[0m16:26:51.393364 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:26:51.393850 [debug] [MainThread]: STDERR: "b''"
[0m16:26:51.394000 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:26:51.394131 [info ] [MainThread]: Connection:
[0m16:26:51.394256 [info ] [MainThread]:   host: localhost
[0m16:26:51.394365 [info ] [MainThread]:   port: 5432
[0m16:26:51.394461 [info ] [MainThread]:   user: postgres
[0m16:26:51.394606 [info ] [MainThread]:   database: postgres
[0m16:26:51.394794 [info ] [MainThread]:   schema: analytics
[0m16:26:51.394896 [info ] [MainThread]:   connect_timeout: 10
[0m16:26:51.394989 [info ] [MainThread]:   role: None
[0m16:26:51.395084 [info ] [MainThread]:   search_path: None
[0m16:26:51.395178 [info ] [MainThread]:   keepalives_idle: 0
[0m16:26:51.395269 [info ] [MainThread]:   sslmode: None
[0m16:26:51.395359 [info ] [MainThread]:   sslcert: None
[0m16:26:51.395450 [info ] [MainThread]:   sslkey: None
[0m16:26:51.395543 [info ] [MainThread]:   sslrootcert: None
[0m16:26:51.395633 [info ] [MainThread]:   application_name: dbt
[0m16:26:51.395722 [info ] [MainThread]:   retries: 1
[0m16:26:51.395998 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m16:26:51.442757 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:26:51.464435 [debug] [MainThread]: Using postgres connection "debug"
[0m16:26:51.464599 [debug] [MainThread]: On debug: select 1 as id
[0m16:26:51.464702 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:26:51.488130 [debug] [MainThread]: SQL status: SELECT 1 in 0.023 seconds
[0m16:26:51.488565 [debug] [MainThread]: On debug: Close
[0m16:26:51.488705 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:26:51.488838 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:26:51.491647 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.2495007, "process_in_blocks": "0", "process_kernel_time": 0.141069, "process_mem_max_rss": "119504896", "process_out_blocks": "0", "process_user_time": 0.605612}
[0m16:26:51.491845 [debug] [MainThread]: Command `dbt debug` succeeded at 16:26:51.491805 after 0.25 seconds
[0m16:26:51.491964 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:26:51.492101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091123f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10972d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108905260>]}
[0m16:26:51.492264 [debug] [MainThread]: Flushing usage events
[0m16:26:52.201714 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:28:06.121265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121514050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124e379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124e37c50>]}


============================== 16:28:06.123749 | 9145a724-29de-4d43-b279-322354bf51c5 ==============================
[0m16:28:06.123749 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:28:06.124025 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt seed', 'warn_error': 'None', 'target_path': 'None', 'introspect': 'True', 'no_print': 'None', 'printer_width': '80', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'empty': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'debug': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'quiet': 'False', 'write_json': 'True'}
[0m16:28:06.213654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9145a724-29de-4d43-b279-322354bf51c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123557950>]}
[0m16:28:06.237122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9145a724-29de-4d43-b279-322354bf51c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124ccacf0>]}
[0m16:28:06.237585 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m16:28:06.303375 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:28:06.303760 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:28:06.303914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9145a724-29de-4d43-b279-322354bf51c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124cd7b50>]}
[0m16:28:06.603379 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.sumup.core
- models.sumup.marts
- models.sumup.staging
- models.sumup
[0m16:28:06.605365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9145a724-29de-4d43-b279-322354bf51c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12454cb90>]}
[0m16:28:06.622099 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m16:28:06.623215 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m16:28:06.637108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9145a724-29de-4d43-b279-322354bf51c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12685a890>]}
[0m16:28:06.637306 [info ] [MainThread]: Found 447 macros
[0m16:28:06.637433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9145a724-29de-4d43-b279-322354bf51c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1268d6d00>]}
[0m16:28:06.637973 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:28:06.638190 [debug] [MainThread]: Command end result
[0m16:28:06.645879 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m16:28:06.646778 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m16:28:06.648137 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m16:28:06.648257 [info ] [MainThread]: 
[0m16:28:06.648405 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:28:06.648512 [info ] [MainThread]: 
[0m16:28:06.648626 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=0
[0m16:28:06.650131 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.5599353, "process_in_blocks": "0", "process_kernel_time": 0.14541, "process_mem_max_rss": "116621312", "process_out_blocks": "0", "process_user_time": 0.920316}
[0m16:28:06.650362 [debug] [MainThread]: Command `dbt seed` succeeded at 16:28:06.650319 after 0.56 seconds
[0m16:28:06.650517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124ca9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1268f35f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1268f3330>]}
[0m16:28:06.650648 [debug] [MainThread]: Flushing usage events
[0m16:28:07.499395 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:29:48.169247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e14050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b37c50>]}


============================== 16:29:48.171745 | ddf52989-cec8-4166-a550-432f4b701c74 ==============================
[0m16:29:48.171745 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:29:48.171989 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'cache_selected_only': 'False', 'version_check': 'True', 'introspect': 'True', 'empty': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'use_colors': 'True', 'no_print': 'None', 'target_path': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'printer_width': '80', 'warn_error': 'None'}
[0m16:29:48.261745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddf52989-cec8-4166-a550-432f4b701c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105257950>]}
[0m16:29:48.283241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ddf52989-cec8-4166-a550-432f4b701c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069cacf0>]}
[0m16:29:48.283630 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m16:29:48.335828 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:29:48.353766 [error] [MainThread]: Encountered an error:
'utf-8' codec can't decode byte 0x9d in position 54: invalid start byte
[0m16:29:48.356118 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/andre/Desktop/sumup/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/andre/Desktop/sumup/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Users/andre/Desktop/sumup/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/Users/andre/Desktop/sumup/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/Users/andre/Desktop/sumup/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
  File "/Users/andre/Desktop/sumup/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/Users/andre/Desktop/sumup/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 389, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andre/Desktop/sumup/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 416, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ~~~~~~~~~~~~~~^
        runtime_config,
        ^^^^^^^^^^^^^^^
    ...<3 lines>...
        active_integrations,
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/andre/Desktop/sumup/venv/lib/python3.13/site-packages/dbt/parser/manifest.py", line 2123, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
        runtime_config,
        write_perf_info=write_perf_info,
    )
  File "/Users/andre/Desktop/sumup/venv/lib/python3.13/site-packages/dbt/parser/manifest.py", line 320, in get_full_manifest
    manifest = loader.load()
  File "/Users/andre/Desktop/sumup/venv/lib/python3.13/site-packages/dbt/parser/manifest.py", line 367, in load
    file_reader.read_files()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/andre/Desktop/sumup/venv/lib/python3.13/site-packages/dbt/parser/read_files.py", line 212, in read_files
    self.read_files_for_project(project, file_types)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andre/Desktop/sumup/venv/lib/python3.13/site-packages/dbt/parser/read_files.py", line 219, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ~~~~~~~~~~~~~~~~~~~~~^
        project,
        ^^^^^^^^
    ...<4 lines>...
        dbt_ignore_spec,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/andre/Desktop/sumup/venv/lib/python3.13/site-packages/dbt/parser/read_files.py", line 167, in read_files_for_parser
    source_files = get_source_files(
        project, dirs, extension, parse_ft, saved_files, ignore_spec
    )
  File "/Users/andre/Desktop/sumup/venv/lib/python3.13/site-packages/dbt/parser/read_files.py", line 148, in get_source_files
    fb_list.append(load_seed_source_file(fp, project.project_name))
                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andre/Desktop/sumup/venv/lib/python3.13/site-packages/dbt/parser/read_files.py", line 130, in load_seed_source_file
    file_contents = load_file_contents(match.absolute_path, strip=True)
  File "/Users/andre/Desktop/sumup/venv/lib/python3.13/site-packages/dbt_common/record.py", line 512, in record_replay_wrapper
    return func_to_record(*call_args, **kwargs)
  File "/Users/andre/Desktop/sumup/venv/lib/python3.13/site-packages/dbt_common/clients/system.py", line 178, in load_file_contents
    to_return = handle.read().decode("utf-8")
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9d in position 54: invalid start byte

[0m16:29:48.358279 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.22138463, "process_in_blocks": "0", "process_kernel_time": 0.132376, "process_mem_max_rss": "115212288", "process_out_blocks": "0", "process_user_time": 0.630716}
[0m16:29:48.358476 [debug] [MainThread]: Command `dbt seed` failed at 16:29:48.358437 after 0.22 seconds
[0m16:29:48.358633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a36c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a36d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa59a0>]}
[0m16:29:48.358772 [debug] [MainThread]: Flushing usage events
[0m16:29:49.081224 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:39:44.381760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ee4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d2b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d2bc50>]}


============================== 16:39:44.384481 | 6fbcbfce-7d8e-4318-9e96-763dcabd888a ==============================
[0m16:39:44.384481 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:39:44.384755 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'warn_error': 'None', 'debug': 'False', 'invocation_command': 'dbt seed', 'empty': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'static_parser': 'True', 'quiet': 'False', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'introspect': 'True', 'no_print': 'None', 'write_json': 'True', 'fail_fast': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'partial_parse': 'True'}
[0m16:39:44.479272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fbcbfce-7d8e-4318-9e96-763dcabd888a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104047950>]}
[0m16:39:44.502626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fbcbfce-7d8e-4318-9e96-763dcabd888a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bbacf0>]}
[0m16:39:44.503260 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m16:39:44.553686 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:39:44.591392 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:39:44.591612 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:39:44.591913 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.sumup.marts
- models.sumup.core
- models.sumup.staging
- models.sumup
[0m16:39:44.594121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fbcbfce-7d8e-4318-9e96-763dcabd888a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c5b050>]}
[0m16:39:44.614307 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m16:39:44.615471 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m16:39:44.626592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fbcbfce-7d8e-4318-9e96-763dcabd888a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d975c0>]}
[0m16:39:44.626814 [info ] [MainThread]: Found 447 macros
[0m16:39:44.626952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fbcbfce-7d8e-4318-9e96-763dcabd888a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c62cf0>]}
[0m16:39:44.627851 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:39:44.628607 [debug] [MainThread]: Command end result
[0m16:39:44.636113 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m16:39:44.636741 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m16:39:44.637949 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m16:39:44.638064 [info ] [MainThread]: 
[0m16:39:44.638218 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:39:44.638331 [info ] [MainThread]: 
[0m16:39:44.638445 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=0
[0m16:39:44.640486 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.2918147, "process_in_blocks": "0", "process_kernel_time": 0.149308, "process_mem_max_rss": "116342784", "process_out_blocks": "0", "process_user_time": 0.696187}
[0m16:39:44.640675 [debug] [MainThread]: Command `dbt seed` succeeded at 16:39:44.640641 after 0.29 seconds
[0m16:39:44.640818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e0bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b99e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105daeb10>]}
[0m16:39:44.640951 [debug] [MainThread]: Flushing usage events
[0m16:39:45.353934 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:13.408578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108080050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec3c50>]}


============================== 16:40:13.411118 | 5d2f65ee-4d75-4d0e-a34b-794d511ec711 ==============================
[0m16:40:13.411118 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:40:13.411371 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'write_json': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'no_print': 'None', 'quiet': 'False', 'debug': 'False', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'printer_width': '80', 'introspect': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'empty': 'None', 'static_parser': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'warn_error': 'None'}
[0m16:40:13.495368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d2f65ee-4d75-4d0e-a34b-794d511ec711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e3950>]}
[0m16:40:13.516708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d2f65ee-4d75-4d0e-a34b-794d511ec711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d56cf0>]}
[0m16:40:13.517276 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m16:40:13.567226 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:40:13.601207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:40:13.601424 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:40:13.601744 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.sumup.marts
- models.sumup.core
- models.sumup
- models.sumup.staging
[0m16:40:13.603824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d2f65ee-4d75-4d0e-a34b-794d511ec711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a537050>]}
[0m16:40:13.623826 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m16:40:13.624917 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m16:40:13.634850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d2f65ee-4d75-4d0e-a34b-794d511ec711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f375c0>]}
[0m16:40:13.635062 [info ] [MainThread]: Found 447 macros
[0m16:40:13.635194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d2f65ee-4d75-4d0e-a34b-794d511ec711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a53ecf0>]}
[0m16:40:13.636022 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:40:13.636785 [debug] [MainThread]: Command end result
[0m16:40:13.644759 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m16:40:13.645538 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m16:40:13.646888 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m16:40:13.647009 [info ] [MainThread]: 
[0m16:40:13.647171 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:40:13.647278 [info ] [MainThread]: 
[0m16:40:13.647399 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=0
[0m16:40:13.648907 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.27133217, "process_in_blocks": "0", "process_kernel_time": 0.136932, "process_mem_max_rss": "115752960", "process_out_blocks": "0", "process_user_time": 0.66557}
[0m16:40:13.649077 [debug] [MainThread]: Command `dbt seed` succeeded at 16:40:13.649044 after 0.27 seconds
[0m16:40:13.649216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6ebad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d35e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a692b10>]}
[0m16:40:13.649342 [debug] [MainThread]: Flushing usage events
[0m16:40:14.365772 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:45:25.085745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dbc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bff9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bffc50>]}


============================== 16:45:25.088517 | 9a5fda0d-15e7-401c-8228-6ae905c6afbd ==============================
[0m16:45:25.088517 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:45:25.088785 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'printer_width': '80', 'debug': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'introspect': 'True', 'empty': 'None', 'target_path': 'None', 'version_check': 'True', 'partial_parse': 'True', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'use_colors': 'True'}
[0m16:45:25.134020 [error] [MainThread]: Encountered an error:
Runtime Error
  data-paths and seed-paths cannot both be defined. The `data-paths` config has been deprecated in favor of `seed-paths`. Please update your `dbt_project.yml` configuration to reflect this change.

Error encountered in /Users/andre/Desktop/sumup/sumup/dbt_project.yml
[0m16:45:25.135531 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.082135126, "process_in_blocks": "0", "process_kernel_time": 0.098464, "process_mem_max_rss": "107020288", "process_out_blocks": "0", "process_user_time": 0.530421}
[0m16:45:25.135717 [debug] [MainThread]: Command `dbt seed` failed at 16:45:25.135679 after 0.08 seconds
[0m16:45:25.135849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ca2c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10929b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a92030>]}
[0m16:45:25.135993 [debug] [MainThread]: Flushing usage events
[0m16:45:25.836893 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:45:36.724620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108414050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10925b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10925bc50>]}


============================== 16:45:36.727071 | da020f85-2119-43a5-b2d4-c5d76892cbed ==============================
[0m16:45:36.727071 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:45:36.727319 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'debug': 'False', 'static_parser': 'True', 'no_print': 'None', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'version_check': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt seed', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'partial_parse': 'True', 'log_format': 'default', 'quiet': 'False', 'write_json': 'True', 'use_colors': 'True', 'introspect': 'True', 'cache_selected_only': 'False'}
[0m16:45:36.816723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da020f85-2119-43a5-b2d4-c5d76892cbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108577950>]}
[0m16:45:36.838016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da020f85-2119-43a5-b2d4-c5d76892cbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090eacf0>]}
[0m16:45:36.838394 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m16:45:36.890217 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:45:36.926733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:45:36.926892 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:45:36.927129 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.sumup.marts
- models.sumup
- models.sumup.core
- models.sumup.staging
[0m16:45:36.929142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da020f85-2119-43a5-b2d4-c5d76892cbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a187050>]}
[0m16:45:36.949002 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m16:45:36.950239 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m16:45:36.961689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da020f85-2119-43a5-b2d4-c5d76892cbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092c75c0>]}
[0m16:45:36.961928 [info ] [MainThread]: Found 447 macros
[0m16:45:36.962064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da020f85-2119-43a5-b2d4-c5d76892cbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a18ecf0>]}
[0m16:45:36.962967 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:45:36.963769 [debug] [MainThread]: Command end result
[0m16:45:36.972249 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m16:45:36.973039 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m16:45:36.974464 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m16:45:36.974588 [info ] [MainThread]: 
[0m16:45:36.974753 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:45:36.974866 [info ] [MainThread]: 
[0m16:45:36.975003 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=0
[0m16:45:36.977337 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.27947405, "process_in_blocks": "0", "process_kernel_time": 0.128483, "process_mem_max_rss": "115605504", "process_out_blocks": "0", "process_user_time": 0.660705}
[0m16:45:36.977543 [debug] [MainThread]: Command `dbt seed` succeeded at 16:45:36.977504 after 0.28 seconds
[0m16:45:36.977701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a33bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090c9e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2e2b10>]}
[0m16:45:36.977839 [debug] [MainThread]: Flushing usage events
[0m16:45:37.678067 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:45:53.171068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104284050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050c79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050c7c50>]}


============================== 16:45:53.174160 | a4cb5fcb-3b36-45ab-8901-9f5206186957 ==============================
[0m16:45:53.174160 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:45:53.174447 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'log_format': 'default', 'quiet': 'False', 'introspect': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'partial_parse': 'True', 'invocation_command': 'dbt seed', 'use_colors': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'write_json': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'no_print': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs'}
[0m16:45:53.253496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4cb5fcb-3b36-45ab-8901-9f5206186957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e7950>]}
[0m16:45:53.275306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4cb5fcb-3b36-45ab-8901-9f5206186957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f5acf0>]}
[0m16:45:53.275865 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m16:45:53.328189 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:45:53.365292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m16:45:53.365570 [debug] [MainThread]: Partial parsing: added file: sumup://seeds/transaction.csv
[0m16:45:53.365702 [debug] [MainThread]: Partial parsing: added file: sumup://seeds/store.csv
[0m16:45:53.365813 [debug] [MainThread]: Partial parsing: added file: sumup://seeds/device.csv
[0m16:45:53.445117 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.sumup
- models.sumup.marts
- models.sumup.core
- models.sumup.staging
[0m16:45:53.446914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4cb5fcb-3b36-45ab-8901-9f5206186957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff8850>]}
[0m16:45:53.467373 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m16:45:53.468441 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m16:45:53.478434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4cb5fcb-3b36-45ab-8901-9f5206186957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060696d0>]}
[0m16:45:53.478624 [info ] [MainThread]: Found 3 seeds, 447 macros
[0m16:45:53.478754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4cb5fcb-3b36-45ab-8901-9f5206186957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106237690>]}
[0m16:45:53.479430 [info ] [MainThread]: 
[0m16:45:53.479563 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:45:53.479668 [info ] [MainThread]: 
[0m16:45:53.479858 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:45:53.481293 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:45:53.506496 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:45:53.506685 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:45:53.506795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:53.540498 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.034 seconds
[0m16:45:53.541092 [debug] [ThreadPool]: On list_postgres: Close
[0m16:45:53.541379 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_analytics)
[0m16:45:53.541551 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "analytics"
"
[0m16:45:53.543674 [debug] [ThreadPool]: Using postgres connection "create_postgres_analytics"
[0m16:45:53.543823 [debug] [ThreadPool]: On create_postgres_analytics: BEGIN
[0m16:45:53.543932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:45:53.549260 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m16:45:53.549372 [debug] [ThreadPool]: Using postgres connection "create_postgres_analytics"
[0m16:45:53.549469 [debug] [ThreadPool]: On create_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "create_postgres_analytics"} */
create schema if not exists "analytics"
[0m16:45:53.560288 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.011 seconds
[0m16:45:53.560632 [debug] [ThreadPool]: On create_postgres_analytics: COMMIT
[0m16:45:53.560777 [debug] [ThreadPool]: Using postgres connection "create_postgres_analytics"
[0m16:45:53.560878 [debug] [ThreadPool]: On create_postgres_analytics: COMMIT
[0m16:45:53.561588 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m16:45:53.561697 [debug] [ThreadPool]: On create_postgres_analytics: Close
[0m16:45:53.563432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_analytics, now list_postgres_analytics)
[0m16:45:53.565627 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m16:45:53.565747 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m16:45:53.565844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:45:53.570246 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m16:45:53.570354 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m16:45:53.570466 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m16:45:53.583835 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.013 seconds
[0m16:45:53.584342 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m16:45:53.584596 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m16:45:53.588473 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:53.588609 [debug] [MainThread]: On master: BEGIN
[0m16:45:53.588712 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:45:53.593015 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:45:53.593128 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:53.593270 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:45:53.604982 [debug] [MainThread]: SQL status: SELECT 0 in 0.012 seconds
[0m16:45:53.605482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4cb5fcb-3b36-45ab-8901-9f5206186957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106578ef0>]}
[0m16:45:53.605679 [debug] [MainThread]: On master: ROLLBACK
[0m16:45:53.605908 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:53.606024 [debug] [MainThread]: On master: BEGIN
[0m16:45:53.606315 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:45:53.606433 [debug] [MainThread]: On master: COMMIT
[0m16:45:53.606547 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:53.606654 [debug] [MainThread]: On master: COMMIT
[0m16:45:53.606838 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:45:53.606954 [debug] [MainThread]: On master: Close
[0m16:45:53.609537 [debug] [Thread-2 (]: Began running node seed.sumup.store
[0m16:45:53.609734 [debug] [Thread-1 (]: Began running node seed.sumup.device
[0m16:45:53.609889 [debug] [Thread-3 (]: Began running node seed.sumup.transaction
[0m16:45:53.610106 [info ] [Thread-2 (]: 2 of 3 START seed file analytics.store ......................................... [RUN]
[0m16:45:53.610329 [info ] [Thread-1 (]: 1 of 3 START seed file analytics.device ........................................ [RUN]
[0m16:45:53.610546 [info ] [Thread-3 (]: 3 of 3 START seed file analytics.transaction ................................... [RUN]
[0m16:45:53.610808 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.sumup.store'
[0m16:45:53.611011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now seed.sumup.device)
[0m16:45:53.611223 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.sumup.transaction'
[0m16:45:53.611393 [debug] [Thread-2 (]: Began compiling node seed.sumup.store
[0m16:45:53.611546 [debug] [Thread-1 (]: Began compiling node seed.sumup.device
[0m16:45:53.611689 [debug] [Thread-3 (]: Began compiling node seed.sumup.transaction
[0m16:45:53.611837 [debug] [Thread-2 (]: Began executing node seed.sumup.store
[0m16:45:53.611980 [debug] [Thread-1 (]: Began executing node seed.sumup.device
[0m16:45:53.612115 [debug] [Thread-3 (]: Began executing node seed.sumup.transaction
[0m16:45:53.660969 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m16:45:53.667402 [debug] [Thread-1 (]: On seed.sumup.device: BEGIN
[0m16:45:53.673669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:53.679553 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m16:45:53.659046 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m16:45:53.679781 [debug] [Thread-3 (]: On seed.sumup.transaction: BEGIN
[0m16:45:53.679921 [debug] [Thread-2 (]: On seed.sumup.store: BEGIN
[0m16:45:53.680050 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:45:53.680172 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:45:53.684871 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m16:45:53.685011 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m16:45:53.685129 [debug] [Thread-1 (]: On seed.sumup.device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.device"} */

    create table "postgres"."analytics"."device" ("id" integer,"type" integer,"store_id" integer)
  
[0m16:45:53.685326 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m16:45:53.685485 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m16:45:53.685608 [debug] [Thread-2 (]: On seed.sumup.store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.store"} */

    create table "postgres"."analytics"."store" ("id" integer,"name" text,"address" text,"city" text,"country" text,"created_at" text,"typology" text,"customer_id" integer)
  
[0m16:45:53.685730 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m16:45:53.685866 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m16:45:53.685985 [debug] [Thread-3 (]: On seed.sumup.transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.transaction"} */

    create table "postgres"."analytics"."transaction" ("id" integer,"device_id" integer,"product_name" text,"product_sku" text,"category_name" text,"amount" integer,"status" text,"card_number" text,"cvv" integer,"created_at" text,"happened_at" text)
  
[0m16:45:53.697812 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.013 seconds
[0m16:45:53.706114 [debug] [Thread-3 (]: SQL status: CREATE TABLE in 0.020 seconds
[0m16:45:53.706258 [debug] [Thread-2 (]: SQL status: CREATE TABLE in 0.020 seconds
[0m16:45:53.784451 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m16:45:53.797128 [debug] [Thread-1 (]: On seed.sumup.device: 
          insert into "postgres"."analytics"."device" ("id", "type", "store_id") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s...
[0m16:45:53.823958 [debug] [Thread-1 (]: SQL status: INSERT 0 200 in 0.015 seconds
[0m16:45:53.826324 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m16:45:53.838676 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.sumup.device"
[0m16:45:53.855069 [debug] [Thread-2 (]: On seed.sumup.store: 
          insert into "postgres"."analytics"."store" ("id", "name", "address", "city", "country", "created_at", "typology", "customer_id") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%...
[0m16:45:53.893116 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.013 seconds
[0m16:45:53.905724 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.sumup.store"
[0m16:45:53.943668 [debug] [Thread-1 (]: On seed.sumup.device: COMMIT
[0m16:45:53.950101 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m16:45:53.961921 [debug] [Thread-1 (]: On seed.sumup.device: COMMIT
[0m16:45:53.974680 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m16:45:53.975338 [debug] [Thread-2 (]: On seed.sumup.store: COMMIT
[0m16:45:53.987957 [debug] [Thread-1 (]: On seed.sumup.device: Close
[0m16:45:53.998798 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m16:45:54.024350 [debug] [Thread-2 (]: On seed.sumup.store: COMMIT
[0m16:45:54.036919 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m16:45:54.042686 [debug] [Thread-2 (]: On seed.sumup.store: Close
[0m16:45:54.074017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4cb5fcb-3b36-45ab-8901-9f5206186957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062f9b50>]}
[0m16:45:54.080416 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4cb5fcb-3b36-45ab-8901-9f5206186957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106083ac0>]}
[0m16:45:54.080621 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file analytics.device .................................... [[32mINSERT 200[0m in 0.41s]
[0m16:45:54.093086 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file analytics.store ..................................... [[32mINSERT 100[0m in 0.44s]
[0m16:45:54.105600 [debug] [Thread-1 (]: Finished running node seed.sumup.device
[0m16:45:54.124389 [debug] [Thread-2 (]: Finished running node seed.sumup.store
[0m16:45:54.608241 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m16:45:54.608472 [debug] [Thread-3 (]: On seed.sumup.transaction: 
          insert into "postgres"."analytics"."transaction" ("id", "device_id", "product_name", "product_sku", "category_name", "amount", "status", "card_number", "cvv", "created_at", "happened_at") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m16:45:54.632210 [debug] [Thread-3 (]: SQL status: INSERT 0 1500 in 0.024 seconds
[0m16:45:54.632743 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.sumup.transaction"
[0m16:45:54.634099 [debug] [Thread-3 (]: On seed.sumup.transaction: COMMIT
[0m16:45:54.634268 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m16:45:54.634401 [debug] [Thread-3 (]: On seed.sumup.transaction: COMMIT
[0m16:45:54.635412 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m16:45:54.635777 [debug] [Thread-3 (]: On seed.sumup.transaction: Close
[0m16:45:54.636088 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4cb5fcb-3b36-45ab-8901-9f5206186957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef0a50>]}
[0m16:45:54.636324 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file analytics.transaction ............................... [[32mINSERT 1500[0m in 1.02s]
[0m16:45:54.636549 [debug] [Thread-3 (]: Finished running node seed.sumup.transaction
[0m16:45:54.637385 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:54.637502 [debug] [MainThread]: On master: BEGIN
[0m16:45:54.637604 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:45:54.641257 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:45:54.641391 [debug] [MainThread]: On master: COMMIT
[0m16:45:54.641497 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:54.641593 [debug] [MainThread]: On master: COMMIT
[0m16:45:54.641737 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:45:54.641838 [debug] [MainThread]: On master: Close
[0m16:45:54.641989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:54.642085 [debug] [MainThread]: Connection 'seed.sumup.device' was properly closed.
[0m16:45:54.642176 [debug] [MainThread]: Connection 'seed.sumup.store' was properly closed.
[0m16:45:54.642259 [debug] [MainThread]: Connection 'seed.sumup.transaction' was properly closed.
[0m16:45:54.642376 [info ] [MainThread]: 
[0m16:45:54.642564 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m16:45:54.643138 [debug] [MainThread]: Command end result
[0m16:45:54.651792 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m16:45:54.652693 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m16:45:54.655159 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m16:45:54.655287 [info ] [MainThread]: 
[0m16:45:54.655436 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:45:54.655552 [info ] [MainThread]: 
[0m16:45:54.655677 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m16:45:54.657416 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.5176108, "process_in_blocks": "0", "process_kernel_time": 0.161739, "process_mem_max_rss": "131104768", "process_out_blocks": "0", "process_user_time": 1.772878}
[0m16:45:54.657630 [debug] [MainThread]: Command `dbt seed` succeeded at 16:45:54.657588 after 1.52 seconds
[0m16:45:54.657781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106112450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051383d0>]}
[0m16:45:54.657924 [debug] [MainThread]: Flushing usage events
[0m16:45:55.471260 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:03:37.485515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a0c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10684f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10684fc50>]}


============================== 08:03:37.489574 | ffd379be-8140-41fb-b1e5-9e78ddcc3fd4 ==============================
[0m08:03:37.489574 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:03:37.489878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'no_print': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'debug': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run -m int_analytics_store', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'version_check': 'True', 'log_format': 'default', 'write_json': 'True', 'introspect': 'True', 'target_path': 'None'}
[0m08:03:37.490087 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m08:03:37.490234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ffd379be-8140-41fb-b1e5-9e78ddcc3fd4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067376f0>]}
[0m08:03:37.734204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffd379be-8140-41fb-b1e5-9e78ddcc3fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e2cf0>]}
[0m08:03:37.755367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffd379be-8140-41fb-b1e5-9e78ddcc3fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066efd50>]}
[0m08:03:37.755873 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:03:37.807854 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:03:37.852539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:03:37.852766 [debug] [MainThread]: Partial parsing: added file: sumup://models/core/int_analytics_store.sql
[0m08:03:37.948276 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.sumup.marts
- models.sumup.staging
[0m08:03:37.950264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffd379be-8140-41fb-b1e5-9e78ddcc3fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077f32f0>]}
[0m08:03:37.977520 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:03:37.978723 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:03:37.989629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffd379be-8140-41fb-b1e5-9e78ddcc3fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae9630>]}
[0m08:03:37.989812 [info ] [MainThread]: Found 3 seeds, 1 model, 447 macros
[0m08:03:37.989939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffd379be-8140-41fb-b1e5-9e78ddcc3fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aabee0>]}
[0m08:03:37.990512 [info ] [MainThread]: 
[0m08:03:37.990644 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:03:37.990750 [info ] [MainThread]: 
[0m08:03:37.990944 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:03:37.991270 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m08:03:38.060472 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m08:03:38.060664 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m08:03:38.060778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:03:38.263929 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.203 seconds
[0m08:03:38.264871 [debug] [ThreadPool]: On list_postgres: Close
[0m08:03:38.265344 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_analytics_analytics)
[0m08:03:38.265701 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "analytics_analytics"
"
[0m08:03:38.269029 [debug] [ThreadPool]: Using postgres connection "create_postgres_analytics_analytics"
[0m08:03:38.269200 [debug] [ThreadPool]: On create_postgres_analytics_analytics: BEGIN
[0m08:03:38.269352 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:03:38.287553 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m08:03:38.288543 [debug] [ThreadPool]: Using postgres connection "create_postgres_analytics_analytics"
[0m08:03:38.288715 [debug] [ThreadPool]: On create_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "create_postgres_analytics_analytics"} */
create schema if not exists "analytics_analytics"
[0m08:03:38.371707 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.083 seconds
[0m08:03:38.374274 [debug] [ThreadPool]: On create_postgres_analytics_analytics: COMMIT
[0m08:03:38.374927 [debug] [ThreadPool]: Using postgres connection "create_postgres_analytics_analytics"
[0m08:03:38.375395 [debug] [ThreadPool]: On create_postgres_analytics_analytics: COMMIT
[0m08:03:38.428910 [debug] [ThreadPool]: SQL status: COMMIT in 0.053 seconds
[0m08:03:38.429572 [debug] [ThreadPool]: On create_postgres_analytics_analytics: Close
[0m08:03:38.435125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_analytics_analytics, now list_postgres_analytics)
[0m08:03:38.435711 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m08:03:38.442603 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:03:38.443587 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:03:38.443761 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m08:03:38.443968 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m08:03:38.444161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:03:38.444316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:03:38.450092 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:03:38.450326 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:03:38.450472 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:03:38.450595 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:03:38.450741 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:03:38.450892 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m08:03:38.467381 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.016 seconds
[0m08:03:38.467801 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.017 seconds
[0m08:03:38.469199 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m08:03:38.470186 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m08:03:38.470520 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m08:03:38.470645 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m08:03:38.472888 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:38.473040 [debug] [MainThread]: On master: BEGIN
[0m08:03:38.473152 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:03:38.484128 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m08:03:38.484291 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:38.484472 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:03:38.495599 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m08:03:38.497011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffd379be-8140-41fb-b1e5-9e78ddcc3fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ddfd0>]}
[0m08:03:38.497504 [debug] [MainThread]: On master: ROLLBACK
[0m08:03:38.497840 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:38.497972 [debug] [MainThread]: On master: BEGIN
[0m08:03:38.498387 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:03:38.498540 [debug] [MainThread]: On master: COMMIT
[0m08:03:38.498661 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:38.498774 [debug] [MainThread]: On master: COMMIT
[0m08:03:38.498983 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:03:38.499102 [debug] [MainThread]: On master: Close
[0m08:03:38.500835 [debug] [Thread-1 (]: Began running node model.sumup.int_analytics_store
[0m08:03:38.501098 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics_analytics.int_analytics_store ........... [RUN]
[0m08:03:38.501308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.int_analytics_store)
[0m08:03:38.501584 [debug] [Thread-1 (]: Began compiling node model.sumup.int_analytics_store
[0m08:03:38.506420 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.int_analytics_store"
[0m08:03:38.507112 [debug] [Thread-1 (]: Began executing node model.sumup.int_analytics_store
[0m08:03:38.528227 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.int_analytics_store"
[0m08:03:38.529087 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_analytics_store"
[0m08:03:38.529303 [debug] [Thread-1 (]: On model.sumup.int_analytics_store: BEGIN
[0m08:03:38.529461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:03:38.542803 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m08:03:38.543030 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_analytics_store"
[0m08:03:38.543228 [debug] [Thread-1 (]: On model.sumup.int_analytics_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_analytics_store"} */

  
    

  create  table "postgres"."analytics_analytics"."int_analytics_store__dbt_tmp"
  
  
    as
  
  (
    select * 
from "postgres"."analytics"."device"
  );
  
[0m08:03:38.559448 [debug] [Thread-1 (]: SQL status: SELECT 200 in 0.016 seconds
[0m08:03:38.565195 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_analytics_store"
[0m08:03:38.565423 [debug] [Thread-1 (]: On model.sumup.int_analytics_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_analytics_store"} */
alter table "postgres"."analytics_analytics"."int_analytics_store__dbt_tmp" rename to "int_analytics_store"
[0m08:03:38.567765 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:03:38.576974 [debug] [Thread-1 (]: On model.sumup.int_analytics_store: COMMIT
[0m08:03:38.577274 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_analytics_store"
[0m08:03:38.577462 [debug] [Thread-1 (]: On model.sumup.int_analytics_store: COMMIT
[0m08:03:38.578168 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:03:38.581822 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_analytics"."int_analytics_store__dbt_backup"
[0m08:03:38.584260 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_analytics_store"
[0m08:03:38.584447 [debug] [Thread-1 (]: On model.sumup.int_analytics_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_analytics_store"} */
drop table if exists "postgres"."analytics_analytics"."int_analytics_store__dbt_backup" cascade
[0m08:03:38.584932 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:03:38.586248 [debug] [Thread-1 (]: On model.sumup.int_analytics_store: Close
[0m08:03:38.587478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffd379be-8140-41fb-b1e5-9e78ddcc3fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b19a70>]}
[0m08:03:38.587847 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics_analytics.int_analytics_store ...... [[32mSELECT 200[0m in 0.09s]
[0m08:03:38.588159 [debug] [Thread-1 (]: Finished running node model.sumup.int_analytics_store
[0m08:03:38.588824 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:38.588971 [debug] [MainThread]: On master: BEGIN
[0m08:03:38.589097 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:03:38.594610 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:03:38.594759 [debug] [MainThread]: On master: COMMIT
[0m08:03:38.594937 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:38.595070 [debug] [MainThread]: On master: COMMIT
[0m08:03:38.595265 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:03:38.595396 [debug] [MainThread]: On master: Close
[0m08:03:38.595572 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:03:38.595700 [debug] [MainThread]: Connection 'model.sumup.int_analytics_store' was properly closed.
[0m08:03:38.595814 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m08:03:38.595983 [info ] [MainThread]: 
[0m08:03:38.596132 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m08:03:38.596563 [debug] [MainThread]: Command end result
[0m08:03:38.608521 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:03:38.609528 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:03:38.612602 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m08:03:38.612759 [info ] [MainThread]: 
[0m08:03:38.612987 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:03:38.613134 [info ] [MainThread]: 
[0m08:03:38.613338 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m08:03:38.613602 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:03:38.619754 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1723063, "process_in_blocks": "0", "process_kernel_time": 0.202666, "process_mem_max_rss": "128335872", "process_out_blocks": "0", "process_user_time": 0.939473}
[0m08:03:38.619992 [debug] [MainThread]: Command `dbt run` succeeded at 08:03:38.619950 after 1.17 seconds
[0m08:03:38.620164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d9e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac7380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa6950>]}
[0m08:03:38.620328 [debug] [MainThread]: Flushing usage events
[0m08:03:39.356297 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:35:15.833362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101f8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113537c50>]}


============================== 08:35:15.836319 | 87c28c22-47df-423f-b5c6-5741404aaba7 ==============================
[0m08:35:15.836319 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:35:15.836608 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m int_analytics_store', 'cache_selected_only': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'empty': 'False', 'log_cache_events': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'indirect_selection': 'eager', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'write_json': 'True', 'no_print': 'None', 'introspect': 'True', 'quiet': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'debug': 'False', 'use_colors': 'True'}
[0m08:35:15.836821 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m08:35:15.836974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '87c28c22-47df-423f-b5c6-5741404aaba7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11341f6f0>]}
[0m08:35:15.926782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87c28c22-47df-423f-b5c6-5741404aaba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132cacf0>]}
[0m08:35:15.948832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87c28c22-47df-423f-b5c6-5741404aaba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132d7d50>]}
[0m08:35:15.949351 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:35:16.000163 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:35:16.051297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:35:16.051546 [debug] [MainThread]: Partial parsing: added file: sumup://models/staging/stg_transaction.sql
[0m08:35:16.138192 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m08:35:16.140166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87c28c22-47df-423f-b5c6-5741404aaba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114333a70>]}
[0m08:35:16.167159 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:35:16.168669 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:35:16.179256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87c28c22-47df-423f-b5c6-5741404aaba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147810f0>]}
[0m08:35:16.179468 [info ] [MainThread]: Found 3 seeds, 2 models, 447 macros
[0m08:35:16.179612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87c28c22-47df-423f-b5c6-5741404aaba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11475fee0>]}
[0m08:35:16.180386 [info ] [MainThread]: 
[0m08:35:16.180562 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:35:16.180680 [info ] [MainThread]: 
[0m08:35:16.180886 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:35:16.181217 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m08:35:16.247852 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m08:35:16.248079 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m08:35:16.248205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:35:16.370598 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.122 seconds
[0m08:35:16.371547 [debug] [ThreadPool]: On list_postgres: Close
[0m08:35:16.374282 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_analytics)
[0m08:35:16.377720 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:35:16.377996 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m08:35:16.378162 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m08:35:16.378416 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m08:35:16.379776 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:35:16.379976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:35:16.380803 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:35:16.380961 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m08:35:16.381195 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m08:35:16.381354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:35:16.381495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:35:16.387897 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:35:16.388064 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:35:16.388240 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m08:35:16.388385 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:35:16.388541 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:35:16.388681 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:35:16.388840 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m08:35:16.389011 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:35:16.389188 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m08:35:16.400731 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m08:35:16.401423 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:35:16.401585 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m08:35:16.401753 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.012 seconds
[0m08:35:16.401906 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:35:16.402522 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m08:35:16.403084 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m08:35:16.403374 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m08:35:16.403512 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m08:35:16.406226 [debug] [MainThread]: Using postgres connection "master"
[0m08:35:16.406384 [debug] [MainThread]: On master: BEGIN
[0m08:35:16.406509 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:35:16.411489 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:35:16.411619 [debug] [MainThread]: Using postgres connection "master"
[0m08:35:16.411788 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:35:16.421178 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m08:35:16.421757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87c28c22-47df-423f-b5c6-5741404aaba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147265d0>]}
[0m08:35:16.421986 [debug] [MainThread]: On master: ROLLBACK
[0m08:35:16.422265 [debug] [MainThread]: Using postgres connection "master"
[0m08:35:16.422394 [debug] [MainThread]: On master: BEGIN
[0m08:35:16.422779 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:35:16.422912 [debug] [MainThread]: On master: COMMIT
[0m08:35:16.423034 [debug] [MainThread]: Using postgres connection "master"
[0m08:35:16.423154 [debug] [MainThread]: On master: COMMIT
[0m08:35:16.423387 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:35:16.423516 [debug] [MainThread]: On master: Close
[0m08:35:16.425178 [debug] [Thread-1 (]: Began running node model.sumup.int_analytics_store
[0m08:35:16.425442 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics_analytics.int_analytics_store ........... [RUN]
[0m08:35:16.425692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.int_analytics_store)
[0m08:35:16.425932 [debug] [Thread-1 (]: Began compiling node model.sumup.int_analytics_store
[0m08:35:16.430070 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.int_analytics_store"
[0m08:35:16.430624 [debug] [Thread-1 (]: Began executing node model.sumup.int_analytics_store
[0m08:35:16.449271 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.int_analytics_store"
[0m08:35:16.450683 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_analytics_store"
[0m08:35:16.450876 [debug] [Thread-1 (]: On model.sumup.int_analytics_store: BEGIN
[0m08:35:16.451029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:35:16.456310 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:35:16.456475 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_analytics_store"
[0m08:35:16.456615 [debug] [Thread-1 (]: On model.sumup.int_analytics_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_analytics_store"} */

  
    

  create  table "postgres"."analytics_analytics"."int_analytics_store__dbt_tmp"
  
  
    as
  
  (
    select * 
from "postgres"."analytics"."device"
  );
  
[0m08:35:16.472729 [debug] [Thread-1 (]: SQL status: SELECT 200 in 0.016 seconds
[0m08:35:16.477827 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_analytics_store"
[0m08:35:16.478057 [debug] [Thread-1 (]: On model.sumup.int_analytics_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_analytics_store"} */
alter table "postgres"."analytics_analytics"."int_analytics_store" rename to "int_analytics_store__dbt_backup"
[0m08:35:16.480103 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:35:16.481670 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_analytics_store"
[0m08:35:16.481829 [debug] [Thread-1 (]: On model.sumup.int_analytics_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_analytics_store"} */
alter table "postgres"."analytics_analytics"."int_analytics_store__dbt_tmp" rename to "int_analytics_store"
[0m08:35:16.482421 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:35:16.490098 [debug] [Thread-1 (]: On model.sumup.int_analytics_store: COMMIT
[0m08:35:16.490328 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_analytics_store"
[0m08:35:16.490469 [debug] [Thread-1 (]: On model.sumup.int_analytics_store: COMMIT
[0m08:35:16.491436 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:35:16.494328 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_analytics"."int_analytics_store__dbt_backup"
[0m08:35:16.496287 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_analytics_store"
[0m08:35:16.496449 [debug] [Thread-1 (]: On model.sumup.int_analytics_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_analytics_store"} */
drop table if exists "postgres"."analytics_analytics"."int_analytics_store__dbt_backup" cascade
[0m08:35:16.502616 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m08:35:16.503743 [debug] [Thread-1 (]: On model.sumup.int_analytics_store: Close
[0m08:35:16.504758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87c28c22-47df-423f-b5c6-5741404aaba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147d5a70>]}
[0m08:35:16.505053 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics_analytics.int_analytics_store ...... [[32mSELECT 200[0m in 0.08s]
[0m08:35:16.505293 [debug] [Thread-1 (]: Finished running node model.sumup.int_analytics_store
[0m08:35:16.505861 [debug] [MainThread]: Using postgres connection "master"
[0m08:35:16.505980 [debug] [MainThread]: On master: BEGIN
[0m08:35:16.506082 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:35:16.510653 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:35:16.510783 [debug] [MainThread]: On master: COMMIT
[0m08:35:16.510893 [debug] [MainThread]: Using postgres connection "master"
[0m08:35:16.510998 [debug] [MainThread]: On master: COMMIT
[0m08:35:16.511197 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:35:16.511300 [debug] [MainThread]: On master: Close
[0m08:35:16.511443 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:35:16.511545 [debug] [MainThread]: Connection 'model.sumup.int_analytics_store' was properly closed.
[0m08:35:16.511718 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m08:35:16.511823 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m08:35:16.511942 [info ] [MainThread]: 
[0m08:35:16.512062 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m08:35:16.512317 [debug] [MainThread]: Command end result
[0m08:35:16.521698 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:35:16.522614 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:35:16.525392 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m08:35:16.525525 [info ] [MainThread]: 
[0m08:35:16.525694 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:35:16.525805 [info ] [MainThread]: 
[0m08:35:16.525943 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m08:35:16.526162 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:35:16.528659 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7369928, "process_in_blocks": "0", "process_kernel_time": 0.178549, "process_mem_max_rss": "128385024", "process_out_blocks": "0", "process_user_time": 0.927545}
[0m08:35:16.528850 [debug] [MainThread]: Command `dbt run` succeeded at 08:35:16.528807 after 0.74 seconds
[0m08:35:16.528998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11352ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147179b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ab9e50>]}
[0m08:35:16.529137 [debug] [MainThread]: Flushing usage events
[0m08:35:17.254919 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:35:25.030712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084f0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109333c50>]}


============================== 08:35:25.033080 | 1a9a6ba3-18ac-495b-a457-dd3bb78167ae ==============================
[0m08:35:25.033080 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:35:25.033328 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'use_colors': 'True', 'fail_fast': 'False', 'quiet': 'False', 'printer_width': '80', 'static_parser': 'True', 'warn_error': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'no_print': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'empty': 'False', 'write_json': 'True', 'partial_parse': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_transaction', 'introspect': 'True', 'log_cache_events': 'False'}
[0m08:35:25.033537 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m08:35:25.033679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1a9a6ba3-18ac-495b-a457-dd3bb78167ae', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10921b6f0>]}
[0m08:35:25.102402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a9a6ba3-18ac-495b-a457-dd3bb78167ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091c6cf0>]}
[0m08:35:25.123618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a9a6ba3-18ac-495b-a457-dd3bb78167ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091d3d50>]}
[0m08:35:25.124202 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:35:25.172021 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:35:25.219802 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:35:25.219998 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:35:25.221974 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m08:35:25.236011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a9a6ba3-18ac-495b-a457-dd3bb78167ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2d9b80>]}
[0m08:35:25.261664 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:35:25.262461 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:35:25.272893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a9a6ba3-18ac-495b-a457-dd3bb78167ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a5e7b0>]}
[0m08:35:25.273120 [info ] [MainThread]: Found 3 seeds, 2 models, 447 macros
[0m08:35:25.273264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a9a6ba3-18ac-495b-a457-dd3bb78167ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a327ee0>]}
[0m08:35:25.273893 [info ] [MainThread]: 
[0m08:35:25.274040 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:35:25.274150 [info ] [MainThread]: 
[0m08:35:25.274359 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:35:25.274706 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m08:35:25.300269 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m08:35:25.300489 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m08:35:25.300618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:35:25.315115 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.014 seconds
[0m08:35:25.315753 [debug] [ThreadPool]: On list_postgres: Close
[0m08:35:25.316037 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_analytics_staging)
[0m08:35:25.316198 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "analytics_staging"
"
[0m08:35:25.318122 [debug] [ThreadPool]: Using postgres connection "create_postgres_analytics_staging"
[0m08:35:25.318242 [debug] [ThreadPool]: On create_postgres_analytics_staging: BEGIN
[0m08:35:25.318332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:35:25.322842 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:35:25.322938 [debug] [ThreadPool]: Using postgres connection "create_postgres_analytics_staging"
[0m08:35:25.323032 [debug] [ThreadPool]: On create_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "create_postgres_analytics_staging"} */
create schema if not exists "analytics_staging"
[0m08:35:25.323780 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m08:35:25.324086 [debug] [ThreadPool]: On create_postgres_analytics_staging: COMMIT
[0m08:35:25.324186 [debug] [ThreadPool]: Using postgres connection "create_postgres_analytics_staging"
[0m08:35:25.324274 [debug] [ThreadPool]: On create_postgres_analytics_staging: COMMIT
[0m08:35:25.324881 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m08:35:25.324975 [debug] [ThreadPool]: On create_postgres_analytics_staging: Close
[0m08:35:25.326569 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_analytics_staging, now list_postgres_analytics_staging)
[0m08:35:25.326777 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m08:35:25.328888 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:35:25.329066 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m08:35:25.329678 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:35:25.329784 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m08:35:25.330315 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:35:25.330418 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m08:35:25.330512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:35:25.330605 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m08:35:25.330693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:35:25.330868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:35:25.337229 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:35:25.337377 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:35:25.337500 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m08:35:25.338021 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:35:25.338123 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:35:25.338227 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:35:25.339357 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m08:35:25.339491 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:35:25.339607 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m08:35:25.343501 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m08:35:25.343991 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m08:35:25.344176 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m08:35:25.344277 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m08:35:25.344690 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m08:35:25.344830 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m08:35:25.345412 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:35:25.345524 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m08:35:25.345897 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:35:25.347921 [debug] [MainThread]: Using postgres connection "master"
[0m08:35:25.348034 [debug] [MainThread]: On master: BEGIN
[0m08:35:25.348123 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:35:25.352058 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:35:25.352159 [debug] [MainThread]: Using postgres connection "master"
[0m08:35:25.352288 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:35:25.356957 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m08:35:25.357369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a9a6ba3-18ac-495b-a457-dd3bb78167ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a455d90>]}
[0m08:35:25.357530 [debug] [MainThread]: On master: ROLLBACK
[0m08:35:25.357724 [debug] [MainThread]: Using postgres connection "master"
[0m08:35:25.357819 [debug] [MainThread]: On master: BEGIN
[0m08:35:25.358049 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:35:25.358144 [debug] [MainThread]: On master: COMMIT
[0m08:35:25.358233 [debug] [MainThread]: Using postgres connection "master"
[0m08:35:25.358329 [debug] [MainThread]: On master: COMMIT
[0m08:35:25.358475 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:35:25.358567 [debug] [MainThread]: On master: Close
[0m08:35:25.359750 [debug] [Thread-1 (]: Began running node model.sumup.stg_transaction
[0m08:35:25.359939 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_staging.stg_transaction .................. [RUN]
[0m08:35:25.360099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.stg_transaction)
[0m08:35:25.360229 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_transaction
[0m08:35:25.363043 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m08:35:25.363403 [debug] [Thread-1 (]: Began executing node model.sumup.stg_transaction
[0m08:35:25.376672 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_transaction"
[0m08:35:25.377132 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:35:25.377264 [debug] [Thread-1 (]: On model.sumup.stg_transaction: BEGIN
[0m08:35:25.377380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:35:25.381769 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:35:25.381923 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:35:25.382075 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  create view "postgres"."analytics_staging"."stg_transaction__dbt_tmp"
    
    
  as (
    SELECT
    -- Primary and Foreign Keys
    CAST(t.id AS INTEGER) AS transaction_id,
    CAST(t.device_id AS INTEGER) AS device_id,

    -- Product Information
    SHA256(
        CONCAT(TRIM(LOWER(t.product_name)), '|' ,TRIM(LOWER(t.product_sku)))) as product_id,
    t.product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(t.amount AS NUMERIC) / 100 AS amount_eur,
    LOWER(TRIM(t.status)) AS status,

    -- PII Protection (Hashing sensitive data for security)
    SHA256( REPLACE(REPLACE(CAST(t.card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    SHA256( CAST(t.cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(t.created_at AS TIMESTAMP) AS created_at_utc,
    CAST(t.happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."device"
  );
[0m08:35:25.383103 [debug] [Thread-1 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "t"
LINE 9:     CAST(t.id AS INTEGER) AS transaction_id,
                 ^

[0m08:35:25.383227 [debug] [Thread-1 (]: On model.sumup.stg_transaction: ROLLBACK
[0m08:35:25.383466 [debug] [Thread-1 (]: On model.sumup.stg_transaction: Close
[0m08:35:25.388783 [debug] [Thread-1 (]: Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  missing FROM-clause entry for table "t"
  LINE 9:     CAST(t.id AS INTEGER) AS transaction_id,
                   ^
  compiled code at target/run/sumup/models/staging/stg_transaction.sql
[0m08:35:25.389601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a9a6ba3-18ac-495b-a457-dd3bb78167ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7490d0>]}
[0m08:35:25.389867 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_staging.stg_transaction ......... [[31mERROR[0m in 0.03s]
[0m08:35:25.390096 [debug] [Thread-1 (]: Finished running node model.sumup.stg_transaction
[0m08:35:25.390312 [debug] [Thread-7 (]: Marking all children of 'model.sumup.stg_transaction' to be skipped because of status 'error'.  Reason: Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  missing FROM-clause entry for table "t"
  LINE 9:     CAST(t.id AS INTEGER) AS transaction_id,
                   ^
  compiled code at target/run/sumup/models/staging/stg_transaction.sql.
[0m08:35:25.391046 [debug] [MainThread]: Using postgres connection "master"
[0m08:35:25.391169 [debug] [MainThread]: On master: BEGIN
[0m08:35:25.391264 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:35:25.396085 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:35:25.396208 [debug] [MainThread]: On master: COMMIT
[0m08:35:25.396331 [debug] [MainThread]: Using postgres connection "master"
[0m08:35:25.396510 [debug] [MainThread]: On master: COMMIT
[0m08:35:25.396673 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:35:25.396776 [debug] [MainThread]: On master: Close
[0m08:35:25.396916 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:35:25.397008 [debug] [MainThread]: Connection 'model.sumup.stg_transaction' was properly closed.
[0m08:35:25.397091 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m08:35:25.397177 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m08:35:25.397285 [info ] [MainThread]: 
[0m08:35:25.397399 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m08:35:25.397651 [debug] [MainThread]: Command end result
[0m08:35:25.408142 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:35:25.408909 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:35:25.411165 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m08:35:25.411278 [info ] [MainThread]: 
[0m08:35:25.411423 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:35:25.411537 [info ] [MainThread]: 
[0m08:35:25.411680 [error] [MainThread]: [31mFailure in model stg_transaction (models/staging/stg_transaction.sql)[0m
[0m08:35:25.411811 [error] [MainThread]:   Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  missing FROM-clause entry for table "t"
  LINE 9:     CAST(t.id AS INTEGER) AS transaction_id,
                   ^
  compiled code at target/run/sumup/models/staging/stg_transaction.sql
[0m08:35:25.411917 [info ] [MainThread]: 
[0m08:35:25.412036 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/staging/stg_transaction.sql
[0m08:35:25.412134 [info ] [MainThread]: 
[0m08:35:25.412251 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m08:35:25.412456 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:35:25.414167 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.40957716, "process_in_blocks": "0", "process_kernel_time": 0.144247, "process_mem_max_rss": "125599744", "process_out_blocks": "0", "process_user_time": 0.75213}
[0m08:35:25.414376 [debug] [MainThread]: Command `dbt run` failed at 08:35:25.414338 after 0.41 seconds
[0m08:35:25.414535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7df1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2c3800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a74bd0>]}
[0m08:35:25.414712 [debug] [MainThread]: Flushing usage events
[0m08:35:26.102237 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:36:20.160483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104064050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ea79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ea7c50>]}


============================== 08:36:20.163510 | 825c99c8-d821-4de7-b4d1-4c664671bec3 ==============================
[0m08:36:20.163510 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:36:20.163821 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'cache_selected_only': 'False', 'static_parser': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'partial_parse': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'use_colors': 'True', 'quiet': 'False', 'no_print': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'printer_width': '80', 'write_json': 'True', 'log_format': 'default', 'fail_fast': 'False', 'invocation_command': 'dbt run -m stg_transaction', 'empty': 'False', 'introspect': 'True'}
[0m08:36:20.164043 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m08:36:20.164253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '825c99c8-d821-4de7-b4d1-4c664671bec3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d8f6f0>]}
[0m08:36:20.375962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '825c99c8-d821-4de7-b4d1-4c664671bec3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d3acf0>]}
[0m08:36:20.400612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '825c99c8-d821-4de7-b4d1-4c664671bec3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d47d50>]}
[0m08:36:20.401268 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:36:20.458664 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:36:20.512547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:36:20.512833 [debug] [MainThread]: Partial parsing: updated file: sumup://models/staging/stg_transaction.sql
[0m08:36:20.600516 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m08:36:20.602387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '825c99c8-d821-4de7-b4d1-4c664671bec3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e4fa70>]}
[0m08:36:20.627603 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:36:20.628756 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:36:20.639419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '825c99c8-d821-4de7-b4d1-4c664671bec3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106114f30>]}
[0m08:36:20.639629 [info ] [MainThread]: Found 3 seeds, 2 models, 447 macros
[0m08:36:20.639760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '825c99c8-d821-4de7-b4d1-4c664671bec3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060fbee0>]}
[0m08:36:20.640346 [info ] [MainThread]: 
[0m08:36:20.640484 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:36:20.640593 [info ] [MainThread]: 
[0m08:36:20.640937 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:36:20.641263 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m08:36:20.699017 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m08:36:20.699207 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m08:36:20.699323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:36:20.720681 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.021 seconds
[0m08:36:20.721271 [debug] [ThreadPool]: On list_postgres: Close
[0m08:36:20.722989 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics)
[0m08:36:20.723188 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m08:36:20.725316 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:36:20.725500 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m08:36:20.726294 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:36:20.726421 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m08:36:20.727012 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:36:20.727122 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m08:36:20.727223 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:36:20.727329 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m08:36:20.727420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:36:20.727561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:36:20.732995 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:36:20.733120 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:36:20.733257 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:36:20.733365 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:36:20.733491 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:36:20.733611 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m08:36:20.733729 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:36:20.733845 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:36:20.733991 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m08:36:20.740384 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m08:36:20.740489 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m08:36:20.740930 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:36:20.741326 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m08:36:20.741446 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m08:36:20.741925 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m08:36:20.742033 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:36:20.742163 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m08:36:20.742592 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m08:36:20.744252 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:20.744361 [debug] [MainThread]: On master: BEGIN
[0m08:36:20.744449 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:36:20.748433 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:36:20.748538 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:20.748665 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:36:20.753983 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m08:36:20.754375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '825c99c8-d821-4de7-b4d1-4c664671bec3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060de210>]}
[0m08:36:20.754534 [debug] [MainThread]: On master: ROLLBACK
[0m08:36:20.754748 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:20.754843 [debug] [MainThread]: On master: BEGIN
[0m08:36:20.755119 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:36:20.755217 [debug] [MainThread]: On master: COMMIT
[0m08:36:20.755307 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:20.755395 [debug] [MainThread]: On master: COMMIT
[0m08:36:20.755555 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:36:20.755650 [debug] [MainThread]: On master: Close
[0m08:36:20.756892 [debug] [Thread-1 (]: Began running node model.sumup.stg_transaction
[0m08:36:20.757080 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_staging.stg_transaction .................. [RUN]
[0m08:36:20.757241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.stg_transaction)
[0m08:36:20.757370 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_transaction
[0m08:36:20.760428 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m08:36:20.760700 [debug] [Thread-1 (]: Began executing node model.sumup.stg_transaction
[0m08:36:20.774447 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_transaction"
[0m08:36:20.775002 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:36:20.775135 [debug] [Thread-1 (]: On model.sumup.stg_transaction: BEGIN
[0m08:36:20.775250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:36:20.780197 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:36:20.780348 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:36:20.780495 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  create view "postgres"."analytics_staging"."stg_transaction__dbt_tmp"
    
    
  as (
    SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
    SHA256(
        CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))) as product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) / 100 AS amount_eur,
    LOWER(status) AS status,

    -- PII Protection (Hashing sensitive data for security)
    SHA256( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    SHA256( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."device"
  );
[0m08:36:20.781459 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "device_id" does not exist
LINE 10:     CAST(device_id AS INTEGER) AS device_id,
                  ^

[0m08:36:20.781584 [debug] [Thread-1 (]: On model.sumup.stg_transaction: ROLLBACK
[0m08:36:20.781819 [debug] [Thread-1 (]: On model.sumup.stg_transaction: Close
[0m08:36:20.787099 [debug] [Thread-1 (]: Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  column "device_id" does not exist
  LINE 10:     CAST(device_id AS INTEGER) AS device_id,
                    ^
  compiled code at target/run/sumup/models/staging/stg_transaction.sql
[0m08:36:20.788082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '825c99c8-d821-4de7-b4d1-4c664671bec3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106165e90>]}
[0m08:36:20.788388 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_staging.stg_transaction ......... [[31mERROR[0m in 0.03s]
[0m08:36:20.788630 [debug] [Thread-1 (]: Finished running node model.sumup.stg_transaction
[0m08:36:20.788856 [debug] [Thread-7 (]: Marking all children of 'model.sumup.stg_transaction' to be skipped because of status 'error'.  Reason: Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  column "device_id" does not exist
  LINE 10:     CAST(device_id AS INTEGER) AS device_id,
                    ^
  compiled code at target/run/sumup/models/staging/stg_transaction.sql.
[0m08:36:20.789657 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:20.789782 [debug] [MainThread]: On master: BEGIN
[0m08:36:20.789877 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:36:20.795025 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:36:20.795189 [debug] [MainThread]: On master: COMMIT
[0m08:36:20.795301 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:20.795404 [debug] [MainThread]: On master: COMMIT
[0m08:36:20.795554 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:36:20.795659 [debug] [MainThread]: On master: Close
[0m08:36:20.795808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:36:20.795912 [debug] [MainThread]: Connection 'model.sumup.stg_transaction' was properly closed.
[0m08:36:20.795998 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m08:36:20.796082 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m08:36:20.796189 [info ] [MainThread]: 
[0m08:36:20.796312 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m08:36:20.796585 [debug] [MainThread]: Command end result
[0m08:36:20.804979 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:36:20.805664 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:36:20.807877 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m08:36:20.807986 [info ] [MainThread]: 
[0m08:36:20.808130 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:36:20.808262 [info ] [MainThread]: 
[0m08:36:20.808429 [error] [MainThread]: [31mFailure in model stg_transaction (models/staging/stg_transaction.sql)[0m
[0m08:36:20.808568 [error] [MainThread]:   Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  column "device_id" does not exist
  LINE 10:     CAST(device_id AS INTEGER) AS device_id,
                    ^
  compiled code at target/run/sumup/models/staging/stg_transaction.sql
[0m08:36:20.808707 [info ] [MainThread]: 
[0m08:36:20.808861 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/staging/stg_transaction.sql
[0m08:36:20.808971 [info ] [MainThread]: 
[0m08:36:20.809091 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m08:36:20.809301 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:36:20.811387 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6880553, "process_in_blocks": "0", "process_kernel_time": 0.173389, "process_mem_max_rss": "127041536", "process_out_blocks": "0", "process_user_time": 0.888333}
[0m08:36:20.811570 [debug] [MainThread]: Command `dbt run` failed at 08:36:20.811539 after 0.69 seconds
[0m08:36:20.811711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c558b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106468950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e2450>]}
[0m08:36:20.811849 [debug] [MainThread]: Flushing usage events
[0m08:36:21.494246 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:37:17.550584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a14050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110137c50>]}


============================== 08:37:17.553312 | a5c9fbc2-bfaa-4540-921b-57d8de9079dd ==============================
[0m08:37:17.553312 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:37:17.553575 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'no_print': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'log_format': 'default', 'write_json': 'True', 'empty': 'False', 'invocation_command': 'dbt run -m stg_transaction', 'target_path': 'None', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'quiet': 'False', 'version_check': 'True', 'use_colors': 'True', 'warn_error': 'None'}
[0m08:37:17.553780 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m08:37:17.553936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a5c9fbc2-bfaa-4540-921b-57d8de9079dd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11001f6f0>]}
[0m08:37:17.640932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5c9fbc2-bfaa-4540-921b-57d8de9079dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fcacf0>]}
[0m08:37:17.662554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5c9fbc2-bfaa-4540-921b-57d8de9079dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd7d50>]}
[0m08:37:17.663020 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:37:17.715748 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:37:17.767495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:37:17.767804 [debug] [MainThread]: Partial parsing: updated file: sumup://models/staging/stg_transaction.sql
[0m08:37:17.855229 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m08:37:17.857071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5c9fbc2-bfaa-4540-921b-57d8de9079dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f37a70>]}
[0m08:37:17.882248 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:37:17.883395 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:37:17.894176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5c9fbc2-bfaa-4540-921b-57d8de9079dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d74f30>]}
[0m08:37:17.894381 [info ] [MainThread]: Found 3 seeds, 2 models, 447 macros
[0m08:37:17.894514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5c9fbc2-bfaa-4540-921b-57d8de9079dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d5bee0>]}
[0m08:37:17.895101 [info ] [MainThread]: 
[0m08:37:17.895236 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:37:17.895338 [info ] [MainThread]: 
[0m08:37:17.895530 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:37:17.895852 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m08:37:17.948856 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m08:37:17.949030 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m08:37:17.949137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:37:17.969607 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.020 seconds
[0m08:37:17.970164 [debug] [ThreadPool]: On list_postgres: Close
[0m08:37:17.971910 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_analytics)
[0m08:37:17.974132 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:37:17.974303 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m08:37:17.974410 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m08:37:17.974574 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m08:37:17.975365 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:37:17.975514 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:37:17.976076 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:37:17.976191 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m08:37:17.976350 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m08:37:17.976457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:37:17.976562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:37:17.982673 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:37:17.982806 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:37:17.982918 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:37:17.983053 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:37:17.983175 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m08:37:17.983296 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:37:17.983416 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m08:37:17.983708 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:37:17.983839 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:37:17.989713 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m08:37:17.989825 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m08:37:17.990260 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:37:17.990368 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m08:37:17.990792 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m08:37:17.991262 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m08:37:17.991391 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:37:17.991505 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m08:37:17.991740 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m08:37:17.993538 [debug] [MainThread]: Using postgres connection "master"
[0m08:37:17.993646 [debug] [MainThread]: On master: BEGIN
[0m08:37:17.993740 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:37:17.998845 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:37:17.998950 [debug] [MainThread]: Using postgres connection "master"
[0m08:37:17.999088 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:37:18.003700 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m08:37:18.004097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5c9fbc2-bfaa-4540-921b-57d8de9079dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10408b590>]}
[0m08:37:18.004259 [debug] [MainThread]: On master: ROLLBACK
[0m08:37:18.004455 [debug] [MainThread]: Using postgres connection "master"
[0m08:37:18.004550 [debug] [MainThread]: On master: BEGIN
[0m08:37:18.004801 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:37:18.004899 [debug] [MainThread]: On master: COMMIT
[0m08:37:18.004990 [debug] [MainThread]: Using postgres connection "master"
[0m08:37:18.005081 [debug] [MainThread]: On master: COMMIT
[0m08:37:18.005232 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:37:18.005328 [debug] [MainThread]: On master: Close
[0m08:37:18.006540 [debug] [Thread-1 (]: Began running node model.sumup.stg_transaction
[0m08:37:18.006728 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_staging.stg_transaction .................. [RUN]
[0m08:37:18.006887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.stg_transaction)
[0m08:37:18.007016 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_transaction
[0m08:37:18.010083 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m08:37:18.010346 [debug] [Thread-1 (]: Began executing node model.sumup.stg_transaction
[0m08:37:18.023858 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_transaction"
[0m08:37:18.024245 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:37:18.024377 [debug] [Thread-1 (]: On model.sumup.stg_transaction: BEGIN
[0m08:37:18.024492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:37:18.029661 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:37:18.029790 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:37:18.029938 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  create view "postgres"."analytics_staging"."stg_transaction__dbt_tmp"
    
    
  as (
    SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
    SHA256(
        CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))) as product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) / 100 AS amount_eur,
    LOWER(status) AS status,

    -- PII Protection (Hashing sensitive data for security)
    SHA256( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    SHA256( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  );
[0m08:37:18.035338 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function sha256(text) does not exist
LINE 13:     SHA256(
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m08:37:18.035492 [debug] [Thread-1 (]: On model.sumup.stg_transaction: ROLLBACK
[0m08:37:18.035701 [debug] [Thread-1 (]: On model.sumup.stg_transaction: Close
[0m08:37:18.041179 [debug] [Thread-1 (]: Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  function sha256(text) does not exist
  LINE 13:     SHA256(
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/sumup/models/staging/stg_transaction.sql
[0m08:37:18.042127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5c9fbc2-bfaa-4540-921b-57d8de9079dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dc9e90>]}
[0m08:37:18.042403 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_staging.stg_transaction ......... [[31mERROR[0m in 0.03s]
[0m08:37:18.042636 [debug] [Thread-1 (]: Finished running node model.sumup.stg_transaction
[0m08:37:18.042851 [debug] [Thread-7 (]: Marking all children of 'model.sumup.stg_transaction' to be skipped because of status 'error'.  Reason: Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  function sha256(text) does not exist
  LINE 13:     SHA256(
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/sumup/models/staging/stg_transaction.sql.
[0m08:37:18.043592 [debug] [MainThread]: Using postgres connection "master"
[0m08:37:18.043710 [debug] [MainThread]: On master: BEGIN
[0m08:37:18.043811 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:37:18.048165 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:37:18.048263 [debug] [MainThread]: On master: COMMIT
[0m08:37:18.048352 [debug] [MainThread]: Using postgres connection "master"
[0m08:37:18.048437 [debug] [MainThread]: On master: COMMIT
[0m08:37:18.048629 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:37:18.048713 [debug] [MainThread]: On master: Close
[0m08:37:18.048836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:37:18.049003 [debug] [MainThread]: Connection 'model.sumup.stg_transaction' was properly closed.
[0m08:37:18.049116 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m08:37:18.049209 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m08:37:18.049318 [info ] [MainThread]: 
[0m08:37:18.049436 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m08:37:18.049692 [debug] [MainThread]: Command end result
[0m08:37:18.058287 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:37:18.059014 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:37:18.061267 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m08:37:18.061383 [info ] [MainThread]: 
[0m08:37:18.061522 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:37:18.061636 [info ] [MainThread]: 
[0m08:37:18.061778 [error] [MainThread]: [31mFailure in model stg_transaction (models/staging/stg_transaction.sql)[0m
[0m08:37:18.061915 [error] [MainThread]:   Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  function sha256(text) does not exist
  LINE 13:     SHA256(
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/sumup/models/staging/stg_transaction.sql
[0m08:37:18.062034 [info ] [MainThread]: 
[0m08:37:18.062158 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/staging/stg_transaction.sql
[0m08:37:18.062256 [info ] [MainThread]: 
[0m08:37:18.062367 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m08:37:18.062564 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:37:18.064770 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.54609174, "process_in_blocks": "0", "process_kernel_time": 0.161093, "process_mem_max_rss": "130433024", "process_out_blocks": "0", "process_user_time": 0.855517}
[0m08:37:18.064941 [debug] [MainThread]: Command `dbt run` failed at 08:37:18.064909 after 0.55 seconds
[0m08:37:18.065078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110795c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130c8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d42950>]}
[0m08:37:18.065202 [debug] [MainThread]: Flushing usage events
[0m08:37:18.786382 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:38:19.945578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cbc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b039d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b03c50>]}


============================== 08:38:19.948185 | 7629caad-b504-4a87-a21f-a580477bf98f ==============================
[0m08:38:19.948185 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:38:19.948463 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'target_path': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'invocation_command': 'dbt run -m stg_transaction', 'use_colors': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_format': 'default'}
[0m08:38:19.948674 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m08:38:19.948822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7629caad-b504-4a87-a21f-a580477bf98f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e76f0>]}
[0m08:38:20.040747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7629caad-b504-4a87-a21f-a580477bf98f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106992cf0>]}
[0m08:38:20.062054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7629caad-b504-4a87-a21f-a580477bf98f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10699bd50>]}
[0m08:38:20.062538 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:38:20.116733 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:38:20.168587 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:38:20.168857 [debug] [MainThread]: Partial parsing: updated file: sumup://models/staging/stg_transaction.sql
[0m08:38:20.403262 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m08:38:20.405266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7629caad-b504-4a87-a21f-a580477bf98f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aafa70>]}
[0m08:38:20.431875 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:38:20.433069 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:38:20.444588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7629caad-b504-4a87-a21f-a580477bf98f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d6cf30>]}
[0m08:38:20.444822 [info ] [MainThread]: Found 3 seeds, 2 models, 447 macros
[0m08:38:20.444955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7629caad-b504-4a87-a21f-a580477bf98f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d53ee0>]}
[0m08:38:20.445650 [info ] [MainThread]: 
[0m08:38:20.445818 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:38:20.445936 [info ] [MainThread]: 
[0m08:38:20.446139 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:38:20.446478 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m08:38:20.516280 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m08:38:20.516486 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m08:38:20.516601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:20.541285 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.025 seconds
[0m08:38:20.541894 [debug] [ThreadPool]: On list_postgres: Close
[0m08:38:20.543724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics)
[0m08:38:20.543969 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m08:38:20.546198 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:38:20.546390 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m08:38:20.547240 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:38:20.547368 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m08:38:20.547975 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:38:20.548091 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m08:38:20.548200 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:38:20.548304 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m08:38:20.548420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:20.548594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:20.553283 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:38:20.553493 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:38:20.553644 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:38:20.553797 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:38:20.553938 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:38:20.554109 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:38:20.554262 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:38:20.554403 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m08:38:20.554567 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m08:38:20.559666 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m08:38:20.559833 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m08:38:20.559937 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m08:38:20.560485 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m08:38:20.560944 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:38:20.561369 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m08:38:20.561639 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m08:38:20.561748 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m08:38:20.561860 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:38:20.564584 [debug] [MainThread]: Using postgres connection "master"
[0m08:38:20.564739 [debug] [MainThread]: On master: BEGIN
[0m08:38:20.564838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:38:20.569148 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:38:20.569270 [debug] [MainThread]: Using postgres connection "master"
[0m08:38:20.569402 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:38:20.576798 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m08:38:20.577369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7629caad-b504-4a87-a21f-a580477bf98f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103787590>]}
[0m08:38:20.577570 [debug] [MainThread]: On master: ROLLBACK
[0m08:38:20.577821 [debug] [MainThread]: Using postgres connection "master"
[0m08:38:20.577928 [debug] [MainThread]: On master: BEGIN
[0m08:38:20.578258 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:38:20.578357 [debug] [MainThread]: On master: COMMIT
[0m08:38:20.578457 [debug] [MainThread]: Using postgres connection "master"
[0m08:38:20.578553 [debug] [MainThread]: On master: COMMIT
[0m08:38:20.578740 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:38:20.578840 [debug] [MainThread]: On master: Close
[0m08:38:20.580224 [debug] [Thread-1 (]: Began running node model.sumup.stg_transaction
[0m08:38:20.580425 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_staging.stg_transaction .................. [RUN]
[0m08:38:20.580597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.stg_transaction)
[0m08:38:20.580738 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_transaction
[0m08:38:20.584001 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m08:38:20.584293 [debug] [Thread-1 (]: Began executing node model.sumup.stg_transaction
[0m08:38:20.598872 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_transaction"
[0m08:38:20.599268 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:38:20.599412 [debug] [Thread-1 (]: On model.sumup.stg_transaction: BEGIN
[0m08:38:20.599537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:38:20.603530 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:38:20.603701 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:38:20.603849 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  create view "postgres"."analytics_staging"."stg_transaction__dbt_tmp"
    
    
  as (
    SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
    SHA2_HEX(
        CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))
    ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) / 100 AS amount_eur,
    LOWER(status) AS status,

    -- PII Protection (Hashing sensitive data for security)
    SHA256( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    SHA256( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  );
[0m08:38:20.604794 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function sha2_hex(text) does not exist
LINE 13:     SHA2_HEX(
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m08:38:20.604930 [debug] [Thread-1 (]: On model.sumup.stg_transaction: ROLLBACK
[0m08:38:20.605175 [debug] [Thread-1 (]: On model.sumup.stg_transaction: Close
[0m08:38:20.610644 [debug] [Thread-1 (]: Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  function sha2_hex(text) does not exist
  LINE 13:     SHA2_HEX(
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/sumup/models/staging/stg_transaction.sql
[0m08:38:20.611490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7629caad-b504-4a87-a21f-a580477bf98f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dbde90>]}
[0m08:38:20.611768 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_staging.stg_transaction ......... [[31mERROR[0m in 0.03s]
[0m08:38:20.611997 [debug] [Thread-1 (]: Finished running node model.sumup.stg_transaction
[0m08:38:20.612200 [debug] [Thread-7 (]: Marking all children of 'model.sumup.stg_transaction' to be skipped because of status 'error'.  Reason: Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  function sha2_hex(text) does not exist
  LINE 13:     SHA2_HEX(
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/sumup/models/staging/stg_transaction.sql.
[0m08:38:20.612944 [debug] [MainThread]: Using postgres connection "master"
[0m08:38:20.613085 [debug] [MainThread]: On master: BEGIN
[0m08:38:20.613194 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:38:20.617973 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:38:20.618095 [debug] [MainThread]: On master: COMMIT
[0m08:38:20.618211 [debug] [MainThread]: Using postgres connection "master"
[0m08:38:20.618385 [debug] [MainThread]: On master: COMMIT
[0m08:38:20.618566 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:38:20.618672 [debug] [MainThread]: On master: Close
[0m08:38:20.618814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:38:20.618912 [debug] [MainThread]: Connection 'model.sumup.stg_transaction' was properly closed.
[0m08:38:20.619025 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m08:38:20.619113 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m08:38:20.619221 [info ] [MainThread]: 
[0m08:38:20.619339 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m08:38:20.619598 [debug] [MainThread]: Command end result
[0m08:38:20.628285 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:38:20.629121 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:38:20.631556 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m08:38:20.631689 [info ] [MainThread]: 
[0m08:38:20.631846 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:38:20.631971 [info ] [MainThread]: 
[0m08:38:20.632125 [error] [MainThread]: [31mFailure in model stg_transaction (models/staging/stg_transaction.sql)[0m
[0m08:38:20.632291 [error] [MainThread]:   Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  function sha2_hex(text) does not exist
  LINE 13:     SHA2_HEX(
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/sumup/models/staging/stg_transaction.sql
[0m08:38:20.632433 [info ] [MainThread]: 
[0m08:38:20.632570 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/staging/stg_transaction.sql
[0m08:38:20.632675 [info ] [MainThread]: 
[0m08:38:20.632795 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m08:38:20.632998 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:38:20.635498 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7220935, "process_in_blocks": "0", "process_kernel_time": 0.169804, "process_mem_max_rss": "125501440", "process_out_blocks": "0", "process_user_time": 0.891909}
[0m08:38:20.635775 [debug] [MainThread]: Command `dbt run` failed at 08:38:20.635723 after 0.72 seconds
[0m08:38:20.635966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ad8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c0950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d3a950>]}
[0m08:38:20.636133 [debug] [MainThread]: Flushing usage events
[0m08:38:21.334052 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:39:17.318412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fe8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e2b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e2bc50>]}


============================== 08:39:17.321726 | 3ddebd2d-8132-4c2c-818d-93f9f9a50d8e ==============================
[0m08:39:17.321726 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:39:17.322025 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'debug': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run -m stg_transaction', 'cache_selected_only': 'False', 'write_json': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'printer_width': '80', 'partial_parse': 'True', 'static_parser': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'warn_error': 'None', 'empty': 'False', 'quiet': 'False', 'fail_fast': 'False', 'introspect': 'True'}
[0m08:39:17.322389 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m08:39:17.322538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3ddebd2d-8132-4c2c-818d-93f9f9a50d8e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d136f0>]}
[0m08:39:17.432126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ddebd2d-8132-4c2c-818d-93f9f9a50d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cbecf0>]}
[0m08:39:17.455957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ddebd2d-8132-4c2c-818d-93f9f9a50d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ccbd50>]}
[0m08:39:17.456490 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:39:17.509646 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:39:17.564485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:39:17.564794 [debug] [MainThread]: Partial parsing: updated file: sumup://models/staging/stg_transaction.sql
[0m08:39:17.653553 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m08:39:17.655394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ddebd2d-8132-4c2c-818d-93f9f9a50d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dd3a70>]}
[0m08:39:17.680882 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:39:17.682031 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:39:17.693000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ddebd2d-8132-4c2c-818d-93f9f9a50d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106098f30>]}
[0m08:39:17.693199 [info ] [MainThread]: Found 3 seeds, 2 models, 447 macros
[0m08:39:17.693327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ddebd2d-8132-4c2c-818d-93f9f9a50d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10607fee0>]}
[0m08:39:17.693922 [info ] [MainThread]: 
[0m08:39:17.694053 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:39:17.694152 [info ] [MainThread]: 
[0m08:39:17.694343 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:39:17.694673 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m08:39:17.746933 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m08:39:17.747106 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m08:39:17.747209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:39:17.766977 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.020 seconds
[0m08:39:17.767547 [debug] [ThreadPool]: On list_postgres: Close
[0m08:39:17.769354 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m08:39:17.771611 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:39:17.771773 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m08:39:17.771884 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m08:39:17.772083 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m08:39:17.772923 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:39:17.773057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:39:17.773700 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:39:17.773826 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m08:39:17.773996 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m08:39:17.774105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:39:17.774208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:39:17.779031 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:39:17.779154 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:39:17.779262 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m08:39:17.779381 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:39:17.779535 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:39:17.779647 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:39:17.779777 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:39:17.779926 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:39:17.780033 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m08:39:17.783244 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m08:39:17.783372 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m08:39:17.783484 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m08:39:17.783965 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m08:39:17.784388 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m08:39:17.784772 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:39:17.784981 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m08:39:17.785091 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:39:17.785221 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m08:39:17.787107 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:17.787216 [debug] [MainThread]: On master: BEGIN
[0m08:39:17.787306 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:39:17.791587 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:39:17.791684 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:17.791811 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:39:17.796552 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m08:39:17.796959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ddebd2d-8132-4c2c-818d-93f9f9a50d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101a97590>]}
[0m08:39:17.797114 [debug] [MainThread]: On master: ROLLBACK
[0m08:39:17.797286 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:17.797376 [debug] [MainThread]: On master: BEGIN
[0m08:39:17.797602 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:39:17.797695 [debug] [MainThread]: On master: COMMIT
[0m08:39:17.797785 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:17.797880 [debug] [MainThread]: On master: COMMIT
[0m08:39:17.798030 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:39:17.798122 [debug] [MainThread]: On master: Close
[0m08:39:17.799416 [debug] [Thread-1 (]: Began running node model.sumup.stg_transaction
[0m08:39:17.799601 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_staging.stg_transaction .................. [RUN]
[0m08:39:17.799759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.stg_transaction)
[0m08:39:17.799887 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_transaction
[0m08:39:17.802976 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m08:39:17.804458 [debug] [Thread-1 (]: Began executing node model.sumup.stg_transaction
[0m08:39:17.818161 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_transaction"
[0m08:39:17.818661 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:39:17.818815 [debug] [Thread-1 (]: On model.sumup.stg_transaction: BEGIN
[0m08:39:17.818933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:39:17.824639 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m08:39:17.824774 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:39:17.824922 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  create view "postgres"."analytics_staging"."stg_transaction__dbt_tmp"
    
    
  as (
    SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
    ENCODE(
        DIGEST(
            -- Concatenate fields, cast to BYTEA for the function
            CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA,
            'sha256'
        ), 'hex' -- Convert binary output to hexadecimal string
    ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) / 100 AS amount_eur,
    LOWER(status) AS status,

    -- PII Protection (Hashing sensitive data for security)
    SHA256( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    SHA256( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  );
[0m08:39:17.826450 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function digest(bytea, unknown) does not exist
LINE 14:         DIGEST(
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m08:39:17.826574 [debug] [Thread-1 (]: On model.sumup.stg_transaction: ROLLBACK
[0m08:39:17.826830 [debug] [Thread-1 (]: On model.sumup.stg_transaction: Close
[0m08:39:17.832223 [debug] [Thread-1 (]: Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  function digest(bytea, unknown) does not exist
  LINE 14:         DIGEST(
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/sumup/models/staging/stg_transaction.sql
[0m08:39:17.833040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ddebd2d-8132-4c2c-818d-93f9f9a50d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ede90>]}
[0m08:39:17.833294 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_staging.stg_transaction ......... [[31mERROR[0m in 0.03s]
[0m08:39:17.833536 [debug] [Thread-1 (]: Finished running node model.sumup.stg_transaction
[0m08:39:17.833746 [debug] [Thread-7 (]: Marking all children of 'model.sumup.stg_transaction' to be skipped because of status 'error'.  Reason: Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  function digest(bytea, unknown) does not exist
  LINE 14:         DIGEST(
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/sumup/models/staging/stg_transaction.sql.
[0m08:39:17.834495 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:17.834620 [debug] [MainThread]: On master: BEGIN
[0m08:39:17.834720 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:39:17.838365 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:39:17.838471 [debug] [MainThread]: On master: COMMIT
[0m08:39:17.838565 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:17.838652 [debug] [MainThread]: On master: COMMIT
[0m08:39:17.838798 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:39:17.838887 [debug] [MainThread]: On master: Close
[0m08:39:17.839006 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:39:17.839094 [debug] [MainThread]: Connection 'model.sumup.stg_transaction' was properly closed.
[0m08:39:17.839173 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m08:39:17.839251 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m08:39:17.839347 [info ] [MainThread]: 
[0m08:39:17.839457 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m08:39:17.839882 [debug] [MainThread]: Command end result
[0m08:39:17.848573 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:39:17.849309 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:39:17.851605 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m08:39:17.851725 [info ] [MainThread]: 
[0m08:39:17.851865 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:39:17.851985 [info ] [MainThread]: 
[0m08:39:17.852125 [error] [MainThread]: [31mFailure in model stg_transaction (models/staging/stg_transaction.sql)[0m
[0m08:39:17.852268 [error] [MainThread]:   Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  function digest(bytea, unknown) does not exist
  LINE 14:         DIGEST(
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/sumup/models/staging/stg_transaction.sql
[0m08:39:17.852380 [info ] [MainThread]: 
[0m08:39:17.852505 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/staging/stg_transaction.sql
[0m08:39:17.852609 [info ] [MainThread]: 
[0m08:39:17.852725 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m08:39:17.852920 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:39:17.854607 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5721786, "process_in_blocks": "0", "process_kernel_time": 0.162055, "process_mem_max_rss": "128860160", "process_out_blocks": "0", "process_user_time": 0.872693}
[0m08:39:17.854816 [debug] [MainThread]: Command `dbt run` failed at 08:39:17.854779 after 0.57 seconds
[0m08:39:17.854975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bdd270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ec950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106066950>]}
[0m08:39:17.855107 [debug] [MainThread]: Flushing usage events
[0m08:39:18.565438 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:39:37.214985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109937c50>]}


============================== 08:39:37.217393 | 1150dad8-70b4-4b5e-b182-4f8af66557b3 ==============================
[0m08:39:37.217393 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:39:37.217664 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'empty': 'False', 'target_path': 'None', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run -m stg_transaction', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'use_colors': 'True', 'no_print': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'log_format': 'default', 'log_cache_events': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'write_json': 'True'}
[0m08:39:37.217870 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m08:39:37.218015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1150dad8-70b4-4b5e-b182-4f8af66557b3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10981f6f0>]}
[0m08:39:37.300441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1150dad8-70b4-4b5e-b182-4f8af66557b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096cacf0>]}
[0m08:39:37.321735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1150dad8-70b4-4b5e-b182-4f8af66557b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096d7d50>]}
[0m08:39:37.322131 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:39:37.371395 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:39:37.423560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:39:37.423862 [debug] [MainThread]: Partial parsing: updated file: sumup://models/staging/stg_transaction.sql
[0m08:39:37.514656 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m08:39:37.516555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1150dad8-70b4-4b5e-b182-4f8af66557b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aab3a70>]}
[0m08:39:37.542037 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:39:37.543136 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:39:37.553586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1150dad8-70b4-4b5e-b182-4f8af66557b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b774f30>]}
[0m08:39:37.553828 [info ] [MainThread]: Found 3 seeds, 2 models, 447 macros
[0m08:39:37.553965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1150dad8-70b4-4b5e-b182-4f8af66557b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b75bee0>]}
[0m08:39:37.554562 [info ] [MainThread]: 
[0m08:39:37.554701 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:39:37.554804 [info ] [MainThread]: 
[0m08:39:37.555079 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:39:37.555454 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m08:39:37.609885 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m08:39:37.610079 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m08:39:37.610188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:39:37.627854 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.018 seconds
[0m08:39:37.628462 [debug] [ThreadPool]: On list_postgres: Close
[0m08:39:37.630245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_analytics)
[0m08:39:37.630450 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m08:39:37.632598 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:39:37.632777 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m08:39:37.633565 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:39:37.633688 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m08:39:37.634242 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:39:37.634348 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m08:39:37.634446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:39:37.634541 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m08:39:37.634661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:39:37.634841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:39:37.639792 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:39:37.639930 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:39:37.640033 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:39:37.640145 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:39:37.640253 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:39:37.640375 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m08:39:37.640505 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m08:39:37.640614 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:39:37.640782 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:39:37.646384 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m08:39:37.646503 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m08:39:37.646976 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:39:37.647083 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m08:39:37.647497 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m08:39:37.647930 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m08:39:37.648039 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:39:37.648290 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m08:39:37.648385 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m08:39:37.650300 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:37.650442 [debug] [MainThread]: On master: BEGIN
[0m08:39:37.650542 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:39:37.653971 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m08:39:37.654103 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:37.654242 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:39:37.660630 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m08:39:37.661077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1150dad8-70b4-4b5e-b182-4f8af66557b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b736150>]}
[0m08:39:37.661249 [debug] [MainThread]: On master: ROLLBACK
[0m08:39:37.661521 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:37.661619 [debug] [MainThread]: On master: BEGIN
[0m08:39:37.662083 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:39:37.662192 [debug] [MainThread]: On master: COMMIT
[0m08:39:37.662288 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:37.662379 [debug] [MainThread]: On master: COMMIT
[0m08:39:37.662530 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:39:37.662626 [debug] [MainThread]: On master: Close
[0m08:39:37.663782 [debug] [Thread-1 (]: Began running node model.sumup.stg_transaction
[0m08:39:37.663970 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_staging.stg_transaction .................. [RUN]
[0m08:39:37.664135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.stg_transaction)
[0m08:39:37.664264 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_transaction
[0m08:39:37.667296 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m08:39:37.667562 [debug] [Thread-1 (]: Began executing node model.sumup.stg_transaction
[0m08:39:37.680615 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_transaction"
[0m08:39:37.680989 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:39:37.681118 [debug] [Thread-1 (]: On model.sumup.stg_transaction: BEGIN
[0m08:39:37.681231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:39:37.686166 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:39:37.686315 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:39:37.686479 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  create view "postgres"."analytics_staging"."stg_transaction__dbt_tmp"
    
    
  as (
    CREATE EXTENSION IF NOT EXISTS pgcrypto;


SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
    ENCODE(
        DIGEST(
            -- Concatenate fields, cast to BYTEA for the function
            CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA,
            'sha256'
        ), 'hex' -- Convert binary output to hexadecimal string
    ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) / 100 AS amount_eur,
    LOWER(status) AS status,

    -- PII Protection (Hashing sensitive data for security)
    SHA256( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    SHA256( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  );
[0m08:39:37.686841 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "CREATE"
LINE 7:     CREATE EXTENSION IF NOT EXISTS pgcrypto;
            ^

[0m08:39:37.687015 [debug] [Thread-1 (]: On model.sumup.stg_transaction: ROLLBACK
[0m08:39:37.687273 [debug] [Thread-1 (]: On model.sumup.stg_transaction: Close
[0m08:39:37.692490 [debug] [Thread-1 (]: Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  syntax error at or near "CREATE"
  LINE 7:     CREATE EXTENSION IF NOT EXISTS pgcrypto;
              ^
  compiled code at target/run/sumup/models/staging/stg_transaction.sql
[0m08:39:37.693360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1150dad8-70b4-4b5e-b182-4f8af66557b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7c9d30>]}
[0m08:39:37.693623 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_staging.stg_transaction ......... [[31mERROR[0m in 0.03s]
[0m08:39:37.693852 [debug] [Thread-1 (]: Finished running node model.sumup.stg_transaction
[0m08:39:37.694052 [debug] [Thread-7 (]: Marking all children of 'model.sumup.stg_transaction' to be skipped because of status 'error'.  Reason: Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  syntax error at or near "CREATE"
  LINE 7:     CREATE EXTENSION IF NOT EXISTS pgcrypto;
              ^
  compiled code at target/run/sumup/models/staging/stg_transaction.sql.
[0m08:39:37.694788 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:37.694907 [debug] [MainThread]: On master: BEGIN
[0m08:39:37.695006 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:39:37.700036 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:39:37.700232 [debug] [MainThread]: On master: COMMIT
[0m08:39:37.700360 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:37.700464 [debug] [MainThread]: On master: COMMIT
[0m08:39:37.700629 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:39:37.700737 [debug] [MainThread]: On master: Close
[0m08:39:37.700868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:39:37.700957 [debug] [MainThread]: Connection 'model.sumup.stg_transaction' was properly closed.
[0m08:39:37.701039 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m08:39:37.701116 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m08:39:37.701211 [info ] [MainThread]: 
[0m08:39:37.701352 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m08:39:37.701625 [debug] [MainThread]: Command end result
[0m08:39:37.710359 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:39:37.711068 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:39:37.713278 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m08:39:37.713397 [info ] [MainThread]: 
[0m08:39:37.713545 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:39:37.713662 [info ] [MainThread]: 
[0m08:39:37.713806 [error] [MainThread]: [31mFailure in model stg_transaction (models/staging/stg_transaction.sql)[0m
[0m08:39:37.713939 [error] [MainThread]:   Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  syntax error at or near "CREATE"
  LINE 7:     CREATE EXTENSION IF NOT EXISTS pgcrypto;
              ^
  compiled code at target/run/sumup/models/staging/stg_transaction.sql
[0m08:39:37.714049 [info ] [MainThread]: 
[0m08:39:37.714174 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/staging/stg_transaction.sql
[0m08:39:37.714273 [info ] [MainThread]: 
[0m08:39:37.714387 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m08:39:37.714582 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:39:37.716071 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.53045803, "process_in_blocks": "0", "process_kernel_time": 0.156763, "process_mem_max_rss": "128794624", "process_out_blocks": "0", "process_user_time": 0.856461}
[0m08:39:37.716227 [debug] [MainThread]: Command `dbt run` failed at 08:39:37.716196 after 0.53 seconds
[0m08:39:37.716360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8b98b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cac8440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b742950>]}
[0m08:39:37.716484 [debug] [MainThread]: Flushing usage events
[0m08:39:38.410532 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:39:43.541116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cd4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11313b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11313bc50>]}


============================== 08:39:43.543488 | f4e740cd-bc1e-4f4a-a3ca-6512cebf7000 ==============================
[0m08:39:43.543488 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:39:43.543763 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'quiet': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'invocation_command': 'dbt run -m stg_transaction', 'empty': 'False', 'printer_width': '80', 'static_parser': 'True', 'version_check': 'True', 'no_print': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'use_colors': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error': 'None'}
[0m08:39:43.543967 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m08:39:43.544109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f4e740cd-bc1e-4f4a-a3ca-6512cebf7000', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11301f6f0>]}
[0m08:39:43.613464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4e740cd-bc1e-4f4a-a3ca-6512cebf7000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fcacf0>]}
[0m08:39:43.635178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4e740cd-bc1e-4f4a-a3ca-6512cebf7000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fd7d50>]}
[0m08:39:43.635718 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:39:43.683290 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:39:43.731315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:39:43.731599 [debug] [MainThread]: Partial parsing: updated file: sumup://models/staging/stg_transaction.sql
[0m08:39:43.818200 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m08:39:43.820071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4e740cd-bc1e-4f4a-a3ca-6512cebf7000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142afa70>]}
[0m08:39:43.845844 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:39:43.846719 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:39:43.856628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4e740cd-bc1e-4f4a-a3ca-6512cebf7000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114674f30>]}
[0m08:39:43.856821 [info ] [MainThread]: Found 3 seeds, 2 models, 447 macros
[0m08:39:43.856953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4e740cd-bc1e-4f4a-a3ca-6512cebf7000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11465bee0>]}
[0m08:39:43.857530 [info ] [MainThread]: 
[0m08:39:43.857662 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:39:43.857764 [info ] [MainThread]: 
[0m08:39:43.857959 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:39:43.858290 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m08:39:43.905914 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m08:39:43.906111 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m08:39:43.906227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:39:43.920640 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.014 seconds
[0m08:39:43.921220 [debug] [ThreadPool]: On list_postgres: Close
[0m08:39:43.922907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m08:39:43.923120 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m08:39:43.925206 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:39:43.925384 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m08:39:43.926164 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:39:43.926287 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m08:39:43.926831 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:39:43.926937 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m08:39:43.927034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:39:43.927127 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m08:39:43.927217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:39:43.927368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:39:43.935685 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m08:39:43.935788 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:39:43.935891 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:39:43.937133 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m08:39:43.937270 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m08:39:43.937366 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:39:43.937466 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:39:43.937571 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m08:39:43.937688 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m08:39:43.941310 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m08:39:43.941776 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m08:39:43.941883 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m08:39:43.941993 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m08:39:43.942104 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m08:39:43.942477 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:39:43.942851 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m08:39:43.943223 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:39:43.943413 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m08:39:43.944961 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:43.945067 [debug] [MainThread]: On master: BEGIN
[0m08:39:43.945154 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:39:43.949066 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:39:43.949166 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:43.949297 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:39:43.954049 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m08:39:43.954453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4e740cd-bc1e-4f4a-a3ca-6512cebf7000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106297650>]}
[0m08:39:43.954610 [debug] [MainThread]: On master: ROLLBACK
[0m08:39:43.954813 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:43.954907 [debug] [MainThread]: On master: BEGIN
[0m08:39:43.955209 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:39:43.955306 [debug] [MainThread]: On master: COMMIT
[0m08:39:43.955395 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:43.955484 [debug] [MainThread]: On master: COMMIT
[0m08:39:43.955643 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:39:43.955737 [debug] [MainThread]: On master: Close
[0m08:39:43.956864 [debug] [Thread-1 (]: Began running node model.sumup.stg_transaction
[0m08:39:43.957048 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_staging.stg_transaction .................. [RUN]
[0m08:39:43.957206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.stg_transaction)
[0m08:39:43.957332 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_transaction
[0m08:39:43.960331 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m08:39:43.960577 [debug] [Thread-1 (]: Began executing node model.sumup.stg_transaction
[0m08:39:43.974433 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_transaction"
[0m08:39:43.974804 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:39:43.974932 [debug] [Thread-1 (]: On model.sumup.stg_transaction: BEGIN
[0m08:39:43.975046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:39:43.981570 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:39:43.981693 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:39:43.981838 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  create view "postgres"."analytics_staging"."stg_transaction__dbt_tmp"
    
    
  as (
    CREATE EXTENSION IF NOT EXISTS pgcrypto


SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
    ENCODE(
        DIGEST(
            -- Concatenate fields, cast to BYTEA for the function
            CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA,
            'sha256'
        ), 'hex' -- Convert binary output to hexadecimal string
    ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) / 100 AS amount_eur,
    LOWER(status) AS status,

    -- PII Protection (Hashing sensitive data for security)
    SHA256( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    SHA256( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  );
[0m08:39:43.982297 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "CREATE"
LINE 7:     CREATE EXTENSION IF NOT EXISTS pgcrypto
            ^

[0m08:39:43.982415 [debug] [Thread-1 (]: On model.sumup.stg_transaction: ROLLBACK
[0m08:39:43.982664 [debug] [Thread-1 (]: On model.sumup.stg_transaction: Close
[0m08:39:43.987838 [debug] [Thread-1 (]: Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  syntax error at or near "CREATE"
  LINE 7:     CREATE EXTENSION IF NOT EXISTS pgcrypto
              ^
  compiled code at target/run/sumup/models/staging/stg_transaction.sql
[0m08:39:43.988659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4e740cd-bc1e-4f4a-a3ca-6512cebf7000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146c9d30>]}
[0m08:39:43.988915 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_staging.stg_transaction ......... [[31mERROR[0m in 0.03s]
[0m08:39:43.989143 [debug] [Thread-1 (]: Finished running node model.sumup.stg_transaction
[0m08:39:43.989348 [debug] [Thread-7 (]: Marking all children of 'model.sumup.stg_transaction' to be skipped because of status 'error'.  Reason: Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  syntax error at or near "CREATE"
  LINE 7:     CREATE EXTENSION IF NOT EXISTS pgcrypto
              ^
  compiled code at target/run/sumup/models/staging/stg_transaction.sql.
[0m08:39:43.990063 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:43.990212 [debug] [MainThread]: On master: BEGIN
[0m08:39:43.990325 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:39:43.995009 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:39:43.995117 [debug] [MainThread]: On master: COMMIT
[0m08:39:43.995209 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:43.995298 [debug] [MainThread]: On master: COMMIT
[0m08:39:43.995539 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:39:43.995676 [debug] [MainThread]: On master: Close
[0m08:39:43.995824 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:39:43.995924 [debug] [MainThread]: Connection 'model.sumup.stg_transaction' was properly closed.
[0m08:39:43.996013 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m08:39:43.996101 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m08:39:43.996204 [info ] [MainThread]: 
[0m08:39:43.996319 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m08:39:43.996579 [debug] [MainThread]: Command end result
[0m08:39:44.005574 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:39:44.006337 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:39:44.008523 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m08:39:44.008634 [info ] [MainThread]: 
[0m08:39:44.008776 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:39:44.008896 [info ] [MainThread]: 
[0m08:39:44.009036 [error] [MainThread]: [31mFailure in model stg_transaction (models/staging/stg_transaction.sql)[0m
[0m08:39:44.009175 [error] [MainThread]:   Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  syntax error at or near "CREATE"
  LINE 7:     CREATE EXTENSION IF NOT EXISTS pgcrypto
              ^
  compiled code at target/run/sumup/models/staging/stg_transaction.sql
[0m08:39:44.009279 [info ] [MainThread]: 
[0m08:39:44.009403 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/staging/stg_transaction.sql
[0m08:39:44.009503 [info ] [MainThread]: 
[0m08:39:44.009617 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m08:39:44.009815 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:39:44.011259 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.4964744, "process_in_blocks": "0", "process_kernel_time": 0.137696, "process_mem_max_rss": "130400256", "process_out_blocks": "0", "process_user_time": 0.880137}
[0m08:39:44.011418 [debug] [MainThread]: Command `dbt run` failed at 08:39:44.011388 after 0.50 seconds
[0m08:39:44.011559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140b5770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149c8440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138577d0>]}
[0m08:39:44.011687 [debug] [MainThread]: Flushing usage events
[0m08:39:44.702087 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:40:50.152773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10721b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10721bc50>]}


============================== 08:40:50.155411 | 446a2743-1146-4f7a-88b5-a30f98fa5552 ==============================
[0m08:40:50.155411 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:40:50.155667 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'version_check': 'True', 'log_format': 'default', 'partial_parse': 'True', 'debug': 'False', 'no_print': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'invocation_command': 'dbt run -m stg_transaction', 'indirect_selection': 'eager', 'write_json': 'True', 'empty': 'False', 'warn_error': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'fail_fast': 'False', 'static_parser': 'True'}
[0m08:40:50.155892 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m08:40:50.156042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '446a2743-1146-4f7a-88b5-a30f98fa5552', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070ff6f0>]}
[0m08:40:50.338986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '446a2743-1146-4f7a-88b5-a30f98fa5552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070aacf0>]}
[0m08:40:50.362469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '446a2743-1146-4f7a-88b5-a30f98fa5552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b7d50>]}
[0m08:40:50.363120 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:40:50.415105 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:40:50.470437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:40:50.470797 [debug] [MainThread]: Partial parsing: updated file: sumup://models/staging/stg_transaction.sql
[0m08:40:50.560470 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m08:40:50.562403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '446a2743-1146-4f7a-88b5-a30f98fa5552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081bfa70>]}
[0m08:40:50.594241 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:40:50.595593 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:40:50.607393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '446a2743-1146-4f7a-88b5-a30f98fa5552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108484f30>]}
[0m08:40:50.607653 [info ] [MainThread]: Found 3 seeds, 2 models, 447 macros
[0m08:40:50.607791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '446a2743-1146-4f7a-88b5-a30f98fa5552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10846bee0>]}
[0m08:40:50.608395 [info ] [MainThread]: 
[0m08:40:50.608537 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:40:50.608641 [info ] [MainThread]: 
[0m08:40:50.608843 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:40:50.609186 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m08:40:50.665444 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m08:40:50.665628 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m08:40:50.665735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:40:50.688852 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.023 seconds
[0m08:40:50.689423 [debug] [ThreadPool]: On list_postgres: Close
[0m08:40:50.691131 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics)
[0m08:40:50.693334 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:40:50.693519 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m08:40:50.693655 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m08:40:50.693834 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m08:40:50.694655 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:40:50.694770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:40:50.695321 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:40:50.695431 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m08:40:50.695591 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m08:40:50.695708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:40:50.695817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:40:50.700820 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:40:50.700982 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:40:50.701089 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:40:50.701189 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:40:50.701294 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:40:50.701404 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m08:40:50.701513 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:40:50.701644 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m08:40:50.701831 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:40:50.707029 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m08:40:50.707142 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m08:40:50.707615 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m08:40:50.707725 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m08:40:50.708088 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:40:50.708534 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m08:40:50.708644 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m08:40:50.709017 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:40:50.709119 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m08:40:50.710874 [debug] [MainThread]: Using postgres connection "master"
[0m08:40:50.710976 [debug] [MainThread]: On master: BEGIN
[0m08:40:50.711062 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:40:50.715343 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:40:50.715449 [debug] [MainThread]: Using postgres connection "master"
[0m08:40:50.715578 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:40:50.720651 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m08:40:50.721045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '446a2743-1146-4f7a-88b5-a30f98fa5552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e9f590>]}
[0m08:40:50.721203 [debug] [MainThread]: On master: ROLLBACK
[0m08:40:50.721422 [debug] [MainThread]: Using postgres connection "master"
[0m08:40:50.721515 [debug] [MainThread]: On master: BEGIN
[0m08:40:50.721808 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:40:50.721905 [debug] [MainThread]: On master: COMMIT
[0m08:40:50.721996 [debug] [MainThread]: Using postgres connection "master"
[0m08:40:50.722084 [debug] [MainThread]: On master: COMMIT
[0m08:40:50.722251 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:40:50.722346 [debug] [MainThread]: On master: Close
[0m08:40:50.723615 [debug] [Thread-1 (]: Began running node model.sumup.stg_transaction
[0m08:40:50.723808 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_staging.stg_transaction .................. [RUN]
[0m08:40:50.723982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.stg_transaction)
[0m08:40:50.724116 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_transaction
[0m08:40:50.727148 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m08:40:50.727408 [debug] [Thread-1 (]: Began executing node model.sumup.stg_transaction
[0m08:40:50.741238 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_transaction"
[0m08:40:50.741661 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:40:50.741803 [debug] [Thread-1 (]: On model.sumup.stg_transaction: BEGIN
[0m08:40:50.741924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:40:50.747295 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:40:50.747441 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:40:50.747591 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  create view "postgres"."analytics_staging"."stg_transaction__dbt_tmp"
    
    
  as (
    CREATE EXTENSION IF NOT EXISTS pgcrypto


SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
   
    CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA  AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) / 100 AS amount_eur,
    LOWER(status) AS status,

    -- PII Protection (Hashing sensitive data for security)
    SHA256( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    SHA256( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  );
[0m08:40:50.747944 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "CREATE"
LINE 7:     CREATE EXTENSION IF NOT EXISTS pgcrypto
            ^

[0m08:40:50.748075 [debug] [Thread-1 (]: On model.sumup.stg_transaction: ROLLBACK
[0m08:40:50.748303 [debug] [Thread-1 (]: On model.sumup.stg_transaction: Close
[0m08:40:50.754004 [debug] [Thread-1 (]: Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  syntax error at or near "CREATE"
  LINE 7:     CREATE EXTENSION IF NOT EXISTS pgcrypto
              ^
  compiled code at target/run/sumup/models/staging/stg_transaction.sql
[0m08:40:50.754888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '446a2743-1146-4f7a-88b5-a30f98fa5552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084d9d30>]}
[0m08:40:50.755142 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_staging.stg_transaction ......... [[31mERROR[0m in 0.03s]
[0m08:40:50.755372 [debug] [Thread-1 (]: Finished running node model.sumup.stg_transaction
[0m08:40:50.755580 [debug] [Thread-7 (]: Marking all children of 'model.sumup.stg_transaction' to be skipped because of status 'error'.  Reason: Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  syntax error at or near "CREATE"
  LINE 7:     CREATE EXTENSION IF NOT EXISTS pgcrypto
              ^
  compiled code at target/run/sumup/models/staging/stg_transaction.sql.
[0m08:40:50.756283 [debug] [MainThread]: Using postgres connection "master"
[0m08:40:50.756399 [debug] [MainThread]: On master: BEGIN
[0m08:40:50.756487 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:40:50.760704 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:40:50.760817 [debug] [MainThread]: On master: COMMIT
[0m08:40:50.760912 [debug] [MainThread]: Using postgres connection "master"
[0m08:40:50.761000 [debug] [MainThread]: On master: COMMIT
[0m08:40:50.761187 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:40:50.761276 [debug] [MainThread]: On master: Close
[0m08:40:50.761401 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:40:50.761488 [debug] [MainThread]: Connection 'model.sumup.stg_transaction' was properly closed.
[0m08:40:50.761572 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m08:40:50.761661 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m08:40:50.761823 [info ] [MainThread]: 
[0m08:40:50.761940 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m08:40:50.762197 [debug] [MainThread]: Command end result
[0m08:40:50.770847 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:40:50.771657 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:40:50.773917 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m08:40:50.774029 [info ] [MainThread]: 
[0m08:40:50.774178 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:40:50.774296 [info ] [MainThread]: 
[0m08:40:50.774439 [error] [MainThread]: [31mFailure in model stg_transaction (models/staging/stg_transaction.sql)[0m
[0m08:40:50.774574 [error] [MainThread]:   Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  syntax error at or near "CREATE"
  LINE 7:     CREATE EXTENSION IF NOT EXISTS pgcrypto
              ^
  compiled code at target/run/sumup/models/staging/stg_transaction.sql
[0m08:40:50.774675 [info ] [MainThread]: 
[0m08:40:50.774796 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/staging/stg_transaction.sql
[0m08:40:50.774895 [info ] [MainThread]: 
[0m08:40:50.775008 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m08:40:50.775202 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:40:50.776676 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6585435, "process_in_blocks": "0", "process_kernel_time": 0.169492, "process_mem_max_rss": "123437056", "process_out_blocks": "0", "process_user_time": 0.884998}
[0m08:40:50.776847 [debug] [MainThread]: Command `dbt run` failed at 08:40:50.776809 after 0.66 seconds
[0m08:40:50.776986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc9270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d8440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108452950>]}
[0m08:40:50.777123 [debug] [MainThread]: Flushing usage events
[0m08:40:51.510618 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:40:58.553656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a74050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b7c50>]}


============================== 08:40:58.556223 | 120b52ce-be7a-4b97-9dfd-3fe135d6a5ac ==============================
[0m08:40:58.556223 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:40:58.556497 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'quiet': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'no_print': 'None', 'invocation_command': 'dbt run -m stg_transaction', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'empty': 'False', 'introspect': 'True', 'write_json': 'True', 'target_path': 'None', 'log_format': 'default', 'static_parser': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'use_colors': 'True', 'log_cache_events': 'False'}
[0m08:40:58.556697 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m08:40:58.556846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '120b52ce-be7a-4b97-9dfd-3fe135d6a5ac', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679f6f0>]}
[0m08:40:58.625782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '120b52ce-be7a-4b97-9dfd-3fe135d6a5ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10674acf0>]}
[0m08:40:58.647438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '120b52ce-be7a-4b97-9dfd-3fe135d6a5ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106757d50>]}
[0m08:40:58.647985 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:40:58.696396 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:40:58.743812 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:40:58.744070 [debug] [MainThread]: Partial parsing: updated file: sumup://models/staging/stg_transaction.sql
[0m08:40:58.829414 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m08:40:58.831245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '120b52ce-be7a-4b97-9dfd-3fe135d6a5ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10785fa70>]}
[0m08:40:58.856782 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:40:58.857685 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:40:58.867520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '120b52ce-be7a-4b97-9dfd-3fe135d6a5ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b24f30>]}
[0m08:40:58.867703 [info ] [MainThread]: Found 3 seeds, 2 models, 447 macros
[0m08:40:58.867834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '120b52ce-be7a-4b97-9dfd-3fe135d6a5ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0fee0>]}
[0m08:40:58.868442 [info ] [MainThread]: 
[0m08:40:58.868579 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:40:58.868684 [info ] [MainThread]: 
[0m08:40:58.868873 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:40:58.869197 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m08:40:58.918374 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m08:40:58.918559 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m08:40:58.918668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:40:58.931179 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.012 seconds
[0m08:40:58.931827 [debug] [ThreadPool]: On list_postgres: Close
[0m08:40:58.933572 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m08:40:58.935874 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:40:58.936059 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m08:40:58.936185 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m08:40:58.936362 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m08:40:58.937245 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:40:58.937387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:40:58.937983 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:40:58.938095 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m08:40:58.938246 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m08:40:58.938359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:40:58.938471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:40:58.942896 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:40:58.943035 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:40:58.943143 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:40:58.943259 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m08:40:58.943380 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:40:58.943481 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:40:58.943610 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:40:58.943726 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:40:58.943854 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m08:40:58.950459 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m08:40:58.950916 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:40:58.951308 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:40:58.952064 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m08:40:58.952466 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m08:40:58.952583 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.009 seconds
[0m08:40:58.952990 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m08:40:58.953088 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m08:40:58.953319 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m08:40:58.954979 [debug] [MainThread]: Using postgres connection "master"
[0m08:40:58.955085 [debug] [MainThread]: On master: BEGIN
[0m08:40:58.955173 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:40:58.959090 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:40:58.959190 [debug] [MainThread]: Using postgres connection "master"
[0m08:40:58.959318 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:40:58.964157 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m08:40:58.964579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '120b52ce-be7a-4b97-9dfd-3fe135d6a5ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aee510>]}
[0m08:40:58.964756 [debug] [MainThread]: On master: ROLLBACK
[0m08:40:58.964971 [debug] [MainThread]: Using postgres connection "master"
[0m08:40:58.965064 [debug] [MainThread]: On master: BEGIN
[0m08:40:58.965342 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:40:58.965437 [debug] [MainThread]: On master: COMMIT
[0m08:40:58.965527 [debug] [MainThread]: Using postgres connection "master"
[0m08:40:58.965613 [debug] [MainThread]: On master: COMMIT
[0m08:40:58.965779 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:40:58.965871 [debug] [MainThread]: On master: Close
[0m08:40:58.967015 [debug] [Thread-1 (]: Began running node model.sumup.stg_transaction
[0m08:40:58.967194 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_staging.stg_transaction .................. [RUN]
[0m08:40:58.967351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.stg_transaction)
[0m08:40:58.967482 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_transaction
[0m08:40:58.970512 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m08:40:58.970760 [debug] [Thread-1 (]: Began executing node model.sumup.stg_transaction
[0m08:40:58.984516 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_transaction"
[0m08:40:58.984931 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:40:58.985095 [debug] [Thread-1 (]: On model.sumup.stg_transaction: BEGIN
[0m08:40:58.985283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:40:58.989588 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:40:58.989725 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:40:58.989868 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  create view "postgres"."analytics_staging"."stg_transaction__dbt_tmp"
    
    
  as (
    SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
   
    CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA  AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) / 100 AS amount_eur,
    LOWER(status) AS status,

    -- PII Protection (Hashing sensitive data for security)
    SHA256( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    SHA256( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  );
[0m08:40:58.991847 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function sha256(text) does not exist
LINE 25:     SHA256( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ...
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m08:40:58.991972 [debug] [Thread-1 (]: On model.sumup.stg_transaction: ROLLBACK
[0m08:40:58.992216 [debug] [Thread-1 (]: On model.sumup.stg_transaction: Close
[0m08:40:58.997524 [debug] [Thread-1 (]: Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  function sha256(text) does not exist
  LINE 25:     SHA256( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/sumup/models/staging/stg_transaction.sql
[0m08:40:58.998428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '120b52ce-be7a-4b97-9dfd-3fe135d6a5ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b7de90>]}
[0m08:40:58.998689 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_staging.stg_transaction ......... [[31mERROR[0m in 0.03s]
[0m08:40:58.998916 [debug] [Thread-1 (]: Finished running node model.sumup.stg_transaction
[0m08:40:58.999121 [debug] [Thread-7 (]: Marking all children of 'model.sumup.stg_transaction' to be skipped because of status 'error'.  Reason: Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  function sha256(text) does not exist
  LINE 25:     SHA256( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/sumup/models/staging/stg_transaction.sql.
[0m08:40:58.999833 [debug] [MainThread]: Using postgres connection "master"
[0m08:40:58.999946 [debug] [MainThread]: On master: BEGIN
[0m08:40:59.000036 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:40:59.003726 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:40:59.003837 [debug] [MainThread]: On master: COMMIT
[0m08:40:59.003932 [debug] [MainThread]: Using postgres connection "master"
[0m08:40:59.004020 [debug] [MainThread]: On master: COMMIT
[0m08:40:59.004195 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:40:59.004285 [debug] [MainThread]: On master: Close
[0m08:40:59.004421 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:40:59.004520 [debug] [MainThread]: Connection 'model.sumup.stg_transaction' was properly closed.
[0m08:40:59.004609 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m08:40:59.004696 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m08:40:59.004793 [info ] [MainThread]: 
[0m08:40:59.004902 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m08:40:59.005235 [debug] [MainThread]: Command end result
[0m08:40:59.013958 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:40:59.014778 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:40:59.017049 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m08:40:59.017173 [info ] [MainThread]: 
[0m08:40:59.017322 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:40:59.017448 [info ] [MainThread]: 
[0m08:40:59.017597 [error] [MainThread]: [31mFailure in model stg_transaction (models/staging/stg_transaction.sql)[0m
[0m08:40:59.017745 [error] [MainThread]:   Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  function sha256(text) does not exist
  LINE 25:     SHA256( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/sumup/models/staging/stg_transaction.sql
[0m08:40:59.017854 [info ] [MainThread]: 
[0m08:40:59.017983 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/staging/stg_transaction.sql
[0m08:40:59.018088 [info ] [MainThread]: 
[0m08:40:59.018206 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m08:40:59.018411 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:40:59.020045 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.49308917, "process_in_blocks": "0", "process_kernel_time": 0.132466, "process_mem_max_rss": "128876544", "process_out_blocks": "0", "process_user_time": 0.857734}
[0m08:40:59.020283 [debug] [MainThread]: Command `dbt run` failed at 08:40:59.020243 after 0.49 seconds
[0m08:40:59.020445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107665c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e78950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107af2950>]}
[0m08:40:59.020595 [debug] [MainThread]: Flushing usage events
[0m08:40:59.697300 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:42:06.913308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078fc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087439d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108743c50>]}


============================== 08:42:06.916799 | f08324ef-5307-4d3a-af29-030d4d520261 ==============================
[0m08:42:06.916799 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:42:06.917139 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'debug': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run -m stg_transaction', 'version_check': 'True', 'warn_error': 'None', 'printer_width': '80', 'quiet': 'False', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'no_print': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False'}
[0m08:42:06.917394 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m08:42:06.917558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f08324ef-5307-4d3a-af29-030d4d520261', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086276f0>]}
[0m08:42:07.076089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f08324ef-5307-4d3a-af29-030d4d520261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085d2cf0>]}
[0m08:42:07.104518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f08324ef-5307-4d3a-af29-030d4d520261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085dfd50>]}
[0m08:42:07.105419 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:42:07.189423 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:42:07.248469 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:42:07.248842 [debug] [MainThread]: Partial parsing: updated file: sumup://models/staging/stg_transaction.sql
[0m08:42:07.389431 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m08:42:07.392305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f08324ef-5307-4d3a-af29-030d4d520261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096e3a70>]}
[0m08:42:07.420382 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:42:07.421750 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:42:07.432992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f08324ef-5307-4d3a-af29-030d4d520261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099acf30>]}
[0m08:42:07.433196 [info ] [MainThread]: Found 3 seeds, 2 models, 447 macros
[0m08:42:07.433329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f08324ef-5307-4d3a-af29-030d4d520261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109993ee0>]}
[0m08:42:07.433928 [info ] [MainThread]: 
[0m08:42:07.434068 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:42:07.434174 [info ] [MainThread]: 
[0m08:42:07.434367 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:42:07.434696 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m08:42:07.494812 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m08:42:07.495030 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m08:42:07.495148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:42:07.513304 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.018 seconds
[0m08:42:07.513943 [debug] [ThreadPool]: On list_postgres: Close
[0m08:42:07.515718 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m08:42:07.517960 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:42:07.518143 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m08:42:07.518281 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m08:42:07.518486 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m08:42:07.519325 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:42:07.519452 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:42:07.520082 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:42:07.520200 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m08:42:07.520371 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m08:42:07.520480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:42:07.520581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:42:07.526144 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:42:07.526267 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:42:07.526384 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:42:07.526494 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:42:07.526610 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:42:07.526713 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:42:07.526842 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m08:42:07.526968 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m08:42:07.527089 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:42:07.533431 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m08:42:07.533539 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m08:42:07.533988 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:42:07.534097 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m08:42:07.534498 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m08:42:07.534951 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m08:42:07.535075 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:42:07.535197 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m08:42:07.535406 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m08:42:07.537380 [debug] [MainThread]: Using postgres connection "master"
[0m08:42:07.537506 [debug] [MainThread]: On master: BEGIN
[0m08:42:07.537601 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:42:07.541800 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:42:07.541911 [debug] [MainThread]: Using postgres connection "master"
[0m08:42:07.542042 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:42:07.547422 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m08:42:07.547832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f08324ef-5307-4d3a-af29-030d4d520261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109962510>]}
[0m08:42:07.547995 [debug] [MainThread]: On master: ROLLBACK
[0m08:42:07.548233 [debug] [MainThread]: Using postgres connection "master"
[0m08:42:07.548335 [debug] [MainThread]: On master: BEGIN
[0m08:42:07.548620 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:42:07.548716 [debug] [MainThread]: On master: COMMIT
[0m08:42:07.548805 [debug] [MainThread]: Using postgres connection "master"
[0m08:42:07.548893 [debug] [MainThread]: On master: COMMIT
[0m08:42:07.549055 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:42:07.549148 [debug] [MainThread]: On master: Close
[0m08:42:07.550426 [debug] [Thread-1 (]: Began running node model.sumup.stg_transaction
[0m08:42:07.550626 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_staging.stg_transaction .................. [RUN]
[0m08:42:07.550811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.stg_transaction)
[0m08:42:07.550947 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_transaction
[0m08:42:07.554226 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m08:42:07.554507 [debug] [Thread-1 (]: Began executing node model.sumup.stg_transaction
[0m08:42:07.568771 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_transaction"
[0m08:42:07.569437 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:42:07.569571 [debug] [Thread-1 (]: On model.sumup.stg_transaction: BEGIN
[0m08:42:07.569685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:42:07.575175 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:42:07.575333 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:42:07.575488 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  create view "postgres"."analytics_staging"."stg_transaction__dbt_tmp"
    
    
  as (
    SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) / 100 AS amount_eur,
    LOWER(status) AS status,

    -- PII Protection (Hashing sensitive data for security)
    SHA256( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    SHA256( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  );
[0m08:42:07.577687 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function sha256(text) does not exist
LINE 25:     SHA256( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ...
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m08:42:07.577814 [debug] [Thread-1 (]: On model.sumup.stg_transaction: ROLLBACK
[0m08:42:07.578082 [debug] [Thread-1 (]: On model.sumup.stg_transaction: Close
[0m08:42:07.583768 [debug] [Thread-1 (]: Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  function sha256(text) does not exist
  LINE 25:     SHA256( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/sumup/models/staging/stg_transaction.sql
[0m08:42:07.584671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f08324ef-5307-4d3a-af29-030d4d520261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a01e90>]}
[0m08:42:07.584945 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_staging.stg_transaction ......... [[31mERROR[0m in 0.03s]
[0m08:42:07.585215 [debug] [Thread-1 (]: Finished running node model.sumup.stg_transaction
[0m08:42:07.585458 [debug] [Thread-7 (]: Marking all children of 'model.sumup.stg_transaction' to be skipped because of status 'error'.  Reason: Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  function sha256(text) does not exist
  LINE 25:     SHA256( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/sumup/models/staging/stg_transaction.sql.
[0m08:42:07.586203 [debug] [MainThread]: Using postgres connection "master"
[0m08:42:07.586326 [debug] [MainThread]: On master: BEGIN
[0m08:42:07.586418 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:42:07.591309 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:42:07.591451 [debug] [MainThread]: On master: COMMIT
[0m08:42:07.591557 [debug] [MainThread]: Using postgres connection "master"
[0m08:42:07.591655 [debug] [MainThread]: On master: COMMIT
[0m08:42:07.591838 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:42:07.591948 [debug] [MainThread]: On master: Close
[0m08:42:07.592102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:42:07.592207 [debug] [MainThread]: Connection 'model.sumup.stg_transaction' was properly closed.
[0m08:42:07.592301 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m08:42:07.592391 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m08:42:07.592568 [info ] [MainThread]: 
[0m08:42:07.592694 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m08:42:07.592969 [debug] [MainThread]: Command end result
[0m08:42:07.601796 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:42:07.602575 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:42:07.605214 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m08:42:07.605378 [info ] [MainThread]: 
[0m08:42:07.605540 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:42:07.605665 [info ] [MainThread]: 
[0m08:42:07.605846 [error] [MainThread]: [31mFailure in model stg_transaction (models/staging/stg_transaction.sql)[0m
[0m08:42:07.606013 [error] [MainThread]:   Database Error in model stg_transaction (models/staging/stg_transaction.sql)
  function sha256(text) does not exist
  LINE 25:     SHA256( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/sumup/models/staging/stg_transaction.sql
[0m08:42:07.606130 [info ] [MainThread]: 
[0m08:42:07.606264 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/staging/stg_transaction.sql
[0m08:42:07.606366 [info ] [MainThread]: 
[0m08:42:07.606485 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m08:42:07.606683 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:42:07.609079 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.74363834, "process_in_blocks": "0", "process_kernel_time": 0.210748, "process_mem_max_rss": "127287296", "process_out_blocks": "0", "process_user_time": 0.967254}
[0m08:42:07.609272 [debug] [MainThread]: Command `dbt run` failed at 08:42:07.609237 after 0.74 seconds
[0m08:42:07.609425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094f1270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d00950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10997a950>]}
[0m08:42:07.609562 [debug] [MainThread]: Flushing usage events
[0m08:42:08.296938 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:42:22.260156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bac050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049ef9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049efc50>]}


============================== 08:42:22.262559 | 17dbc7ba-51fd-43af-92f6-25b9e469e584 ==============================
[0m08:42:22.262559 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:42:22.262822 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m stg_transaction', 'version_check': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'log_format': 'default', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'use_colors': 'True', 'printer_width': '80', 'introspect': 'True', 'target_path': 'None', 'debug': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'no_print': 'None', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup'}
[0m08:42:22.263019 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m08:42:22.263161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '17dbc7ba-51fd-43af-92f6-25b9e469e584', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d76f0>]}
[0m08:42:22.343081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17dbc7ba-51fd-43af-92f6-25b9e469e584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104882cf0>]}
[0m08:42:22.364810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17dbc7ba-51fd-43af-92f6-25b9e469e584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10488fd50>]}
[0m08:42:22.365363 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:42:22.415431 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:42:22.464472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:42:22.464805 [debug] [MainThread]: Partial parsing: updated file: sumup://models/staging/stg_transaction.sql
[0m08:42:22.553609 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m08:42:22.555486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17dbc7ba-51fd-43af-92f6-25b9e469e584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10599ba70>]}
[0m08:42:22.580743 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:42:22.581793 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:42:22.591533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17dbc7ba-51fd-43af-92f6-25b9e469e584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c58f30>]}
[0m08:42:22.591728 [info ] [MainThread]: Found 3 seeds, 2 models, 447 macros
[0m08:42:22.591858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17dbc7ba-51fd-43af-92f6-25b9e469e584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c43ee0>]}
[0m08:42:22.592423 [info ] [MainThread]: 
[0m08:42:22.592560 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:42:22.592670 [info ] [MainThread]: 
[0m08:42:22.592869 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:42:22.593201 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m08:42:22.640685 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m08:42:22.640891 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m08:42:22.641021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:42:22.659389 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.018 seconds
[0m08:42:22.659975 [debug] [ThreadPool]: On list_postgres: Close
[0m08:42:22.661664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics)
[0m08:42:22.661870 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m08:42:22.663993 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:42:22.664178 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m08:42:22.664967 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:42:22.665086 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m08:42:22.665643 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:42:22.665751 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m08:42:22.665849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:42:22.665966 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m08:42:22.666058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:42:22.666208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:42:22.672198 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:42:22.672319 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:42:22.672424 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:42:22.672575 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:42:22.672736 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:42:22.672866 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:42:22.672984 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m08:42:22.673121 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:42:22.673250 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m08:42:22.678465 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m08:42:22.678955 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m08:42:22.679083 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m08:42:22.679226 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m08:42:22.679657 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m08:42:22.679765 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m08:42:22.680140 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:42:22.680401 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m08:42:22.680495 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:42:22.682252 [debug] [MainThread]: Using postgres connection "master"
[0m08:42:22.682374 [debug] [MainThread]: On master: BEGIN
[0m08:42:22.682469 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:42:22.687449 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:42:22.687550 [debug] [MainThread]: Using postgres connection "master"
[0m08:42:22.687677 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:42:22.693868 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m08:42:22.694273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17dbc7ba-51fd-43af-92f6-25b9e469e584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c0e210>]}
[0m08:42:22.694432 [debug] [MainThread]: On master: ROLLBACK
[0m08:42:22.694626 [debug] [MainThread]: Using postgres connection "master"
[0m08:42:22.694722 [debug] [MainThread]: On master: BEGIN
[0m08:42:22.694990 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:42:22.695087 [debug] [MainThread]: On master: COMMIT
[0m08:42:22.695181 [debug] [MainThread]: Using postgres connection "master"
[0m08:42:22.695269 [debug] [MainThread]: On master: COMMIT
[0m08:42:22.695431 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:42:22.695525 [debug] [MainThread]: On master: Close
[0m08:42:22.696631 [debug] [Thread-1 (]: Began running node model.sumup.stg_transaction
[0m08:42:22.696820 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_staging.stg_transaction .................. [RUN]
[0m08:42:22.696979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.stg_transaction)
[0m08:42:22.697104 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_transaction
[0m08:42:22.700189 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m08:42:22.700458 [debug] [Thread-1 (]: Began executing node model.sumup.stg_transaction
[0m08:42:22.714167 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_transaction"
[0m08:42:22.714546 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:42:22.714672 [debug] [Thread-1 (]: On model.sumup.stg_transaction: BEGIN
[0m08:42:22.714783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:42:22.719864 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:42:22.719991 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:42:22.720132 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  create view "postgres"."analytics_staging"."stg_transaction__dbt_tmp"
    
    
  as (
    SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) / 100 AS amount_eur,
    LOWER(status) AS status,

    -- PII Protection (Hashing sensitive data for security)
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  );
[0m08:42:22.734727 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m08:42:22.737111 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:42:22.737253 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
alter table "postgres"."analytics_staging"."stg_transaction__dbt_tmp" rename to "stg_transaction"
[0m08:42:22.737653 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:42:22.743426 [debug] [Thread-1 (]: On model.sumup.stg_transaction: COMMIT
[0m08:42:22.743600 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:42:22.743730 [debug] [Thread-1 (]: On model.sumup.stg_transaction: COMMIT
[0m08:42:22.744211 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:42:22.746671 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_transaction__dbt_backup"
[0m08:42:22.748436 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:42:22.748569 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
drop view if exists "postgres"."analytics_staging"."stg_transaction__dbt_backup" cascade
[0m08:42:22.748804 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:42:22.749697 [debug] [Thread-1 (]: On model.sumup.stg_transaction: Close
[0m08:42:22.750527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17dbc7ba-51fd-43af-92f6-25b9e469e584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cadd30>]}
[0m08:42:22.750768 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analytics_staging.stg_transaction ............. [[32mCREATE VIEW[0m in 0.05s]
[0m08:42:22.750995 [debug] [Thread-1 (]: Finished running node model.sumup.stg_transaction
[0m08:42:22.751521 [debug] [MainThread]: Using postgres connection "master"
[0m08:42:22.751642 [debug] [MainThread]: On master: BEGIN
[0m08:42:22.751739 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:42:22.756534 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:42:22.756644 [debug] [MainThread]: On master: COMMIT
[0m08:42:22.756741 [debug] [MainThread]: Using postgres connection "master"
[0m08:42:22.756832 [debug] [MainThread]: On master: COMMIT
[0m08:42:22.757024 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:42:22.757120 [debug] [MainThread]: On master: Close
[0m08:42:22.757257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:42:22.757472 [debug] [MainThread]: Connection 'model.sumup.stg_transaction' was properly closed.
[0m08:42:22.757589 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m08:42:22.757684 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m08:42:22.757803 [info ] [MainThread]: 
[0m08:42:22.757926 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m08:42:22.758184 [debug] [MainThread]: Command end result
[0m08:42:22.766309 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:42:22.766955 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:42:22.769178 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m08:42:22.769301 [info ] [MainThread]: 
[0m08:42:22.769452 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:42:22.769564 [info ] [MainThread]: 
[0m08:42:22.769692 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m08:42:22.769910 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:42:22.771897 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5403317, "process_in_blocks": "0", "process_kernel_time": 0.144445, "process_mem_max_rss": "129024000", "process_out_blocks": "0", "process_user_time": 0.860621}
[0m08:42:22.772136 [debug] [MainThread]: Command `dbt run` succeeded at 08:42:22.772098 after 0.54 seconds
[0m08:42:22.772282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105779d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bfbad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c2a950>]}
[0m08:42:22.772423 [debug] [MainThread]: Flushing usage events
[0m08:42:23.501141 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:07:05.028694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e33c50>]}


============================== 09:07:05.040130 | fce232e8-a9d3-4e4a-8410-dd7283e7b1a5 ==============================
[0m09:07:05.040130 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:07:05.040438 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'write_json': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'printer_width': '80', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'static_parser': 'True', 'warn_error': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'debug': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'empty': 'None', 'invocation_command': 'dbt test -m transaction', 'log_format': 'default'}
[0m09:07:05.041190 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m09:07:05.041409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fce232e8-a9d3-4e4a-8410-dd7283e7b1a5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d1f6f0>]}
[0m09:07:05.321836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fce232e8-a9d3-4e4a-8410-dd7283e7b1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ccacf0>]}
[0m09:07:05.343747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fce232e8-a9d3-4e4a-8410-dd7283e7b1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cd7d50>]}
[0m09:07:05.344272 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:07:05.403479 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:07:05.455844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:07:05.456142 [debug] [MainThread]: Partial parsing: added file: sumup://seeds/transaction.yml
[0m09:07:05.487280 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m09:07:05.489278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fce232e8-a9d3-4e4a-8410-dd7283e7b1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eadd60>]}
[0m09:07:05.515819 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:07:05.517194 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:07:05.532940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fce232e8-a9d3-4e4a-8410-dd7283e7b1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108873cb0>]}
[0m09:07:05.533191 [info ] [MainThread]: Found 3 seeds, 2 models, 447 macros
[0m09:07:05.533325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fce232e8-a9d3-4e4a-8410-dd7283e7b1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10890cfc0>]}
[0m09:07:05.533912 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:07:05.534126 [debug] [MainThread]: Command end result
[0m09:07:05.542501 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:07:05.543303 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:07:05.544773 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:07:05.545000 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m09:07:05.547251 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6040621, "process_in_blocks": "0", "process_kernel_time": 0.162899, "process_mem_max_rss": "109281280", "process_out_blocks": "0", "process_user_time": 0.746318}
[0m09:07:05.547425 [debug] [MainThread]: Command `dbt test` succeeded at 09:07:05.547392 after 0.60 seconds
[0m09:07:05.547565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ca9e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108882200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088822b0>]}
[0m09:07:05.547694 [debug] [MainThread]: Flushing usage events
[0m09:07:06.285157 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:09:24.918712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e7c50>]}


============================== 09:09:24.921774 | f38b41eb-3331-446b-8b7c-501c35e2828d ==============================
[0m09:09:24.921774 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:09:24.922042 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'write_json': 'True', 'no_print': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'printer_width': '80', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'introspect': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'quiet': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'invocation_command': 'dbt test -m transaction', 'warn_error': 'None', 'partial_parse': 'True', 'fail_fast': 'False'}
[0m09:09:24.922260 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m09:09:24.922405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f38b41eb-3331-446b-8b7c-501c35e2828d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067cf6f0>]}
[0m09:09:25.010164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f38b41eb-3331-446b-8b7c-501c35e2828d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10677acf0>]}
[0m09:09:25.030817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f38b41eb-3331-446b-8b7c-501c35e2828d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106787d50>]}
[0m09:09:25.031168 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:09:25.082163 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:09:25.139348 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:09:25.139641 [debug] [MainThread]: Partial parsing: added file: sumup://seeds/__sources.yml
[0m09:09:25.207957 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m09:09:25.211624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f38b41eb-3331-446b-8b7c-501c35e2828d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107892990>]}
[0m09:09:25.241300 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:09:25.242606 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:09:25.258930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f38b41eb-3331-446b-8b7c-501c35e2828d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b82430>]}
[0m09:09:25.259183 [info ] [MainThread]: Found 3 seeds, 2 models, 1 source, 447 macros
[0m09:09:25.259324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f38b41eb-3331-446b-8b7c-501c35e2828d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079e9710>]}
[0m09:09:25.259897 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:09:25.260120 [debug] [MainThread]: Command end result
[0m09:09:25.319703 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:09:25.323286 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:09:25.324985 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:09:25.325239 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m09:09:25.328073 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4440811, "process_in_blocks": "0", "process_kernel_time": 0.144211, "process_mem_max_rss": "123076608", "process_out_blocks": "0", "process_user_time": 0.783901}
[0m09:09:25.328774 [debug] [MainThread]: Command `dbt test` succeeded at 09:09:25.328665 after 0.45 seconds
[0m09:09:25.329584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106759f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b26e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b26d00>]}
[0m09:09:25.330041 [debug] [MainThread]: Flushing usage events
[0m09:09:26.057520 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:09:31.968327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a48050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068879d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106887c50>]}


============================== 09:09:31.971426 | a5d6a0ab-96bf-4654-82a9-2bb479438631 ==============================
[0m09:09:31.971426 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:09:31.971721 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'printer_width': '80', 'static_parser': 'True', 'quiet': 'False', 'empty': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt test -m transaction', 'warn_error': 'None', 'log_format': 'default', 'debug': 'False', 'version_check': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'indirect_selection': 'eager', 'write_json': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'introspect': 'True', 'target_path': 'None'}
[0m09:09:31.972109 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m09:09:31.972305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a5d6a0ab-96bf-4654-82a9-2bb479438631', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067736f0>]}
[0m09:09:32.039856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5d6a0ab-96bf-4654-82a9-2bb479438631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671ecf0>]}
[0m09:09:32.060747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5d6a0ab-96bf-4654-82a9-2bb479438631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10672bd50>]}
[0m09:09:32.061290 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:09:32.108774 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:09:32.165105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:09:32.165380 [debug] [MainThread]: Partial parsing: updated file: sumup://seeds/__sources.yml
[0m09:09:32.232205 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m09:09:32.235932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5d6a0ab-96bf-4654-82a9-2bb479438631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10783aa80>]}
[0m09:09:32.265864 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:09:32.266730 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:09:32.281271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5d6a0ab-96bf-4654-82a9-2bb479438631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b326d0>]}
[0m09:09:32.281484 [info ] [MainThread]: Found 3 seeds, 2 models, 1 source, 447 macros
[0m09:09:32.281613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5d6a0ab-96bf-4654-82a9-2bb479438631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079bda50>]}
[0m09:09:32.282153 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:09:32.282368 [debug] [MainThread]: Command end result
[0m09:09:32.317066 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:09:32.317768 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:09:32.318892 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:09:32.319079 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m09:09:32.320517 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.3788372, "process_in_blocks": "0", "process_kernel_time": 0.117528, "process_mem_max_rss": "121618432", "process_out_blocks": "0", "process_user_time": 0.781863}
[0m09:09:32.320705 [debug] [MainThread]: Command `dbt test` succeeded at 09:09:32.320670 after 0.38 seconds
[0m09:09:32.320844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fdf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ab78b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b84050>]}
[0m09:09:32.320972 [debug] [MainThread]: Flushing usage events
[0m09:09:33.005548 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:23:03.634859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082cc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10910f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10910fc50>]}


============================== 09:23:03.646444 | 69fabd87-0f0f-45ce-8cb2-eddc86183ffb ==============================
[0m09:23:03.646444 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:23:03.646713 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'target_path': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'debug': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run -m +int_transaction', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'version_check': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_format': 'default', 'empty': 'False', 'fail_fast': 'False', 'no_print': 'None', 'warn_error': 'None'}
[0m09:23:03.646900 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m09:23:03.647043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '69fabd87-0f0f-45ce-8cb2-eddc86183ffb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ff76f0>]}
[0m09:23:03.872027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69fabd87-0f0f-45ce-8cb2-eddc86183ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa2cf0>]}
[0m09:23:03.895689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69fabd87-0f0f-45ce-8cb2-eddc86183ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fafd50>]}
[0m09:23:03.896174 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:23:03.972665 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:23:04.121916 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 5 files added, 0 files changed.
[0m09:23:04.122192 [debug] [MainThread]: Partial parsing: added file: sumup://models/staging/stg_transaction.yml
[0m09:23:04.122329 [debug] [MainThread]: Partial parsing: added file: sumup://models/core/_sources.yml
[0m09:23:04.122451 [debug] [MainThread]: Partial parsing: added file: sumup://models/marts/_sources.yml
[0m09:23:04.122568 [debug] [MainThread]: Partial parsing: added file: sumup://seeds/_sources.yml
[0m09:23:04.122672 [debug] [MainThread]: Partial parsing: added file: sumup://models/core/int_transaction.sql
[0m09:23:04.261870 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m09:23:04.265313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69fabd87-0f0f-45ce-8cb2-eddc86183ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0bd7c0>]}
[0m09:23:04.357713 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:23:04.362860 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:23:04.423707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69fabd87-0f0f-45ce-8cb2-eddc86183ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e71d30>]}
[0m09:23:04.423912 [info ] [MainThread]: Found 3 seeds, 3 models, 1 source, 447 macros
[0m09:23:04.424051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69fabd87-0f0f-45ce-8cb2-eddc86183ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3b46d0>]}
[0m09:23:04.424583 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:23:04.424793 [debug] [MainThread]: Command end result
[0m09:23:04.459572 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:23:04.460592 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:23:04.461896 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:23:04.462139 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m09:23:04.465409 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9288221, "process_in_blocks": "0", "process_kernel_time": 0.168247, "process_mem_max_rss": "122765312", "process_out_blocks": "0", "process_user_time": 0.872523}
[0m09:23:04.465643 [debug] [MainThread]: Command `dbt run` succeeded at 09:23:04.465602 after 0.93 seconds
[0m09:23:04.465804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f81f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a20dff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a20e150>]}
[0m09:23:04.465948 [debug] [MainThread]: Flushing usage events
[0m09:23:05.291563 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:24:22.019369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111af4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11343b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11343bc50>]}


============================== 09:24:22.021979 | a3799293-38d9-4b1a-b0b5-6a189bae6376 ==============================
[0m09:24:22.021979 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:24:22.022259 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'target_path': 'None', 'write_json': 'True', 'printer_width': '80', 'debug': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'no_print': 'None', 'partial_parse': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'log_format': 'default', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select int_transaction+', 'quiet': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'introspect': 'True'}
[0m09:24:22.110806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3799293-38d9-4b1a-b0b5-6a189bae6376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112263950>]}
[0m09:24:22.132696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3799293-38d9-4b1a-b0b5-6a189bae6376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132cacf0>]}
[0m09:24:22.133100 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:24:22.186436 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:24:22.250941 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:24:22.251222 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:24:22.253924 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m09:24:22.271289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3799293-38d9-4b1a-b0b5-6a189bae6376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ac5d50>]}
[0m09:24:22.312471 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:24:22.313783 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:24:22.323965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3799293-38d9-4b1a-b0b5-6a189bae6376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134a66c0>]}
[0m09:24:22.324169 [info ] [MainThread]: Found 3 seeds, 3 models, 1 source, 447 macros
[0m09:24:22.324303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3799293-38d9-4b1a-b0b5-6a189bae6376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142143d0>]}
[0m09:24:22.324896 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:24:22.325653 [debug] [MainThread]: Command end result
[0m09:24:22.338497 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:24:22.339208 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:24:22.340475 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:24:22.342551 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.35739517, "process_in_blocks": "0", "process_kernel_time": 0.147316, "process_mem_max_rss": "116293632", "process_out_blocks": "0", "process_user_time": 0.713213}
[0m09:24:22.342775 [debug] [MainThread]: Command `dbt run` succeeded at 09:24:22.342734 after 0.36 seconds
[0m09:24:22.342940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134cd7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132a9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ca1790>]}
[0m09:24:22.343118 [debug] [MainThread]: Flushing usage events
[0m09:24:23.081082 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:24:29.378973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106014050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e579d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e57c50>]}


============================== 09:24:29.381390 | 9526860b-4210-4fbc-b46f-691c0f31ea46 ==============================
[0m09:24:29.381390 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:24:29.381663 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'no_print': 'None', 'quiet': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'invocation_command': 'dbt run --select +int_transaction', 'printer_width': '80', 'use_experimental_parser': 'False', 'target_path': 'None', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'fail_fast': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'static_parser': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'version_check': 'True'}
[0m09:24:29.450894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9526860b-4210-4fbc-b46f-691c0f31ea46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106177950>]}
[0m09:24:29.473144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9526860b-4210-4fbc-b46f-691c0f31ea46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ceacf0>]}
[0m09:24:29.473729 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:24:29.524770 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:24:29.581734 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:24:29.581915 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:24:29.584074 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m09:24:29.602353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9526860b-4210-4fbc-b46f-691c0f31ea46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d89d50>]}
[0m09:24:29.636830 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:24:29.637909 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:24:29.648696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9526860b-4210-4fbc-b46f-691c0f31ea46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec66c0>]}
[0m09:24:29.648922 [info ] [MainThread]: Found 3 seeds, 3 models, 1 source, 447 macros
[0m09:24:29.649054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9526860b-4210-4fbc-b46f-691c0f31ea46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c83d0>]}
[0m09:24:29.649638 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:24:29.650436 [debug] [MainThread]: Command end result
[0m09:24:29.659166 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:24:29.659931 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:24:29.661538 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:24:29.663041 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.31083676, "process_in_blocks": "0", "process_kernel_time": 0.128377, "process_mem_max_rss": "117276672", "process_out_blocks": "0", "process_user_time": 0.718408}
[0m09:24:29.663216 [debug] [MainThread]: Command `dbt run` succeeded at 09:24:29.663184 after 0.31 seconds
[0m09:24:29.663356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eed7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f49790>]}
[0m09:24:29.663480 [debug] [MainThread]: Flushing usage events
[0m09:24:30.366752 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:24:37.229047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ddc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c1f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c1fc50>]}


============================== 09:24:37.231497 | b200565f-082a-41d8-aa31-a78433915f49 ==============================
[0m09:24:37.231497 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:24:37.231745 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'write_json': 'True', 'partial_parse': 'True', 'debug': 'False', 'quiet': 'False', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'static_parser': 'True', 'log_cache_events': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'fail_fast': 'False', 'version_check': 'True', 'introspect': 'True', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'warn_error': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select +int_transaction', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'target_path': 'None'}
[0m09:24:37.313782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b200565f-082a-41d8-aa31-a78433915f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f3f950>]}
[0m09:24:37.335812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b200565f-082a-41d8-aa31-a78433915f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab2cf0>]}
[0m09:24:37.336398 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:24:37.387746 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:24:37.445568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:24:37.445830 [debug] [MainThread]: Partial parsing: updated file: sumup://models/core/int_transaction.sql
[0m09:24:37.539202 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m09:24:37.544111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b200565f-082a-41d8-aa31-a78433915f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b4ad50>]}
[0m09:24:37.575199 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:24:37.576188 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:24:37.585905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b200565f-082a-41d8-aa31-a78433915f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c8e6c0>]}
[0m09:24:37.586116 [info ] [MainThread]: Found 3 seeds, 3 models, 1 source, 447 macros
[0m09:24:37.586248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b200565f-082a-41d8-aa31-a78433915f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ee9a90>]}
[0m09:24:37.586899 [info ] [MainThread]: 
[0m09:24:37.587031 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:24:37.587133 [info ] [MainThread]: 
[0m09:24:37.587331 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:24:37.588741 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:24:37.592683 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:24:37.643671 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:24:37.643873 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:24:37.644018 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:24:37.644152 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:24:37.644274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:37.644385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:37.755441 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.111 seconds
[0m09:24:37.755726 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.111 seconds
[0m09:24:37.756500 [debug] [ThreadPool]: On list_postgres: Close
[0m09:24:37.757110 [debug] [ThreadPool]: On list_postgres: Close
[0m09:24:37.757974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_analytics)
[0m09:24:37.761086 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:24:37.761307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics)
[0m09:24:37.761469 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m09:24:37.761691 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m09:24:37.762531 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:24:37.762675 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:24:37.763673 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:24:37.763812 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m09:24:37.764006 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m09:24:37.764138 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:24:37.764262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:37.770543 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m09:24:37.770702 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m09:24:37.770835 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m09:24:37.770956 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:24:37.771085 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:24:37.771212 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:24:37.771355 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m09:24:37.771551 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:24:37.771707 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m09:24:37.788751 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.017 seconds
[0m09:24:37.788948 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.017 seconds
[0m09:24:37.789716 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m09:24:37.789901 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.018 seconds
[0m09:24:37.790527 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m09:24:37.791216 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m09:24:37.791394 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m09:24:37.791550 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m09:24:37.791853 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m09:24:37.794661 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:37.794831 [debug] [MainThread]: On master: BEGIN
[0m09:24:37.794960 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:24:37.799088 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:24:37.799228 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:37.799404 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:24:37.806122 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m09:24:37.806831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b200565f-082a-41d8-aa31-a78433915f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a052f70>]}
[0m09:24:37.807062 [debug] [MainThread]: On master: ROLLBACK
[0m09:24:37.807347 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:37.807484 [debug] [MainThread]: On master: BEGIN
[0m09:24:37.807803 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:24:37.807942 [debug] [MainThread]: On master: COMMIT
[0m09:24:37.808073 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:37.808201 [debug] [MainThread]: On master: COMMIT
[0m09:24:37.808407 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:24:37.808543 [debug] [MainThread]: On master: Close
[0m09:24:37.810250 [debug] [Thread-1 (]: Began running node model.sumup.stg_transaction
[0m09:24:37.810524 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_staging.stg_transaction .................. [RUN]
[0m09:24:37.810786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.stg_transaction)
[0m09:24:37.810965 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_transaction
[0m09:24:37.815209 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m09:24:37.815908 [debug] [Thread-1 (]: Began executing node model.sumup.stg_transaction
[0m09:24:37.832841 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_transaction"
[0m09:24:37.833519 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:24:37.833670 [debug] [Thread-1 (]: On model.sumup.stg_transaction: BEGIN
[0m09:24:37.833804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:37.840147 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m09:24:37.840288 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:24:37.840449 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  create view "postgres"."analytics_staging"."stg_transaction__dbt_tmp"
    
    
  as (
    SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) / 100 AS amount_eur,
    LOWER(status) AS status,

    -- PII Protection (Hashing sensitive data for security)
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  );
[0m09:24:37.854397 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m09:24:37.857422 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:24:37.857583 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
alter table "postgres"."analytics_staging"."stg_transaction" rename to "stg_transaction__dbt_backup"
[0m09:24:37.858631 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:24:37.859893 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:24:37.860063 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
alter table "postgres"."analytics_staging"."stg_transaction__dbt_tmp" rename to "stg_transaction"
[0m09:24:37.860898 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:24:37.868317 [debug] [Thread-1 (]: On model.sumup.stg_transaction: COMMIT
[0m09:24:37.868488 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:24:37.868629 [debug] [Thread-1 (]: On model.sumup.stg_transaction: COMMIT
[0m09:24:37.869357 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:24:37.871759 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_transaction__dbt_backup"
[0m09:24:37.873776 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:24:37.873921 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
drop view if exists "postgres"."analytics_staging"."stg_transaction__dbt_backup" cascade
[0m09:24:37.878536 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m09:24:37.879562 [debug] [Thread-1 (]: On model.sumup.stg_transaction: Close
[0m09:24:37.880542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b200565f-082a-41d8-aa31-a78433915f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e57dd0>]}
[0m09:24:37.880829 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_staging.stg_transaction ............. [[32mCREATE VIEW[0m in 0.07s]
[0m09:24:37.881073 [debug] [Thread-1 (]: Finished running node model.sumup.stg_transaction
[0m09:24:37.881440 [debug] [Thread-2 (]: Began running node model.sumup.int_transaction
[0m09:24:37.881670 [info ] [Thread-2 (]: 2 of 2 START sql table model analytics_analytics.int_transaction ............... [RUN]
[0m09:24:37.881853 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.int_transaction)
[0m09:24:37.882027 [debug] [Thread-2 (]: Began compiling node model.sumup.int_transaction
[0m09:24:37.883287 [debug] [Thread-2 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m09:24:37.883777 [debug] [Thread-2 (]: Began executing node model.sumup.int_transaction
[0m09:24:37.892739 [debug] [Thread-2 (]: Writing runtime sql for node "model.sumup.int_transaction"
[0m09:24:37.893131 [debug] [Thread-2 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:24:37.893270 [debug] [Thread-2 (]: On model.sumup.int_transaction: BEGIN
[0m09:24:37.893395 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:24:37.899008 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m09:24:37.899175 [debug] [Thread-2 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:24:37.899331 [debug] [Thread-2 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

  
    

  create  table "postgres"."analytics_analytics"."int_transaction__dbt_tmp"
  
  
    as
  
  (
    SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) / 100 AS amount_eur,
    LOWER(status) AS status,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction"
  );
  
[0m09:24:37.901076 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 14:     CAST(id AS INTEGER) AS transaction_id,
                  ^

[0m09:24:37.901213 [debug] [Thread-2 (]: On model.sumup.int_transaction: ROLLBACK
[0m09:24:37.901491 [debug] [Thread-2 (]: On model.sumup.int_transaction: Close
[0m09:24:37.907002 [debug] [Thread-2 (]: Database Error in model int_transaction (models/core/int_transaction.sql)
  column "id" does not exist
  LINE 14:     CAST(id AS INTEGER) AS transaction_id,
                    ^
  compiled code at target/run/sumup/models/core/int_transaction.sql
[0m09:24:37.907231 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b200565f-082a-41d8-aa31-a78433915f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e5bcd0>]}
[0m09:24:37.907511 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model analytics_analytics.int_transaction ...... [[31mERROR[0m in 0.03s]
[0m09:24:37.907737 [debug] [Thread-2 (]: Finished running node model.sumup.int_transaction
[0m09:24:37.907947 [debug] [Thread-7 (]: Marking all children of 'model.sumup.int_transaction' to be skipped because of status 'error'.  Reason: Database Error in model int_transaction (models/core/int_transaction.sql)
  column "id" does not exist
  LINE 14:     CAST(id AS INTEGER) AS transaction_id,
                    ^
  compiled code at target/run/sumup/models/core/int_transaction.sql.
[0m09:24:37.908751 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:37.908863 [debug] [MainThread]: On master: BEGIN
[0m09:24:37.908960 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:24:37.914247 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:24:37.914411 [debug] [MainThread]: On master: COMMIT
[0m09:24:37.914537 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:37.914686 [debug] [MainThread]: On master: COMMIT
[0m09:24:37.914903 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:24:37.915049 [debug] [MainThread]: On master: Close
[0m09:24:37.915230 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:24:37.915338 [debug] [MainThread]: Connection 'model.sumup.stg_transaction' was properly closed.
[0m09:24:37.915434 [debug] [MainThread]: Connection 'model.sumup.int_transaction' was properly closed.
[0m09:24:37.915525 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m09:24:37.915650 [info ] [MainThread]: 
[0m09:24:37.915778 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m09:24:37.916107 [debug] [MainThread]: Command end result
[0m09:24:37.925668 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:24:37.926537 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:24:37.929597 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:24:37.929753 [info ] [MainThread]: 
[0m09:24:37.929912 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:24:37.930026 [info ] [MainThread]: 
[0m09:24:37.930172 [error] [MainThread]: [31mFailure in model int_transaction (models/core/int_transaction.sql)[0m
[0m09:24:37.930304 [error] [MainThread]:   Database Error in model int_transaction (models/core/int_transaction.sql)
  column "id" does not exist
  LINE 14:     CAST(id AS INTEGER) AS transaction_id,
                    ^
  compiled code at target/run/sumup/models/core/int_transaction.sql
[0m09:24:37.930404 [info ] [MainThread]: 
[0m09:24:37.930525 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/core/int_transaction.sql
[0m09:24:37.930625 [info ] [MainThread]: 
[0m09:24:37.930739 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m09:24:37.933080 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7360036, "process_in_blocks": "0", "process_kernel_time": 0.1696, "process_mem_max_rss": "130564096", "process_out_blocks": "0", "process_user_time": 0.942547}
[0m09:24:37.933259 [debug] [MainThread]: Command `dbt run` failed at 09:24:37.933224 after 0.74 seconds
[0m09:24:37.933414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d347d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a263d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cb7a50>]}
[0m09:24:37.933551 [debug] [MainThread]: Flushing usage events
[0m09:24:38.623703 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:25:16.979322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ec050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10682f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10682fc50>]}


============================== 09:25:16.984149 | b4b97a17-fcfa-4614-a791-444ba4efd766 ==============================
[0m09:25:16.984149 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:25:16.984401 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'introspect': 'True', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select +int_transaction', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'version_check': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'no_print': 'None', 'debug': 'False', 'empty': 'False', 'use_colors': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'partial_parse': 'True', 'printer_width': '80'}
[0m09:25:17.068994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4b97a17-fcfa-4614-a791-444ba4efd766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b4f950>]}
[0m09:25:17.090561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4b97a17-fcfa-4614-a791-444ba4efd766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c2cf0>]}
[0m09:25:17.090977 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:25:17.146850 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:25:17.206742 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:25:17.207045 [debug] [MainThread]: Partial parsing: updated file: sumup://models/core/int_transaction.sql
[0m09:25:17.301452 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m09:25:17.306663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4b97a17-fcfa-4614-a791-444ba4efd766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10775ed50>]}
[0m09:25:17.339601 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:25:17.340959 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:25:17.351097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4b97a17-fcfa-4614-a791-444ba4efd766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10689e6c0>]}
[0m09:25:17.351289 [info ] [MainThread]: Found 3 seeds, 3 models, 1 source, 447 macros
[0m09:25:17.351423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4b97a17-fcfa-4614-a791-444ba4efd766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107af9a90>]}
[0m09:25:17.352066 [info ] [MainThread]: 
[0m09:25:17.352199 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:25:17.352304 [info ] [MainThread]: 
[0m09:25:17.352497 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:25:17.353910 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:25:17.357825 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:25:17.407667 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:25:17.407855 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:25:17.407994 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:25:17.408128 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:25:17.408252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:25:17.408362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:25:17.435841 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.028 seconds
[0m09:25:17.436034 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.028 seconds
[0m09:25:17.436579 [debug] [ThreadPool]: On list_postgres: Close
[0m09:25:17.437008 [debug] [ThreadPool]: On list_postgres: Close
[0m09:25:17.437846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics)
[0m09:25:17.438049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_analytics)
[0m09:25:17.440325 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:25:17.440515 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m09:25:17.441157 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:25:17.441270 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m09:25:17.442116 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:25:17.442233 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m09:25:17.442348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:25:17.442461 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m09:25:17.442562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:25:17.442708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:25:17.447966 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m09:25:17.448105 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m09:25:17.448253 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:25:17.448366 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m09:25:17.448485 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:25:17.448610 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m09:25:17.448729 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:25:17.448848 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m09:25:17.449001 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:25:17.455651 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m09:25:17.455768 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m09:25:17.456244 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m09:25:17.456357 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m09:25:17.456764 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m09:25:17.457241 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m09:25:17.457361 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m09:25:17.457646 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m09:25:17.457751 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m09:25:17.459711 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:17.459849 [debug] [MainThread]: On master: BEGIN
[0m09:25:17.459951 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:25:17.464095 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:25:17.464199 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:17.464330 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:25:17.471228 [debug] [MainThread]: SQL status: SELECT 1 in 0.007 seconds
[0m09:25:17.471723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4b97a17-fcfa-4614-a791-444ba4efd766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c63110>]}
[0m09:25:17.471879 [debug] [MainThread]: On master: ROLLBACK
[0m09:25:17.472111 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:17.472209 [debug] [MainThread]: On master: BEGIN
[0m09:25:17.472538 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:25:17.472656 [debug] [MainThread]: On master: COMMIT
[0m09:25:17.472750 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:17.472841 [debug] [MainThread]: On master: COMMIT
[0m09:25:17.473039 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:25:17.473137 [debug] [MainThread]: On master: Close
[0m09:25:17.474367 [debug] [Thread-1 (]: Began running node model.sumup.stg_transaction
[0m09:25:17.474553 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_staging.stg_transaction .................. [RUN]
[0m09:25:17.474711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.stg_transaction)
[0m09:25:17.474839 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_transaction
[0m09:25:17.477974 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m09:25:17.478398 [debug] [Thread-1 (]: Began executing node model.sumup.stg_transaction
[0m09:25:17.492358 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_transaction"
[0m09:25:17.492952 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:25:17.493123 [debug] [Thread-1 (]: On model.sumup.stg_transaction: BEGIN
[0m09:25:17.493253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:25:17.498197 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m09:25:17.498343 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:25:17.498488 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  create view "postgres"."analytics_staging"."stg_transaction__dbt_tmp"
    
    
  as (
    SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) / 100 AS amount_eur,
    LOWER(status) AS status,

    -- PII Protection (Hashing sensitive data for security)
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  );
[0m09:25:17.506050 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:25:17.508602 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:25:17.508734 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
alter table "postgres"."analytics_staging"."stg_transaction" rename to "stg_transaction__dbt_backup"
[0m09:25:17.509668 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:17.510643 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:25:17.510768 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
alter table "postgres"."analytics_staging"."stg_transaction__dbt_tmp" rename to "stg_transaction"
[0m09:25:17.511282 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:25:17.517594 [debug] [Thread-1 (]: On model.sumup.stg_transaction: COMMIT
[0m09:25:17.517736 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:25:17.517880 [debug] [Thread-1 (]: On model.sumup.stg_transaction: COMMIT
[0m09:25:17.518391 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m09:25:17.520471 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_transaction__dbt_backup"
[0m09:25:17.522183 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:25:17.522314 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
drop view if exists "postgres"."analytics_staging"."stg_transaction__dbt_backup" cascade
[0m09:25:17.524145 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:25:17.525032 [debug] [Thread-1 (]: On model.sumup.stg_transaction: Close
[0m09:25:17.525860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4b97a17-fcfa-4614-a791-444ba4efd766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a53dd0>]}
[0m09:25:17.526115 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_staging.stg_transaction ............. [[32mCREATE VIEW[0m in 0.05s]
[0m09:25:17.526340 [debug] [Thread-1 (]: Finished running node model.sumup.stg_transaction
[0m09:25:17.526594 [debug] [Thread-2 (]: Began running node model.sumup.int_transaction
[0m09:25:17.526815 [info ] [Thread-2 (]: 2 of 2 START sql table model analytics_analytics.int_transaction ............... [RUN]
[0m09:25:17.527011 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.int_transaction)
[0m09:25:17.527166 [debug] [Thread-2 (]: Began compiling node model.sumup.int_transaction
[0m09:25:17.528271 [debug] [Thread-2 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m09:25:17.528549 [debug] [Thread-2 (]: Began executing node model.sumup.int_transaction
[0m09:25:17.536917 [debug] [Thread-2 (]: Writing runtime sql for node "model.sumup.int_transaction"
[0m09:25:17.537311 [debug] [Thread-2 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:25:17.537439 [debug] [Thread-2 (]: On model.sumup.int_transaction: BEGIN
[0m09:25:17.537550 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:25:17.542212 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m09:25:17.542336 [debug] [Thread-2 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:25:17.542486 [debug] [Thread-2 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

  
    

  create  table "postgres"."analytics_analytics"."int_transaction__dbt_tmp"
  
  
    as
  
  (
    SELECT
    -- Primary and Foreign Keys
    transaction_id,
    device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    amount_eur,
    status,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction"
  );
  
[0m09:25:17.543436 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "card_number" does not exist
LINE 30:     MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ...
                                       ^

[0m09:25:17.543593 [debug] [Thread-2 (]: On model.sumup.int_transaction: ROLLBACK
[0m09:25:17.543814 [debug] [Thread-2 (]: On model.sumup.int_transaction: Close
[0m09:25:17.549004 [debug] [Thread-2 (]: Database Error in model int_transaction (models/core/int_transaction.sql)
  column "card_number" does not exist
  LINE 30:     MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ...
                                         ^
  compiled code at target/run/sumup/models/core/int_transaction.sql
[0m09:25:17.549383 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4b97a17-fcfa-4614-a791-444ba4efd766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a67a10>]}
[0m09:25:17.549614 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model analytics_analytics.int_transaction ...... [[31mERROR[0m in 0.02s]
[0m09:25:17.549825 [debug] [Thread-2 (]: Finished running node model.sumup.int_transaction
[0m09:25:17.550022 [debug] [Thread-7 (]: Marking all children of 'model.sumup.int_transaction' to be skipped because of status 'error'.  Reason: Database Error in model int_transaction (models/core/int_transaction.sql)
  column "card_number" does not exist
  LINE 30:     MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ...
                                         ^
  compiled code at target/run/sumup/models/core/int_transaction.sql.
[0m09:25:17.550732 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:17.550845 [debug] [MainThread]: On master: BEGIN
[0m09:25:17.550942 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:25:17.555416 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:25:17.555542 [debug] [MainThread]: On master: COMMIT
[0m09:25:17.555651 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:17.555754 [debug] [MainThread]: On master: COMMIT
[0m09:25:17.555906 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:25:17.556005 [debug] [MainThread]: On master: Close
[0m09:25:17.556151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:25:17.556242 [debug] [MainThread]: Connection 'model.sumup.stg_transaction' was properly closed.
[0m09:25:17.556324 [debug] [MainThread]: Connection 'model.sumup.int_transaction' was properly closed.
[0m09:25:17.556404 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m09:25:17.556517 [info ] [MainThread]: 
[0m09:25:17.556631 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m09:25:17.556933 [debug] [MainThread]: Command end result
[0m09:25:17.565777 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:25:17.566730 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:25:17.568930 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:25:17.569037 [info ] [MainThread]: 
[0m09:25:17.569174 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:25:17.569288 [info ] [MainThread]: 
[0m09:25:17.569428 [error] [MainThread]: [31mFailure in model int_transaction (models/core/int_transaction.sql)[0m
[0m09:25:17.569564 [error] [MainThread]:   Database Error in model int_transaction (models/core/int_transaction.sql)
  column "card_number" does not exist
  LINE 30:     MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ...
                                         ^
  compiled code at target/run/sumup/models/core/int_transaction.sql
[0m09:25:17.569666 [info ] [MainThread]: 
[0m09:25:17.569786 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/core/int_transaction.sql
[0m09:25:17.569888 [info ] [MainThread]: 
[0m09:25:17.570003 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m09:25:17.571485 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6270723, "process_in_blocks": "0", "process_kernel_time": 0.160156, "process_mem_max_rss": "130498560", "process_out_blocks": "0", "process_user_time": 0.908795}
[0m09:25:17.571661 [debug] [MainThread]: Command `dbt run` failed at 09:25:17.571631 after 0.63 seconds
[0m09:25:17.571804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079447d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d2ac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c7a50>]}
[0m09:25:17.571931 [debug] [MainThread]: Flushing usage events
[0m09:25:18.266903 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:25:44.738513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae14050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c437c50>]}


============================== 09:25:44.741167 | d6b5e391-688b-4066-a704-acb048248e33 ==============================
[0m09:25:44.741167 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:25:44.741433 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'empty': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'invocation_command': 'dbt run --select +int_transaction', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'write_json': 'True', 'partial_parse': 'True', 'no_print': 'None', 'printer_width': '80', 'fail_fast': 'False', 'use_colors': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'version_check': 'True'}
[0m09:25:44.827707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6b5e391-688b-4066-a704-acb048248e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b257950>]}
[0m09:25:44.851249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6b5e391-688b-4066-a704-acb048248e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1cacf0>]}
[0m09:25:44.851773 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:25:44.903649 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:25:44.961564 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:25:44.961883 [debug] [MainThread]: Partial parsing: updated file: sumup://models/staging/stg_transaction.sql
[0m09:25:45.083130 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m09:25:45.088455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6b5e391-688b-4066-a704-acb048248e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1bab50>]}
[0m09:25:45.120770 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:25:45.121934 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:25:45.132073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6b5e391-688b-4066-a704-acb048248e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4a66c0>]}
[0m09:25:45.132286 [info ] [MainThread]: Found 3 seeds, 3 models, 1 source, 447 macros
[0m09:25:45.132436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6b5e391-688b-4066-a704-acb048248e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d551a90>]}
[0m09:25:45.133065 [info ] [MainThread]: 
[0m09:25:45.133197 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:25:45.133304 [info ] [MainThread]: 
[0m09:25:45.133492 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:25:45.134898 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:25:45.138757 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:25:45.188481 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:25:45.188671 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:25:45.188803 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:25:45.188925 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:25:45.189037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:25:45.189141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:25:45.208552 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.019 seconds
[0m09:25:45.208731 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.020 seconds
[0m09:25:45.209333 [debug] [ThreadPool]: On list_postgres: Close
[0m09:25:45.209832 [debug] [ThreadPool]: On list_postgres: Close
[0m09:25:45.210490 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_analytics)
[0m09:25:45.210675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m09:25:45.212774 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:25:45.212959 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m09:25:45.213562 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:25:45.213672 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m09:25:45.214452 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:25:45.214560 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m09:25:45.214661 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:25:45.214760 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m09:25:45.214849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:25:45.214987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:25:45.219932 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m09:25:45.220054 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m09:25:45.220183 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m09:25:45.220295 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:25:45.220410 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:25:45.220510 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:25:45.220622 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:25:45.220751 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m09:25:45.220874 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m09:25:45.225919 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m09:25:45.226070 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m09:25:45.226182 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m09:25:45.226650 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m09:25:45.227033 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m09:25:45.227404 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m09:25:45.227647 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m09:25:45.227764 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m09:25:45.227887 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m09:25:45.229865 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:45.229971 [debug] [MainThread]: On master: BEGIN
[0m09:25:45.230058 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:25:45.234324 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:25:45.234426 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:45.234550 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:25:45.241467 [debug] [MainThread]: SQL status: SELECT 1 in 0.007 seconds
[0m09:25:45.241938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6b5e391-688b-4066-a704-acb048248e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d83af70>]}
[0m09:25:45.242093 [debug] [MainThread]: On master: ROLLBACK
[0m09:25:45.242257 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:45.242349 [debug] [MainThread]: On master: BEGIN
[0m09:25:45.242701 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:25:45.242810 [debug] [MainThread]: On master: COMMIT
[0m09:25:45.242906 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:45.242995 [debug] [MainThread]: On master: COMMIT
[0m09:25:45.243183 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:25:45.243279 [debug] [MainThread]: On master: Close
[0m09:25:45.244407 [debug] [Thread-1 (]: Began running node model.sumup.stg_transaction
[0m09:25:45.244587 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_staging.stg_transaction .................. [RUN]
[0m09:25:45.244747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.stg_transaction)
[0m09:25:45.244871 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_transaction
[0m09:25:45.247818 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m09:25:45.248116 [debug] [Thread-1 (]: Began executing node model.sumup.stg_transaction
[0m09:25:45.261744 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_transaction"
[0m09:25:45.262185 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:25:45.262321 [debug] [Thread-1 (]: On model.sumup.stg_transaction: BEGIN
[0m09:25:45.262444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:25:45.266733 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m09:25:45.266864 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:25:45.267002 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  create view "postgres"."analytics_staging"."stg_transaction__dbt_tmp"
    
    
  as (
    SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) / 100 AS amount_eur,
    LOWER(status) AS status,

    -- Card Information 
    REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '') AS card_number,
    CAST(cvv AS VARCHAR) AS cvv,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  );
[0m09:25:45.273370 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:25:45.275885 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:25:45.276060 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
alter table "postgres"."analytics_staging"."stg_transaction" rename to "stg_transaction__dbt_backup"
[0m09:25:45.277192 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:45.278274 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:25:45.278398 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
alter table "postgres"."analytics_staging"."stg_transaction__dbt_tmp" rename to "stg_transaction"
[0m09:25:45.279331 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:45.285555 [debug] [Thread-1 (]: On model.sumup.stg_transaction: COMMIT
[0m09:25:45.285696 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:25:45.285819 [debug] [Thread-1 (]: On model.sumup.stg_transaction: COMMIT
[0m09:25:45.286828 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:45.288879 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_transaction__dbt_backup"
[0m09:25:45.290663 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:25:45.290797 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
drop view if exists "postgres"."analytics_staging"."stg_transaction__dbt_backup" cascade
[0m09:25:45.292636 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:25:45.293539 [debug] [Thread-1 (]: On model.sumup.stg_transaction: Close
[0m09:25:45.294486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b5e391-688b-4066-a704-acb048248e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4b7dd0>]}
[0m09:25:45.294759 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_staging.stg_transaction ............. [[32mCREATE VIEW[0m in 0.05s]
[0m09:25:45.295002 [debug] [Thread-1 (]: Finished running node model.sumup.stg_transaction
[0m09:25:45.295267 [debug] [Thread-2 (]: Began running node model.sumup.int_transaction
[0m09:25:45.295504 [info ] [Thread-2 (]: 2 of 2 START sql table model analytics_analytics.int_transaction ............... [RUN]
[0m09:25:45.295703 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.int_transaction)
[0m09:25:45.295830 [debug] [Thread-2 (]: Began compiling node model.sumup.int_transaction
[0m09:25:45.296895 [debug] [Thread-2 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m09:25:45.297158 [debug] [Thread-2 (]: Began executing node model.sumup.int_transaction
[0m09:25:45.305273 [debug] [Thread-2 (]: Writing runtime sql for node "model.sumup.int_transaction"
[0m09:25:45.305611 [debug] [Thread-2 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:25:45.305740 [debug] [Thread-2 (]: On model.sumup.int_transaction: BEGIN
[0m09:25:45.305853 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:25:45.310525 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m09:25:45.310682 [debug] [Thread-2 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:25:45.310825 [debug] [Thread-2 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

  
    

  create  table "postgres"."analytics_analytics"."int_transaction__dbt_tmp"
  
  
    as
  
  (
    SELECT
    -- Primary and Foreign Keys
    transaction_id,
    device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    amount_eur,
    status,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction"
  );
  
[0m09:25:45.345131 [debug] [Thread-2 (]: SQL status: SELECT 1500 in 0.034 seconds
[0m09:25:45.348175 [debug] [Thread-2 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:25:45.348320 [debug] [Thread-2 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */
alter table "postgres"."analytics_analytics"."int_transaction__dbt_tmp" rename to "int_transaction"
[0m09:25:45.349562 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:45.350106 [debug] [Thread-2 (]: On model.sumup.int_transaction: COMMIT
[0m09:25:45.350234 [debug] [Thread-2 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:25:45.350350 [debug] [Thread-2 (]: On model.sumup.int_transaction: COMMIT
[0m09:25:45.351035 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:45.351804 [debug] [Thread-2 (]: Applying DROP to: "postgres"."analytics_analytics"."int_transaction__dbt_backup"
[0m09:25:45.352890 [debug] [Thread-2 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:25:45.353025 [debug] [Thread-2 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */
drop table if exists "postgres"."analytics_analytics"."int_transaction__dbt_backup" cascade
[0m09:25:45.353343 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m09:25:45.353884 [debug] [Thread-2 (]: On model.sumup.int_transaction: Close
[0m09:25:45.354128 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b5e391-688b-4066-a704-acb048248e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4c3960>]}
[0m09:25:45.354389 [info ] [Thread-2 (]: 2 of 2 OK created sql table model analytics_analytics.int_transaction .......... [[32mSELECT 1500[0m in 0.06s]
[0m09:25:45.354610 [debug] [Thread-2 (]: Finished running node model.sumup.int_transaction
[0m09:25:45.355159 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:45.355278 [debug] [MainThread]: On master: BEGIN
[0m09:25:45.355382 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:25:45.361056 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m09:25:45.361182 [debug] [MainThread]: On master: COMMIT
[0m09:25:45.361290 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:45.361389 [debug] [MainThread]: On master: COMMIT
[0m09:25:45.361542 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:25:45.361647 [debug] [MainThread]: On master: Close
[0m09:25:45.361788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:25:45.361887 [debug] [MainThread]: Connection 'model.sumup.stg_transaction' was properly closed.
[0m09:25:45.362022 [debug] [MainThread]: Connection 'model.sumup.int_transaction' was properly closed.
[0m09:25:45.362111 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m09:25:45.362219 [info ] [MainThread]: 
[0m09:25:45.362336 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m09:25:45.362638 [debug] [MainThread]: Command end result
[0m09:25:45.372257 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:25:45.373016 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:25:45.375471 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:25:45.375595 [info ] [MainThread]: 
[0m09:25:45.375743 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:25:45.375892 [info ] [MainThread]: 
[0m09:25:45.376024 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m09:25:45.377853 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.67336494, "process_in_blocks": "0", "process_kernel_time": 0.162694, "process_mem_max_rss": "130416640", "process_out_blocks": "0", "process_user_time": 0.950935}
[0m09:25:45.378043 [debug] [MainThread]: Command `dbt run` succeeded at 09:25:45.378003 after 0.67 seconds
[0m09:25:45.378196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9fda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d902600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d323a50>]}
[0m09:25:45.378382 [debug] [MainThread]: Flushing usage events
[0m09:25:46.102238 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:10:34.436724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103890050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046d79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046d7c50>]}


============================== 09:10:34.439513 | 4b219e63-d4cb-46eb-8c54-1c78782a2df2 ==============================
[0m09:10:34.439513 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:10:34.439772 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'no_print': 'None', 'fail_fast': 'False', 'warn_error': 'None', 'write_json': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'debug': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run -m stg_device', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'version_check': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'empty': 'False', 'log_format': 'default', 'use_colors': 'True'}
[0m09:10:34.439979 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m09:10:34.440121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4b219e63-d4cb-46eb-8c54-1c78782a2df2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045bb6f0>]}
[0m09:10:34.526876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b219e63-d4cb-46eb-8c54-1c78782a2df2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104566cf0>]}
[0m09:10:34.547979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b219e63-d4cb-46eb-8c54-1c78782a2df2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104573d50>]}
[0m09:10:34.548369 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:10:34.603774 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:10:34.664074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m09:10:34.664347 [debug] [MainThread]: Partial parsing: added file: sumup://models/staging/stg_device.sql
[0m09:10:34.664487 [debug] [MainThread]: Partial parsing: added file: sumup://models/staging/stg_device.yml
[0m09:10:34.664600 [debug] [MainThread]: Partial parsing: added file: sumup://models/staging/stg_stores.sql
[0m09:10:34.664710 [debug] [MainThread]: Partial parsing: added file: sumup://models/staging/stg_stores.yml
[0m09:10:34.737944 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.sumup.stg_stores' (models/staging/stg_stores.sql) depends on a source named 'seed.stores' which was not found
[0m09:10:34.738257 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m09:10:34.740480 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.34113124, "process_in_blocks": "0", "process_kernel_time": 0.141503, "process_mem_max_rss": "118685696", "process_out_blocks": "0", "process_user_time": 0.736765}
[0m09:10:34.740702 [debug] [MainThread]: Command `dbt run` failed at 09:10:34.740661 after 0.34 seconds
[0m09:10:34.740877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105904230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105905040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045c3e70>]}
[0m09:10:34.741028 [debug] [MainThread]: Flushing usage events
[0m09:10:35.460509 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:11:07.124574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108708050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10954f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10954fc50>]}


============================== 09:11:07.127204 | 53ccd728-93b6-4b9d-aec5-9be7131a62cf ==============================
[0m09:11:07.127204 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:11:07.127467 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'target_path': 'None', 'debug': 'False', 'log_format': 'default', 'write_json': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt run -m stg_device', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'empty': 'False', 'introspect': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'quiet': 'False'}
[0m09:11:07.127667 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m09:11:07.127845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '53ccd728-93b6-4b9d-aec5-9be7131a62cf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094336f0>]}
[0m09:11:07.212049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53ccd728-93b6-4b9d-aec5-9be7131a62cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093decf0>]}
[0m09:11:07.233154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53ccd728-93b6-4b9d-aec5-9be7131a62cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093ebd50>]}
[0m09:11:07.233551 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:11:07.284235 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:11:07.342729 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m09:11:07.342993 [debug] [MainThread]: Partial parsing: added file: sumup://models/staging/stg_device.sql
[0m09:11:07.343118 [debug] [MainThread]: Partial parsing: added file: sumup://models/staging/stg_stores.sql
[0m09:11:07.343239 [debug] [MainThread]: Partial parsing: added file: sumup://models/staging/stg_stores.yml
[0m09:11:07.343348 [debug] [MainThread]: Partial parsing: added file: sumup://models/staging/stg_device.yml
[0m09:11:07.436982 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m09:11:07.441698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53ccd728-93b6-4b9d-aec5-9be7131a62cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4fb3e0>]}
[0m09:11:07.491650 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:11:07.492971 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:11:07.530146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53ccd728-93b6-4b9d-aec5-9be7131a62cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a487310>]}
[0m09:11:07.530405 [info ] [MainThread]: Found 3 seeds, 5 models, 1 source, 447 macros
[0m09:11:07.530554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53ccd728-93b6-4b9d-aec5-9be7131a62cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7302c0>]}
[0m09:11:07.531183 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:11:07.531406 [debug] [MainThread]: Command end result
[0m09:11:07.541623 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:11:07.542464 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:11:07.543709 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:11:07.543916 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m09:11:07.545378 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4536526, "process_in_blocks": "0", "process_kernel_time": 0.129068, "process_mem_max_rss": "121159680", "process_out_blocks": "0", "process_user_time": 0.802318}
[0m09:11:07.545554 [debug] [MainThread]: Command `dbt run` succeeded at 09:11:07.545520 after 0.45 seconds
[0m09:11:07.545685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093bde50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a73d650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a73d7b0>]}
[0m09:11:07.545807 [debug] [MainThread]: Flushing usage events
[0m09:11:08.224780 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:11:36.158885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ecc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d0f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d0fc50>]}


============================== 09:11:36.161341 | fab26cec-54ff-49e7-b03e-9400870e9c69 ==============================
[0m09:11:36.161341 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:11:36.161603 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'quiet': 'False', 'warn_error': 'None', 'write_json': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'log_format': 'default', 'no_print': 'None', 'partial_parse': 'True', 'printer_width': '80', 'invocation_command': 'dbt run --select +stg_stores', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'empty': 'False', 'static_parser': 'True', 'debug': 'False'}
[0m09:11:36.243163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fab26cec-54ff-49e7-b03e-9400870e9c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10602f950>]}
[0m09:11:36.263651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fab26cec-54ff-49e7-b03e-9400870e9c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba2cf0>]}
[0m09:11:36.264242 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:11:36.313746 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:11:36.369442 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:11:36.369657 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:11:36.372016 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m09:11:36.390501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fab26cec-54ff-49e7-b03e-9400870e9c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c41d50>]}
[0m09:11:36.421891 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:11:36.423314 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:11:36.433219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fab26cec-54ff-49e7-b03e-9400870e9c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d7e6c0>]}
[0m09:11:36.433425 [info ] [MainThread]: Found 3 seeds, 5 models, 1 source, 447 macros
[0m09:11:36.433560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fab26cec-54ff-49e7-b03e-9400870e9c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c4ba10>]}
[0m09:11:36.434170 [info ] [MainThread]: 
[0m09:11:36.434313 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:11:36.434419 [info ] [MainThread]: 
[0m09:11:36.434620 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:11:36.434951 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:11:36.461162 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:11:36.461343 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:11:36.461453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:11:36.630991 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.169 seconds
[0m09:11:36.632379 [debug] [ThreadPool]: On list_postgres: Close
[0m09:11:36.636146 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics)
[0m09:11:36.636539 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m09:11:36.640605 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:11:36.640960 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m09:11:36.642055 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:11:36.642263 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m09:11:36.643643 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:11:36.643839 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m09:11:36.644048 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:11:36.644283 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m09:11:36.644454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:11:36.644728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:11:36.689506 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m09:11:36.689756 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m09:11:36.689924 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m09:11:36.690079 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:11:36.690217 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:11:36.690412 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:11:36.690681 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m09:11:36.691004 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m09:11:36.691246 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:11:36.745052 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.054 seconds
[0m09:11:36.745579 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.054 seconds
[0m09:11:36.748742 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m09:11:36.749221 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.058 seconds
[0m09:11:36.751700 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m09:11:36.753259 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m09:11:36.753704 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m09:11:36.754326 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m09:11:36.754736 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m09:11:36.760879 [debug] [MainThread]: Using postgres connection "master"
[0m09:11:36.761113 [debug] [MainThread]: On master: BEGIN
[0m09:11:36.761223 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:11:36.824126 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m09:11:36.824813 [debug] [MainThread]: Using postgres connection "master"
[0m09:11:36.825258 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:11:36.844547 [debug] [MainThread]: SQL status: SELECT 1 in 0.019 seconds
[0m09:11:36.850718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fab26cec-54ff-49e7-b03e-9400870e9c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f01f0>]}
[0m09:11:36.851484 [debug] [MainThread]: On master: ROLLBACK
[0m09:11:36.852178 [debug] [MainThread]: Using postgres connection "master"
[0m09:11:36.852602 [debug] [MainThread]: On master: BEGIN
[0m09:11:36.853264 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:11:36.853730 [debug] [MainThread]: On master: COMMIT
[0m09:11:36.854110 [debug] [MainThread]: Using postgres connection "master"
[0m09:11:36.854429 [debug] [MainThread]: On master: COMMIT
[0m09:11:36.854945 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:11:36.855290 [debug] [MainThread]: On master: Close
[0m09:11:36.859052 [debug] [Thread-1 (]: Began running node model.sumup.stg_stores
[0m09:11:36.859844 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_staging.stg_stores ....................... [RUN]
[0m09:11:36.860511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.stg_stores)
[0m09:11:36.861051 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_stores
[0m09:11:36.866421 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_stores"
[0m09:11:36.867709 [debug] [Thread-1 (]: Began executing node model.sumup.stg_stores
[0m09:11:36.888304 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_stores"
[0m09:11:36.889132 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_stores"
[0m09:11:36.889335 [debug] [Thread-1 (]: On model.sumup.stg_stores: BEGIN
[0m09:11:36.889494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:11:36.903630 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m09:11:36.903850 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_stores"
[0m09:11:36.904058 [debug] [Thread-1 (]: On model.sumup.stg_stores: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_stores"} */

  create view "postgres"."analytics_staging"."stg_stores__dbt_tmp"
    
    
  as (
    

SELECT
    -- Primary Key: Rename to be explicit
    id AS store_id,

    -- Descriptive Attributes: Rename 'typology' for clarity
    typology AS store_typology,
    country,
    city,
    
    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-19 07:11:36.150420+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."store"
  );
[0m09:11:36.904767 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 21: FROM "postgres"."analytics"."store"
         ^

[0m09:11:36.904964 [debug] [Thread-1 (]: On model.sumup.stg_stores: ROLLBACK
[0m09:11:36.905314 [debug] [Thread-1 (]: On model.sumup.stg_stores: Close
[0m09:11:36.912162 [debug] [Thread-1 (]: Database Error in model stg_stores (models/staging/stg_stores.sql)
  syntax error at or near "FROM"
  LINE 21: FROM "postgres"."analytics"."store"
           ^
  compiled code at target/run/sumup/models/staging/stg_stores.sql
[0m09:11:36.913318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fab26cec-54ff-49e7-b03e-9400870e9c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e2b710>]}
[0m09:11:36.913826 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_staging.stg_stores .............. [[31mERROR[0m in 0.05s]
[0m09:11:36.914144 [debug] [Thread-1 (]: Finished running node model.sumup.stg_stores
[0m09:11:36.914445 [debug] [Thread-7 (]: Marking all children of 'model.sumup.stg_stores' to be skipped because of status 'error'.  Reason: Database Error in model stg_stores (models/staging/stg_stores.sql)
  syntax error at or near "FROM"
  LINE 21: FROM "postgres"."analytics"."store"
           ^
  compiled code at target/run/sumup/models/staging/stg_stores.sql.
[0m09:11:36.915571 [debug] [MainThread]: Using postgres connection "master"
[0m09:11:36.915727 [debug] [MainThread]: On master: BEGIN
[0m09:11:36.915854 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:11:36.921028 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:11:36.921188 [debug] [MainThread]: On master: COMMIT
[0m09:11:36.921343 [debug] [MainThread]: Using postgres connection "master"
[0m09:11:36.921478 [debug] [MainThread]: On master: COMMIT
[0m09:11:36.921798 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:11:36.921931 [debug] [MainThread]: On master: Close
[0m09:11:36.922111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:11:36.922238 [debug] [MainThread]: Connection 'model.sumup.stg_stores' was properly closed.
[0m09:11:36.922353 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m09:11:36.922468 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m09:11:36.922606 [info ] [MainThread]: 
[0m09:11:36.922756 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m09:11:36.923075 [debug] [MainThread]: Command end result
[0m09:11:36.936724 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:11:36.937917 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:11:36.940936 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:11:36.941093 [info ] [MainThread]: 
[0m09:11:36.941275 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:11:36.941410 [info ] [MainThread]: 
[0m09:11:36.941582 [error] [MainThread]: [31mFailure in model stg_stores (models/staging/stg_stores.sql)[0m
[0m09:11:36.941736 [error] [MainThread]:   Database Error in model stg_stores (models/staging/stg_stores.sql)
  syntax error at or near "FROM"
  LINE 21: FROM "postgres"."analytics"."store"
           ^
  compiled code at target/run/sumup/models/staging/stg_stores.sql
[0m09:11:36.941854 [info ] [MainThread]: 
[0m09:11:36.941993 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/staging/stg_stores.sql
[0m09:11:36.942103 [info ] [MainThread]: 
[0m09:11:36.942239 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m09:11:36.944527 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.81185544, "process_in_blocks": "0", "process_kernel_time": 0.158541, "process_mem_max_rss": "123846656", "process_out_blocks": "0", "process_user_time": 0.801417}
[0m09:11:36.944747 [debug] [MainThread]: Command `dbt run` failed at 09:11:36.944707 after 0.81 seconds
[0m09:11:36.944928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e7a4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10820b390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10820acb0>]}
[0m09:11:36.945084 [debug] [MainThread]: Flushing usage events
[0m09:11:37.680988 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:11:45.630855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10677c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075bf9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075bfc50>]}


============================== 09:11:45.633891 | 19c937c7-cde2-4f5d-8995-657a82894d27 ==============================
[0m09:11:45.633891 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:11:45.634145 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'target_path': 'None', 'static_parser': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'empty': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'quiet': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'no_print': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'use_colors': 'True', 'invocation_command': 'dbt run --select +stg_stores', 'printer_width': '80', 'introspect': 'True'}
[0m09:11:45.702424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19c937c7-cde2-4f5d-8995-657a82894d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068df950>]}
[0m09:11:45.723191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19c937c7-cde2-4f5d-8995-657a82894d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107452cf0>]}
[0m09:11:45.723843 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:11:45.772689 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:11:45.829510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:11:45.829793 [debug] [MainThread]: Partial parsing: updated file: sumup://models/staging/stg_stores.sql
[0m09:11:45.920765 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m09:11:45.925507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19c937c7-cde2-4f5d-8995-657a82894d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084f2d50>]}
[0m09:11:45.958579 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:11:45.959518 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:11:45.969521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19c937c7-cde2-4f5d-8995-657a82894d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10762e6c0>]}
[0m09:11:45.969718 [info ] [MainThread]: Found 3 seeds, 5 models, 1 source, 447 macros
[0m09:11:45.969857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19c937c7-cde2-4f5d-8995-657a82894d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10888dfd0>]}
[0m09:11:45.970484 [info ] [MainThread]: 
[0m09:11:45.970616 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:11:45.970717 [info ] [MainThread]: 
[0m09:11:45.970909 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:11:45.971247 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:11:46.025297 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:11:46.025502 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:11:46.025609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:11:46.040937 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.015 seconds
[0m09:11:46.041534 [debug] [ThreadPool]: On list_postgres: Close
[0m09:11:46.043279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m09:11:46.043515 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m09:11:46.045633 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:11:46.045845 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m09:11:46.046642 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:11:46.046764 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m09:11:46.047299 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:11:46.047410 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m09:11:46.047508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:11:46.047605 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m09:11:46.047698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:11:46.047850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:11:46.060012 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m09:11:46.060118 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:11:46.060225 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m09:11:46.060362 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m09:11:46.060517 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:11:46.060652 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:11:46.060773 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m09:11:46.060899 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:11:46.061009 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m09:11:46.065016 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m09:11:46.065127 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m09:11:46.065605 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m09:11:46.065724 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m09:11:46.066181 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m09:11:46.066623 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m09:11:46.066738 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m09:11:46.067022 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m09:11:46.067126 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m09:11:46.069147 [debug] [MainThread]: Using postgres connection "master"
[0m09:11:46.069283 [debug] [MainThread]: On master: BEGIN
[0m09:11:46.069382 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:11:46.073064 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:11:46.073165 [debug] [MainThread]: Using postgres connection "master"
[0m09:11:46.073299 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:11:46.077502 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m09:11:46.077981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19c937c7-cde2-4f5d-8995-657a82894d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a1b040>]}
[0m09:11:46.078151 [debug] [MainThread]: On master: ROLLBACK
[0m09:11:46.078333 [debug] [MainThread]: Using postgres connection "master"
[0m09:11:46.078430 [debug] [MainThread]: On master: BEGIN
[0m09:11:46.078678 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:11:46.078776 [debug] [MainThread]: On master: COMMIT
[0m09:11:46.078870 [debug] [MainThread]: Using postgres connection "master"
[0m09:11:46.078959 [debug] [MainThread]: On master: COMMIT
[0m09:11:46.079187 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:11:46.079309 [debug] [MainThread]: On master: Close
[0m09:11:46.080549 [debug] [Thread-1 (]: Began running node model.sumup.stg_stores
[0m09:11:46.080754 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_staging.stg_stores ....................... [RUN]
[0m09:11:46.080929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.stg_stores)
[0m09:11:46.081061 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_stores
[0m09:11:46.084278 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_stores"
[0m09:11:46.084707 [debug] [Thread-1 (]: Began executing node model.sumup.stg_stores
[0m09:11:46.098610 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_stores"
[0m09:11:46.099003 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_stores"
[0m09:11:46.099131 [debug] [Thread-1 (]: On model.sumup.stg_stores: BEGIN
[0m09:11:46.099245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:11:46.103523 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m09:11:46.103662 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_stores"
[0m09:11:46.103789 [debug] [Thread-1 (]: On model.sumup.stg_stores: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_stores"} */

  create view "postgres"."analytics_staging"."stg_stores__dbt_tmp"
    
    
  as (
    

SELECT
    -- Primary Key: Rename to be explicit
    id AS store_id,

    -- Descriptive Attributes: Rename 'typology' for clarity
    typology AS store_typology,
    country,
    city
    
    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-19 07:11:45.621085+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."store"
  );
[0m09:11:46.122739 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m09:11:46.125411 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_stores"
[0m09:11:46.125568 [debug] [Thread-1 (]: On model.sumup.stg_stores: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_stores"} */
alter table "postgres"."analytics_staging"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m09:11:46.127505 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:11:46.133296 [debug] [Thread-1 (]: On model.sumup.stg_stores: COMMIT
[0m09:11:46.133460 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_stores"
[0m09:11:46.133585 [debug] [Thread-1 (]: On model.sumup.stg_stores: COMMIT
[0m09:11:46.134630 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:11:46.137096 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_stores__dbt_backup"
[0m09:11:46.138933 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_stores"
[0m09:11:46.139076 [debug] [Thread-1 (]: On model.sumup.stg_stores: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_stores"} */
drop view if exists "postgres"."analytics_staging"."stg_stores__dbt_backup" cascade
[0m09:11:46.139661 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:11:46.140635 [debug] [Thread-1 (]: On model.sumup.stg_stores: Close
[0m09:11:46.141541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19c937c7-cde2-4f5d-8995-657a82894d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086b7a10>]}
[0m09:11:46.141813 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analytics_staging.stg_stores .................. [[32mCREATE VIEW[0m in 0.06s]
[0m09:11:46.142052 [debug] [Thread-1 (]: Finished running node model.sumup.stg_stores
[0m09:11:46.142577 [debug] [MainThread]: Using postgres connection "master"
[0m09:11:46.142694 [debug] [MainThread]: On master: BEGIN
[0m09:11:46.142795 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:11:46.148653 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m09:11:46.148769 [debug] [MainThread]: On master: COMMIT
[0m09:11:46.148872 [debug] [MainThread]: Using postgres connection "master"
[0m09:11:46.148977 [debug] [MainThread]: On master: COMMIT
[0m09:11:46.149143 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:11:46.149246 [debug] [MainThread]: On master: Close
[0m09:11:46.149386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:11:46.149487 [debug] [MainThread]: Connection 'model.sumup.stg_stores' was properly closed.
[0m09:11:46.149579 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m09:11:46.149668 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m09:11:46.149787 [info ] [MainThread]: 
[0m09:11:46.149910 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m09:11:46.150167 [debug] [MainThread]: Command end result
[0m09:11:46.159902 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:11:46.160661 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:11:46.163076 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:11:46.163208 [info ] [MainThread]: 
[0m09:11:46.163373 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:11:46.163521 [info ] [MainThread]: 
[0m09:11:46.163660 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m09:11:46.165590 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5622908, "process_in_blocks": "0", "process_kernel_time": 0.149489, "process_mem_max_rss": "129122304", "process_out_blocks": "0", "process_user_time": 0.88087}
[0m09:11:46.165816 [debug] [MainThread]: Command `dbt run` succeeded at 09:11:46.165776 after 0.56 seconds
[0m09:11:46.165973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087eb120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10834a2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108349810>]}
[0m09:11:46.166122 [debug] [MainThread]: Flushing usage events
[0m09:11:46.835785 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:11:53.063269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10466c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054b39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054b3c50>]}


============================== 09:11:53.066458 | a779df4e-aa19-462e-a396-09d719ed822b ==============================
[0m09:11:53.066458 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:11:53.066710 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'no_print': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'static_parser': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'fail_fast': 'False', 'version_check': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select +stg_device', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'introspect': 'True'}
[0m09:11:53.134742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a779df4e-aa19-462e-a396-09d719ed822b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d3950>]}
[0m09:11:53.155338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a779df4e-aa19-462e-a396-09d719ed822b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105342cf0>]}
[0m09:11:53.155881 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:11:53.204278 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:11:53.259366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:11:53.259538 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:11:53.261570 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m09:11:53.278295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a779df4e-aa19-462e-a396-09d719ed822b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ddd50>]}
[0m09:11:53.309306 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:11:53.310249 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:11:53.322394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a779df4e-aa19-462e-a396-09d719ed822b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10551e6c0>]}
[0m09:11:53.322646 [info ] [MainThread]: Found 3 seeds, 5 models, 1 source, 447 macros
[0m09:11:53.322790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a779df4e-aa19-462e-a396-09d719ed822b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e7a10>]}
[0m09:11:53.323388 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:11:53.324196 [debug] [MainThread]: Command end result
[0m09:11:53.336827 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:11:53.337810 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:11:53.339370 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:11:53.340757 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.3092901, "process_in_blocks": "0", "process_kernel_time": 0.121192, "process_mem_max_rss": "117587968", "process_out_blocks": "0", "process_user_time": 0.703106}
[0m09:11:53.340936 [debug] [MainThread]: Command `dbt run` succeeded at 09:11:53.340901 after 0.31 seconds
[0m09:11:53.341079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055457e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105321f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c5490>]}
[0m09:11:53.341311 [debug] [MainThread]: Flushing usage events
[0m09:11:54.009707 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:12:06.960001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085f4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10943b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10943bc50>]}


============================== 09:12:06.962424 | 29cb2018-3f88-489f-871c-13505dd2201a ==============================
[0m09:12:06.962424 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:12:06.962713 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run --select +stg_device', 'indirect_selection': 'eager', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'use_colors': 'True', 'empty': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'no_print': 'None', 'debug': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'write_json': 'True'}
[0m09:12:07.040152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29cb2018-3f88-489f-871c-13505dd2201a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108757950>]}
[0m09:12:07.060781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29cb2018-3f88-489f-871c-13505dd2201a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092cacf0>]}
[0m09:12:07.061331 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:12:07.111299 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:12:07.167163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:12:07.167413 [debug] [MainThread]: Partial parsing: updated file: sumup://models/staging/stg_device.sql
[0m09:12:07.258110 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m09:12:07.263061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29cb2018-3f88-489f-871c-13505dd2201a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a36ad50>]}
[0m09:12:07.294009 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:12:07.295116 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:12:07.305268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29cb2018-3f88-489f-871c-13505dd2201a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094a66c0>]}
[0m09:12:07.305462 [info ] [MainThread]: Found 3 seeds, 5 models, 1 source, 447 macros
[0m09:12:07.305600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29cb2018-3f88-489f-871c-13505dd2201a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7058d0>]}
[0m09:12:07.306240 [info ] [MainThread]: 
[0m09:12:07.306377 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:12:07.306500 [info ] [MainThread]: 
[0m09:12:07.306700 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:12:07.307040 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:12:07.356663 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:12:07.356874 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:12:07.356989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:07.377437 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.020 seconds
[0m09:12:07.378014 [debug] [ThreadPool]: On list_postgres: Close
[0m09:12:07.379929 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics)
[0m09:12:07.382203 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:12:07.382382 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m09:12:07.382485 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m09:12:07.382655 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m09:12:07.383458 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:12:07.383580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:12:07.384137 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:12:07.384248 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m09:12:07.384413 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m09:12:07.384531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:07.384643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:07.389615 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m09:12:07.389761 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m09:12:07.389895 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:12:07.390028 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m09:12:07.390138 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:12:07.390257 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:12:07.390365 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:12:07.390473 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m09:12:07.390612 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m09:12:07.397602 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m09:12:07.397720 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m09:12:07.397812 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m09:12:07.398278 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m09:12:07.398684 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m09:12:07.399069 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m09:12:07.399293 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m09:12:07.399397 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m09:12:07.399504 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m09:12:07.401619 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:07.401732 [debug] [MainThread]: On master: BEGIN
[0m09:12:07.401825 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:12:07.405590 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:12:07.405694 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:07.405824 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:12:07.411097 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m09:12:07.411687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29cb2018-3f88-489f-871c-13505dd2201a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a897040>]}
[0m09:12:07.411844 [debug] [MainThread]: On master: ROLLBACK
[0m09:12:07.412059 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:07.412156 [debug] [MainThread]: On master: BEGIN
[0m09:12:07.412471 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:12:07.412577 [debug] [MainThread]: On master: COMMIT
[0m09:12:07.412673 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:07.412765 [debug] [MainThread]: On master: COMMIT
[0m09:12:07.412947 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:12:07.413043 [debug] [MainThread]: On master: Close
[0m09:12:07.414134 [debug] [Thread-1 (]: Began running node model.sumup.stg_device
[0m09:12:07.414317 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_staging.stg_device ....................... [RUN]
[0m09:12:07.414491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.stg_device)
[0m09:12:07.414624 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_device
[0m09:12:07.417768 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_device"
[0m09:12:07.418064 [debug] [Thread-1 (]: Began executing node model.sumup.stg_device
[0m09:12:07.432131 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_device"
[0m09:12:07.432544 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:12:07.432674 [debug] [Thread-1 (]: On model.sumup.stg_device: BEGIN
[0m09:12:07.432787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:07.438042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m09:12:07.438178 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:12:07.438305 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */

  create view "postgres"."analytics_staging"."stg_device__dbt_tmp"
    
    
  as (
    

SELECT
    -- Primary Key
    id AS device_id,

    -- Foreign Key to stores (assuming this links the device to a specific store)
    store_id,

    -- Descriptive Attributes
    device_type,
    
    -- Other fields, if any, standardized here
    -- e.g., CAST(status AS VARCHAR) AS device_status

    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-19 07:12:06.951892+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM"postgres"."analytics"."device"
  );
[0m09:12:07.438768 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 25: FROM"postgres"."analytics"."device"
         ^

[0m09:12:07.438884 [debug] [Thread-1 (]: On model.sumup.stg_device: ROLLBACK
[0m09:12:07.439121 [debug] [Thread-1 (]: On model.sumup.stg_device: Close
[0m09:12:07.444394 [debug] [Thread-1 (]: Database Error in model stg_device (models/staging/stg_device.sql)
  syntax error at or near "FROM"
  LINE 25: FROM"postgres"."analytics"."device"
           ^
  compiled code at target/run/sumup/models/staging/stg_device.sql
[0m09:12:07.445190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29cb2018-3f88-489f-871c-13505dd2201a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a673b90>]}
[0m09:12:07.445494 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_staging.stg_device .............. [[31mERROR[0m in 0.03s]
[0m09:12:07.445730 [debug] [Thread-1 (]: Finished running node model.sumup.stg_device
[0m09:12:07.445937 [debug] [Thread-7 (]: Marking all children of 'model.sumup.stg_device' to be skipped because of status 'error'.  Reason: Database Error in model stg_device (models/staging/stg_device.sql)
  syntax error at or near "FROM"
  LINE 25: FROM"postgres"."analytics"."device"
           ^
  compiled code at target/run/sumup/models/staging/stg_device.sql.
[0m09:12:07.446785 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:07.446947 [debug] [MainThread]: On master: BEGIN
[0m09:12:07.447063 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:12:07.452318 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:12:07.452452 [debug] [MainThread]: On master: COMMIT
[0m09:12:07.452561 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:07.452663 [debug] [MainThread]: On master: COMMIT
[0m09:12:07.452822 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:12:07.452926 [debug] [MainThread]: On master: Close
[0m09:12:07.453073 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:12:07.453175 [debug] [MainThread]: Connection 'model.sumup.stg_device' was properly closed.
[0m09:12:07.453268 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m09:12:07.453359 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m09:12:07.453470 [info ] [MainThread]: 
[0m09:12:07.453592 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m09:12:07.453853 [debug] [MainThread]: Command end result
[0m09:12:07.463494 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:12:07.464445 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:12:07.467046 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:12:07.467180 [info ] [MainThread]: 
[0m09:12:07.467332 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:12:07.467450 [info ] [MainThread]: 
[0m09:12:07.467597 [error] [MainThread]: [31mFailure in model stg_device (models/staging/stg_device.sql)[0m
[0m09:12:07.467734 [error] [MainThread]:   Database Error in model stg_device (models/staging/stg_device.sql)
  syntax error at or near "FROM"
  LINE 25: FROM"postgres"."analytics"."device"
           ^
  compiled code at target/run/sumup/models/staging/stg_device.sql
[0m09:12:07.467836 [info ] [MainThread]: 
[0m09:12:07.467957 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/staging/stg_device.sql
[0m09:12:07.468058 [info ] [MainThread]: 
[0m09:12:07.468173 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m09:12:07.469613 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.53634495, "process_in_blocks": "0", "process_kernel_time": 0.138315, "process_mem_max_rss": "129433600", "process_out_blocks": "0", "process_user_time": 0.870595}
[0m09:12:07.469779 [debug] [MainThread]: Command `dbt run` failed at 09:12:07.469743 after 0.54 seconds
[0m09:12:07.469938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a682fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1c1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1c1c70>]}
[0m09:12:07.470074 [debug] [MainThread]: Flushing usage events
[0m09:12:08.150937 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:12:13.931038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c74050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a37c50>]}


============================== 09:12:13.933621 | b1d04272-908a-406d-8afa-3c50d202ba97 ==============================
[0m09:12:13.933621 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:12:13.933878 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select +stg_device', 'printer_width': '80', 'use_experimental_parser': 'False', 'target_path': 'None', 'version_check': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'log_format': 'default', 'partial_parse': 'True', 'static_parser': 'True', 'quiet': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'no_print': 'None', 'write_json': 'True', 'debug': 'False', 'fail_fast': 'False', 'introspect': 'True', 'empty': 'False'}
[0m09:12:14.001625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1d04272-908a-406d-8afa-3c50d202ba97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10705b950>]}
[0m09:12:14.021883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1d04272-908a-406d-8afa-3c50d202ba97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098cacf0>]}
[0m09:12:14.022438 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:12:14.072019 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:12:14.129643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:12:14.129920 [debug] [MainThread]: Partial parsing: updated file: sumup://models/staging/stg_device.sql
[0m09:12:14.219224 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m09:12:14.224307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1d04272-908a-406d-8afa-3c50d202ba97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1c2d50>]}
[0m09:12:14.256055 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:12:14.256916 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:12:14.266787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1d04272-908a-406d-8afa-3c50d202ba97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aa66c0>]}
[0m09:12:14.266979 [info ] [MainThread]: Found 3 seeds, 5 models, 1 source, 447 macros
[0m09:12:14.267114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1d04272-908a-406d-8afa-3c50d202ba97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7d9a90>]}
[0m09:12:14.267770 [info ] [MainThread]: 
[0m09:12:14.267917 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:12:14.268021 [info ] [MainThread]: 
[0m09:12:14.268239 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:12:14.268605 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:12:14.319373 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:12:14.319567 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:12:14.319678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:14.334223 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.015 seconds
[0m09:12:14.334787 [debug] [ThreadPool]: On list_postgres: Close
[0m09:12:14.336609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics)
[0m09:12:14.338785 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:12:14.338972 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m09:12:14.339105 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m09:12:14.339301 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m09:12:14.340071 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:12:14.340197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:12:14.340753 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:12:14.340861 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m09:12:14.341027 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m09:12:14.341144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:14.341251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:14.348095 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m09:12:14.348212 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m09:12:14.348325 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:12:14.348432 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m09:12:14.348546 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:12:14.348658 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m09:12:14.348774 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:12:14.348882 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:12:14.349022 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m09:12:14.355105 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m09:12:14.355555 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m09:12:14.356992 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m09:12:14.357094 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m09:12:14.357529 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m09:12:14.357628 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m09:12:14.358017 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m09:12:14.358358 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m09:12:14.358462 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m09:12:14.360401 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:14.360509 [debug] [MainThread]: On master: BEGIN
[0m09:12:14.360601 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:12:14.365859 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:12:14.365962 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:14.366094 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:12:14.371062 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m09:12:14.371599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1d04272-908a-406d-8afa-3c50d202ba97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b966f70>]}
[0m09:12:14.371751 [debug] [MainThread]: On master: ROLLBACK
[0m09:12:14.371982 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:14.372077 [debug] [MainThread]: On master: BEGIN
[0m09:12:14.372364 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:12:14.372459 [debug] [MainThread]: On master: COMMIT
[0m09:12:14.372567 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:14.372654 [debug] [MainThread]: On master: COMMIT
[0m09:12:14.372821 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:12:14.372915 [debug] [MainThread]: On master: Close
[0m09:12:14.373947 [debug] [Thread-1 (]: Began running node model.sumup.stg_device
[0m09:12:14.374137 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_staging.stg_device ....................... [RUN]
[0m09:12:14.374297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.stg_device)
[0m09:12:14.374428 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_device
[0m09:12:14.377516 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_device"
[0m09:12:14.377785 [debug] [Thread-1 (]: Began executing node model.sumup.stg_device
[0m09:12:14.391441 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_device"
[0m09:12:14.391848 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:12:14.391981 [debug] [Thread-1 (]: On model.sumup.stg_device: BEGIN
[0m09:12:14.392093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:14.397229 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m09:12:14.397365 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:12:14.397490 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */

  create view "postgres"."analytics_staging"."stg_device__dbt_tmp"
    
    
  as (
    

SELECT
    -- Primary Key
    id AS device_id,

    -- Foreign Key to stores (assuming this links the device to a specific store)
    store_id,

    -- Descriptive Attributes
    device_type
    
    -- Other fields, if any, standardized here
    -- e.g., CAST(status AS VARCHAR) AS device_status

    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-19 07:12:13.921737+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM"postgres"."analytics"."device"
  );
[0m09:12:14.398444 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "device_type" does not exist
LINE 17:     device_type
             ^

[0m09:12:14.398566 [debug] [Thread-1 (]: On model.sumup.stg_device: ROLLBACK
[0m09:12:14.398795 [debug] [Thread-1 (]: On model.sumup.stg_device: Close
[0m09:12:14.404010 [debug] [Thread-1 (]: Database Error in model stg_device (models/staging/stg_device.sql)
  column "device_type" does not exist
  LINE 17:     device_type
               ^
  compiled code at target/run/sumup/models/staging/stg_device.sql
[0m09:12:14.404817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1d04272-908a-406d-8afa-3c50d202ba97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b37bf50>]}
[0m09:12:14.405086 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_staging.stg_device .............. [[31mERROR[0m in 0.03s]
[0m09:12:14.405315 [debug] [Thread-1 (]: Finished running node model.sumup.stg_device
[0m09:12:14.405517 [debug] [Thread-7 (]: Marking all children of 'model.sumup.stg_device' to be skipped because of status 'error'.  Reason: Database Error in model stg_device (models/staging/stg_device.sql)
  column "device_type" does not exist
  LINE 17:     device_type
               ^
  compiled code at target/run/sumup/models/staging/stg_device.sql.
[0m09:12:14.406253 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:14.406372 [debug] [MainThread]: On master: BEGIN
[0m09:12:14.406470 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:12:14.411798 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:12:14.411927 [debug] [MainThread]: On master: COMMIT
[0m09:12:14.412035 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:14.412170 [debug] [MainThread]: On master: COMMIT
[0m09:12:14.412353 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:12:14.412453 [debug] [MainThread]: On master: Close
[0m09:12:14.412601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:12:14.412701 [debug] [MainThread]: Connection 'model.sumup.stg_device' was properly closed.
[0m09:12:14.412790 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m09:12:14.412873 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m09:12:14.412986 [info ] [MainThread]: 
[0m09:12:14.413108 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m09:12:14.413376 [debug] [MainThread]: Command end result
[0m09:12:14.422641 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:12:14.423343 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:12:14.425565 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:12:14.425676 [info ] [MainThread]: 
[0m09:12:14.425814 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:12:14.425925 [info ] [MainThread]: 
[0m09:12:14.426065 [error] [MainThread]: [31mFailure in model stg_device (models/staging/stg_device.sql)[0m
[0m09:12:14.426199 [error] [MainThread]:   Database Error in model stg_device (models/staging/stg_device.sql)
  column "device_type" does not exist
  LINE 17:     device_type
               ^
  compiled code at target/run/sumup/models/staging/stg_device.sql
[0m09:12:14.426299 [info ] [MainThread]: 
[0m09:12:14.426417 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/staging/stg_device.sql
[0m09:12:14.426516 [info ] [MainThread]: 
[0m09:12:14.426629 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m09:12:14.428020 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5238845, "process_in_blocks": "0", "process_kernel_time": 0.134276, "process_mem_max_rss": "129384448", "process_out_blocks": "0", "process_user_time": 0.863813}
[0m09:12:14.428185 [debug] [MainThread]: Command `dbt run` failed at 09:12:14.428154 after 0.52 seconds
[0m09:12:14.428319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b72efc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a991a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a992cb0>]}
[0m09:12:14.428453 [debug] [MainThread]: Flushing usage events
[0m09:12:15.123771 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:12:48.863640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f34050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d7b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d7bc50>]}


============================== 09:12:48.867479 | 3a1311b9-6f89-47e7-9344-c279880636e7 ==============================
[0m09:12:48.867479 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:12:48.867772 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'introspect': 'True', 'empty': 'False', 'version_check': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run --select +stg_device', 'no_print': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'fail_fast': 'False', 'printer_width': '80', 'quiet': 'False'}
[0m09:12:48.952882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a1311b9-6f89-47e7-9344-c279880636e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106097950>]}
[0m09:12:48.973865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a1311b9-6f89-47e7-9344-c279880636e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c0acf0>]}
[0m09:12:48.974323 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:12:49.031136 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:12:49.090395 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:12:49.090683 [debug] [MainThread]: Partial parsing: updated file: sumup://models/staging/stg_device.sql
[0m09:12:49.180048 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m09:12:49.184876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a1311b9-6f89-47e7-9344-c279880636e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ca6d50>]}
[0m09:12:49.218488 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:12:49.219676 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:12:49.230792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a1311b9-6f89-47e7-9344-c279880636e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de66c0>]}
[0m09:12:49.231060 [info ] [MainThread]: Found 3 seeds, 5 models, 1 source, 447 macros
[0m09:12:49.231203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a1311b9-6f89-47e7-9344-c279880636e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108045a90>]}
[0m09:12:49.231873 [info ] [MainThread]: 
[0m09:12:49.232013 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:12:49.232121 [info ] [MainThread]: 
[0m09:12:49.232320 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:12:49.232659 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:12:49.285369 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:12:49.285564 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:12:49.285677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:49.313187 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.027 seconds
[0m09:12:49.313874 [debug] [ThreadPool]: On list_postgres: Close
[0m09:12:49.315744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics)
[0m09:12:49.318126 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:12:49.318303 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m09:12:49.318415 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m09:12:49.318589 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m09:12:49.319411 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:12:49.319538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:12:49.320103 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:12:49.320410 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m09:12:49.320621 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m09:12:49.320730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:49.320833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:49.326389 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m09:12:49.326533 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:12:49.326656 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m09:12:49.326790 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:12:49.326924 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m09:12:49.327031 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:12:49.327179 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:12:49.327334 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m09:12:49.327476 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m09:12:49.331799 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m09:12:49.331931 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m09:12:49.332030 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m09:12:49.332563 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m09:12:49.332962 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m09:12:49.333351 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m09:12:49.333558 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m09:12:49.333666 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m09:12:49.333767 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m09:12:49.336075 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:49.336188 [debug] [MainThread]: On master: BEGIN
[0m09:12:49.336278 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:12:49.341655 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:12:49.341758 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:49.341884 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:12:49.347852 [debug] [MainThread]: SQL status: SELECT 2 in 0.006 seconds
[0m09:12:49.348402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a1311b9-6f89-47e7-9344-c279880636e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d6f70>]}
[0m09:12:49.348559 [debug] [MainThread]: On master: ROLLBACK
[0m09:12:49.348765 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:49.348858 [debug] [MainThread]: On master: BEGIN
[0m09:12:49.349150 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:12:49.349246 [debug] [MainThread]: On master: COMMIT
[0m09:12:49.349338 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:49.349424 [debug] [MainThread]: On master: COMMIT
[0m09:12:49.349592 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:12:49.349686 [debug] [MainThread]: On master: Close
[0m09:12:49.350886 [debug] [Thread-1 (]: Began running node model.sumup.stg_device
[0m09:12:49.351075 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_staging.stg_device ....................... [RUN]
[0m09:12:49.351242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.stg_device)
[0m09:12:49.351376 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_device
[0m09:12:49.354519 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_device"
[0m09:12:49.354779 [debug] [Thread-1 (]: Began executing node model.sumup.stg_device
[0m09:12:49.369150 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_device"
[0m09:12:49.369555 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:12:49.369689 [debug] [Thread-1 (]: On model.sumup.stg_device: BEGIN
[0m09:12:49.369808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:49.375191 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m09:12:49.375326 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:12:49.375450 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */

  create view "postgres"."analytics_staging"."stg_device__dbt_tmp"
    
    
  as (
    

SELECT
    -- Primary Key
    id AS device_id,

    -- Foreign Key to stores (assuming this links the device to a specific store)
    store_id,

    -- Descriptive Attributes
    device_type
    
    -- Other fields, if any, standardized here
    -- e.g., CAST(status AS VARCHAR) AS device_status

    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-19 07:12:48.849347+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."device"
  );
[0m09:12:49.376049 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "device_type" does not exist
LINE 17:     device_type
             ^

[0m09:12:49.376169 [debug] [Thread-1 (]: On model.sumup.stg_device: ROLLBACK
[0m09:12:49.376439 [debug] [Thread-1 (]: On model.sumup.stg_device: Close
[0m09:12:49.382244 [debug] [Thread-1 (]: Database Error in model stg_device (models/staging/stg_device.sql)
  column "device_type" does not exist
  LINE 17:     device_type
               ^
  compiled code at target/run/sumup/models/staging/stg_device.sql
[0m09:12:49.383066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a1311b9-6f89-47e7-9344-c279880636e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6bf50>]}
[0m09:12:49.383332 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_staging.stg_device .............. [[31mERROR[0m in 0.03s]
[0m09:12:49.383565 [debug] [Thread-1 (]: Finished running node model.sumup.stg_device
[0m09:12:49.383766 [debug] [Thread-7 (]: Marking all children of 'model.sumup.stg_device' to be skipped because of status 'error'.  Reason: Database Error in model stg_device (models/staging/stg_device.sql)
  column "device_type" does not exist
  LINE 17:     device_type
               ^
  compiled code at target/run/sumup/models/staging/stg_device.sql.
[0m09:12:49.384499 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:49.384618 [debug] [MainThread]: On master: BEGIN
[0m09:12:49.384719 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:12:49.390110 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:12:49.390245 [debug] [MainThread]: On master: COMMIT
[0m09:12:49.390355 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:49.390456 [debug] [MainThread]: On master: COMMIT
[0m09:12:49.390625 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:12:49.390727 [debug] [MainThread]: On master: Close
[0m09:12:49.390864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:12:49.390960 [debug] [MainThread]: Connection 'model.sumup.stg_device' was properly closed.
[0m09:12:49.391043 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m09:12:49.391124 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m09:12:49.391223 [info ] [MainThread]: 
[0m09:12:49.391336 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m09:12:49.391627 [debug] [MainThread]: Command end result
[0m09:12:49.403686 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:12:49.404437 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:12:49.406679 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:12:49.406793 [info ] [MainThread]: 
[0m09:12:49.406930 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:12:49.407043 [info ] [MainThread]: 
[0m09:12:49.407186 [error] [MainThread]: [31mFailure in model stg_device (models/staging/stg_device.sql)[0m
[0m09:12:49.407322 [error] [MainThread]:   Database Error in model stg_device (models/staging/stg_device.sql)
  column "device_type" does not exist
  LINE 17:     device_type
               ^
  compiled code at target/run/sumup/models/staging/stg_device.sql
[0m09:12:49.407422 [info ] [MainThread]: 
[0m09:12:49.407543 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/staging/stg_device.sql
[0m09:12:49.407640 [info ] [MainThread]: 
[0m09:12:49.407754 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m09:12:49.409729 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5816225, "process_in_blocks": "0", "process_kernel_time": 0.150012, "process_mem_max_rss": "128303104", "process_out_blocks": "0", "process_user_time": 0.86923}
[0m09:12:49.409899 [debug] [MainThread]: Command `dbt run` failed at 09:12:49.409866 after 0.58 seconds
[0m09:12:49.410039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc6fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b01a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b01c70>]}
[0m09:12:49.410163 [debug] [MainThread]: Flushing usage events
[0m09:12:50.100505 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:13:12.101670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042d8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10511b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10511bc50>]}


============================== 09:13:12.104980 | 8c3621e7-4816-4369-baff-f89d6a8cb3cf ==============================
[0m09:13:12.104980 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:13:12.105267 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'no_print': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'printer_width': '80', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select +stg_device', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'use_colors': 'True', 'empty': 'False', 'warn_error': 'None', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'target_path': 'None', 'write_json': 'True', 'quiet': 'False'}
[0m09:13:12.187395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c3621e7-4816-4369-baff-f89d6a8cb3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10443b950>]}
[0m09:13:12.209071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c3621e7-4816-4369-baff-f89d6a8cb3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104faecf0>]}
[0m09:13:12.209730 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:13:12.262518 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:13:12.323952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:13:12.324267 [debug] [MainThread]: Partial parsing: updated file: sumup://models/staging/stg_device.sql
[0m09:13:12.420489 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.marts
[0m09:13:12.425853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c3621e7-4816-4369-baff-f89d6a8cb3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10604ed50>]}
[0m09:13:12.459676 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:13:12.461055 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:13:12.474360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c3621e7-4816-4369-baff-f89d6a8cb3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10518a6c0>]}
[0m09:13:12.474618 [info ] [MainThread]: Found 3 seeds, 5 models, 1 source, 447 macros
[0m09:13:12.474763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c3621e7-4816-4369-baff-f89d6a8cb3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e9a90>]}
[0m09:13:12.475433 [info ] [MainThread]: 
[0m09:13:12.475581 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:13:12.475685 [info ] [MainThread]: 
[0m09:13:12.475978 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:13:12.476400 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:13:12.546601 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:13:12.546790 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:13:12.546901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:13:12.565224 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.018 seconds
[0m09:13:12.565826 [debug] [ThreadPool]: On list_postgres: Close
[0m09:13:12.567650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics)
[0m09:13:12.569800 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:13:12.569998 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m09:13:12.570135 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m09:13:12.570829 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:13:12.571201 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m09:13:12.571346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:13:12.571492 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m09:13:12.572122 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:13:12.572289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:13:12.572413 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m09:13:12.572573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:13:12.577132 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m09:13:12.577268 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m09:13:12.577380 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:13:12.577486 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m09:13:12.577636 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:13:12.577746 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m09:13:12.577860 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:13:12.577966 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m09:13:12.578107 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:13:12.585686 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m09:13:12.585792 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m09:13:12.586309 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m09:13:12.586728 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m09:13:12.586828 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.009 seconds
[0m09:13:12.587240 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m09:13:12.587348 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m09:13:12.587467 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m09:13:12.587596 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m09:13:12.589940 [debug] [MainThread]: Using postgres connection "master"
[0m09:13:12.590043 [debug] [MainThread]: On master: BEGIN
[0m09:13:12.590129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:13:12.595237 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:13:12.595364 [debug] [MainThread]: Using postgres connection "master"
[0m09:13:12.595534 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:13:12.601298 [debug] [MainThread]: SQL status: SELECT 2 in 0.006 seconds
[0m09:13:12.601952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c3621e7-4816-4369-baff-f89d6a8cb3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10657f110>]}
[0m09:13:12.602127 [debug] [MainThread]: On master: ROLLBACK
[0m09:13:12.602353 [debug] [MainThread]: Using postgres connection "master"
[0m09:13:12.602454 [debug] [MainThread]: On master: BEGIN
[0m09:13:12.602741 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:13:12.602861 [debug] [MainThread]: On master: COMMIT
[0m09:13:12.602961 [debug] [MainThread]: Using postgres connection "master"
[0m09:13:12.603053 [debug] [MainThread]: On master: COMMIT
[0m09:13:12.603226 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:13:12.603325 [debug] [MainThread]: On master: Close
[0m09:13:12.604497 [debug] [Thread-1 (]: Began running node model.sumup.stg_device
[0m09:13:12.604704 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_staging.stg_device ....................... [RUN]
[0m09:13:12.604884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.stg_device)
[0m09:13:12.605018 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_device
[0m09:13:12.608453 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_device"
[0m09:13:12.608752 [debug] [Thread-1 (]: Began executing node model.sumup.stg_device
[0m09:13:12.622597 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_device"
[0m09:13:12.622980 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:13:12.623115 [debug] [Thread-1 (]: On model.sumup.stg_device: BEGIN
[0m09:13:12.623241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:13:12.628133 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m09:13:12.628278 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:13:12.628423 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */

  create view "postgres"."analytics_staging"."stg_device__dbt_tmp"
    
    
  as (
    

SELECT
    -- Primary Key
    id AS device_id,

    -- Foreign Key to stores (assuming this links the device to a specific store)
    store_id,

    -- Descriptive Attributes
    type as device_type
    
    -- Other fields, if any, standardized here
    -- e.g., CAST(status AS VARCHAR) AS device_status

    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-19 07:13:12.088958+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."device"
  );
[0m09:13:12.632134 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:13:12.634570 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:13:12.634715 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */
alter table "postgres"."analytics_staging"."stg_device__dbt_tmp" rename to "stg_device"
[0m09:13:12.635197 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:13:12.640390 [debug] [Thread-1 (]: On model.sumup.stg_device: COMMIT
[0m09:13:12.640542 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:13:12.640663 [debug] [Thread-1 (]: On model.sumup.stg_device: COMMIT
[0m09:13:12.641418 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:13:12.643757 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_device__dbt_backup"
[0m09:13:12.645576 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:13:12.645726 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */
drop view if exists "postgres"."analytics_staging"."stg_device__dbt_backup" cascade
[0m09:13:12.646089 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:13:12.647094 [debug] [Thread-1 (]: On model.sumup.stg_device: Close
[0m09:13:12.647981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c3621e7-4816-4369-baff-f89d6a8cb3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106213ad0>]}
[0m09:13:12.648229 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analytics_staging.stg_device .................. [[32mCREATE VIEW[0m in 0.04s]
[0m09:13:12.648461 [debug] [Thread-1 (]: Finished running node model.sumup.stg_device
[0m09:13:12.648962 [debug] [MainThread]: Using postgres connection "master"
[0m09:13:12.649086 [debug] [MainThread]: On master: BEGIN
[0m09:13:12.649179 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:13:12.654317 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:13:12.654432 [debug] [MainThread]: On master: COMMIT
[0m09:13:12.654544 [debug] [MainThread]: Using postgres connection "master"
[0m09:13:12.654775 [debug] [MainThread]: On master: COMMIT
[0m09:13:12.654956 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:13:12.655069 [debug] [MainThread]: On master: Close
[0m09:13:12.655213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:13:12.655313 [debug] [MainThread]: Connection 'model.sumup.stg_device' was properly closed.
[0m09:13:12.655396 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m09:13:12.655478 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m09:13:12.655587 [info ] [MainThread]: 
[0m09:13:12.655701 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m09:13:12.655947 [debug] [MainThread]: Command end result
[0m09:13:12.664973 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:13:12.665880 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:13:12.668474 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:13:12.668598 [info ] [MainThread]: 
[0m09:13:12.668749 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:13:12.668863 [info ] [MainThread]: 
[0m09:13:12.668988 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m09:13:12.670548 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6002729, "process_in_blocks": "0", "process_kernel_time": 0.158518, "process_mem_max_rss": "128139264", "process_out_blocks": "0", "process_user_time": 0.908986}
[0m09:13:12.670768 [debug] [MainThread]: Command `dbt run` succeeded at 09:13:12.670726 after 0.60 seconds
[0m09:13:12.670929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063771d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ebb4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb82d0>]}
[0m09:13:12.671075 [debug] [MainThread]: Flushing usage events
[0m09:13:13.392027 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:33:03.744963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106194050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107437c50>]}


============================== 17:33:03.746884 | 154c5782-3abd-433d-9c89-53086cc8817f ==============================
[0m17:33:03.746884 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:33:03.747139 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_format': 'default', 'version_check': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'no_print': 'None', 'introspect': 'True', 'quiet': 'False', 'static_parser': 'True', 'use_colors': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'invocation_command': 'dbt run -m customer_store_ranking', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'write_json': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs'}
[0m17:33:03.747316 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m17:33:03.747454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '154c5782-3abd-433d-9c89-53086cc8817f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10731f6f0>]}
[0m17:33:03.858778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '154c5782-3abd-433d-9c89-53086cc8817f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072cacf0>]}
[0m17:33:03.879592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '154c5782-3abd-433d-9c89-53086cc8817f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d7d50>]}
[0m17:33:03.879967 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:33:03.919484 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:33:03.975362 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 6 files added, 0 files changed.
[0m17:33:03.975596 [debug] [MainThread]: Partial parsing: added file: sumup://models/marts/core/store_ranking.sql
[0m17:33:03.975723 [debug] [MainThread]: Partial parsing: added file: sumup://models/intermediate/core/int_analytics_store.sql
[0m17:33:03.975835 [debug] [MainThread]: Partial parsing: added file: sumup://models/marts/core/customer_store_ranking.sql
[0m17:33:03.975937 [debug] [MainThread]: Partial parsing: added file: sumup://models/marts/core/device_adoption.sql
[0m17:33:03.976038 [debug] [MainThread]: Partial parsing: added file: sumup://models/intermediate/core/int_transaction.sql
[0m17:33:03.976137 [debug] [MainThread]: Partial parsing: added file: sumup://models/marts/core/products_ranking.sql
[0m17:33:03.976263 [debug] [MainThread]: Partial parsing: deleted file: sumup://models/core/int_transaction.sql
[0m17:33:03.976362 [debug] [MainThread]: Partial parsing: deleted file: sumup://models/core/int_analytics_store.sql
[0m17:33:04.046919 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.sumup.customer_store_ranking' (models/marts/core/customer_store_ranking.sql) depends on a node named 'stg_store' which was not found
[0m17:33:04.047231 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:33:04.048483 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.32945362, "process_in_blocks": "0", "process_kernel_time": 0.088618, "process_mem_max_rss": "119095296", "process_out_blocks": "0", "process_user_time": 0.697178}
[0m17:33:04.048665 [debug] [MainThread]: Command `dbt run` failed at 17:33:04.048627 after 0.33 seconds
[0m17:33:04.048817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108411310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108410e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107327e70>]}
[0m17:33:04.048952 [debug] [MainThread]: Flushing usage events
[0m17:33:14.509934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10649c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072df9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072dfc50>]}


============================== 17:33:14.511678 | 4ef46a87-02ab-4bc0-98b0-86d757c9dd69 ==============================
[0m17:33:14.511678 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:33:14.511931 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run -m +customer_store_ranking', 'partial_parse': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'fail_fast': 'False', 'warn_error': 'None', 'write_json': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'use_colors': 'True', 'introspect': 'True', 'empty': 'False', 'quiet': 'False', 'version_check': 'True', 'no_print': 'None'}
[0m17:33:14.512110 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m17:33:14.512254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4ef46a87-02ab-4bc0-98b0-86d757c9dd69', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c76f0>]}
[0m17:33:14.575496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ef46a87-02ab-4bc0-98b0-86d757c9dd69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107172cf0>]}
[0m17:33:14.596505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ef46a87-02ab-4bc0-98b0-86d757c9dd69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10717fd50>]}
[0m17:33:14.596893 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:33:14.631850 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:33:14.675645 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 6 files added, 0 files changed.
[0m17:33:14.675896 [debug] [MainThread]: Partial parsing: added file: sumup://models/marts/core/store_ranking.sql
[0m17:33:14.676023 [debug] [MainThread]: Partial parsing: added file: sumup://models/intermediate/core/int_analytics_store.sql
[0m17:33:14.676132 [debug] [MainThread]: Partial parsing: added file: sumup://models/intermediate/core/int_transaction.sql
[0m17:33:14.676238 [debug] [MainThread]: Partial parsing: added file: sumup://models/marts/core/products_ranking.sql
[0m17:33:14.676339 [debug] [MainThread]: Partial parsing: added file: sumup://models/marts/core/device_adoption.sql
[0m17:33:14.676438 [debug] [MainThread]: Partial parsing: added file: sumup://models/marts/core/customer_store_ranking.sql
[0m17:33:14.676567 [debug] [MainThread]: Partial parsing: deleted file: sumup://models/core/int_transaction.sql
[0m17:33:14.676664 [debug] [MainThread]: Partial parsing: deleted file: sumup://models/core/int_analytics_store.sql
[0m17:33:14.746888 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.sumup.customer_store_ranking' (models/marts/core/customer_store_ranking.sql) depends on a node named 'stg_store' which was not found
[0m17:33:14.747214 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:33:14.748524 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.26330918, "process_in_blocks": "0", "process_kernel_time": 0.081966, "process_mem_max_rss": "119078912", "process_out_blocks": "0", "process_user_time": 0.699038}
[0m17:33:14.748711 [debug] [MainThread]: Command `dbt run` failed at 17:33:14.748673 after 0.26 seconds
[0m17:33:14.748869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108461310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108460e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071cfe70>]}
[0m17:33:14.749027 [debug] [MainThread]: Flushing usage events
[0m17:33:24.758286 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:33:27.999898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ac050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ef9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071efc50>]}


============================== 17:33:28.001614 | 5a1cc73e-b28d-4ae1-a51a-c6fa8e42f055 ==============================
[0m17:33:28.001614 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:33:28.001864 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'static_parser': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'partial_parse': 'True', 'quiet': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run -m +customer_store_ranking', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'warn_error': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'write_json': 'True', 'debug': 'False'}
[0m17:33:28.002040 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m17:33:28.002178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5a1cc73e-b28d-4ae1-a51a-c6fa8e42f055', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d76f0>]}
[0m17:33:28.065571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a1cc73e-b28d-4ae1-a51a-c6fa8e42f055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107082cf0>]}
[0m17:33:28.086245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a1cc73e-b28d-4ae1-a51a-c6fa8e42f055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10708bd50>]}
[0m17:33:28.086574 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:33:28.120424 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:33:28.164321 [debug] [MainThread]: Partial parsing enabled: 7 files deleted, 8 files added, 0 files changed.
[0m17:33:28.164540 [debug] [MainThread]: Partial parsing: added file: sumup://models/marts/core/store_ranking.sql
[0m17:33:28.164676 [debug] [MainThread]: Partial parsing: added file: sumup://models/staging/stg_store.yml
[0m17:33:28.164787 [debug] [MainThread]: Partial parsing: added file: sumup://models/marts/core/products_ranking.sql
[0m17:33:28.164889 [debug] [MainThread]: Partial parsing: added file: sumup://models/marts/core/customer_store_ranking.sql
[0m17:33:28.164987 [debug] [MainThread]: Partial parsing: added file: sumup://models/marts/core/device_adoption.sql
[0m17:33:28.165084 [debug] [MainThread]: Partial parsing: added file: sumup://models/intermediate/core/int_transaction.sql
[0m17:33:28.165180 [debug] [MainThread]: Partial parsing: added file: sumup://models/intermediate/core/int_analytics_store.sql
[0m17:33:28.165275 [debug] [MainThread]: Partial parsing: added file: sumup://models/staging/stg_store.sql
[0m17:33:28.165395 [debug] [MainThread]: Partial parsing: deleted file: sumup://models/core/int_analytics_store.sql
[0m17:33:28.165488 [debug] [MainThread]: Partial parsing: deleted file: sumup://models/staging/stg_stores.sql
[0m17:33:28.165576 [debug] [MainThread]: Partial parsing: deleted file: sumup://models/core/int_transaction.sql
[0m17:33:28.258901 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m17:33:28.260716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a1cc73e-b28d-4ae1-a51a-c6fa8e42f055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10819fb60>]}
[0m17:33:28.289325 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m17:33:28.290460 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m17:33:28.323599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a1cc73e-b28d-4ae1-a51a-c6fa8e42f055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079191d0>]}
[0m17:33:28.323837 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m17:33:28.323990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a1cc73e-b28d-4ae1-a51a-c6fa8e42f055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072602c0>]}
[0m17:33:28.324707 [info ] [MainThread]: 
[0m17:33:28.324852 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:33:28.324961 [info ] [MainThread]: 
[0m17:33:28.325147 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:33:28.326665 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:33:28.330559 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:33:28.360891 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:33:28.361099 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:33:28.361241 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:33:28.361374 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:33:28.361498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:28.361610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:28.538421 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.177 seconds
[0m17:33:28.538705 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.177 seconds
[0m17:33:28.540239 [debug] [ThreadPool]: On list_postgres: Close
[0m17:33:28.540764 [debug] [ThreadPool]: On list_postgres: Close
[0m17:33:28.541816 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics)
[0m17:33:28.544590 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m17:33:28.544800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m17:33:28.544957 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m17:33:28.545143 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m17:33:28.545873 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m17:33:28.546003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:28.546961 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m17:33:28.547096 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m17:33:28.547276 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m17:33:28.547407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:28.547540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:28.586940 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m17:33:28.587165 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m17:33:28.587347 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m17:33:28.587600 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m17:33:28.587732 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m17:33:28.587860 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m17:33:28.587998 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m17:33:28.588178 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m17:33:28.588446 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m17:33:28.603129 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.014 seconds
[0m17:33:28.603312 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.015 seconds
[0m17:33:28.603428 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.015 seconds
[0m17:33:28.604306 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m17:33:28.605040 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m17:33:28.605457 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m17:33:28.605776 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m17:33:28.605893 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m17:33:28.605998 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m17:33:28.608800 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:28.608915 [debug] [MainThread]: On master: BEGIN
[0m17:33:28.609014 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:33:28.614234 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m17:33:28.614344 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:28.614488 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:33:28.627944 [debug] [MainThread]: SQL status: SELECT 3 in 0.013 seconds
[0m17:33:28.628890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a1cc73e-b28d-4ae1-a51a-c6fa8e42f055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108492ed0>]}
[0m17:33:28.629084 [debug] [MainThread]: On master: ROLLBACK
[0m17:33:28.629353 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:28.629463 [debug] [MainThread]: On master: BEGIN
[0m17:33:28.629798 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:33:28.629909 [debug] [MainThread]: On master: COMMIT
[0m17:33:28.630014 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:28.630116 [debug] [MainThread]: On master: COMMIT
[0m17:33:28.630296 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:33:28.630405 [debug] [MainThread]: On master: Close
[0m17:33:28.631889 [debug] [Thread-2 (]: Began running node model.sumup.stg_store
[0m17:33:28.632052 [debug] [Thread-3 (]: Began running node model.sumup.stg_transaction
[0m17:33:28.632191 [debug] [Thread-1 (]: Began running node model.sumup.stg_device
[0m17:33:28.632478 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics_staging.stg_store ........................ [RUN]
[0m17:33:28.632863 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics_staging.stg_transaction .................. [RUN]
[0m17:33:28.633080 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_staging.stg_device ....................... [RUN]
[0m17:33:28.633280 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.stg_store)
[0m17:33:28.633435 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.stg_transaction)
[0m17:33:28.633612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.stg_device)
[0m17:33:28.633860 [debug] [Thread-2 (]: Began compiling node model.sumup.stg_store
[0m17:33:28.634092 [debug] [Thread-3 (]: Began compiling node model.sumup.stg_transaction
[0m17:33:28.634316 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_device
[0m17:33:28.640337 [debug] [Thread-2 (]: Writing injected SQL for node "model.sumup.stg_store"
[0m17:33:28.641924 [debug] [Thread-3 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m17:33:28.643911 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_device"
[0m17:33:28.644516 [debug] [Thread-2 (]: Began executing node model.sumup.stg_store
[0m17:33:28.663578 [debug] [Thread-3 (]: Began executing node model.sumup.stg_transaction
[0m17:33:28.663899 [debug] [Thread-2 (]: Writing runtime sql for node "model.sumup.stg_store"
[0m17:33:28.665740 [debug] [Thread-3 (]: Writing runtime sql for node "model.sumup.stg_transaction"
[0m17:33:28.666036 [debug] [Thread-1 (]: Began executing node model.sumup.stg_device
[0m17:33:28.667535 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_device"
[0m17:33:28.667833 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m17:33:28.668012 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m17:33:28.668165 [debug] [Thread-2 (]: On model.sumup.stg_store: BEGIN
[0m17:33:28.668334 [debug] [Thread-3 (]: On model.sumup.stg_transaction: BEGIN
[0m17:33:28.668492 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:33:28.668655 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m17:33:28.668789 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:33:28.668998 [debug] [Thread-1 (]: On model.sumup.stg_device: BEGIN
[0m17:33:28.669209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:28.674609 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m17:33:28.674777 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m17:33:28.674924 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m17:33:28.675081 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m17:33:28.675260 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  create view "postgres"."analytics_staging"."stg_transaction__dbt_tmp"
    
    
  as (
    SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) / 100 AS amount_eur,
    LOWER(status) AS status,

    -- Card Information 
    REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '') AS card_number,
    CAST(cvv AS VARCHAR) AS cvv,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  );
[0m17:33:28.675456 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:33:28.675620 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */

  create view "postgres"."analytics_staging"."stg_store__dbt_tmp"
    
    
  as (
    

SELECT
    -- Primary Key: Rename to be explicit
    id AS store_id,

    -- Descriptive Attributes: Rename 'typology' for clarity
    typology AS store_typology,
    country,
    city
    
    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-20 15:33:27.993069+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."store"
  );
[0m17:33:28.675806 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m17:33:28.675994 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */

  create view "postgres"."analytics_staging"."stg_device__dbt_tmp"
    
    
  as (
    

SELECT
    -- Primary Key
    id AS device_id,

    -- Foreign Key to stores (assuming this links the device to a specific store)
    store_id,

    -- Descriptive Attributes
    type as device_type
    
    -- Other fields, if any, standardized here
    -- e.g., CAST(status AS VARCHAR) AS device_status

    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-20 15:33:27.993069+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."device"
  );
[0m17:33:28.689213 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m17:33:28.689377 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m17:33:28.692963 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m17:33:28.693152 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m17:33:28.694415 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m17:33:28.694579 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */
alter table "postgres"."analytics_staging"."stg_device" rename to "stg_device__dbt_backup"
[0m17:33:28.696012 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m17:33:28.696175 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */
alter table "postgres"."analytics_staging"."stg_store__dbt_tmp" rename to "stg_store"
[0m17:33:28.696361 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
alter table "postgres"."analytics_staging"."stg_transaction" rename to "stg_transaction__dbt_backup"
[0m17:33:28.696921 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:33:28.697083 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:33:28.698277 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m17:33:28.698432 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:33:28.705065 [debug] [Thread-2 (]: On model.sumup.stg_store: COMMIT
[0m17:33:28.705222 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */
alter table "postgres"."analytics_staging"."stg_device__dbt_tmp" rename to "stg_device"
[0m17:33:28.706560 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m17:33:28.706716 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m17:33:28.706882 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
alter table "postgres"."analytics_staging"."stg_transaction__dbt_tmp" rename to "stg_transaction"
[0m17:33:28.707028 [debug] [Thread-2 (]: On model.sumup.stg_store: COMMIT
[0m17:33:28.707285 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:33:28.708750 [debug] [Thread-1 (]: On model.sumup.stg_device: COMMIT
[0m17:33:28.708899 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:33:28.709029 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m17:33:28.709158 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m17:33:28.709754 [debug] [Thread-3 (]: On model.sumup.stg_transaction: COMMIT
[0m17:33:28.712184 [debug] [Thread-2 (]: Applying DROP to: "postgres"."analytics_staging"."stg_store__dbt_backup"
[0m17:33:28.712329 [debug] [Thread-1 (]: On model.sumup.stg_device: COMMIT
[0m17:33:28.712471 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m17:33:28.714408 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m17:33:28.714576 [debug] [Thread-3 (]: On model.sumup.stg_transaction: COMMIT
[0m17:33:28.714728 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */
drop view if exists "postgres"."analytics_staging"."stg_store__dbt_backup" cascade
[0m17:33:28.714968 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m17:33:28.715913 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_device__dbt_backup"
[0m17:33:28.716051 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:33:28.716318 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m17:33:28.716444 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m17:33:28.717403 [debug] [Thread-2 (]: On model.sumup.stg_store: Close
[0m17:33:28.717552 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */
drop view if exists "postgres"."analytics_staging"."stg_device__dbt_backup" cascade
[0m17:33:28.718345 [debug] [Thread-3 (]: Applying DROP to: "postgres"."analytics_staging"."stg_transaction__dbt_backup"
[0m17:33:28.719135 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m17:33:28.719290 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
drop view if exists "postgres"."analytics_staging"."stg_transaction__dbt_backup" cascade
[0m17:33:28.719610 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a1cc73e-b28d-4ae1-a51a-c6fa8e42f055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10846b330>]}
[0m17:33:28.719874 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics_staging.stg_store ................... [[32mCREATE VIEW[0m in 0.09s]
[0m17:33:28.720103 [debug] [Thread-2 (]: Finished running node model.sumup.stg_store
[0m17:33:28.723123 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m17:33:28.723259 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m17:33:28.723749 [debug] [Thread-1 (]: On model.sumup.stg_device: Close
[0m17:33:28.724201 [debug] [Thread-3 (]: On model.sumup.stg_transaction: Close
[0m17:33:28.724408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a1cc73e-b28d-4ae1-a51a-c6fa8e42f055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d7570>]}
[0m17:33:28.724586 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a1cc73e-b28d-4ae1-a51a-c6fa8e42f055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086d9ac0>]}
[0m17:33:28.724818 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_staging.stg_device .................. [[32mCREATE VIEW[0m in 0.09s]
[0m17:33:28.725248 [debug] [Thread-1 (]: Finished running node model.sumup.stg_device
[0m17:33:28.725067 [info ] [Thread-3 (]: 3 of 4 OK created sql view model analytics_staging.stg_transaction ............. [[32mCREATE VIEW[0m in 0.09s]
[0m17:33:28.725531 [debug] [Thread-3 (]: Finished running node model.sumup.stg_transaction
[0m17:33:28.725862 [debug] [Thread-4 (]: Began running node model.sumup.customer_store_ranking
[0m17:33:28.726064 [info ] [Thread-4 (]: 4 of 4 START sql view model analytics_analytics.customer_store_ranking ......... [RUN]
[0m17:33:28.726267 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.sumup.customer_store_ranking'
[0m17:33:28.726402 [debug] [Thread-4 (]: Began compiling node model.sumup.customer_store_ranking
[0m17:33:28.727678 [debug] [Thread-4 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m17:33:28.728194 [debug] [Thread-4 (]: Began executing node model.sumup.customer_store_ranking
[0m17:33:28.733057 [debug] [Thread-4 (]: Writing runtime sql for node "model.sumup.customer_store_ranking"
[0m17:33:28.733626 [debug] [Thread-4 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m17:33:28.733769 [debug] [Thread-4 (]: On model.sumup.customer_store_ranking: BEGIN
[0m17:33:28.733897 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:33:28.739233 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m17:33:28.739369 [debug] [Thread-4 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m17:33:28.739501 [debug] [Thread-4 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  create view "postgres"."analytics_analytics"."customer_store_ranking__dbt_tmp"
    
    
  as (
    select t.transaction_id,
       d.store_id,
       s.store_name,
       t.amount_eur,
       t.happened_at_utc
from "postgres"."analytics_staging"."stg_transaction" t
left join "postgres"."analytics_staging"."stg_device" d using (device_id)
left join "postgres"."analytics_staging"."stg_store" s using (store_id)
  );
[0m17:33:28.741076 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column s.store_name does not exist
LINE 9:        s.store_name,
               ^

[0m17:33:28.741220 [debug] [Thread-4 (]: On model.sumup.customer_store_ranking: ROLLBACK
[0m17:33:28.741498 [debug] [Thread-4 (]: On model.sumup.customer_store_ranking: Close
[0m17:33:28.746571 [debug] [Thread-4 (]: Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  column s.store_name does not exist
  LINE 9:        s.store_name,
                 ^
  compiled code at target/run/sumup/models/marts/core/customer_store_ranking.sql
[0m17:33:28.746804 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a1cc73e-b28d-4ae1-a51a-c6fa8e42f055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c86b620>]}
[0m17:33:28.747090 [error] [Thread-4 (]: 4 of 4 ERROR creating sql view model analytics_analytics.customer_store_ranking  [[31mERROR[0m in 0.02s]
[0m17:33:28.747322 [debug] [Thread-4 (]: Finished running node model.sumup.customer_store_ranking
[0m17:33:28.747529 [debug] [Thread-7 (]: Marking all children of 'model.sumup.customer_store_ranking' to be skipped because of status 'error'.  Reason: Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  column s.store_name does not exist
  LINE 9:        s.store_name,
                 ^
  compiled code at target/run/sumup/models/marts/core/customer_store_ranking.sql.
[0m17:33:28.748370 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:28.748505 [debug] [MainThread]: On master: BEGIN
[0m17:33:28.748611 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:33:28.754915 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m17:33:28.755042 [debug] [MainThread]: On master: COMMIT
[0m17:33:28.755148 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:28.755245 [debug] [MainThread]: On master: COMMIT
[0m17:33:28.755446 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:33:28.755548 [debug] [MainThread]: On master: Close
[0m17:33:28.755701 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:33:28.755857 [debug] [MainThread]: Connection 'model.sumup.stg_device' was properly closed.
[0m17:33:28.755984 [debug] [MainThread]: Connection 'model.sumup.stg_store' was properly closed.
[0m17:33:28.756082 [debug] [MainThread]: Connection 'model.sumup.stg_transaction' was properly closed.
[0m17:33:28.756177 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m17:33:28.756367 [info ] [MainThread]: 
[0m17:33:28.756592 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m17:33:28.757042 [debug] [MainThread]: Command end result
[0m17:33:28.766654 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m17:33:28.767452 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m17:33:28.770096 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m17:33:28.770216 [info ] [MainThread]: 
[0m17:33:28.770355 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:33:28.770465 [info ] [MainThread]: 
[0m17:33:28.770616 [error] [MainThread]: [31mFailure in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)[0m
[0m17:33:28.770756 [error] [MainThread]:   Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  column s.store_name does not exist
  LINE 9:        s.store_name,
                 ^
  compiled code at target/run/sumup/models/marts/core/customer_store_ranking.sql
[0m17:33:28.770859 [info ] [MainThread]: 
[0m17:33:28.770981 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/marts/core/customer_store_ranking.sql
[0m17:33:28.771113 [info ] [MainThread]: 
[0m17:33:28.771259 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m17:33:28.771489 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:33:28.772913 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.79786175, "process_in_blocks": "0", "process_kernel_time": 0.125827, "process_mem_max_rss": "130088960", "process_out_blocks": "0", "process_user_time": 0.9177}
[0m17:33:28.773133 [debug] [MainThread]: Command `dbt run` failed at 17:33:28.773091 after 0.80 seconds
[0m17:33:28.773428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b91bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f61c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086badb0>]}
[0m17:33:28.773698 [debug] [MainThread]: Flushing usage events
[0m17:33:38.781030 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:34:01.344743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108437c50>]}


============================== 17:34:01.346546 | 15b9e37a-9808-419a-a56b-a938b56ee5ab ==============================
[0m17:34:01.346546 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:34:01.346796 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'write_json': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'target_path': 'None', 'use_colors': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'no_print': 'None', 'static_parser': 'True', 'printer_width': '80', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'invocation_command': 'dbt run -m +customer_store_ranking', 'log_format': 'default'}
[0m17:34:01.346976 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m17:34:01.347111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '15b9e37a-9808-419a-a56b-a938b56ee5ab', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10831f6f0>]}
[0m17:34:01.412413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15b9e37a-9808-419a-a56b-a938b56ee5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081cacf0>]}
[0m17:34:01.433684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15b9e37a-9808-419a-a56b-a938b56ee5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d7d50>]}
[0m17:34:01.434006 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:34:01.469862 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:34:01.510531 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:34:01.510822 [debug] [MainThread]: Partial parsing: updated file: sumup://models/marts/core/customer_store_ranking.sql
[0m17:34:01.595993 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m17:34:01.597856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15b9e37a-9808-419a-a56b-a938b56ee5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109342f30>]}
[0m17:34:01.623046 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m17:34:01.623869 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m17:34:01.629072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15b9e37a-9808-419a-a56b-a938b56ee5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109621710>]}
[0m17:34:01.629259 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m17:34:01.629396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15b9e37a-9808-419a-a56b-a938b56ee5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096036c0>]}
[0m17:34:01.630106 [info ] [MainThread]: 
[0m17:34:01.630249 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:34:01.630356 [info ] [MainThread]: 
[0m17:34:01.630548 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:34:01.632021 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:34:01.635799 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:34:01.677012 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:34:01.677203 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:34:01.677330 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:34:01.677461 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:34:01.677581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:01.677685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:01.692044 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.014 seconds
[0m17:34:01.692192 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.015 seconds
[0m17:34:01.692707 [debug] [ThreadPool]: On list_postgres: Close
[0m17:34:01.693117 [debug] [ThreadPool]: On list_postgres: Close
[0m17:34:01.693924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics)
[0m17:34:01.694128 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_analytics)
[0m17:34:01.696228 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m17:34:01.696420 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m17:34:01.697050 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m17:34:01.697170 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m17:34:01.697903 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m17:34:01.698008 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m17:34:01.698104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:01.698200 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m17:34:01.698288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:01.698432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:01.703997 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m17:34:01.704112 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m17:34:01.704219 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m17:34:01.704321 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m17:34:01.704427 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m17:34:01.704524 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m17:34:01.704631 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m17:34:01.704750 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m17:34:01.704879 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m17:34:01.709805 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m17:34:01.709913 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m17:34:01.710370 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m17:34:01.710473 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m17:34:01.710852 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m17:34:01.711308 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m17:34:01.711427 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m17:34:01.711530 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m17:34:01.711877 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m17:34:01.713836 [debug] [MainThread]: Using postgres connection "master"
[0m17:34:01.713941 [debug] [MainThread]: On master: BEGIN
[0m17:34:01.714029 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:34:01.718699 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m17:34:01.718801 [debug] [MainThread]: Using postgres connection "master"
[0m17:34:01.718927 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:34:01.725417 [debug] [MainThread]: SQL status: SELECT 4 in 0.006 seconds
[0m17:34:01.726074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15b9e37a-9808-419a-a56b-a938b56ee5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095e28d0>]}
[0m17:34:01.726224 [debug] [MainThread]: On master: ROLLBACK
[0m17:34:01.726442 [debug] [MainThread]: Using postgres connection "master"
[0m17:34:01.726535 [debug] [MainThread]: On master: BEGIN
[0m17:34:01.726857 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:34:01.726954 [debug] [MainThread]: On master: COMMIT
[0m17:34:01.727046 [debug] [MainThread]: Using postgres connection "master"
[0m17:34:01.727134 [debug] [MainThread]: On master: COMMIT
[0m17:34:01.727317 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:34:01.727411 [debug] [MainThread]: On master: Close
[0m17:34:01.728195 [debug] [Thread-2 (]: Began running node model.sumup.stg_store
[0m17:34:01.728340 [debug] [Thread-3 (]: Began running node model.sumup.stg_transaction
[0m17:34:01.728645 [debug] [Thread-1 (]: Began running node model.sumup.stg_device
[0m17:34:01.728519 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics_staging.stg_store ........................ [RUN]
[0m17:34:01.728867 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics_staging.stg_transaction .................. [RUN]
[0m17:34:01.729037 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_staging.stg_device ....................... [RUN]
[0m17:34:01.729191 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.stg_store)
[0m17:34:01.729322 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.stg_transaction)
[0m17:34:01.729447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.stg_device)
[0m17:34:01.729576 [debug] [Thread-2 (]: Began compiling node model.sumup.stg_store
[0m17:34:01.729705 [debug] [Thread-3 (]: Began compiling node model.sumup.stg_transaction
[0m17:34:01.729822 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_device
[0m17:34:01.732879 [debug] [Thread-2 (]: Writing injected SQL for node "model.sumup.stg_store"
[0m17:34:01.733722 [debug] [Thread-3 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m17:34:01.734920 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_device"
[0m17:34:01.735302 [debug] [Thread-1 (]: Began executing node model.sumup.stg_device
[0m17:34:01.735440 [debug] [Thread-2 (]: Began executing node model.sumup.stg_store
[0m17:34:01.735572 [debug] [Thread-3 (]: Began executing node model.sumup.stg_transaction
[0m17:34:01.750452 [debug] [Thread-2 (]: Writing runtime sql for node "model.sumup.stg_store"
[0m17:34:01.750654 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_device"
[0m17:34:01.751695 [debug] [Thread-3 (]: Writing runtime sql for node "model.sumup.stg_transaction"
[0m17:34:01.752034 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m17:34:01.752189 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m17:34:01.752325 [debug] [Thread-2 (]: On model.sumup.stg_store: BEGIN
[0m17:34:01.752448 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m17:34:01.752696 [debug] [Thread-1 (]: On model.sumup.stg_device: BEGIN
[0m17:34:01.752814 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:34:01.752932 [debug] [Thread-3 (]: On model.sumup.stg_transaction: BEGIN
[0m17:34:01.753047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:01.753223 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:34:01.758838 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m17:34:01.758957 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m17:34:01.759074 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */

  create view "postgres"."analytics_staging"."stg_store__dbt_tmp"
    
    
  as (
    

SELECT
    -- Primary Key: Rename to be explicit
    id AS store_id,

    -- Descriptive Attributes: Rename 'typology' for clarity
    typology AS store_typology,
    country,
    city
    
    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-20 15:34:01.337909+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."store"
  );
[0m17:34:01.759499 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:34:01.759626 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m17:34:01.759740 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m17:34:01.759857 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m17:34:01.759981 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */

  create view "postgres"."analytics_staging"."stg_device__dbt_tmp"
    
    
  as (
    

SELECT
    -- Primary Key
    id AS device_id,

    -- Foreign Key to stores (assuming this links the device to a specific store)
    store_id,

    -- Descriptive Attributes
    type as device_type
    
    -- Other fields, if any, standardized here
    -- e.g., CAST(status AS VARCHAR) AS device_status

    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-20 15:34:01.337909+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."device"
  );
[0m17:34:01.760145 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  create view "postgres"."analytics_staging"."stg_transaction__dbt_tmp"
    
    
  as (
    SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) / 100 AS amount_eur,
    LOWER(status) AS status,

    -- Card Information 
    REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '') AS card_number,
    CAST(cvv AS VARCHAR) AS cvv,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  );
[0m17:34:01.762139 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m17:34:01.764361 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m17:34:01.764493 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m17:34:01.764615 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */
alter table "postgres"."analytics_staging"."stg_store" rename to "stg_store__dbt_backup"
[0m17:34:01.764731 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m17:34:01.765718 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m17:34:01.766804 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m17:34:01.766925 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:34:01.767043 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */
alter table "postgres"."analytics_staging"."stg_device" rename to "stg_device__dbt_backup"
[0m17:34:01.767166 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
alter table "postgres"."analytics_staging"."stg_transaction" rename to "stg_transaction__dbt_backup"
[0m17:34:01.768018 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m17:34:01.768174 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */
alter table "postgres"."analytics_staging"."stg_store__dbt_tmp" rename to "stg_store"
[0m17:34:01.768428 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:34:01.769257 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m17:34:01.769383 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:34:01.769503 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */
alter table "postgres"."analytics_staging"."stg_device__dbt_tmp" rename to "stg_device"
[0m17:34:01.769615 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:34:01.770556 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m17:34:01.777991 [debug] [Thread-2 (]: On model.sumup.stg_store: COMMIT
[0m17:34:01.778176 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m17:34:01.778323 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
alter table "postgres"."analytics_staging"."stg_transaction__dbt_tmp" rename to "stg_transaction"
[0m17:34:01.778466 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m17:34:01.779042 [debug] [Thread-1 (]: On model.sumup.stg_device: COMMIT
[0m17:34:01.779200 [debug] [Thread-2 (]: On model.sumup.stg_store: COMMIT
[0m17:34:01.779339 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m17:34:01.779479 [debug] [Thread-1 (]: On model.sumup.stg_device: COMMIT
[0m17:34:01.779640 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:34:01.780173 [debug] [Thread-3 (]: On model.sumup.stg_transaction: COMMIT
[0m17:34:01.780301 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m17:34:01.780422 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m17:34:01.780533 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:34:01.782994 [debug] [Thread-2 (]: Applying DROP to: "postgres"."analytics_staging"."stg_store__dbt_backup"
[0m17:34:01.783139 [debug] [Thread-3 (]: On model.sumup.stg_transaction: COMMIT
[0m17:34:01.783877 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_device__dbt_backup"
[0m17:34:01.785619 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m17:34:01.785891 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m17:34:01.786028 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */
drop view if exists "postgres"."analytics_staging"."stg_store__dbt_backup" cascade
[0m17:34:01.786170 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */
drop view if exists "postgres"."analytics_staging"."stg_device__dbt_backup" cascade
[0m17:34:01.786314 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m17:34:01.787043 [debug] [Thread-3 (]: Applying DROP to: "postgres"."analytics_staging"."stg_transaction__dbt_backup"
[0m17:34:01.787266 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m17:34:01.787380 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
drop view if exists "postgres"."analytics_staging"."stg_transaction__dbt_backup" cascade
[0m17:34:01.787755 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:34:01.787999 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:34:01.789002 [debug] [Thread-2 (]: On model.sumup.stg_store: Close
[0m17:34:01.789457 [debug] [Thread-1 (]: On model.sumup.stg_device: Close
[0m17:34:01.789578 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:34:01.790570 [debug] [Thread-3 (]: On model.sumup.stg_transaction: Close
[0m17:34:01.790841 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15b9e37a-9808-419a-a56b-a938b56ee5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10959e620>]}
[0m17:34:01.790965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15b9e37a-9808-419a-a56b-a938b56ee5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b93750>]}
[0m17:34:01.791203 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics_staging.stg_store ................... [[32mCREATE VIEW[0m in 0.06s]
[0m17:34:01.791426 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_staging.stg_device .................. [[32mCREATE VIEW[0m in 0.06s]
[0m17:34:01.791561 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15b9e37a-9808-419a-a56b-a938b56ee5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b13250>]}
[0m17:34:01.791804 [debug] [Thread-2 (]: Finished running node model.sumup.stg_store
[0m17:34:01.791993 [debug] [Thread-1 (]: Finished running node model.sumup.stg_device
[0m17:34:01.792212 [info ] [Thread-3 (]: 3 of 4 OK created sql view model analytics_staging.stg_transaction ............. [[32mCREATE VIEW[0m in 0.06s]
[0m17:34:01.792510 [debug] [Thread-3 (]: Finished running node model.sumup.stg_transaction
[0m17:34:01.792789 [debug] [Thread-4 (]: Began running node model.sumup.customer_store_ranking
[0m17:34:01.792989 [info ] [Thread-4 (]: 4 of 4 START sql view model analytics_analytics.customer_store_ranking ......... [RUN]
[0m17:34:01.793177 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.sumup.customer_store_ranking'
[0m17:34:01.793296 [debug] [Thread-4 (]: Began compiling node model.sumup.customer_store_ranking
[0m17:34:01.794424 [debug] [Thread-4 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m17:34:01.794701 [debug] [Thread-4 (]: Began executing node model.sumup.customer_store_ranking
[0m17:34:01.795845 [debug] [Thread-4 (]: Writing runtime sql for node "model.sumup.customer_store_ranking"
[0m17:34:01.796127 [debug] [Thread-4 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m17:34:01.796251 [debug] [Thread-4 (]: On model.sumup.customer_store_ranking: BEGIN
[0m17:34:01.796405 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:34:01.801249 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m17:34:01.801372 [debug] [Thread-4 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m17:34:01.801489 [debug] [Thread-4 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  create view "postgres"."analytics_analytics"."customer_store_ranking__dbt_tmp"
    
    
  as (
    select t.transaction_id,
       s.store_id,
       t.amount_eur,
       t.happened_at_utc
from "postgres"."analytics_staging"."stg_transaction" t
left join "postgres"."analytics_staging"."stg_device" d using (device_id)
left join "postgres"."analytics_staging"."stg_store" s using (store_id)
  );
[0m17:34:01.806120 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m17:34:01.807547 [debug] [Thread-4 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m17:34:01.807715 [debug] [Thread-4 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */
alter table "postgres"."analytics_analytics"."customer_store_ranking__dbt_tmp" rename to "customer_store_ranking"
[0m17:34:01.808134 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:34:01.808632 [debug] [Thread-4 (]: On model.sumup.customer_store_ranking: COMMIT
[0m17:34:01.808747 [debug] [Thread-4 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m17:34:01.808855 [debug] [Thread-4 (]: On model.sumup.customer_store_ranking: COMMIT
[0m17:34:01.809290 [debug] [Thread-4 (]: SQL status: COMMIT in 0.000 seconds
[0m17:34:01.809964 [debug] [Thread-4 (]: Applying DROP to: "postgres"."analytics_analytics"."customer_store_ranking__dbt_backup"
[0m17:34:01.810188 [debug] [Thread-4 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m17:34:01.810300 [debug] [Thread-4 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */
drop view if exists "postgres"."analytics_analytics"."customer_store_ranking__dbt_backup" cascade
[0m17:34:01.810556 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:34:01.810963 [debug] [Thread-4 (]: On model.sumup.customer_store_ranking: Close
[0m17:34:01.811149 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15b9e37a-9808-419a-a56b-a938b56ee5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ab4050>]}
[0m17:34:01.811359 [info ] [Thread-4 (]: 4 of 4 OK created sql view model analytics_analytics.customer_store_ranking .... [[32mCREATE VIEW[0m in 0.02s]
[0m17:34:01.811564 [debug] [Thread-4 (]: Finished running node model.sumup.customer_store_ranking
[0m17:34:01.812047 [debug] [MainThread]: Using postgres connection "master"
[0m17:34:01.812146 [debug] [MainThread]: On master: BEGIN
[0m17:34:01.812231 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:34:01.817363 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m17:34:01.817468 [debug] [MainThread]: On master: COMMIT
[0m17:34:01.817558 [debug] [MainThread]: Using postgres connection "master"
[0m17:34:01.817643 [debug] [MainThread]: On master: COMMIT
[0m17:34:01.817835 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:34:01.818022 [debug] [MainThread]: On master: Close
[0m17:34:01.818196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:01.818301 [debug] [MainThread]: Connection 'model.sumup.stg_device' was properly closed.
[0m17:34:01.818392 [debug] [MainThread]: Connection 'model.sumup.stg_store' was properly closed.
[0m17:34:01.818476 [debug] [MainThread]: Connection 'model.sumup.stg_transaction' was properly closed.
[0m17:34:01.818558 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m17:34:01.818682 [info ] [MainThread]: 
[0m17:34:01.818806 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m17:34:01.819211 [debug] [MainThread]: Command end result
[0m17:34:01.830329 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m17:34:01.831067 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m17:34:01.833413 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m17:34:01.833529 [info ] [MainThread]: 
[0m17:34:01.833668 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:34:01.833775 [info ] [MainThread]: 
[0m17:34:01.833895 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m17:34:01.834098 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:34:01.835351 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5156066, "process_in_blocks": "0", "process_kernel_time": 0.102935, "process_mem_max_rss": "129695744", "process_out_blocks": "0", "process_user_time": 0.887414}
[0m17:34:01.835507 [debug] [MainThread]: Command `dbt run` succeeded at 17:34:01.835476 after 0.52 seconds
[0m17:34:01.835637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d72e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094b0a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090ff650>]}
[0m17:34:01.835759 [debug] [MainThread]: Flushing usage events
[0m17:34:11.878887 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:08:28.830646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104748050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055839d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105583c50>]}


============================== 18:08:28.833320 | 5dfa9c0f-7b29-4bbf-8d1b-de36974c182f ==============================
[0m18:08:28.833320 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:08:28.833585 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'introspect': 'True', 'write_json': 'True', 'invocation_command': 'dbt show -m customer_store_ranking', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_cache_events': 'False', 'empty': 'None', 'use_colors': 'True', 'printer_width': '80', 'partial_parse': 'True', 'log_format': 'default', 'warn_error': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'no_print': 'None', 'quiet': 'False', 'target_path': 'None', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'use_experimental_parser': 'False', 'debug': 'False'}
[0m18:08:28.833788 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m18:08:28.833938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5dfa9c0f-7b29-4bbf-8d1b-de36974c182f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10546f6f0>]}
[0m18:08:28.926006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dfa9c0f-7b29-4bbf-8d1b-de36974c182f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10541acf0>]}
[0m18:08:28.948771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dfa9c0f-7b29-4bbf-8d1b-de36974c182f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105427d50>]}
[0m18:08:28.960517 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:08:29.002074 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:08:29.059760 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:08:29.060028 [debug] [MainThread]: Partial parsing: updated file: sumup://models/marts/core/customer_store_ranking.sql
[0m18:08:29.146797 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m18:08:29.148726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dfa9c0f-7b29-4bbf-8d1b-de36974c182f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10663be30>]}
[0m18:08:29.180837 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m18:08:29.182546 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m18:08:29.184019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dfa9c0f-7b29-4bbf-8d1b-de36974c182f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f74d0>]}
[0m18:08:29.184268 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m18:08:29.184412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dfa9c0f-7b29-4bbf-8d1b-de36974c182f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a7ee0>]}
[0m18:08:29.185100 [info ] [MainThread]: 
[0m18:08:29.185249 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:08:29.185360 [info ] [MainThread]: 
[0m18:08:29.185573 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:08:29.187321 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m18:08:29.191973 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m18:08:29.195507 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m18:08:29.245114 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m18:08:29.245333 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m18:08:29.245496 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m18:08:29.245641 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m18:08:29.245782 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m18:08:29.245929 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m18:08:29.246051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:29.246166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:29.246280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:29.333396 [debug] [ThreadPool]: SQL status: BEGIN in 0.087 seconds
[0m18:08:29.333640 [debug] [ThreadPool]: SQL status: BEGIN in 0.088 seconds
[0m18:08:29.333813 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m18:08:29.333951 [debug] [ThreadPool]: SQL status: BEGIN in 0.088 seconds
[0m18:08:29.334092 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m18:08:29.334243 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m18:08:29.334382 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m18:08:29.334522 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m18:08:29.334727 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m18:08:29.351042 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.016 seconds
[0m18:08:29.351852 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m18:08:29.352040 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.017 seconds
[0m18:08:29.352196 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.017 seconds
[0m18:08:29.352785 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m18:08:29.353338 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m18:08:29.353480 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m18:08:29.354071 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m18:08:29.354205 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m18:08:29.357326 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:29.357497 [debug] [MainThread]: On master: BEGIN
[0m18:08:29.357629 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:29.363150 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:08:29.363295 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:29.363474 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:08:29.373080 [debug] [MainThread]: SQL status: SELECT 7 in 0.009 seconds
[0m18:08:29.374284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dfa9c0f-7b29-4bbf-8d1b-de36974c182f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065eb1d0>]}
[0m18:08:29.374494 [debug] [MainThread]: On master: ROLLBACK
[0m18:08:29.374745 [debug] [MainThread]: On master: Close
[0m18:08:29.376258 [debug] [Thread-1 (]: Began running node model.sumup.customer_store_ranking
[0m18:08:29.376460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.customer_store_ranking)
[0m18:08:29.376629 [debug] [Thread-1 (]: Began compiling node model.sumup.customer_store_ranking
[0m18:08:29.381082 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m18:08:29.381483 [debug] [Thread-1 (]: Began executing node model.sumup.customer_store_ranking
[0m18:08:29.384724 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m18:08:29.384907 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  
  select t.transaction_id,
       s.store_id,
       sum(t.amount_eur) over (partition by s.store_id order by t.amount_eur desc) as total_amount_eur
from "postgres"."analytics_staging"."stg_transaction" t
left join "postgres"."analytics_staging"."stg_device" d using (device_id)
left join "postgres"."analytics_staging"."stg_store" s using (store_id)
group by t.transaction_id, s.store_id
  
  limit 5

[0m18:08:29.385074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:29.395284 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "t.amount_eur" must appear in the GROUP BY clause or be used in an aggregate function
LINE 6:        sum(t.amount_eur) over (partition by s.store_id order...
                   ^

[0m18:08:29.395495 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: Close
[0m18:08:29.399050 [debug] [Thread-1 (]: Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  column "t.amount_eur" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 6:        sum(t.amount_eur) over (partition by s.store_id order...
                     ^
[0m18:08:29.399352 [debug] [Thread-1 (]: Finished running node model.sumup.customer_store_ranking
[0m18:08:29.399601 [debug] [Thread-7 (]: Marking all children of 'model.sumup.customer_store_ranking' to be skipped because of status 'error'.  Reason: Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  column "t.amount_eur" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 6:        sum(t.amount_eur) over (partition by s.store_id order...
                     ^.
[0m18:08:29.400079 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:29.400246 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m18:08:29.400407 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m18:08:29.400533 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m18:08:29.400737 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
    column "t.amount_eur" must appear in the GROUP BY clause or be used in an aggregate function
    LINE 6:        sum(t.amount_eur) over (partition by s.store_id order...
                       ^
[0m18:08:29.400998 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:08:29.403217 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.6085352, "process_in_blocks": "0", "process_kernel_time": 0.161067, "process_mem_max_rss": "128679936", "process_out_blocks": "0", "process_user_time": 0.865216}
[0m18:08:29.403425 [debug] [MainThread]: Command `dbt show` failed at 18:08:29.403384 after 0.61 seconds
[0m18:08:29.403586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10688e2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053b0a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053b0550>]}
[0m18:08:29.403749 [debug] [MainThread]: Flushing usage events
[0m18:08:39.444563 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:25:15.071649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106120050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f5f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f5fc50>]}


============================== 08:25:15.074658 | df3c4d03-a8dc-4ad2-8e80-1b1e4d1a8d90 ==============================
[0m08:25:15.074658 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:25:15.074919 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt show -select customer_store_ranking', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'partial_parse': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'empty': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'log_format': 'default', 'fail_fast': 'False', 'write_json': 'True'}
[0m08:25:15.159550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df3c4d03-a8dc-4ad2-8e80-1b1e4d1a8d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106283950>]}
[0m08:25:15.181903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df3c4d03-a8dc-4ad2-8e80-1b1e4d1a8d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df6cf0>]}
[0m08:25:15.192768 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:25:15.233205 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:25:15.289472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:25:15.289653 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:25:15.291881 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m08:25:15.303808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df3c4d03-a8dc-4ad2-8e80-1b1e4d1a8d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f4c550>]}
[0m08:25:15.328857 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:25:15.329958 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:25:15.330958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df3c4d03-a8dc-4ad2-8e80-1b1e4d1a8d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d9ed50>]}
[0m08:25:15.331126 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m08:25:15.331255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df3c4d03-a8dc-4ad2-8e80-1b1e4d1a8d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10768e510>]}
[0m08:25:15.331522 [warn ] [MainThread]: The selection criterion 'elect' does not match any enabled nodes
[0m08:25:15.332061 [info ] [MainThread]: 
[0m08:25:15.332196 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:25:15.332296 [info ] [MainThread]: 
[0m08:25:15.332490 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:25:15.334102 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m08:25:15.338794 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m08:25:15.339051 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m08:25:15.360365 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:25:15.360545 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:25:15.360688 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:25:15.360826 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m08:25:15.360945 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m08:25:15.361064 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m08:25:15.361183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:25:15.361291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:25:15.361396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:25:15.461505 [debug] [ThreadPool]: SQL status: BEGIN in 0.100 seconds
[0m08:25:15.461764 [debug] [ThreadPool]: SQL status: BEGIN in 0.100 seconds
[0m08:25:15.461920 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:25:15.462052 [debug] [ThreadPool]: SQL status: BEGIN in 0.101 seconds
[0m08:25:15.462192 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:25:15.462354 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:25:15.462518 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:25:15.462678 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m08:25:15.462895 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m08:25:15.484028 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.021 seconds
[0m08:25:15.484306 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.021 seconds
[0m08:25:15.484492 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.021 seconds
[0m08:25:15.485455 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:25:15.486159 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m08:25:15.486800 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m08:25:15.487388 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:25:15.487560 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m08:25:15.487710 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m08:25:15.492889 [debug] [MainThread]: Using postgres connection "master"
[0m08:25:15.493098 [debug] [MainThread]: On master: BEGIN
[0m08:25:15.493243 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:25:15.498207 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:25:15.498377 [debug] [MainThread]: Using postgres connection "master"
[0m08:25:15.498576 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:25:15.521349 [debug] [MainThread]: SQL status: SELECT 7 in 0.022 seconds
[0m08:25:15.522954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df3c4d03-a8dc-4ad2-8e80-1b1e4d1a8d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080cb1e0>]}
[0m08:25:15.523260 [debug] [MainThread]: On master: ROLLBACK
[0m08:25:15.523622 [debug] [MainThread]: On master: Close
[0m08:25:15.525338 [debug] [Thread-1 (]: Began running node model.sumup.customer_store_ranking
[0m08:25:15.525613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.customer_store_ranking)
[0m08:25:15.525840 [debug] [Thread-1 (]: Began compiling node model.sumup.customer_store_ranking
[0m08:25:15.530090 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m08:25:15.530508 [debug] [Thread-1 (]: Began executing node model.sumup.customer_store_ranking
[0m08:25:15.534501 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m08:25:15.534718 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  
  select t.transaction_id,
       s.store_id,
       sum(t.amount_eur) over (partition by s.store_id order by t.amount_eur desc) as total_amount_eur
from "postgres"."analytics_staging"."stg_transaction" t
left join "postgres"."analytics_staging"."stg_device" d using (device_id)
left join "postgres"."analytics_staging"."stg_store" s using (store_id)
group by t.transaction_id, s.store_id
  
  limit 5

[0m08:25:15.534899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:25:15.548845 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "t.amount_eur" must appear in the GROUP BY clause or be used in an aggregate function
LINE 6:        sum(t.amount_eur) over (partition by s.store_id order...
                   ^

[0m08:25:15.549150 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: Close
[0m08:25:15.552852 [debug] [Thread-1 (]: Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  column "t.amount_eur" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 6:        sum(t.amount_eur) over (partition by s.store_id order...
                     ^
[0m08:25:15.553183 [debug] [Thread-1 (]: Finished running node model.sumup.customer_store_ranking
[0m08:25:15.553438 [debug] [Thread-7 (]: Marking all children of 'model.sumup.customer_store_ranking' to be skipped because of status 'error'.  Reason: Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  column "t.amount_eur" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 6:        sum(t.amount_eur) over (partition by s.store_id order...
                     ^.
[0m08:25:15.553929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:25:15.554079 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m08:25:15.554209 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m08:25:15.554324 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m08:25:15.554544 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
    column "t.amount_eur" must appear in the GROUP BY clause or be used in an aggregate function
    LINE 6:        sum(t.amount_eur) over (partition by s.store_id order...
                       ^
[0m08:25:15.556877 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.51999456, "process_in_blocks": "0", "process_kernel_time": 0.140012, "process_mem_max_rss": "125419520", "process_out_blocks": "0", "process_user_time": 0.730072}
[0m08:25:15.557144 [debug] [MainThread]: Command `dbt show` failed at 08:25:15.557098 after 0.52 seconds
[0m08:25:15.557322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082e9390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082e9440>]}
[0m08:25:15.557481 [debug] [MainThread]: Flushing usage events
[0m08:25:16.309379 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:25:59.282977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104014050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105637c50>]}


============================== 08:25:59.285500 | d6245de6-da3c-4fd3-bea9-cc782b2dabdf ==============================
[0m08:25:59.285500 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:25:59.285755 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'cache_selected_only': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'no_print': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'debug': 'False', 'static_parser': 'True', 'version_check': 'True', 'log_format': 'default', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'write_json': 'True', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'target_path': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt show -select int_transaction', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m08:25:59.371630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6245de6-da3c-4fd3-bea9-cc782b2dabdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10445b950>]}
[0m08:25:59.392400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6245de6-da3c-4fd3-bea9-cc782b2dabdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053cacf0>]}
[0m08:25:59.402489 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:25:59.442563 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:25:59.497946 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:25:59.498167 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:25:59.500724 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m08:25:59.513568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6245de6-da3c-4fd3-bea9-cc782b2dabdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb8550>]}
[0m08:25:59.539421 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:25:59.540587 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:25:59.541532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6245de6-da3c-4fd3-bea9-cc782b2dabdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d0ad50>]}
[0m08:25:59.541706 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m08:25:59.541834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6245de6-da3c-4fd3-bea9-cc782b2dabdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ba510>]}
[0m08:25:59.542101 [warn ] [MainThread]: The selection criterion 'elect' does not match any enabled nodes
[0m08:25:59.542635 [info ] [MainThread]: 
[0m08:25:59.542765 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:25:59.542865 [info ] [MainThread]: 
[0m08:25:59.543060 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:25:59.544637 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m08:25:59.549226 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m08:25:59.550182 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m08:25:59.571146 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:25:59.571325 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:25:59.571484 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:25:59.571621 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m08:25:59.571742 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m08:25:59.571866 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m08:25:59.571983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:25:59.572088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:25:59.572194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:25:59.590457 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m08:25:59.590640 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m08:25:59.590762 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m08:25:59.590893 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:25:59.591014 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:25:59.591132 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:25:59.591261 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m08:25:59.591400 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m08:25:59.591532 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:25:59.597306 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m08:25:59.597415 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m08:25:59.597514 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m08:25:59.598058 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:25:59.598476 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m08:25:59.598864 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m08:25:59.599101 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:25:59.599213 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m08:25:59.599341 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m08:25:59.602004 [debug] [MainThread]: Using postgres connection "master"
[0m08:25:59.602128 [debug] [MainThread]: On master: BEGIN
[0m08:25:59.602222 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:25:59.606317 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:25:59.606419 [debug] [MainThread]: Using postgres connection "master"
[0m08:25:59.606546 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:25:59.611555 [debug] [MainThread]: SQL status: SELECT 7 in 0.005 seconds
[0m08:25:59.612419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6245de6-da3c-4fd3-bea9-cc782b2dabdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070371e0>]}
[0m08:25:59.612562 [debug] [MainThread]: On master: ROLLBACK
[0m08:25:59.612786 [debug] [MainThread]: On master: Close
[0m08:25:59.613892 [debug] [Thread-1 (]: Began running node model.sumup.int_transaction
[0m08:25:59.614038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.int_transaction)
[0m08:25:59.614165 [debug] [Thread-1 (]: Began compiling node model.sumup.int_transaction
[0m08:25:59.616942 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m08:25:59.617563 [debug] [Thread-1 (]: Began executing node model.sumup.int_transaction
[0m08:25:59.620396 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_transaction"
[0m08:25:59.620556 [debug] [Thread-1 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

  
  SELECT
    -- Primary and Foreign Keys
    transaction_id,
    device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    amount_eur,
    status,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction"
  
  limit 5

[0m08:25:59.620693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:25:59.632908 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.012 seconds
[0m08:25:59.633926 [debug] [Thread-1 (]: On model.sumup.int_transaction: Close
[0m08:25:59.634202 [debug] [Thread-1 (]: Finished running node model.sumup.int_transaction
[0m08:25:59.634616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:25:59.634723 [debug] [MainThread]: Connection 'model.sumup.int_transaction' was properly closed.
[0m08:25:59.634818 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m08:25:59.634907 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m08:25:59.635131 [debug] [MainThread]: Command end result
[0m08:25:59.643820 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:25:59.644472 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:25:59.646974 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m08:25:59.647088 [debug] [MainThread]: Excluded node 'int_transaction' from results
[0m08:25:59.649152 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 0.3937622, "process_in_blocks": "0", "process_kernel_time": 0.128269, "process_mem_max_rss": "125730816", "process_out_blocks": "0", "process_user_time": 0.72385}
[0m08:25:59.649326 [debug] [MainThread]: Command `dbt show` succeeded at 08:25:59.649292 after 0.39 seconds
[0m08:25:59.649457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053a9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073909f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073912e0>]}
[0m08:25:59.649577 [debug] [MainThread]: Flushing usage events
[0m08:26:00.354530 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:26:29.920105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044d4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053179d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105317c50>]}


============================== 08:26:29.922563 | 5964405d-a9fa-4aa6-9f27-592f5364e583 ==============================
[0m08:26:29.922563 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:26:29.922842 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'write_json': 'True', 'version_check': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'log_format': 'default', 'cache_selected_only': 'False', 'empty': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run -m +int_transaction', 'debug': 'False', 'introspect': 'True', 'quiet': 'False', 'static_parser': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'warn_error': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'target_path': 'None'}
[0m08:26:29.923046 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m08:26:29.923193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5964405d-a9fa-4aa6-9f27-592f5364e583', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051ff6f0>]}
[0m08:26:30.002333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5964405d-a9fa-4aa6-9f27-592f5364e583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051aacf0>]}
[0m08:26:30.022734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5964405d-a9fa-4aa6-9f27-592f5364e583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b3d50>]}
[0m08:26:30.023263 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:26:30.062627 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:26:30.111594 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:26:30.111754 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:26:30.113895 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m08:26:30.127711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5964405d-a9fa-4aa6-9f27-592f5364e583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106375d60>]}
[0m08:26:30.152380 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:26:30.153737 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:26:30.163121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5964405d-a9fa-4aa6-9f27-592f5364e583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aef150>]}
[0m08:26:30.163307 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m08:26:30.163438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5964405d-a9fa-4aa6-9f27-592f5364e583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10649b790>]}
[0m08:26:30.164106 [info ] [MainThread]: 
[0m08:26:30.164241 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:26:30.164345 [info ] [MainThread]: 
[0m08:26:30.164542 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:26:30.165964 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m08:26:30.166751 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m08:26:30.187402 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m08:26:30.187592 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m08:26:30.187719 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m08:26:30.187838 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m08:26:30.187948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:26:30.188047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:26:30.208185 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.020 seconds
[0m08:26:30.208396 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.020 seconds
[0m08:26:30.208949 [debug] [ThreadPool]: On list_postgres: Close
[0m08:26:30.209367 [debug] [ThreadPool]: On list_postgres: Close
[0m08:26:30.210195 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m08:26:30.210383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics)
[0m08:26:30.212563 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:26:30.212758 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m08:26:30.213420 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:26:30.213531 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m08:26:30.214317 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:26:30.214427 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m08:26:30.214524 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:26:30.214631 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m08:26:30.214731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:26:30.214870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:26:30.222397 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m08:26:30.222517 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m08:26:30.222616 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:26:30.222709 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m08:26:30.222811 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:26:30.222916 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m08:26:30.223022 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:26:30.223128 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:26:30.223265 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m08:26:30.229342 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m08:26:30.229449 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m08:26:30.229938 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:26:30.230047 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m08:26:30.230448 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m08:26:30.230914 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m08:26:30.231026 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:26:30.231433 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m08:26:30.231533 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m08:26:30.233592 [debug] [MainThread]: Using postgres connection "master"
[0m08:26:30.233713 [debug] [MainThread]: On master: BEGIN
[0m08:26:30.233807 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:26:30.238945 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:26:30.239049 [debug] [MainThread]: Using postgres connection "master"
[0m08:26:30.239179 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:26:30.244096 [debug] [MainThread]: SQL status: SELECT 7 in 0.005 seconds
[0m08:26:30.244945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5964405d-a9fa-4aa6-9f27-592f5364e583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10651a150>]}
[0m08:26:30.245103 [debug] [MainThread]: On master: ROLLBACK
[0m08:26:30.245293 [debug] [MainThread]: Using postgres connection "master"
[0m08:26:30.245389 [debug] [MainThread]: On master: BEGIN
[0m08:26:30.245647 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:26:30.245745 [debug] [MainThread]: On master: COMMIT
[0m08:26:30.245837 [debug] [MainThread]: Using postgres connection "master"
[0m08:26:30.245925 [debug] [MainThread]: On master: COMMIT
[0m08:26:30.246091 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:26:30.246185 [debug] [MainThread]: On master: Close
[0m08:26:30.247298 [debug] [Thread-1 (]: Began running node model.sumup.stg_transaction
[0m08:26:30.247488 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_staging.stg_transaction .................. [RUN]
[0m08:26:30.247653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.stg_transaction)
[0m08:26:30.247783 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_transaction
[0m08:26:30.250889 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m08:26:30.251583 [debug] [Thread-1 (]: Began executing node model.sumup.stg_transaction
[0m08:26:30.265288 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_transaction"
[0m08:26:30.265860 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:26:30.266002 [debug] [Thread-1 (]: On model.sumup.stg_transaction: BEGIN
[0m08:26:30.266117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:26:30.271001 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:26:30.271146 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:26:30.271293 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  create view "postgres"."analytics_staging"."stg_transaction__dbt_tmp"
    
    
  as (
    SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) / 100 AS amount_eur,
    LOWER(status) AS status,

    -- Card Information 
    REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '') AS card_number,
    CAST(cvv AS VARCHAR) AS cvv,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  );
[0m08:26:30.282382 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m08:26:30.284937 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:26:30.285075 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
alter table "postgres"."analytics_staging"."stg_transaction" rename to "stg_transaction__dbt_backup"
[0m08:26:30.286447 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:26:30.287411 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:26:30.287538 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
alter table "postgres"."analytics_staging"."stg_transaction__dbt_tmp" rename to "stg_transaction"
[0m08:26:30.288086 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:26:30.294148 [debug] [Thread-1 (]: On model.sumup.stg_transaction: COMMIT
[0m08:26:30.294288 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:26:30.294408 [debug] [Thread-1 (]: On model.sumup.stg_transaction: COMMIT
[0m08:26:30.295124 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:26:30.297410 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_transaction__dbt_backup"
[0m08:26:30.299121 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:26:30.299251 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
drop view if exists "postgres"."analytics_staging"."stg_transaction__dbt_backup" cascade
[0m08:26:30.302364 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m08:26:30.303250 [debug] [Thread-1 (]: On model.sumup.stg_transaction: Close
[0m08:26:30.304069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5964405d-a9fa-4aa6-9f27-592f5364e583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067107e0>]}
[0m08:26:30.304316 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_staging.stg_transaction ............. [[32mCREATE VIEW[0m in 0.06s]
[0m08:26:30.304551 [debug] [Thread-1 (]: Finished running node model.sumup.stg_transaction
[0m08:26:30.304809 [debug] [Thread-2 (]: Began running node model.sumup.int_transaction
[0m08:26:30.305055 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics_analytics.int_transaction ................ [RUN]
[0m08:26:30.305264 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.int_transaction)
[0m08:26:30.305404 [debug] [Thread-2 (]: Began compiling node model.sumup.int_transaction
[0m08:26:30.306318 [debug] [Thread-2 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m08:26:30.306559 [debug] [Thread-2 (]: Began executing node model.sumup.int_transaction
[0m08:26:30.309419 [debug] [Thread-2 (]: Writing runtime sql for node "model.sumup.int_transaction"
[0m08:26:30.309793 [debug] [Thread-2 (]: Using postgres connection "model.sumup.int_transaction"
[0m08:26:30.309917 [debug] [Thread-2 (]: On model.sumup.int_transaction: BEGIN
[0m08:26:30.310032 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:26:30.314627 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m08:26:30.314756 [debug] [Thread-2 (]: Using postgres connection "model.sumup.int_transaction"
[0m08:26:30.314900 [debug] [Thread-2 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

  create view "postgres"."analytics_analytics"."int_transaction__dbt_tmp"
    
    
  as (
    SELECT
    -- Primary and Foreign Keys
    transaction_id,
    device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    amount_eur,
    status,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction"
  );
[0m08:26:30.318475 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m08:26:30.319666 [debug] [Thread-2 (]: Using postgres connection "model.sumup.int_transaction"
[0m08:26:30.319797 [debug] [Thread-2 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */
alter table "postgres"."analytics_analytics"."int_transaction" rename to "int_transaction__dbt_backup"
[0m08:26:30.320564 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:26:30.321464 [debug] [Thread-2 (]: Using postgres connection "model.sumup.int_transaction"
[0m08:26:30.321584 [debug] [Thread-2 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */
alter table "postgres"."analytics_analytics"."int_transaction__dbt_tmp" rename to "int_transaction"
[0m08:26:30.322028 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:26:30.347712 [debug] [Thread-2 (]: On model.sumup.int_transaction: COMMIT
[0m08:26:30.347917 [debug] [Thread-2 (]: Using postgres connection "model.sumup.int_transaction"
[0m08:26:30.348043 [debug] [Thread-2 (]: On model.sumup.int_transaction: COMMIT
[0m08:26:30.348653 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m08:26:30.349453 [debug] [Thread-2 (]: Applying DROP to: "postgres"."analytics_analytics"."int_transaction__dbt_backup"
[0m08:26:30.350715 [debug] [Thread-2 (]: Using postgres connection "model.sumup.int_transaction"
[0m08:26:30.350865 [debug] [Thread-2 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */
drop table if exists "postgres"."analytics_analytics"."int_transaction__dbt_backup" cascade
[0m08:26:30.359587 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.009 seconds
[0m08:26:30.360079 [debug] [Thread-2 (]: On model.sumup.int_transaction: Close
[0m08:26:30.360307 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5964405d-a9fa-4aa6-9f27-592f5364e583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10614c0f0>]}
[0m08:26:30.360547 [info ] [Thread-2 (]: 2 of 2 OK created sql view model analytics_analytics.int_transaction ........... [[32mCREATE VIEW[0m in 0.06s]
[0m08:26:30.360775 [debug] [Thread-2 (]: Finished running node model.sumup.int_transaction
[0m08:26:30.361258 [debug] [MainThread]: Using postgres connection "master"
[0m08:26:30.361374 [debug] [MainThread]: On master: BEGIN
[0m08:26:30.361469 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:26:30.366725 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:26:30.366844 [debug] [MainThread]: On master: COMMIT
[0m08:26:30.366942 [debug] [MainThread]: Using postgres connection "master"
[0m08:26:30.367043 [debug] [MainThread]: On master: COMMIT
[0m08:26:30.367267 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:26:30.367389 [debug] [MainThread]: On master: Close
[0m08:26:30.367532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:26:30.367628 [debug] [MainThread]: Connection 'model.sumup.stg_transaction' was properly closed.
[0m08:26:30.367715 [debug] [MainThread]: Connection 'model.sumup.int_transaction' was properly closed.
[0m08:26:30.367796 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m08:26:30.367915 [info ] [MainThread]: 
[0m08:26:30.368036 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m08:26:30.368335 [debug] [MainThread]: Command end result
[0m08:26:30.376836 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:26:30.377622 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:26:30.380178 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m08:26:30.380316 [info ] [MainThread]: 
[0m08:26:30.380460 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:26:30.380570 [info ] [MainThread]: 
[0m08:26:30.380692 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m08:26:30.380897 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:26:30.383146 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.49088663, "process_in_blocks": "0", "process_kernel_time": 0.117447, "process_mem_max_rss": "124239872", "process_out_blocks": "0", "process_user_time": 0.794254}
[0m08:26:30.383405 [debug] [MainThread]: Command `dbt run` succeeded at 08:26:30.383360 after 0.49 seconds
[0m08:26:30.383570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045f3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106118650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053a83d0>]}
[0m08:26:30.383723 [debug] [MainThread]: Flushing usage events
[0m08:26:31.077557 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:26:35.813766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ac050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052eb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ebc50>]}


============================== 08:26:35.816116 | f14c74fb-16c6-451d-888a-b00e29c888e9 ==============================
[0m08:26:35.816116 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:26:35.816396 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'fail_fast': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'invocation_command': 'dbt show -select int_transaction', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'introspect': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_format': 'default', 'no_print': 'None', 'warn_error': 'None', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'partial_parse': 'True'}
[0m08:26:35.882955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f14c74fb-16c6-451d-888a-b00e29c888e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104613950>]}
[0m08:26:35.903289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f14c74fb-16c6-451d-888a-b00e29c888e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105182cf0>]}
[0m08:26:35.912398 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:26:35.950906 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:26:36.000784 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:26:36.000957 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:26:36.003154 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m08:26:36.031368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f14c74fb-16c6-451d-888a-b00e29c888e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d8550>]}
[0m08:26:36.060533 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:26:36.061363 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:26:36.062317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f14c74fb-16c6-451d-888a-b00e29c888e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10612ad50>]}
[0m08:26:36.062476 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m08:26:36.062602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f14c74fb-16c6-451d-888a-b00e29c888e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a1a510>]}
[0m08:26:36.062887 [warn ] [MainThread]: The selection criterion 'elect' does not match any enabled nodes
[0m08:26:36.063400 [info ] [MainThread]: 
[0m08:26:36.063530 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:26:36.063630 [info ] [MainThread]: 
[0m08:26:36.063826 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:26:36.065389 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m08:26:36.065595 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m08:26:36.071043 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m08:26:36.086933 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:26:36.087117 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:26:36.087278 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:26:36.087424 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m08:26:36.087546 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m08:26:36.087672 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m08:26:36.087795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:26:36.087899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:26:36.088012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:26:36.105535 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m08:26:36.105725 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m08:26:36.105866 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:26:36.105977 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m08:26:36.106089 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:26:36.106203 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:26:36.106311 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:26:36.106418 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m08:26:36.106570 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m08:26:36.113045 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m08:26:36.113602 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m08:26:36.113724 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m08:26:36.114166 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:26:36.114290 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m08:26:36.114420 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m08:26:36.114533 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:26:36.114987 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m08:26:36.115722 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m08:26:36.117760 [debug] [MainThread]: Using postgres connection "master"
[0m08:26:36.117872 [debug] [MainThread]: On master: BEGIN
[0m08:26:36.117959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:26:36.123040 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:26:36.123154 [debug] [MainThread]: Using postgres connection "master"
[0m08:26:36.123289 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:26:36.129656 [debug] [MainThread]: SQL status: SELECT 5 in 0.006 seconds
[0m08:26:36.130421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f14c74fb-16c6-451d-888a-b00e29c888e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106456f70>]}
[0m08:26:36.130581 [debug] [MainThread]: On master: ROLLBACK
[0m08:26:36.130843 [debug] [MainThread]: On master: Close
[0m08:26:36.132024 [debug] [Thread-1 (]: Began running node model.sumup.int_transaction
[0m08:26:36.132180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.int_transaction)
[0m08:26:36.132308 [debug] [Thread-1 (]: Began compiling node model.sumup.int_transaction
[0m08:26:36.135235 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m08:26:36.135529 [debug] [Thread-1 (]: Began executing node model.sumup.int_transaction
[0m08:26:36.138356 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_transaction"
[0m08:26:36.138512 [debug] [Thread-1 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

  
  SELECT
    -- Primary and Foreign Keys
    transaction_id,
    device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    amount_eur,
    status,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction"
  
  limit 5

[0m08:26:36.138653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:26:36.145639 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.007 seconds
[0m08:26:36.146645 [debug] [Thread-1 (]: On model.sumup.int_transaction: Close
[0m08:26:36.146925 [debug] [Thread-1 (]: Finished running node model.sumup.int_transaction
[0m08:26:36.147396 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:26:36.147510 [debug] [MainThread]: Connection 'model.sumup.int_transaction' was properly closed.
[0m08:26:36.147610 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m08:26:36.147703 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m08:26:36.148063 [debug] [MainThread]: Command end result
[0m08:26:36.156683 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:26:36.157374 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:26:36.159942 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m08:26:36.160057 [debug] [MainThread]: Excluded node 'int_transaction' from results
[0m08:26:36.161517 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 0.37448686, "process_in_blocks": "0", "process_kernel_time": 0.099227, "process_mem_max_rss": "126763008", "process_out_blocks": "0", "process_user_time": 0.727625}
[0m08:26:36.161690 [debug] [MainThread]: Command `dbt show` succeeded at 08:26:36.161658 after 0.37 seconds
[0m08:26:36.161832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105161f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106678940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106679230>]}
[0m08:26:36.161958 [debug] [MainThread]: Flushing usage events
[0m08:26:36.875627 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:27:20.106027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110504050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e33c50>]}


============================== 08:27:20.108437 | 960b8786-6b32-446f-b205-ffd47299e57c ==============================
[0m08:27:20.108437 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:27:20.108701 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'no_print': 'None', 'invocation_command': 'dbt show --select int_transaction', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'version_check': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'empty': 'None', 'log_format': 'default', 'write_json': 'True', 'introspect': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:27:20.185420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '960b8786-6b32-446f-b205-ffd47299e57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110857950>]}
[0m08:27:20.205676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '960b8786-6b32-446f-b205-ffd47299e57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bcacf0>]}
[0m08:27:20.215188 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:27:20.261659 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:27:20.314366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:27:20.314558 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:27:20.316938 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m08:27:20.329278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '960b8786-6b32-446f-b205-ffd47299e57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d74550>]}
[0m08:27:20.354266 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:27:20.355388 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:27:20.356314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '960b8786-6b32-446f-b205-ffd47299e57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114bc6d50>]}
[0m08:27:20.356482 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m08:27:20.356607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '960b8786-6b32-446f-b205-ffd47299e57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144b6510>]}
[0m08:27:20.357215 [info ] [MainThread]: 
[0m08:27:20.357346 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:27:20.357448 [info ] [MainThread]: 
[0m08:27:20.357642 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:27:20.359245 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m08:27:20.363913 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m08:27:20.364156 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m08:27:20.384669 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:27:20.384842 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:27:20.385002 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:27:20.385148 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m08:27:20.385275 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m08:27:20.385398 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m08:27:20.385522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:27:20.385633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:27:20.385741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:27:20.402971 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m08:27:20.403132 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m08:27:20.403274 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m08:27:20.403406 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:27:20.403524 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:27:20.403643 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:27:20.403779 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m08:27:20.403919 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:27:20.404060 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m08:27:20.408909 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m08:27:20.409017 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m08:27:20.409539 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m08:27:20.409651 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m08:27:20.410062 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:27:20.410516 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m08:27:20.410628 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m08:27:20.410995 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:27:20.411093 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m08:27:20.413268 [debug] [MainThread]: Using postgres connection "master"
[0m08:27:20.413391 [debug] [MainThread]: On master: BEGIN
[0m08:27:20.413488 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:27:20.418550 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:27:20.418649 [debug] [MainThread]: Using postgres connection "master"
[0m08:27:20.418786 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:27:20.426122 [debug] [MainThread]: SQL status: SELECT 5 in 0.007 seconds
[0m08:27:20.426880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '960b8786-6b32-446f-b205-ffd47299e57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11586ef70>]}
[0m08:27:20.427029 [debug] [MainThread]: On master: ROLLBACK
[0m08:27:20.427271 [debug] [MainThread]: On master: Close
[0m08:27:20.428437 [debug] [Thread-1 (]: Began running node model.sumup.int_transaction
[0m08:27:20.428597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.int_transaction)
[0m08:27:20.428731 [debug] [Thread-1 (]: Began compiling node model.sumup.int_transaction
[0m08:27:20.431633 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m08:27:20.431904 [debug] [Thread-1 (]: Began executing node model.sumup.int_transaction
[0m08:27:20.434762 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_transaction"
[0m08:27:20.434920 [debug] [Thread-1 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

  
  SELECT
    -- Primary and Foreign Keys
    transaction_id,
    device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    amount_eur,
    status,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction"
  
  limit 5

[0m08:27:20.435060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:27:20.441908 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.007 seconds
[0m08:27:20.442843 [debug] [Thread-1 (]: On model.sumup.int_transaction: Close
[0m08:27:20.443112 [debug] [Thread-1 (]: Finished running node model.sumup.int_transaction
[0m08:27:20.443524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:27:20.443640 [debug] [MainThread]: Connection 'model.sumup.int_transaction' was properly closed.
[0m08:27:20.443737 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m08:27:20.443829 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m08:27:20.444063 [debug] [MainThread]: Command end result
[0m08:27:20.452116 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:27:20.452714 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:27:20.455141 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m08:27:20.455319 [info ] [MainThread]: Previewing node 'int_transaction':
| transaction_id | device_id | product_id           | product_name  | product_sku   | category_name | ... |
| -------------- | --------- | -------------------- | ------------- | ------------- | ------------- | --- |
|              1 |       169 | d258d27c3831a5a2f... | libero. Morbi | 3770009015048 | amet,         | ... |
|              2 |         9 | 3dec67584ca7a7c31... | hendrerit a,  | 3770009015049 | magna         | ... |
|              3 |        25 | b34ad2e5ea0ca1ef0... | neque vitae   | 3770009015074 | montes,       | ... |
|              4 |        89 | b52ba1b59dca64134... | Sed eu        | 3770009015042 | erat          | ... |
|              5 |        40 | 0f8de273bce571d9c... | dolor. Nulla  | 3770009015049 | Etiam         | ... |

[0m08:27:20.456774 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 0.3766742, "process_in_blocks": "0", "process_kernel_time": 0.12619, "process_mem_max_rss": "125616128", "process_out_blocks": "0", "process_user_time": 0.723831}
[0m08:27:20.456943 [debug] [MainThread]: Command `dbt show` succeeded at 08:27:20.456911 after 0.38 seconds
[0m08:27:20.457077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ba9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a8c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a8d230>]}
[0m08:27:20.457204 [debug] [MainThread]: Flushing usage events
[0m08:27:21.202544 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:07:12.429177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106464050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072a79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072a7c50>]}


============================== 09:07:12.432128 | abf1cc9e-df1f-40e4-843b-97b80cd88a0f ==============================
[0m09:07:12.432128 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:07:12.432407 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'no_print': 'None', 'printer_width': '80', 'debug': 'False', 'invocation_command': 'dbt run -m +customer_store_ranking', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'warn_error': 'None'}
[0m09:07:12.432617 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m09:07:12.432763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'abf1cc9e-df1f-40e4-843b-97b80cd88a0f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10718f6f0>]}
[0m09:07:12.516783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abf1cc9e-df1f-40e4-843b-97b80cd88a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10713acf0>]}
[0m09:07:12.537734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abf1cc9e-df1f-40e4-843b-97b80cd88a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107147d50>]}
[0m09:07:12.538111 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:07:12.576990 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:07:12.631580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m09:07:12.631837 [debug] [MainThread]: Partial parsing: updated file: sumup://models/staging/stg_store.sql
[0m09:07:12.631983 [debug] [MainThread]: Partial parsing: updated file: sumup://models/marts/core/customer_store_ranking.sql
[0m09:07:12.632112 [debug] [MainThread]: Partial parsing: updated file: sumup://models/intermediate/core/int_transaction.sql
[0m09:07:12.720016 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m09:07:12.721935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abf1cc9e-df1f-40e4-843b-97b80cd88a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10825ba70>]}
[0m09:07:12.747434 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:07:12.748700 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:07:12.758885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abf1cc9e-df1f-40e4-843b-97b80cd88a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085559b0>]}
[0m09:07:12.759080 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m09:07:12.759214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abf1cc9e-df1f-40e4-843b-97b80cd88a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108382ea0>]}
[0m09:07:12.759842 [info ] [MainThread]: 
[0m09:07:12.759977 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:07:12.760081 [info ] [MainThread]: 
[0m09:07:12.760272 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:07:12.761665 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:07:12.765443 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:07:12.813221 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:07:12.813406 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:07:12.813532 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:07:12.813656 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:07:12.813778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:07:12.813884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:07:12.900517 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.087 seconds
[0m09:07:12.900754 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.087 seconds
[0m09:07:12.901461 [debug] [ThreadPool]: On list_postgres: Close
[0m09:07:12.902002 [debug] [ThreadPool]: On list_postgres: Close
[0m09:07:12.903079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics)
[0m09:07:12.906159 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:07:12.906392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_analytics)
[0m09:07:12.906543 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m09:07:12.906747 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m09:07:12.907536 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:07:12.907694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:07:12.908628 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:07:12.908760 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m09:07:12.908946 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m09:07:12.909077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:07:12.909194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:07:12.913980 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m09:07:12.914157 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:07:12.914304 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:07:12.914454 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m09:07:12.914605 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:07:12.914746 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m09:07:12.915179 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m09:07:12.915310 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:07:12.915443 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m09:07:12.920655 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m09:07:12.920791 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m09:07:12.921411 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m09:07:12.921547 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m09:07:12.922061 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m09:07:12.922656 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m09:07:12.922801 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m09:07:12.923308 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m09:07:12.923431 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m09:07:12.925936 [debug] [MainThread]: Using postgres connection "master"
[0m09:07:12.926075 [debug] [MainThread]: On master: BEGIN
[0m09:07:12.926188 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:07:12.931265 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:07:12.931392 [debug] [MainThread]: Using postgres connection "master"
[0m09:07:12.931553 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:07:12.938598 [debug] [MainThread]: SQL status: SELECT 5 in 0.007 seconds
[0m09:07:12.939544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abf1cc9e-df1f-40e4-843b-97b80cd88a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084ea750>]}
[0m09:07:12.939743 [debug] [MainThread]: On master: ROLLBACK
[0m09:07:12.939983 [debug] [MainThread]: Using postgres connection "master"
[0m09:07:12.940106 [debug] [MainThread]: On master: BEGIN
[0m09:07:12.940398 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:07:12.940521 [debug] [MainThread]: On master: COMMIT
[0m09:07:12.940641 [debug] [MainThread]: Using postgres connection "master"
[0m09:07:12.940756 [debug] [MainThread]: On master: COMMIT
[0m09:07:12.940947 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:07:12.941066 [debug] [MainThread]: On master: Close
[0m09:07:12.942457 [debug] [Thread-1 (]: Began running node model.sumup.stg_transaction
[0m09:07:12.942694 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_staging.stg_transaction .................. [RUN]
[0m09:07:12.942886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.stg_transaction)
[0m09:07:12.943043 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_transaction
[0m09:07:12.946804 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m09:07:12.947609 [debug] [Thread-1 (]: Began executing node model.sumup.stg_transaction
[0m09:07:12.963500 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_transaction"
[0m09:07:12.964220 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:07:12.964375 [debug] [Thread-1 (]: On model.sumup.stg_transaction: BEGIN
[0m09:07:12.964502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:12.969819 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m09:07:12.969954 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:07:12.970108 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  create view "postgres"."analytics_staging"."stg_transaction__dbt_tmp"
    
    
  as (
    SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) / 100 AS amount_eur,
    LOWER(status) AS status,

    -- Card Information 
    REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '') AS card_number,
    CAST(cvv AS VARCHAR) AS cvv,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  );
[0m09:07:12.979203 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:07:12.981978 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:07:12.982133 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
alter table "postgres"."analytics_staging"."stg_transaction" rename to "stg_transaction__dbt_backup"
[0m09:07:12.982797 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:07:12.983874 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:07:12.984011 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
alter table "postgres"."analytics_staging"."stg_transaction__dbt_tmp" rename to "stg_transaction"
[0m09:07:12.984527 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:07:12.991462 [debug] [Thread-1 (]: On model.sumup.stg_transaction: COMMIT
[0m09:07:12.991617 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:07:12.991744 [debug] [Thread-1 (]: On model.sumup.stg_transaction: COMMIT
[0m09:07:12.992863 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:07:12.995167 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_transaction__dbt_backup"
[0m09:07:12.997046 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:07:12.997185 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
drop view if exists "postgres"."analytics_staging"."stg_transaction__dbt_backup" cascade
[0m09:07:12.999567 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:07:13.000553 [debug] [Thread-1 (]: On model.sumup.stg_transaction: Close
[0m09:07:13.001455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abf1cc9e-df1f-40e4-843b-97b80cd88a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c5440>]}
[0m09:07:13.001748 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_staging.stg_transaction ............. [[32mCREATE VIEW[0m in 0.06s]
[0m09:07:13.001985 [debug] [Thread-1 (]: Finished running node model.sumup.stg_transaction
[0m09:07:13.002268 [debug] [Thread-2 (]: Began running node model.sumup.customer_store_ranking
[0m09:07:13.002515 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics_analytics.customer_store_ranking ......... [RUN]
[0m09:07:13.002715 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.customer_store_ranking)
[0m09:07:13.002858 [debug] [Thread-2 (]: Began compiling node model.sumup.customer_store_ranking
[0m09:07:13.004026 [debug] [Thread-2 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m09:07:13.004448 [debug] [Thread-2 (]: Began executing node model.sumup.customer_store_ranking
[0m09:07:13.005657 [debug] [Thread-2 (]: Writing runtime sql for node "model.sumup.customer_store_ranking"
[0m09:07:13.006071 [debug] [Thread-2 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m09:07:13.006230 [debug] [Thread-2 (]: On model.sumup.customer_store_ranking: BEGIN
[0m09:07:13.006361 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:07:13.011756 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m09:07:13.012073 [debug] [Thread-2 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m09:07:13.012229 [debug] [Thread-2 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  create view "postgres"."analytics_analytics"."customer_store_ranking__dbt_tmp"
    
    
  as (
    SELECT
    s.store_name,
    SUM(t.transacted_amount) AS total_amount
FROM
    "postgres"."analytics_staging"."stg_transaction" 
GROUP BY
    s.store_name
ORDER BY
    total_amount DESC
LIMIT 10
  );
[0m09:07:13.012801 [debug] [Thread-2 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "s"
LINE 8:     s.store_name,
            ^

[0m09:07:13.012932 [debug] [Thread-2 (]: On model.sumup.customer_store_ranking: ROLLBACK
[0m09:07:13.013166 [debug] [Thread-2 (]: On model.sumup.customer_store_ranking: Close
[0m09:07:13.018413 [debug] [Thread-2 (]: Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  missing FROM-clause entry for table "s"
  LINE 8:     s.store_name,
              ^
  compiled code at target/run/sumup/models/marts/core/customer_store_ranking.sql
[0m09:07:13.018629 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abf1cc9e-df1f-40e4-843b-97b80cd88a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fbcd70>]}
[0m09:07:13.018902 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model analytics_analytics.customer_store_ranking  [[31mERROR[0m in 0.02s]
[0m09:07:13.019137 [debug] [Thread-2 (]: Finished running node model.sumup.customer_store_ranking
[0m09:07:13.019347 [debug] [Thread-7 (]: Marking all children of 'model.sumup.customer_store_ranking' to be skipped because of status 'error'.  Reason: Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  missing FROM-clause entry for table "s"
  LINE 8:     s.store_name,
              ^
  compiled code at target/run/sumup/models/marts/core/customer_store_ranking.sql.
[0m09:07:13.020140 [debug] [MainThread]: Using postgres connection "master"
[0m09:07:13.020255 [debug] [MainThread]: On master: BEGIN
[0m09:07:13.020355 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:07:13.024007 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:07:13.024133 [debug] [MainThread]: On master: COMMIT
[0m09:07:13.024236 [debug] [MainThread]: Using postgres connection "master"
[0m09:07:13.024331 [debug] [MainThread]: On master: COMMIT
[0m09:07:13.024527 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:07:13.024622 [debug] [MainThread]: On master: Close
[0m09:07:13.024758 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:07:13.024851 [debug] [MainThread]: Connection 'model.sumup.stg_transaction' was properly closed.
[0m09:07:13.024939 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m09:07:13.025022 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m09:07:13.025149 [info ] [MainThread]: 
[0m09:07:13.025273 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m09:07:13.025612 [debug] [MainThread]: Command end result
[0m09:07:13.034437 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:07:13.035142 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:07:13.037528 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:07:13.037639 [info ] [MainThread]: 
[0m09:07:13.037771 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:07:13.037934 [info ] [MainThread]: 
[0m09:07:13.038104 [error] [MainThread]: [31mFailure in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)[0m
[0m09:07:13.038254 [error] [MainThread]:   Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  missing FROM-clause entry for table "s"
  LINE 8:     s.store_name,
              ^
  compiled code at target/run/sumup/models/marts/core/customer_store_ranking.sql
[0m09:07:13.038364 [info ] [MainThread]: 
[0m09:07:13.038492 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/marts/core/customer_store_ranking.sql
[0m09:07:13.038599 [info ] [MainThread]: 
[0m09:07:13.038720 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m09:07:13.039001 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m09:07:13.041733 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.647831, "process_in_blocks": "0", "process_kernel_time": 0.142941, "process_mem_max_rss": "129335296", "process_out_blocks": "0", "process_user_time": 0.881028}
[0m09:07:13.041943 [debug] [MainThread]: Command `dbt run` failed at 09:07:13.041909 after 0.65 seconds
[0m09:07:13.042099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ce8dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10850b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073383d0>]}
[0m09:07:13.042243 [debug] [MainThread]: Flushing usage events
[0m09:07:13.771743 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:07:30.552708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bc0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a079d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a07c50>]}


============================== 09:07:30.555155 | 39165691-de1d-4587-933e-3031a76e7199 ==============================
[0m09:07:30.555155 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:07:30.555421 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'target_path': 'None', 'static_parser': 'True', 'debug': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'printer_width': '80', 'empty': 'False', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'invocation_command': 'dbt run -m customer_store_ranking', 'warn_error': 'None'}
[0m09:07:30.555620 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m09:07:30.555769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '39165691-de1d-4587-933e-3031a76e7199', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048eb6f0>]}
[0m09:07:30.635250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39165691-de1d-4587-933e-3031a76e7199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104896cf0>]}
[0m09:07:30.656026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39165691-de1d-4587-933e-3031a76e7199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048a3d50>]}
[0m09:07:30.656544 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:07:30.695838 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:07:30.743652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:07:30.743818 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:07:30.745931 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m09:07:30.759469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39165691-de1d-4587-933e-3031a76e7199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b1d60>]}
[0m09:07:30.784495 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:07:30.785618 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:07:30.795482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39165691-de1d-4587-933e-3031a76e7199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10512f150>]}
[0m09:07:30.795726 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m09:07:30.795863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39165691-de1d-4587-933e-3031a76e7199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105adb790>]}
[0m09:07:30.796505 [info ] [MainThread]: 
[0m09:07:30.796641 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:07:30.796747 [info ] [MainThread]: 
[0m09:07:30.796951 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:07:30.797358 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:07:30.819133 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:07:30.819321 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:07:30.819428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:07:30.836956 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.017 seconds
[0m09:07:30.837497 [debug] [ThreadPool]: On list_postgres: Close
[0m09:07:30.839434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m09:07:30.841654 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:07:30.841836 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m09:07:30.841958 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m09:07:30.842141 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m09:07:30.842748 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:07:30.842876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:07:30.843677 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:07:30.843782 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m09:07:30.843929 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m09:07:30.844046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:07:30.844175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:07:30.848981 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m09:07:30.849180 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m09:07:30.849308 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:07:30.849432 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m09:07:30.849545 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:07:30.849675 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m09:07:30.849793 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:07:30.849904 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m09:07:30.850046 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:07:30.856124 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m09:07:30.856654 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m09:07:30.856763 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m09:07:30.857167 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m09:07:30.857267 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m09:07:30.857385 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m09:07:30.857514 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m09:07:30.858017 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m09:07:30.858457 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m09:07:30.860417 [debug] [MainThread]: Using postgres connection "master"
[0m09:07:30.860534 [debug] [MainThread]: On master: BEGIN
[0m09:07:30.860624 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:07:30.864929 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:07:30.865030 [debug] [MainThread]: Using postgres connection "master"
[0m09:07:30.865152 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:07:30.870186 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m09:07:30.870821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39165691-de1d-4587-933e-3031a76e7199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b047d0>]}
[0m09:07:30.870982 [debug] [MainThread]: On master: ROLLBACK
[0m09:07:30.871235 [debug] [MainThread]: Using postgres connection "master"
[0m09:07:30.871331 [debug] [MainThread]: On master: BEGIN
[0m09:07:30.871605 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:07:30.871700 [debug] [MainThread]: On master: COMMIT
[0m09:07:30.871791 [debug] [MainThread]: Using postgres connection "master"
[0m09:07:30.871877 [debug] [MainThread]: On master: COMMIT
[0m09:07:30.872037 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:07:30.872131 [debug] [MainThread]: On master: Close
[0m09:07:30.873231 [debug] [Thread-1 (]: Began running node model.sumup.customer_store_ranking
[0m09:07:30.873415 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_analytics.customer_store_ranking ......... [RUN]
[0m09:07:30.873576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.customer_store_ranking)
[0m09:07:30.873706 [debug] [Thread-1 (]: Began compiling node model.sumup.customer_store_ranking
[0m09:07:30.876642 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m09:07:30.876913 [debug] [Thread-1 (]: Began executing node model.sumup.customer_store_ranking
[0m09:07:30.890627 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.customer_store_ranking"
[0m09:07:30.891009 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m09:07:30.891136 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: BEGIN
[0m09:07:30.891248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:30.896472 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m09:07:30.896616 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m09:07:30.896744 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  create view "postgres"."analytics_analytics"."customer_store_ranking__dbt_tmp"
    
    
  as (
    SELECT
    s.store_name,
    SUM(t.transacted_amount) AS total_amount
FROM
    "postgres"."analytics_staging"."stg_transaction" 
GROUP BY
    s.store_name
ORDER BY
    total_amount DESC
LIMIT 10
  );
[0m09:07:30.897758 [debug] [Thread-1 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "s"
LINE 8:     s.store_name,
            ^

[0m09:07:30.897881 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: ROLLBACK
[0m09:07:30.898125 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: Close
[0m09:07:30.902741 [debug] [Thread-1 (]: Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  missing FROM-clause entry for table "s"
  LINE 8:     s.store_name,
              ^
  compiled code at target/run/sumup/models/marts/core/customer_store_ranking.sql
[0m09:07:30.903550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39165691-de1d-4587-933e-3031a76e7199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e49700>]}
[0m09:07:30.903806 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_analytics.customer_store_ranking  [[31mERROR[0m in 0.03s]
[0m09:07:30.904035 [debug] [Thread-1 (]: Finished running node model.sumup.customer_store_ranking
[0m09:07:30.904240 [debug] [Thread-7 (]: Marking all children of 'model.sumup.customer_store_ranking' to be skipped because of status 'error'.  Reason: Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  missing FROM-clause entry for table "s"
  LINE 8:     s.store_name,
              ^
  compiled code at target/run/sumup/models/marts/core/customer_store_ranking.sql.
[0m09:07:30.904954 [debug] [MainThread]: Using postgres connection "master"
[0m09:07:30.905073 [debug] [MainThread]: On master: BEGIN
[0m09:07:30.905163 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:07:30.910052 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:07:30.910160 [debug] [MainThread]: On master: COMMIT
[0m09:07:30.910258 [debug] [MainThread]: Using postgres connection "master"
[0m09:07:30.910377 [debug] [MainThread]: On master: COMMIT
[0m09:07:30.910540 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:07:30.910644 [debug] [MainThread]: On master: Close
[0m09:07:30.910779 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:07:30.910867 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m09:07:30.910954 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m09:07:30.911039 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m09:07:30.911145 [info ] [MainThread]: 
[0m09:07:30.911262 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m09:07:30.911517 [debug] [MainThread]: Command end result
[0m09:07:30.921477 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:07:30.922342 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:07:30.924972 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:07:30.925097 [info ] [MainThread]: 
[0m09:07:30.925242 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:07:30.925357 [info ] [MainThread]: 
[0m09:07:30.925498 [error] [MainThread]: [31mFailure in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)[0m
[0m09:07:30.925635 [error] [MainThread]:   Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  missing FROM-clause entry for table "s"
  LINE 8:     s.store_name,
              ^
  compiled code at target/run/sumup/models/marts/core/customer_store_ranking.sql
[0m09:07:30.925736 [info ] [MainThread]: 
[0m09:07:30.925858 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/marts/core/customer_store_ranking.sql
[0m09:07:30.925957 [info ] [MainThread]: 
[0m09:07:30.926070 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m09:07:30.926272 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m09:07:30.927910 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.4020693, "process_in_blocks": "0", "process_kernel_time": 0.11412, "process_mem_max_rss": "126238720", "process_out_blocks": "0", "process_user_time": 0.747289}
[0m09:07:30.928097 [debug] [MainThread]: Command `dbt run` failed at 09:07:30.928063 after 0.40 seconds
[0m09:07:30.928245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e17e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b1bbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10571d2d0>]}
[0m09:07:30.928377 [debug] [MainThread]: Flushing usage events
[0m09:07:31.630122 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:07:45.972728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10436c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051af9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051afc50>]}


============================== 09:07:45.975140 | 43427202-bcc1-44f4-8e9d-f4d8da41ea11 ==============================
[0m09:07:45.975140 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:07:45.975388 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'printer_width': '80', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'static_parser': 'True', 'invocation_command': 'dbt run -m customer_store_ranking', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'introspect': 'True', 'debug': 'False', 'warn_error': 'None', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'quiet': 'False', 'use_colors': 'True'}
[0m09:07:45.975589 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m09:07:45.975727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '43427202-bcc1-44f4-8e9d-f4d8da41ea11', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050976f0>]}
[0m09:07:46.051396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43427202-bcc1-44f4-8e9d-f4d8da41ea11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105042cf0>]}
[0m09:07:46.071893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43427202-bcc1-44f4-8e9d-f4d8da41ea11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10504fd50>]}
[0m09:07:46.072253 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:07:46.110454 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:07:46.158979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:07:46.159220 [debug] [MainThread]: Partial parsing: updated file: sumup://models/marts/core/customer_store_ranking.sql
[0m09:07:46.244362 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m09:07:46.246244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43427202-bcc1-44f4-8e9d-f4d8da41ea11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106162e40>]}
[0m09:07:46.270816 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:07:46.271847 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:07:46.281108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43427202-bcc1-44f4-8e9d-f4d8da41ea11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064457f0>]}
[0m09:07:46.281294 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m09:07:46.281427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43427202-bcc1-44f4-8e9d-f4d8da41ea11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064276c0>]}
[0m09:07:46.282039 [info ] [MainThread]: 
[0m09:07:46.282176 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:07:46.282283 [info ] [MainThread]: 
[0m09:07:46.282472 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:07:46.282797 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:07:46.329016 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:07:46.329214 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:07:46.329329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:07:46.346189 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.017 seconds
[0m09:07:46.346975 [debug] [ThreadPool]: On list_postgres: Close
[0m09:07:46.349333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_analytics)
[0m09:07:46.351778 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:07:46.351982 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m09:07:46.352130 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m09:07:46.352312 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m09:07:46.353239 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:07:46.353379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:07:46.354052 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:07:46.354186 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m09:07:46.354413 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m09:07:46.354544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:07:46.354675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:07:46.360180 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m09:07:46.360319 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:07:46.360444 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m09:07:46.360591 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m09:07:46.360738 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:07:46.360868 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m09:07:46.361001 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m09:07:46.361131 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:07:46.361254 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:07:46.367017 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m09:07:46.367129 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m09:07:46.367707 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m09:07:46.367829 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m09:07:46.368255 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m09:07:46.368699 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m09:07:46.368817 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m09:07:46.368930 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m09:07:46.369165 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m09:07:46.371659 [debug] [MainThread]: Using postgres connection "master"
[0m09:07:46.371778 [debug] [MainThread]: On master: BEGIN
[0m09:07:46.371873 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:07:46.376093 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:07:46.376207 [debug] [MainThread]: Using postgres connection "master"
[0m09:07:46.376348 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:07:46.381425 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m09:07:46.382132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43427202-bcc1-44f4-8e9d-f4d8da41ea11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063fe810>]}
[0m09:07:46.382296 [debug] [MainThread]: On master: ROLLBACK
[0m09:07:46.382499 [debug] [MainThread]: Using postgres connection "master"
[0m09:07:46.382590 [debug] [MainThread]: On master: BEGIN
[0m09:07:46.382846 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:07:46.382939 [debug] [MainThread]: On master: COMMIT
[0m09:07:46.383029 [debug] [MainThread]: Using postgres connection "master"
[0m09:07:46.383113 [debug] [MainThread]: On master: COMMIT
[0m09:07:46.383275 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:07:46.383368 [debug] [MainThread]: On master: Close
[0m09:07:46.384504 [debug] [Thread-1 (]: Began running node model.sumup.customer_store_ranking
[0m09:07:46.384691 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_analytics.customer_store_ranking ......... [RUN]
[0m09:07:46.384866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.customer_store_ranking)
[0m09:07:46.384989 [debug] [Thread-1 (]: Began compiling node model.sumup.customer_store_ranking
[0m09:07:46.388006 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m09:07:46.388299 [debug] [Thread-1 (]: Began executing node model.sumup.customer_store_ranking
[0m09:07:46.402166 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.customer_store_ranking"
[0m09:07:46.402554 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m09:07:46.402685 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: BEGIN
[0m09:07:46.402803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:46.406362 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m09:07:46.406510 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m09:07:46.406637 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  create view "postgres"."analytics_analytics"."customer_store_ranking__dbt_tmp"
    
    
  as (
    SELECT
    store_name,
    SUM(t.transacted_amount) AS total_amount
FROM
    "postgres"."analytics_staging"."stg_transaction" 
GROUP BY
    store_name
ORDER BY
    total_amount DESC
LIMIT 10
  );
[0m09:07:46.407522 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "store_name" does not exist
LINE 8:     store_name,
            ^

[0m09:07:46.407648 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: ROLLBACK
[0m09:07:46.407868 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: Close
[0m09:07:46.412511 [debug] [Thread-1 (]: Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  column "store_name" does not exist
  LINE 8:     store_name,
              ^
  compiled code at target/run/sumup/models/marts/core/customer_store_ranking.sql
[0m09:07:46.413296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43427202-bcc1-44f4-8e9d-f4d8da41ea11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063be2b0>]}
[0m09:07:46.413549 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_analytics.customer_store_ranking  [[31mERROR[0m in 0.03s]
[0m09:07:46.413778 [debug] [Thread-1 (]: Finished running node model.sumup.customer_store_ranking
[0m09:07:46.413981 [debug] [Thread-7 (]: Marking all children of 'model.sumup.customer_store_ranking' to be skipped because of status 'error'.  Reason: Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  column "store_name" does not exist
  LINE 8:     store_name,
              ^
  compiled code at target/run/sumup/models/marts/core/customer_store_ranking.sql.
[0m09:07:46.414711 [debug] [MainThread]: Using postgres connection "master"
[0m09:07:46.414842 [debug] [MainThread]: On master: BEGIN
[0m09:07:46.414947 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:07:46.419849 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:07:46.419960 [debug] [MainThread]: On master: COMMIT
[0m09:07:46.420109 [debug] [MainThread]: Using postgres connection "master"
[0m09:07:46.420208 [debug] [MainThread]: On master: COMMIT
[0m09:07:46.420378 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:07:46.420526 [debug] [MainThread]: On master: Close
[0m09:07:46.420688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:07:46.420797 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m09:07:46.420895 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m09:07:46.420986 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m09:07:46.421096 [info ] [MainThread]: 
[0m09:07:46.421215 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m09:07:46.421477 [debug] [MainThread]: Command end result
[0m09:07:46.430294 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:07:46.431063 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:07:46.433397 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:07:46.433515 [info ] [MainThread]: 
[0m09:07:46.433657 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:07:46.433776 [info ] [MainThread]: 
[0m09:07:46.433918 [error] [MainThread]: [31mFailure in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)[0m
[0m09:07:46.434055 [error] [MainThread]:   Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  column "store_name" does not exist
  LINE 8:     store_name,
              ^
  compiled code at target/run/sumup/models/marts/core/customer_store_ranking.sql
[0m09:07:46.434162 [info ] [MainThread]: 
[0m09:07:46.434286 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/marts/core/customer_store_ranking.sql
[0m09:07:46.434387 [info ] [MainThread]: 
[0m09:07:46.434503 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m09:07:46.434701 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m09:07:46.436333 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.49076095, "process_in_blocks": "0", "process_kernel_time": 0.104602, "process_mem_max_rss": "128761856", "process_out_blocks": "0", "process_user_time": 0.838074}
[0m09:07:46.436516 [debug] [MainThread]: Command `dbt run` failed at 09:07:46.436483 after 0.49 seconds
[0m09:07:46.436661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f38410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106788dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106203750>]}
[0m09:07:46.436791 [debug] [MainThread]: Flushing usage events
[0m09:07:47.145065 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:08:05.559058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106218050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107737c50>]}


============================== 09:08:05.561477 | 6e542f6f-cf85-4601-8769-91f6950c4c05 ==============================
[0m09:08:05.561477 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:08:05.561733 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'static_parser': 'True', 'write_json': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'no_print': 'None', 'invocation_command': 'dbt run -m customer_store_ranking', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'debug': 'False', 'use_colors': 'True', 'quiet': 'False', 'empty': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'log_format': 'default', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'target_path': 'None', 'cache_selected_only': 'False'}
[0m09:08:05.561932 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m09:08:05.562078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6e542f6f-cf85-4601-8769-91f6950c4c05', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10761f6f0>]}
[0m09:08:05.637173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e542f6f-cf85-4601-8769-91f6950c4c05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075cacf0>]}
[0m09:08:05.657497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e542f6f-cf85-4601-8769-91f6950c4c05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d7d50>]}
[0m09:08:05.658003 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:08:05.695729 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:08:05.743845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:08:05.744093 [debug] [MainThread]: Partial parsing: updated file: sumup://models/marts/core/customer_store_ranking.sql
[0m09:08:05.829334 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m09:08:05.831188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e542f6f-cf85-4601-8769-91f6950c4c05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088bee40>]}
[0m09:08:05.856447 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:08:05.857504 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:08:05.867130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e542f6f-cf85-4601-8769-91f6950c4c05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e9d7f0>]}
[0m09:08:05.867336 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m09:08:05.867474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e542f6f-cf85-4601-8769-91f6950c4c05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e7f6c0>]}
[0m09:08:05.868112 [info ] [MainThread]: 
[0m09:08:05.868252 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:08:05.868360 [info ] [MainThread]: 
[0m09:08:05.868566 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:08:05.868913 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:08:05.916267 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:08:05.916469 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:08:05.916594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:08:05.933626 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.017 seconds
[0m09:08:05.934220 [debug] [ThreadPool]: On list_postgres: Close
[0m09:08:05.936117 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_analytics)
[0m09:08:05.938385 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:08:05.938562 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m09:08:05.938674 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m09:08:05.938864 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m09:08:05.939641 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:08:05.939773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:08:05.940363 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:08:05.940474 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m09:08:05.940635 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m09:08:05.940749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:08:05.940854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:08:05.944925 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m09:08:05.945058 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m09:08:05.945163 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m09:08:05.945266 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:08:05.945371 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:08:05.945466 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:08:05.945574 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m09:08:05.945694 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m09:08:05.945810 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:08:05.948798 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m09:08:05.948906 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m09:08:05.949370 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m09:08:05.949478 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m09:08:05.949879 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m09:08:05.950345 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m09:08:05.950464 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m09:08:05.950570 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m09:08:05.950758 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m09:08:05.952885 [debug] [MainThread]: Using postgres connection "master"
[0m09:08:05.953007 [debug] [MainThread]: On master: BEGIN
[0m09:08:05.953099 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:08:05.958031 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:08:05.958134 [debug] [MainThread]: Using postgres connection "master"
[0m09:08:05.958265 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:08:05.965784 [debug] [MainThread]: SQL status: SELECT 4 in 0.007 seconds
[0m09:08:05.966449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e542f6f-cf85-4601-8769-91f6950c4c05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e3a810>]}
[0m09:08:05.966601 [debug] [MainThread]: On master: ROLLBACK
[0m09:08:05.966839 [debug] [MainThread]: Using postgres connection "master"
[0m09:08:05.966933 [debug] [MainThread]: On master: BEGIN
[0m09:08:05.967257 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:08:05.967354 [debug] [MainThread]: On master: COMMIT
[0m09:08:05.967447 [debug] [MainThread]: Using postgres connection "master"
[0m09:08:05.967534 [debug] [MainThread]: On master: COMMIT
[0m09:08:05.967732 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:08:05.967826 [debug] [MainThread]: On master: Close
[0m09:08:05.968933 [debug] [Thread-1 (]: Began running node model.sumup.customer_store_ranking
[0m09:08:05.969112 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_analytics.customer_store_ranking ......... [RUN]
[0m09:08:05.969272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.customer_store_ranking)
[0m09:08:05.969402 [debug] [Thread-1 (]: Began compiling node model.sumup.customer_store_ranking
[0m09:08:05.972432 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m09:08:05.972718 [debug] [Thread-1 (]: Began executing node model.sumup.customer_store_ranking
[0m09:08:05.986125 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.customer_store_ranking"
[0m09:08:05.986497 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m09:08:05.986624 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: BEGIN
[0m09:08:05.986739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:08:05.990279 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m09:08:05.990421 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m09:08:05.990549 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  create view "postgres"."analytics_analytics"."customer_store_ranking__dbt_tmp"
    
    
  as (
    SELECT
    store_name,
    SUM(t.transacted_amount) AS total_amount
FROM
    "postgres"."analytics_analytics"."int_transaction" 
GROUP BY
    store_name
ORDER BY
    total_amount DESC
LIMIT 10
  );
[0m09:08:05.991546 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "analytics_analytics.int_transaction" does not exist
LINE 11:     "postgres"."analytics_analytics"."int_transaction" 
             ^

[0m09:08:05.991672 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: ROLLBACK
[0m09:08:05.991877 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: Close
[0m09:08:05.996615 [debug] [Thread-1 (]: Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  relation "analytics_analytics.int_transaction" does not exist
  LINE 11:     "postgres"."analytics_analytics"."int_transaction" 
               ^
  compiled code at target/run/sumup/models/marts/core/customer_store_ranking.sql
[0m09:08:05.997401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e542f6f-cf85-4601-8769-91f6950c4c05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e162b0>]}
[0m09:08:05.997651 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_analytics.customer_store_ranking  [[31mERROR[0m in 0.03s]
[0m09:08:05.997880 [debug] [Thread-1 (]: Finished running node model.sumup.customer_store_ranking
[0m09:08:05.998087 [debug] [Thread-7 (]: Marking all children of 'model.sumup.customer_store_ranking' to be skipped because of status 'error'.  Reason: Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  relation "analytics_analytics.int_transaction" does not exist
  LINE 11:     "postgres"."analytics_analytics"."int_transaction" 
               ^
  compiled code at target/run/sumup/models/marts/core/customer_store_ranking.sql.
[0m09:08:05.998845 [debug] [MainThread]: Using postgres connection "master"
[0m09:08:05.998976 [debug] [MainThread]: On master: BEGIN
[0m09:08:05.999077 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:08:06.004300 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:08:06.004422 [debug] [MainThread]: On master: COMMIT
[0m09:08:06.004527 [debug] [MainThread]: Using postgres connection "master"
[0m09:08:06.004618 [debug] [MainThread]: On master: COMMIT
[0m09:08:06.004755 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:08:06.004844 [debug] [MainThread]: On master: Close
[0m09:08:06.004984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:08:06.005114 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m09:08:06.005215 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m09:08:06.005309 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m09:08:06.005423 [info ] [MainThread]: 
[0m09:08:06.005544 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m09:08:06.005797 [debug] [MainThread]: Command end result
[0m09:08:06.014455 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:08:06.015368 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:08:06.017611 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:08:06.017722 [info ] [MainThread]: 
[0m09:08:06.017860 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:08:06.017972 [info ] [MainThread]: 
[0m09:08:06.018115 [error] [MainThread]: [31mFailure in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)[0m
[0m09:08:06.018252 [error] [MainThread]:   Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  relation "analytics_analytics.int_transaction" does not exist
  LINE 11:     "postgres"."analytics_analytics"."int_transaction" 
               ^
  compiled code at target/run/sumup/models/marts/core/customer_store_ranking.sql
[0m09:08:06.018355 [info ] [MainThread]: 
[0m09:08:06.018478 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/marts/core/customer_store_ranking.sql
[0m09:08:06.018575 [info ] [MainThread]: 
[0m09:08:06.018689 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m09:08:06.018891 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m09:08:06.020357 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.48710233, "process_in_blocks": "0", "process_kernel_time": 0.11663, "process_mem_max_rss": "130088960", "process_out_blocks": "0", "process_user_time": 0.838735}
[0m09:08:06.020512 [debug] [MainThread]: Command `dbt run` failed at 09:08:06.020480 after 0.49 seconds
[0m09:08:06.020641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108414410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9e8ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108926b50>]}
[0m09:08:06.020786 [debug] [MainThread]: Flushing usage events
[0m09:08:06.755655 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:08:22.981384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10599c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067df9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067dfc50>]}


============================== 09:08:22.983789 | 14355a71-c8b1-491e-b0d2-4c7de82024fc ==============================
[0m09:08:22.983789 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:08:22.984059 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'partial_parse': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'log_cache_events': 'False', 'version_check': 'True', 'empty': 'False', 'printer_width': '80', 'introspect': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'no_print': 'None', 'write_json': 'True', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'warn_error': 'None', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'static_parser': 'True', 'debug': 'False', 'invocation_command': 'dbt run -m +customer_store_ranking'}
[0m09:08:22.984262 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m09:08:22.984410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '14355a71-c8b1-491e-b0d2-4c7de82024fc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c36f0>]}
[0m09:08:23.063695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14355a71-c8b1-491e-b0d2-4c7de82024fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10666ecf0>]}
[0m09:08:23.083962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14355a71-c8b1-491e-b0d2-4c7de82024fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106677d50>]}
[0m09:08:23.084468 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:08:23.123277 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:08:23.171790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:08:23.171950 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:08:23.174020 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m09:08:23.187682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14355a71-c8b1-491e-b0d2-4c7de82024fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107791d60>]}
[0m09:08:23.212480 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:08:23.213439 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:08:23.222882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14355a71-c8b1-491e-b0d2-4c7de82024fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e4f150>]}
[0m09:08:23.223064 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m09:08:23.223198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14355a71-c8b1-491e-b0d2-4c7de82024fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b76c0>]}
[0m09:08:23.223906 [info ] [MainThread]: 
[0m09:08:23.224037 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:08:23.224143 [info ] [MainThread]: 
[0m09:08:23.224333 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:08:23.225808 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:08:23.230198 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:08:23.247126 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:08:23.247307 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:08:23.247432 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:08:23.247550 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:08:23.247659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:08:23.247754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:08:23.267021 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.019 seconds
[0m09:08:23.267201 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.020 seconds
[0m09:08:23.267735 [debug] [ThreadPool]: On list_postgres: Close
[0m09:08:23.268147 [debug] [ThreadPool]: On list_postgres: Close
[0m09:08:23.268979 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m09:08:23.271335 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:08:23.271506 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_analytics)
[0m09:08:23.271629 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m09:08:23.271802 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m09:08:23.272462 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:08:23.272574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:08:23.273350 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:08:23.273454 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m09:08:23.273599 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m09:08:23.273709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:08:23.273822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:08:23.278393 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m09:08:23.278506 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m09:08:23.278608 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:08:23.278704 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m09:08:23.278808 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:08:23.278914 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m09:08:23.279020 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:08:23.279123 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:08:23.279263 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m09:08:23.284999 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m09:08:23.285466 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m09:08:23.285631 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m09:08:23.286026 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m09:08:23.286128 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m09:08:23.286245 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m09:08:23.286366 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m09:08:23.287031 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m09:08:23.287388 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m09:08:23.289241 [debug] [MainThread]: Using postgres connection "master"
[0m09:08:23.289346 [debug] [MainThread]: On master: BEGIN
[0m09:08:23.289432 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:08:23.294315 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:08:23.294419 [debug] [MainThread]: Using postgres connection "master"
[0m09:08:23.294550 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:08:23.301220 [debug] [MainThread]: SQL status: SELECT 4 in 0.007 seconds
[0m09:08:23.301886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14355a71-c8b1-491e-b0d2-4c7de82024fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107931fd0>]}
[0m09:08:23.302040 [debug] [MainThread]: On master: ROLLBACK
[0m09:08:23.302367 [debug] [MainThread]: Using postgres connection "master"
[0m09:08:23.302461 [debug] [MainThread]: On master: BEGIN
[0m09:08:23.302745 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:08:23.302845 [debug] [MainThread]: On master: COMMIT
[0m09:08:23.302938 [debug] [MainThread]: Using postgres connection "master"
[0m09:08:23.303027 [debug] [MainThread]: On master: COMMIT
[0m09:08:23.303201 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:08:23.303439 [debug] [MainThread]: On master: Close
[0m09:08:23.304569 [debug] [Thread-3 (]: Began running node model.sumup.stg_transaction
[0m09:08:23.304715 [debug] [Thread-2 (]: Began running node model.sumup.stg_store
[0m09:08:23.304855 [debug] [Thread-1 (]: Began running node model.sumup.stg_device
[0m09:08:23.307516 [info ] [Thread-3 (]: 3 of 5 START sql view model analytics_staging.stg_transaction .................. [RUN]
[0m09:08:23.307738 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics_staging.stg_store ........................ [RUN]
[0m09:08:23.307931 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics_staging.stg_device ....................... [RUN]
[0m09:08:23.308113 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.stg_transaction)
[0m09:08:23.310482 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.stg_store)
[0m09:08:23.310931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.stg_device)
[0m09:08:23.311069 [debug] [Thread-3 (]: Began compiling node model.sumup.stg_transaction
[0m09:08:23.311201 [debug] [Thread-2 (]: Began compiling node model.sumup.stg_store
[0m09:08:23.313414 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_device
[0m09:08:23.317322 [debug] [Thread-3 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m09:08:23.318407 [debug] [Thread-2 (]: Writing injected SQL for node "model.sumup.stg_store"
[0m09:08:23.319357 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_device"
[0m09:08:23.320364 [debug] [Thread-2 (]: Began executing node model.sumup.stg_store
[0m09:08:23.320546 [debug] [Thread-3 (]: Began executing node model.sumup.stg_transaction
[0m09:08:23.326794 [debug] [Thread-1 (]: Began executing node model.sumup.stg_device
[0m09:08:23.335128 [debug] [Thread-3 (]: Writing runtime sql for node "model.sumup.stg_transaction"
[0m09:08:23.336051 [debug] [Thread-2 (]: Writing runtime sql for node "model.sumup.stg_store"
[0m09:08:23.337122 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_device"
[0m09:08:23.337485 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:08:23.337638 [debug] [Thread-1 (]: On model.sumup.stg_device: BEGIN
[0m09:08:23.337758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:08:23.337909 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:08:23.338120 [debug] [Thread-2 (]: On model.sumup.stg_store: BEGIN
[0m09:08:23.338228 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:08:23.338404 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:08:23.338547 [debug] [Thread-3 (]: On model.sumup.stg_transaction: BEGIN
[0m09:08:23.338667 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:08:23.343138 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m09:08:23.343264 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m09:08:23.343381 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:08:23.343510 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:08:23.343662 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */

  create view "postgres"."analytics_staging"."stg_store__dbt_tmp"
    
    
  as (
    

SELECT
    -- Primary Key: Rename to be explicit
    id AS store_id,
    name AS store_name,

    -- Descriptive Attributes: Rename 'typology' for clarity
    typology AS store_typology,
    country,
    city
    
    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-21 07:08:22.973550+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."store"
  );
[0m09:08:23.343814 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m09:08:23.343946 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */

  create view "postgres"."analytics_staging"."stg_device__dbt_tmp"
    
    
  as (
    

SELECT
    -- Primary Key
    id AS device_id,

    -- Foreign Key to stores (assuming this links the device to a specific store)
    store_id,

    -- Descriptive Attributes
    type as device_type
    
    -- Other fields, if any, standardized here
    -- e.g., CAST(status AS VARCHAR) AS device_status

    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-21 07:08:22.973550+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."device"
  );
[0m09:08:23.344101 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:08:23.344265 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  create view "postgres"."analytics_staging"."stg_transaction__dbt_tmp"
    
    
  as (
    SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) / 100 AS amount_eur,
    LOWER(status) AS status,

    -- Card Information 
    REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '') AS card_number,
    CAST(cvv AS VARCHAR) AS cvv,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  );
[0m09:08:23.347573 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:08:23.347710 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:08:23.351671 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:08:23.351807 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:08:23.352836 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:08:23.352967 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */
alter table "postgres"."analytics_staging"."stg_device" rename to "stg_device__dbt_backup"
[0m09:08:23.353918 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:08:23.354098 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */
alter table "postgres"."analytics_staging"."stg_store" rename to "stg_store__dbt_backup"
[0m09:08:23.354252 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
alter table "postgres"."analytics_staging"."stg_transaction" rename to "stg_transaction__dbt_backup"
[0m09:08:23.354633 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:08:23.379113 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m09:08:23.379316 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m09:08:23.379958 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:08:23.380977 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:08:23.382035 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:08:23.382175 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */
alter table "postgres"."analytics_staging"."stg_device__dbt_tmp" rename to "stg_device"
[0m09:08:23.382306 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
alter table "postgres"."analytics_staging"."stg_transaction__dbt_tmp" rename to "stg_transaction"
[0m09:08:23.382429 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */
alter table "postgres"."analytics_staging"."stg_store__dbt_tmp" rename to "stg_store"
[0m09:08:23.383015 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:08:23.383150 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:08:23.389274 [debug] [Thread-2 (]: On model.sumup.stg_store: COMMIT
[0m09:08:23.389460 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m09:08:23.390044 [debug] [Thread-1 (]: On model.sumup.stg_device: COMMIT
[0m09:08:23.390178 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:08:23.390676 [debug] [Thread-3 (]: On model.sumup.stg_transaction: COMMIT
[0m09:08:23.390806 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:08:23.390924 [debug] [Thread-2 (]: On model.sumup.stg_store: COMMIT
[0m09:08:23.391041 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:08:23.391153 [debug] [Thread-1 (]: On model.sumup.stg_device: COMMIT
[0m09:08:23.391283 [debug] [Thread-3 (]: On model.sumup.stg_transaction: COMMIT
[0m09:08:23.391911 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:08:23.394034 [debug] [Thread-2 (]: Applying DROP to: "postgres"."analytics_staging"."stg_store__dbt_backup"
[0m09:08:23.394167 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m09:08:23.396038 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:08:23.396166 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m09:08:23.396995 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_device__dbt_backup"
[0m09:08:23.397129 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */
drop view if exists "postgres"."analytics_staging"."stg_store__dbt_backup" cascade
[0m09:08:23.397803 [debug] [Thread-3 (]: Applying DROP to: "postgres"."analytics_staging"."stg_transaction__dbt_backup"
[0m09:08:23.398040 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:08:23.398290 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:08:23.398416 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */
drop view if exists "postgres"."analytics_staging"."stg_device__dbt_backup" cascade
[0m09:08:23.398540 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
drop view if exists "postgres"."analytics_staging"."stg_transaction__dbt_backup" cascade
[0m09:08:23.399646 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:08:23.400528 [debug] [Thread-2 (]: On model.sumup.stg_store: Close
[0m09:08:23.400672 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:08:23.400809 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:08:23.401712 [debug] [Thread-3 (]: On model.sumup.stg_transaction: Close
[0m09:08:23.402132 [debug] [Thread-1 (]: On model.sumup.stg_device: Close
[0m09:08:23.402601 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14355a71-c8b1-491e-b0d2-4c7de82024fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b29860>]}
[0m09:08:23.402726 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14355a71-c8b1-491e-b0d2-4c7de82024fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107901ef0>]}
[0m09:08:23.403094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14355a71-c8b1-491e-b0d2-4c7de82024fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ced520>]}
[0m09:08:23.402965 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics_staging.stg_store ................... [[32mCREATE VIEW[0m in 0.09s]
[0m09:08:23.403381 [info ] [Thread-3 (]: 3 of 5 OK created sql view model analytics_staging.stg_transaction ............. [[32mCREATE VIEW[0m in 0.09s]
[0m09:08:23.403616 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics_staging.stg_device .................. [[32mCREATE VIEW[0m in 0.09s]
[0m09:08:23.403852 [debug] [Thread-2 (]: Finished running node model.sumup.stg_store
[0m09:08:23.404065 [debug] [Thread-3 (]: Finished running node model.sumup.stg_transaction
[0m09:08:23.404255 [debug] [Thread-1 (]: Finished running node model.sumup.stg_device
[0m09:08:23.404586 [debug] [Thread-4 (]: Began running node model.sumup.int_transaction
[0m09:08:23.404785 [info ] [Thread-4 (]: 4 of 5 START sql view model analytics_analytics.int_transaction ................ [RUN]
[0m09:08:23.404997 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.sumup.int_transaction'
[0m09:08:23.405132 [debug] [Thread-4 (]: Began compiling node model.sumup.int_transaction
[0m09:08:23.406537 [debug] [Thread-4 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m09:08:23.406812 [debug] [Thread-4 (]: Began executing node model.sumup.int_transaction
[0m09:08:23.408001 [debug] [Thread-4 (]: Writing runtime sql for node "model.sumup.int_transaction"
[0m09:08:23.408399 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:08:23.408529 [debug] [Thread-4 (]: On model.sumup.int_transaction: BEGIN
[0m09:08:23.408649 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:08:23.412279 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m09:08:23.412473 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:08:23.412665 [debug] [Thread-4 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

  create view "postgres"."analytics_analytics"."int_transaction__dbt_tmp"
    
    
  as (
    SELECT
    -- Primary and Foreign Keys
    transaction_id,
    device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    amount_eur,
    status,

    --device data
    device_id,
    device_type,
    
    -- store_data
    store_id,
    store_name,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction"
left join "postgres"."analytics_staging"."stg_device" using (device_id)
left join "postgres"."analytics_staging"."stg_store" using (store_id)
  );
[0m09:08:23.414010 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "device_id" specified more than once

[0m09:08:23.414148 [debug] [Thread-4 (]: On model.sumup.int_transaction: ROLLBACK
[0m09:08:23.414401 [debug] [Thread-4 (]: On model.sumup.int_transaction: Close
[0m09:08:23.419225 [debug] [Thread-4 (]: Database Error in model int_transaction (models/intermediate/core/int_transaction.sql)
  column "device_id" specified more than once
  compiled code at target/run/sumup/models/intermediate/core/int_transaction.sql
[0m09:08:23.419433 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14355a71-c8b1-491e-b0d2-4c7de82024fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc98d0>]}
[0m09:08:23.419691 [error] [Thread-4 (]: 4 of 5 ERROR creating sql view model analytics_analytics.int_transaction ....... [[31mERROR[0m in 0.01s]
[0m09:08:23.419912 [debug] [Thread-4 (]: Finished running node model.sumup.int_transaction
[0m09:08:23.420107 [debug] [Thread-7 (]: Marking all children of 'model.sumup.int_transaction' to be skipped because of status 'error'.  Reason: Database Error in model int_transaction (models/intermediate/core/int_transaction.sql)
  column "device_id" specified more than once
  compiled code at target/run/sumup/models/intermediate/core/int_transaction.sql.
[0m09:08:23.420668 [debug] [Thread-2 (]: Began running node model.sumup.customer_store_ranking
[0m09:08:23.420865 [info ] [Thread-2 (]: 5 of 5 SKIP relation analytics_analytics.customer_store_ranking ................ [[33mSKIP[0m]
[0m09:08:23.421063 [debug] [Thread-2 (]: Finished running node model.sumup.customer_store_ranking
[0m09:08:23.421683 [debug] [MainThread]: Using postgres connection "master"
[0m09:08:23.421803 [debug] [MainThread]: On master: BEGIN
[0m09:08:23.421903 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:08:23.426501 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:08:23.426621 [debug] [MainThread]: On master: COMMIT
[0m09:08:23.426723 [debug] [MainThread]: Using postgres connection "master"
[0m09:08:23.426820 [debug] [MainThread]: On master: COMMIT
[0m09:08:23.426992 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:08:23.427083 [debug] [MainThread]: On master: Close
[0m09:08:23.427218 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:08:23.427308 [debug] [MainThread]: Connection 'model.sumup.stg_device' was properly closed.
[0m09:08:23.427390 [debug] [MainThread]: Connection 'model.sumup.stg_store' was properly closed.
[0m09:08:23.427476 [debug] [MainThread]: Connection 'model.sumup.stg_transaction' was properly closed.
[0m09:08:23.427561 [debug] [MainThread]: Connection 'model.sumup.int_transaction' was properly closed.
[0m09:08:23.427699 [info ] [MainThread]: 
[0m09:08:23.427817 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m09:08:23.428232 [debug] [MainThread]: Command end result
[0m09:08:23.437193 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:08:23.438044 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:08:23.441051 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:08:23.441201 [info ] [MainThread]: 
[0m09:08:23.441344 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:08:23.441460 [info ] [MainThread]: 
[0m09:08:23.441603 [error] [MainThread]: [31mFailure in model int_transaction (models/intermediate/core/int_transaction.sql)[0m
[0m09:08:23.441740 [error] [MainThread]:   Database Error in model int_transaction (models/intermediate/core/int_transaction.sql)
  column "device_id" specified more than once
  compiled code at target/run/sumup/models/intermediate/core/int_transaction.sql
[0m09:08:23.441842 [info ] [MainThread]: 
[0m09:08:23.441966 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/intermediate/core/int_transaction.sql
[0m09:08:23.442071 [info ] [MainThread]: 
[0m09:08:23.442188 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=5
[0m09:08:23.442387 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m09:08:23.443861 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.48825476, "process_in_blocks": "0", "process_kernel_time": 0.118441, "process_mem_max_rss": "125698048", "process_out_blocks": "0", "process_user_time": 0.816322}
[0m09:08:23.444040 [debug] [MainThread]: Command `dbt run` failed at 09:08:23.444006 after 0.49 seconds
[0m09:08:23.444202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d68b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba29f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba1c10>]}
[0m09:08:23.444344 [debug] [MainThread]: Flushing usage events
[0m09:08:24.219502 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:09:35.432648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041a0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe7c50>]}


============================== 09:09:35.435553 | 7084bbc4-bd2f-4764-96e9-7071b968c461 ==============================
[0m09:09:35.435553 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:09:35.435823 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'warn_error': 'None', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'partial_parse': 'True', 'debug': 'False', 'use_colors': 'True', 'log_format': 'default', 'target_path': 'None', 'quiet': 'False', 'invocation_command': 'dbt run -m +customer_store_ranking', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'no_print': 'None', 'fail_fast': 'False', 'write_json': 'True', 'introspect': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m09:09:35.436051 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m09:09:35.436263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7084bbc4-bd2f-4764-96e9-7071b968c461', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ecb6f0>]}
[0m09:09:35.522951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7084bbc4-bd2f-4764-96e9-7071b968c461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e76cf0>]}
[0m09:09:35.543423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7084bbc4-bd2f-4764-96e9-7071b968c461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e83d50>]}
[0m09:09:35.543809 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:09:35.583052 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:09:35.639633 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:09:35.639890 [debug] [MainThread]: Partial parsing: updated file: sumup://models/intermediate/core/int_transaction.sql
[0m09:09:35.725638 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m09:09:35.727543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7084bbc4-bd2f-4764-96e9-7071b968c461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f96e40>]}
[0m09:09:35.752612 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:09:35.754027 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:09:35.764214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7084bbc4-bd2f-4764-96e9-7071b968c461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10627d7f0>]}
[0m09:09:35.764399 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m09:09:35.764529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7084bbc4-bd2f-4764-96e9-7071b968c461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10625b6c0>]}
[0m09:09:35.765218 [info ] [MainThread]: 
[0m09:09:35.765355 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:09:35.765458 [info ] [MainThread]: 
[0m09:09:35.765653 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:09:35.767120 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:09:35.771019 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:09:35.819449 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:09:35.819647 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:09:35.819783 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:09:35.819911 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:09:35.820030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:09:35.820174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:09:35.841460 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.021 seconds
[0m09:09:35.841644 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.021 seconds
[0m09:09:35.842188 [debug] [ThreadPool]: On list_postgres: Close
[0m09:09:35.842654 [debug] [ThreadPool]: On list_postgres: Close
[0m09:09:35.843466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics)
[0m09:09:35.843657 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m09:09:35.845866 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:09:35.846058 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m09:09:35.846797 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:09:35.846931 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m09:09:35.847853 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:09:35.847966 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m09:09:35.848065 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:09:35.848165 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m09:09:35.848256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:09:35.848415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:09:35.853721 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m09:09:35.853857 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m09:09:35.853967 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:09:35.854071 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m09:09:35.854175 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:09:35.854284 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:09:35.854389 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:09:35.854493 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m09:09:35.854641 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m09:09:35.859591 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m09:09:35.859700 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m09:09:35.860210 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m09:09:35.860322 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m09:09:35.860710 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m09:09:35.861181 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m09:09:35.861293 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m09:09:35.861671 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m09:09:35.861775 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m09:09:35.863847 [debug] [MainThread]: Using postgres connection "master"
[0m09:09:35.863954 [debug] [MainThread]: On master: BEGIN
[0m09:09:35.864042 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:09:35.868718 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:09:35.868822 [debug] [MainThread]: Using postgres connection "master"
[0m09:09:35.868947 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:09:35.876136 [debug] [MainThread]: SQL status: SELECT 4 in 0.007 seconds
[0m09:09:35.876818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7084bbc4-bd2f-4764-96e9-7071b968c461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106216690>]}
[0m09:09:35.876978 [debug] [MainThread]: On master: ROLLBACK
[0m09:09:35.877202 [debug] [MainThread]: Using postgres connection "master"
[0m09:09:35.877298 [debug] [MainThread]: On master: BEGIN
[0m09:09:35.877582 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:09:35.877679 [debug] [MainThread]: On master: COMMIT
[0m09:09:35.877770 [debug] [MainThread]: Using postgres connection "master"
[0m09:09:35.877858 [debug] [MainThread]: On master: COMMIT
[0m09:09:35.878026 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:09:35.878121 [debug] [MainThread]: On master: Close
[0m09:09:35.879373 [debug] [Thread-3 (]: Began running node model.sumup.stg_transaction
[0m09:09:35.879530 [debug] [Thread-2 (]: Began running node model.sumup.stg_store
[0m09:09:35.879675 [debug] [Thread-1 (]: Began running node model.sumup.stg_device
[0m09:09:35.879872 [info ] [Thread-3 (]: 3 of 5 START sql view model analytics_staging.stg_transaction .................. [RUN]
[0m09:09:35.880056 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics_staging.stg_store ........................ [RUN]
[0m09:09:35.880250 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics_staging.stg_device ....................... [RUN]
[0m09:09:35.880416 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.stg_transaction)
[0m09:09:35.880572 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.stg_store)
[0m09:09:35.880717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.stg_device)
[0m09:09:35.880854 [debug] [Thread-3 (]: Began compiling node model.sumup.stg_transaction
[0m09:09:35.880989 [debug] [Thread-2 (]: Began compiling node model.sumup.stg_store
[0m09:09:35.881117 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_device
[0m09:09:35.884217 [debug] [Thread-3 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m09:09:35.885205 [debug] [Thread-2 (]: Writing injected SQL for node "model.sumup.stg_store"
[0m09:09:35.886622 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_device"
[0m09:09:35.887014 [debug] [Thread-2 (]: Began executing node model.sumup.stg_store
[0m09:09:35.900077 [debug] [Thread-2 (]: Writing runtime sql for node "model.sumup.stg_store"
[0m09:09:35.900358 [debug] [Thread-1 (]: Began executing node model.sumup.stg_device
[0m09:09:35.900517 [debug] [Thread-3 (]: Began executing node model.sumup.stg_transaction
[0m09:09:35.901798 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_device"
[0m09:09:35.902879 [debug] [Thread-3 (]: Writing runtime sql for node "model.sumup.stg_transaction"
[0m09:09:35.903045 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:09:35.903258 [debug] [Thread-2 (]: On model.sumup.stg_store: BEGIN
[0m09:09:35.903425 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:09:35.903660 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:09:35.903790 [debug] [Thread-1 (]: On model.sumup.stg_device: BEGIN
[0m09:09:35.903933 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:09:35.904058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:09:35.904191 [debug] [Thread-3 (]: On model.sumup.stg_transaction: BEGIN
[0m09:09:35.904354 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:09:35.907945 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m09:09:35.908062 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:09:35.908183 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m09:09:35.908326 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */

  create view "postgres"."analytics_staging"."stg_store__dbt_tmp"
    
    
  as (
    

SELECT
    -- Primary Key: Rename to be explicit
    id AS store_id,
    name AS store_name,

    -- Descriptive Attributes: Rename 'typology' for clarity
    typology AS store_typology,
    country,
    city
    
    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-21 07:09:35.421793+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."store"
  );
[0m09:09:35.908481 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:09:35.908641 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */

  create view "postgres"."analytics_staging"."stg_device__dbt_tmp"
    
    
  as (
    

SELECT
    -- Primary Key
    id AS device_id,

    -- Foreign Key to stores (assuming this links the device to a specific store)
    store_id,

    -- Descriptive Attributes
    type as device_type
    
    -- Other fields, if any, standardized here
    -- e.g., CAST(status AS VARCHAR) AS device_status

    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-21 07:09:35.421793+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."device"
  );
[0m09:09:35.908790 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m09:09:35.908922 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:09:35.909062 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  create view "postgres"."analytics_staging"."stg_transaction__dbt_tmp"
    
    
  as (
    SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) / 100 AS amount_eur,
    LOWER(status) AS status,

    -- Card Information 
    REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '') AS card_number,
    CAST(cvv AS VARCHAR) AS cvv,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  );
[0m09:09:35.912841 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:09:35.912982 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:09:35.915534 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:09:35.915670 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:09:35.916650 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:09:35.916780 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */
alter table "postgres"."analytics_staging"."stg_store" rename to "stg_store__dbt_backup"
[0m09:09:35.917910 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:09:35.918042 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */
alter table "postgres"."analytics_staging"."stg_device" rename to "stg_device__dbt_backup"
[0m09:09:35.918192 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
alter table "postgres"."analytics_staging"."stg_transaction" rename to "stg_transaction__dbt_backup"
[0m09:09:35.918562 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:09:35.918683 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:09:35.919616 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:09:35.919732 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:09:35.920596 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:09:35.920715 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */
alter table "postgres"."analytics_staging"."stg_store__dbt_tmp" rename to "stg_store"
[0m09:09:35.921648 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:09:35.921770 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */
alter table "postgres"."analytics_staging"."stg_device__dbt_tmp" rename to "stg_device"
[0m09:09:35.921903 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
alter table "postgres"."analytics_staging"."stg_transaction__dbt_tmp" rename to "stg_transaction"
[0m09:09:35.922248 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:09:35.928015 [debug] [Thread-2 (]: On model.sumup.stg_store: COMMIT
[0m09:09:35.928165 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:09:35.928283 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:09:35.928394 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:09:35.928885 [debug] [Thread-1 (]: On model.sumup.stg_device: COMMIT
[0m09:09:35.929002 [debug] [Thread-2 (]: On model.sumup.stg_store: COMMIT
[0m09:09:35.929462 [debug] [Thread-3 (]: On model.sumup.stg_transaction: COMMIT
[0m09:09:35.929582 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:09:35.929725 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:09:35.929847 [debug] [Thread-1 (]: On model.sumup.stg_device: COMMIT
[0m09:09:35.929962 [debug] [Thread-3 (]: On model.sumup.stg_transaction: COMMIT
[0m09:09:35.930363 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:09:35.932509 [debug] [Thread-2 (]: Applying DROP to: "postgres"."analytics_staging"."stg_store__dbt_backup"
[0m09:09:35.932647 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m09:09:35.934307 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:09:35.934437 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m09:09:35.935135 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_device__dbt_backup"
[0m09:09:35.935259 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */
drop view if exists "postgres"."analytics_staging"."stg_store__dbt_backup" cascade
[0m09:09:35.935926 [debug] [Thread-3 (]: Applying DROP to: "postgres"."analytics_staging"."stg_transaction__dbt_backup"
[0m09:09:35.936178 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:09:35.936425 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:09:35.936549 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */
drop view if exists "postgres"."analytics_staging"."stg_device__dbt_backup" cascade
[0m09:09:35.936667 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
drop view if exists "postgres"."analytics_staging"."stg_transaction__dbt_backup" cascade
[0m09:09:35.937459 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:09:35.938363 [debug] [Thread-2 (]: On model.sumup.stg_store: Close
[0m09:09:35.938498 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:09:35.938614 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:09:35.939064 [debug] [Thread-1 (]: On model.sumup.stg_device: Close
[0m09:09:35.939938 [debug] [Thread-3 (]: On model.sumup.stg_transaction: Close
[0m09:09:35.940371 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7084bbc4-bd2f-4764-96e9-7071b968c461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f2830>]}
[0m09:09:35.940491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7084bbc4-bd2f-4764-96e9-7071b968c461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10668d590>]}
[0m09:09:35.940836 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7084bbc4-bd2f-4764-96e9-7071b968c461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659bbf0>]}
[0m09:09:35.940724 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics_staging.stg_store ................... [[32mCREATE VIEW[0m in 0.06s]
[0m09:09:35.941480 [debug] [Thread-2 (]: Finished running node model.sumup.stg_store
[0m09:09:35.941067 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics_staging.stg_device .................. [[32mCREATE VIEW[0m in 0.06s]
[0m09:09:35.941764 [debug] [Thread-1 (]: Finished running node model.sumup.stg_device
[0m09:09:35.941293 [info ] [Thread-3 (]: 3 of 5 OK created sql view model analytics_staging.stg_transaction ............. [[32mCREATE VIEW[0m in 0.06s]
[0m09:09:35.942012 [debug] [Thread-3 (]: Finished running node model.sumup.stg_transaction
[0m09:09:35.942267 [debug] [Thread-4 (]: Began running node model.sumup.int_transaction
[0m09:09:35.942457 [info ] [Thread-4 (]: 4 of 5 START sql view model analytics_analytics.int_transaction ................ [RUN]
[0m09:09:35.942640 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.sumup.int_transaction'
[0m09:09:35.942767 [debug] [Thread-4 (]: Began compiling node model.sumup.int_transaction
[0m09:09:35.944004 [debug] [Thread-4 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m09:09:35.944371 [debug] [Thread-4 (]: Began executing node model.sumup.int_transaction
[0m09:09:35.945396 [debug] [Thread-4 (]: Writing runtime sql for node "model.sumup.int_transaction"
[0m09:09:35.945708 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:09:35.945825 [debug] [Thread-4 (]: On model.sumup.int_transaction: BEGIN
[0m09:09:35.945932 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:09:35.950653 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m09:09:35.950771 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:09:35.950905 [debug] [Thread-4 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

  create view "postgres"."analytics_analytics"."int_transaction__dbt_tmp"
    
    
  as (
    SELECT
    -- Primary and Foreign Keys
    transaction_id,
    device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    amount_eur,
    status,

    --device data
    device_type,
    
    -- store_data
    store_id,
    store_name,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction"
left join "postgres"."analytics_staging"."stg_device" using (device_id)
left join "postgres"."analytics_staging"."stg_store" using (store_id)
  );
[0m09:09:35.956362 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:09:35.957621 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:09:35.957743 [debug] [Thread-4 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */
alter table "postgres"."analytics_analytics"."int_transaction__dbt_tmp" rename to "int_transaction"
[0m09:09:35.958405 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:09:35.958855 [debug] [Thread-4 (]: On model.sumup.int_transaction: COMMIT
[0m09:09:35.958969 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:09:35.959073 [debug] [Thread-4 (]: On model.sumup.int_transaction: COMMIT
[0m09:09:35.960175 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:09:35.960836 [debug] [Thread-4 (]: Applying DROP to: "postgres"."analytics_analytics"."int_transaction__dbt_backup"
[0m09:09:35.961072 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:09:35.961183 [debug] [Thread-4 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */
drop view if exists "postgres"."analytics_analytics"."int_transaction__dbt_backup" cascade
[0m09:09:35.961476 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:09:35.961874 [debug] [Thread-4 (]: On model.sumup.int_transaction: Close
[0m09:09:35.962068 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7084bbc4-bd2f-4764-96e9-7071b968c461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659c1a0>]}
[0m09:09:35.962284 [info ] [Thread-4 (]: 4 of 5 OK created sql view model analytics_analytics.int_transaction ........... [[32mCREATE VIEW[0m in 0.02s]
[0m09:09:35.962492 [debug] [Thread-4 (]: Finished running node model.sumup.int_transaction
[0m09:09:35.962750 [debug] [Thread-2 (]: Began running node model.sumup.customer_store_ranking
[0m09:09:35.962924 [info ] [Thread-2 (]: 5 of 5 START sql view model analytics_analytics.customer_store_ranking ......... [RUN]
[0m09:09:35.963077 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sumup.stg_store, now model.sumup.customer_store_ranking)
[0m09:09:35.963192 [debug] [Thread-2 (]: Began compiling node model.sumup.customer_store_ranking
[0m09:09:35.964073 [debug] [Thread-2 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m09:09:35.964339 [debug] [Thread-2 (]: Began executing node model.sumup.customer_store_ranking
[0m09:09:35.967290 [debug] [Thread-2 (]: Writing runtime sql for node "model.sumup.customer_store_ranking"
[0m09:09:35.967522 [debug] [Thread-2 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m09:09:35.967633 [debug] [Thread-2 (]: On model.sumup.customer_store_ranking: BEGIN
[0m09:09:35.967737 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:09:35.972326 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m09:09:35.972479 [debug] [Thread-2 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m09:09:35.972615 [debug] [Thread-2 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  create view "postgres"."analytics_analytics"."customer_store_ranking__dbt_tmp"
    
    
  as (
    SELECT
    store_name,
    SUM(t.transacted_amount) AS total_amount
FROM
    "postgres"."analytics_analytics"."int_transaction" 
GROUP BY
    store_name
ORDER BY
    total_amount DESC
LIMIT 10
  );
[0m09:09:35.973169 [debug] [Thread-2 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "t"
LINE 9:     SUM(t.transacted_amount) AS total_amount
                ^

[0m09:09:35.973290 [debug] [Thread-2 (]: On model.sumup.customer_store_ranking: ROLLBACK
[0m09:09:35.973515 [debug] [Thread-2 (]: On model.sumup.customer_store_ranking: Close
[0m09:09:35.978660 [debug] [Thread-2 (]: Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  missing FROM-clause entry for table "t"
  LINE 9:     SUM(t.transacted_amount) AS total_amount
                  ^
  compiled code at target/run/sumup/models/marts/core/customer_store_ranking.sql
[0m09:09:35.978835 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7084bbc4-bd2f-4764-96e9-7071b968c461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106484f50>]}
[0m09:09:35.979063 [error] [Thread-2 (]: 5 of 5 ERROR creating sql view model analytics_analytics.customer_store_ranking  [[31mERROR[0m in 0.02s]
[0m09:09:35.979276 [debug] [Thread-2 (]: Finished running node model.sumup.customer_store_ranking
[0m09:09:35.979472 [debug] [Thread-7 (]: Marking all children of 'model.sumup.customer_store_ranking' to be skipped because of status 'error'.  Reason: Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  missing FROM-clause entry for table "t"
  LINE 9:     SUM(t.transacted_amount) AS total_amount
                  ^
  compiled code at target/run/sumup/models/marts/core/customer_store_ranking.sql.
[0m09:09:35.980173 [debug] [MainThread]: Using postgres connection "master"
[0m09:09:35.980291 [debug] [MainThread]: On master: BEGIN
[0m09:09:35.980383 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:09:35.985430 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:09:35.985549 [debug] [MainThread]: On master: COMMIT
[0m09:09:35.985689 [debug] [MainThread]: Using postgres connection "master"
[0m09:09:35.985780 [debug] [MainThread]: On master: COMMIT
[0m09:09:35.985925 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:09:35.986018 [debug] [MainThread]: On master: Close
[0m09:09:35.986148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:09:35.986236 [debug] [MainThread]: Connection 'model.sumup.stg_device' was properly closed.
[0m09:09:35.986316 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m09:09:35.986393 [debug] [MainThread]: Connection 'model.sumup.stg_transaction' was properly closed.
[0m09:09:35.986467 [debug] [MainThread]: Connection 'model.sumup.int_transaction' was properly closed.
[0m09:09:35.986579 [info ] [MainThread]: 
[0m09:09:35.986689 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m09:09:35.987135 [debug] [MainThread]: Command end result
[0m09:09:35.995729 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:09:35.996402 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:09:35.998723 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:09:35.998831 [info ] [MainThread]: 
[0m09:09:35.998963 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:09:35.999103 [info ] [MainThread]: 
[0m09:09:35.999262 [error] [MainThread]: [31mFailure in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)[0m
[0m09:09:35.999402 [error] [MainThread]:   Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  missing FROM-clause entry for table "t"
  LINE 9:     SUM(t.transacted_amount) AS total_amount
                  ^
  compiled code at target/run/sumup/models/marts/core/customer_store_ranking.sql
[0m09:09:35.999504 [info ] [MainThread]: 
[0m09:09:35.999627 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/marts/core/customer_store_ranking.sql
[0m09:09:35.999728 [info ] [MainThread]: 
[0m09:09:35.999840 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m09:09:36.000035 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m09:09:36.001627 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5982447, "process_in_blocks": "0", "process_kernel_time": 0.150464, "process_mem_max_rss": "130121728", "process_out_blocks": "0", "process_user_time": 0.923732}
[0m09:09:36.001781 [debug] [MainThread]: Command `dbt run` failed at 09:09:36.001751 after 0.60 seconds
[0m09:09:36.001912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e7fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a3a70>]}
[0m09:09:36.002034 [debug] [MainThread]: Flushing usage events
[0m09:09:36.903145 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:09:41.703663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106058050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e9b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e9bc50>]}


============================== 09:09:41.705397 | 81e3370d-5ba7-4969-abc5-29806a2ae74f ==============================
[0m09:09:41.705397 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:09:41.705649 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'invocation_command': 'dbt run -m +customer_store_ranking', 'quiet': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'use_experimental_parser': 'False', 'warn_error': 'None', 'no_print': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'debug': 'False', 'printer_width': '80', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup'}
[0m09:09:41.705816 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m09:09:41.705958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '81e3370d-5ba7-4969-abc5-29806a2ae74f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d836f0>]}
[0m09:09:41.769117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81e3370d-5ba7-4969-abc5-29806a2ae74f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d2ecf0>]}
[0m09:09:41.789999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81e3370d-5ba7-4969-abc5-29806a2ae74f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d3bd50>]}
[0m09:09:41.790314 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:09:41.825051 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:09:41.865539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:09:41.865734 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:09:41.867904 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m09:09:41.881474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81e3370d-5ba7-4969-abc5-29806a2ae74f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e4dd60>]}
[0m09:09:41.907144 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:09:41.907987 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:09:41.913768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81e3370d-5ba7-4969-abc5-29806a2ae74f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10750f150>]}
[0m09:09:41.913973 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m09:09:41.914105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81e3370d-5ba7-4969-abc5-29806a2ae74f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f73790>]}
[0m09:09:41.914835 [info ] [MainThread]: 
[0m09:09:41.914971 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:09:41.915077 [info ] [MainThread]: 
[0m09:09:41.915273 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:09:41.916803 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:09:41.921324 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:09:41.937293 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:09:41.937514 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:09:41.937656 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:09:41.937787 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:09:41.937906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:09:41.938008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:09:41.953511 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.016 seconds
[0m09:09:41.953733 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.016 seconds
[0m09:09:41.954411 [debug] [ThreadPool]: On list_postgres: Close
[0m09:09:41.954843 [debug] [ThreadPool]: On list_postgres: Close
[0m09:09:41.955662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m09:09:41.955856 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics)
[0m09:09:41.958001 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:09:41.958188 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m09:09:41.958892 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:09:41.959015 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m09:09:41.959836 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:09:41.959949 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m09:09:41.960055 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:09:41.960176 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m09:09:41.960290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:09:41.960435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:09:41.966113 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m09:09:41.966259 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:09:41.966375 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:09:41.966580 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m09:09:41.966685 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:09:41.966798 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m09:09:41.967166 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m09:09:41.967265 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:09:41.967369 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m09:09:41.970380 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m09:09:41.970865 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m09:09:41.970974 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m09:09:41.971421 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m09:09:41.971548 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m09:09:41.971662 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m09:09:41.971778 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m09:09:41.972221 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m09:09:41.972842 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m09:09:41.974673 [debug] [MainThread]: Using postgres connection "master"
[0m09:09:41.974778 [debug] [MainThread]: On master: BEGIN
[0m09:09:41.974862 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:09:41.978518 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:09:41.978625 [debug] [MainThread]: Using postgres connection "master"
[0m09:09:41.978759 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:09:41.983822 [debug] [MainThread]: SQL status: SELECT 7 in 0.005 seconds
[0m09:09:41.984636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81e3370d-5ba7-4969-abc5-29806a2ae74f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fee090>]}
[0m09:09:41.984787 [debug] [MainThread]: On master: ROLLBACK
[0m09:09:41.985000 [debug] [MainThread]: Using postgres connection "master"
[0m09:09:41.985098 [debug] [MainThread]: On master: BEGIN
[0m09:09:41.985380 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:09:41.985475 [debug] [MainThread]: On master: COMMIT
[0m09:09:41.985564 [debug] [MainThread]: Using postgres connection "master"
[0m09:09:41.985650 [debug] [MainThread]: On master: COMMIT
[0m09:09:41.985814 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:09:41.985907 [debug] [MainThread]: On master: Close
[0m09:09:41.987021 [debug] [Thread-3 (]: Began running node model.sumup.stg_transaction
[0m09:09:41.987171 [debug] [Thread-2 (]: Began running node model.sumup.stg_store
[0m09:09:41.987311 [debug] [Thread-1 (]: Began running node model.sumup.stg_device
[0m09:09:41.987504 [info ] [Thread-3 (]: 3 of 5 START sql view model analytics_staging.stg_transaction .................. [RUN]
[0m09:09:41.987706 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics_staging.stg_store ........................ [RUN]
[0m09:09:41.987899 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics_staging.stg_device ....................... [RUN]
[0m09:09:41.988063 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.stg_transaction)
[0m09:09:41.988213 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.stg_store)
[0m09:09:41.988349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.stg_device)
[0m09:09:41.988485 [debug] [Thread-3 (]: Began compiling node model.sumup.stg_transaction
[0m09:09:41.988614 [debug] [Thread-2 (]: Began compiling node model.sumup.stg_store
[0m09:09:41.988742 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_device
[0m09:09:41.991854 [debug] [Thread-3 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m09:09:41.992937 [debug] [Thread-2 (]: Writing injected SQL for node "model.sumup.stg_store"
[0m09:09:41.993901 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_device"
[0m09:09:41.994254 [debug] [Thread-3 (]: Began executing node model.sumup.stg_transaction
[0m09:09:41.994412 [debug] [Thread-2 (]: Began executing node model.sumup.stg_store
[0m09:09:41.994552 [debug] [Thread-1 (]: Began executing node model.sumup.stg_device
[0m09:09:42.007883 [debug] [Thread-3 (]: Writing runtime sql for node "model.sumup.stg_transaction"
[0m09:09:42.009252 [debug] [Thread-2 (]: Writing runtime sql for node "model.sumup.stg_store"
[0m09:09:42.010346 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_device"
[0m09:09:42.010760 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:09:42.010933 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:09:42.011059 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:09:42.011181 [debug] [Thread-2 (]: On model.sumup.stg_store: BEGIN
[0m09:09:42.011299 [debug] [Thread-3 (]: On model.sumup.stg_transaction: BEGIN
[0m09:09:42.011408 [debug] [Thread-1 (]: On model.sumup.stg_device: BEGIN
[0m09:09:42.011515 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:09:42.011623 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:09:42.011729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:09:42.018109 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m09:09:42.018240 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:09:42.018378 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m09:09:42.018522 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */

  create view "postgres"."analytics_staging"."stg_store__dbt_tmp"
    
    
  as (
    

SELECT
    -- Primary Key: Rename to be explicit
    id AS store_id,
    name AS store_name,

    -- Descriptive Attributes: Rename 'typology' for clarity
    typology AS store_typology,
    country,
    city
    
    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-21 07:09:41.696646+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."store"
  );
[0m09:09:42.018679 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:09:42.018828 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m09:09:42.018968 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */

  create view "postgres"."analytics_staging"."stg_device__dbt_tmp"
    
    
  as (
    

SELECT
    -- Primary Key
    id AS device_id,

    -- Foreign Key to stores (assuming this links the device to a specific store)
    store_id,

    -- Descriptive Attributes
    type as device_type
    
    -- Other fields, if any, standardized here
    -- e.g., CAST(status AS VARCHAR) AS device_status

    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-21 07:09:41.696646+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."device"
  );
[0m09:09:42.019105 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:09:42.019264 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  create view "postgres"."analytics_staging"."stg_transaction__dbt_tmp"
    
    
  as (
    SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) / 100 AS amount_eur,
    LOWER(status) AS status,

    -- Card Information 
    REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '') AS card_number,
    CAST(cvv AS VARCHAR) AS cvv,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  );
[0m09:09:42.021452 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:09:42.025280 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:09:42.025428 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:09:42.025549 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:09:42.025672 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */
alter table "postgres"."analytics_staging"."stg_store" rename to "stg_store__dbt_backup"
[0m09:09:42.026692 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:09:42.027638 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:09:42.027794 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */
alter table "postgres"."analytics_staging"."stg_device" rename to "stg_device__dbt_backup"
[0m09:09:42.027928 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
alter table "postgres"."analytics_staging"."stg_transaction" rename to "stg_transaction__dbt_backup"
[0m09:09:42.028091 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:09:42.052895 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m09:09:42.053096 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m09:09:42.053733 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:09:42.054715 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:09:42.055611 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:09:42.055743 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */
alter table "postgres"."analytics_staging"."stg_store__dbt_tmp" rename to "stg_store"
[0m09:09:42.055866 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */
alter table "postgres"."analytics_staging"."stg_device__dbt_tmp" rename to "stg_device"
[0m09:09:42.056119 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
alter table "postgres"."analytics_staging"."stg_transaction__dbt_tmp" rename to "stg_transaction"
[0m09:09:42.056701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:09:42.056837 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:09:42.062836 [debug] [Thread-1 (]: On model.sumup.stg_device: COMMIT
[0m09:09:42.062973 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m09:09:42.063509 [debug] [Thread-2 (]: On model.sumup.stg_store: COMMIT
[0m09:09:42.063641 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:09:42.064140 [debug] [Thread-3 (]: On model.sumup.stg_transaction: COMMIT
[0m09:09:42.064269 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:09:42.064387 [debug] [Thread-1 (]: On model.sumup.stg_device: COMMIT
[0m09:09:42.064506 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:09:42.064621 [debug] [Thread-2 (]: On model.sumup.stg_store: COMMIT
[0m09:09:42.064752 [debug] [Thread-3 (]: On model.sumup.stg_transaction: COMMIT
[0m09:09:42.065420 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:09:42.067482 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_device__dbt_backup"
[0m09:09:42.067615 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m09:09:42.069327 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:09:42.069456 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m09:09:42.070342 [debug] [Thread-2 (]: Applying DROP to: "postgres"."analytics_staging"."stg_store__dbt_backup"
[0m09:09:42.070486 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */
drop view if exists "postgres"."analytics_staging"."stg_device__dbt_backup" cascade
[0m09:09:42.071215 [debug] [Thread-3 (]: Applying DROP to: "postgres"."analytics_staging"."stg_transaction__dbt_backup"
[0m09:09:42.071465 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:09:42.071723 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:09:42.071847 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */
drop view if exists "postgres"."analytics_staging"."stg_store__dbt_backup" cascade
[0m09:09:42.071968 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
drop view if exists "postgres"."analytics_staging"."stg_transaction__dbt_backup" cascade
[0m09:09:42.073405 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:09:42.074323 [debug] [Thread-1 (]: On model.sumup.stg_device: Close
[0m09:09:42.074463 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:09:42.074581 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:09:42.075046 [debug] [Thread-2 (]: On model.sumup.stg_store: Close
[0m09:09:42.075992 [debug] [Thread-3 (]: On model.sumup.stg_transaction: Close
[0m09:09:42.076474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e3370d-5ba7-4969-abc5-29806a2ae74f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e8ec0>]}
[0m09:09:42.076601 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e3370d-5ba7-4969-abc5-29806a2ae74f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc63f0>]}
[0m09:09:42.076952 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e3370d-5ba7-4969-abc5-29806a2ae74f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083b5010>]}
[0m09:09:42.076836 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics_staging.stg_device .................. [[32mCREATE VIEW[0m in 0.09s]
[0m09:09:42.077167 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics_staging.stg_store ................... [[32mCREATE VIEW[0m in 0.09s]
[0m09:09:42.077625 [debug] [Thread-1 (]: Finished running node model.sumup.stg_device
[0m09:09:42.077393 [info ] [Thread-3 (]: 3 of 5 OK created sql view model analytics_staging.stg_transaction ............. [[32mCREATE VIEW[0m in 0.09s]
[0m09:09:42.077845 [debug] [Thread-2 (]: Finished running node model.sumup.stg_store
[0m09:09:42.078074 [debug] [Thread-3 (]: Finished running node model.sumup.stg_transaction
[0m09:09:42.078380 [debug] [Thread-4 (]: Began running node model.sumup.int_transaction
[0m09:09:42.078580 [info ] [Thread-4 (]: 4 of 5 START sql view model analytics_analytics.int_transaction ................ [RUN]
[0m09:09:42.078769 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.sumup.int_transaction'
[0m09:09:42.078899 [debug] [Thread-4 (]: Began compiling node model.sumup.int_transaction
[0m09:09:42.079924 [debug] [Thread-4 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m09:09:42.080169 [debug] [Thread-4 (]: Began executing node model.sumup.int_transaction
[0m09:09:42.081425 [debug] [Thread-4 (]: Writing runtime sql for node "model.sumup.int_transaction"
[0m09:09:42.081640 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:09:42.081757 [debug] [Thread-4 (]: On model.sumup.int_transaction: BEGIN
[0m09:09:42.081868 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:09:42.085687 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m09:09:42.085863 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:09:42.086023 [debug] [Thread-4 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

  create view "postgres"."analytics_analytics"."int_transaction__dbt_tmp"
    
    
  as (
    SELECT
    -- Primary and Foreign Keys
    transaction_id,
    device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    amount_eur,
    status,

    --device data
    device_type,
    
    -- store_data
    store_id,
    store_name,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction"
left join "postgres"."analytics_staging"."stg_device" using (device_id)
left join "postgres"."analytics_staging"."stg_store" using (store_id)
  );
[0m09:09:42.089260 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:09:42.090379 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:09:42.090502 [debug] [Thread-4 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */
alter table "postgres"."analytics_analytics"."int_transaction__dbt_tmp" rename to "int_transaction"
[0m09:09:42.091088 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:09:42.091560 [debug] [Thread-4 (]: On model.sumup.int_transaction: COMMIT
[0m09:09:42.091677 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:09:42.091784 [debug] [Thread-4 (]: On model.sumup.int_transaction: COMMIT
[0m09:09:42.092473 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:09:42.093360 [debug] [Thread-4 (]: Applying DROP to: "postgres"."analytics_analytics"."int_transaction__dbt_backup"
[0m09:09:42.093605 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:09:42.093734 [debug] [Thread-4 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */
drop view if exists "postgres"."analytics_analytics"."int_transaction__dbt_backup" cascade
[0m09:09:42.094010 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:09:42.094426 [debug] [Thread-4 (]: On model.sumup.int_transaction: Close
[0m09:09:42.094619 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e3370d-5ba7-4969-abc5-29806a2ae74f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10838d710>]}
[0m09:09:42.094843 [info ] [Thread-4 (]: 4 of 5 OK created sql view model analytics_analytics.int_transaction ........... [[32mCREATE VIEW[0m in 0.02s]
[0m09:09:42.095060 [debug] [Thread-4 (]: Finished running node model.sumup.int_transaction
[0m09:09:42.095345 [debug] [Thread-1 (]: Began running node model.sumup.customer_store_ranking
[0m09:09:42.095541 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics_analytics.customer_store_ranking ......... [RUN]
[0m09:09:42.095717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.stg_device, now model.sumup.customer_store_ranking)
[0m09:09:42.095844 [debug] [Thread-1 (]: Began compiling node model.sumup.customer_store_ranking
[0m09:09:42.096734 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m09:09:42.097013 [debug] [Thread-1 (]: Began executing node model.sumup.customer_store_ranking
[0m09:09:42.098239 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.customer_store_ranking"
[0m09:09:42.098482 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m09:09:42.098598 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: BEGIN
[0m09:09:42.098710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:09:42.103662 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m09:09:42.103799 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m09:09:42.103974 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  create view "postgres"."analytics_analytics"."customer_store_ranking__dbt_tmp"
    
    
  as (
    SELECT
    store_name,
    SUM(t.transacted_amount) AS total_amount
FROM
    "postgres"."analytics_analytics"."int_transaction" 
GROUP BY
    store_name
ORDER BY
    total_amount DESC
LIMIT 10
  );
[0m09:09:42.104974 [debug] [Thread-1 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "t"
LINE 9:     SUM(t.transacted_amount) AS total_amount
                ^

[0m09:09:42.105102 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: ROLLBACK
[0m09:09:42.105348 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: Close
[0m09:09:42.110421 [debug] [Thread-1 (]: Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  missing FROM-clause entry for table "t"
  LINE 9:     SUM(t.transacted_amount) AS total_amount
                  ^
  compiled code at target/run/sumup/models/marts/core/customer_store_ranking.sql
[0m09:09:42.110607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e3370d-5ba7-4969-abc5-29806a2ae74f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083cf1d0>]}
[0m09:09:42.110838 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model analytics_analytics.customer_store_ranking  [[31mERROR[0m in 0.01s]
[0m09:09:42.111054 [debug] [Thread-1 (]: Finished running node model.sumup.customer_store_ranking
[0m09:09:42.111257 [debug] [Thread-7 (]: Marking all children of 'model.sumup.customer_store_ranking' to be skipped because of status 'error'.  Reason: Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  missing FROM-clause entry for table "t"
  LINE 9:     SUM(t.transacted_amount) AS total_amount
                  ^
  compiled code at target/run/sumup/models/marts/core/customer_store_ranking.sql.
[0m09:09:42.111980 [debug] [MainThread]: Using postgres connection "master"
[0m09:09:42.112094 [debug] [MainThread]: On master: BEGIN
[0m09:09:42.112185 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:09:42.116755 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:09:42.116881 [debug] [MainThread]: On master: COMMIT
[0m09:09:42.117018 [debug] [MainThread]: Using postgres connection "master"
[0m09:09:42.117138 [debug] [MainThread]: On master: COMMIT
[0m09:09:42.117294 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:09:42.117400 [debug] [MainThread]: On master: Close
[0m09:09:42.117551 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:09:42.117642 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m09:09:42.117736 [debug] [MainThread]: Connection 'model.sumup.stg_store' was properly closed.
[0m09:09:42.117826 [debug] [MainThread]: Connection 'model.sumup.stg_transaction' was properly closed.
[0m09:09:42.117917 [debug] [MainThread]: Connection 'model.sumup.int_transaction' was properly closed.
[0m09:09:42.118051 [info ] [MainThread]: 
[0m09:09:42.118173 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m09:09:42.118609 [debug] [MainThread]: Command end result
[0m09:09:42.128263 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:09:42.129079 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:09:42.131549 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:09:42.131684 [info ] [MainThread]: 
[0m09:09:42.131833 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:09:42.131951 [info ] [MainThread]: 
[0m09:09:42.132099 [error] [MainThread]: [31mFailure in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)[0m
[0m09:09:42.132241 [error] [MainThread]:   Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  missing FROM-clause entry for table "t"
  LINE 9:     SUM(t.transacted_amount) AS total_amount
                  ^
  compiled code at target/run/sumup/models/marts/core/customer_store_ranking.sql
[0m09:09:42.132344 [info ] [MainThread]: 
[0m09:09:42.132480 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/marts/core/customer_store_ranking.sql
[0m09:09:42.132585 [info ] [MainThread]: 
[0m09:09:42.132700 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m09:09:42.132904 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m09:09:42.134475 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.45545045, "process_in_blocks": "0", "process_kernel_time": 0.115092, "process_mem_max_rss": "128565248", "process_out_blocks": "0", "process_user_time": 0.820503}
[0m09:09:42.134668 [debug] [MainThread]: Command `dbt run` failed at 09:09:42.134633 after 0.46 seconds
[0m09:09:42.134821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d1af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ea92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10847fc50>]}
[0m09:09:42.134952 [debug] [MainThread]: Flushing usage events
[0m09:09:43.024074 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:09:52.582131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e84050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc7c50>]}


============================== 09:09:52.584057 | 58476d85-d1ed-4ce8-ba04-ea8824d33076 ==============================
[0m09:09:52.584057 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:09:52.584305 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'printer_width': '80', 'use_colors': 'True', 'empty': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'version_check': 'True', 'invocation_command': 'dbt run -m +customer_store_ranking', 'debug': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'quiet': 'False', 'write_json': 'True', 'warn_error': 'None', 'no_print': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'introspect': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None'}
[0m09:09:52.584516 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m09:09:52.584657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '58476d85-d1ed-4ce8-ba04-ea8824d33076', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108baf6f0>]}
[0m09:09:52.648627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58476d85-d1ed-4ce8-ba04-ea8824d33076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b5acf0>]}
[0m09:09:52.669357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58476d85-d1ed-4ce8-ba04-ea8824d33076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b67d50>]}
[0m09:09:52.669673 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:09:52.708577 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:09:52.757672 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:09:52.757927 [debug] [MainThread]: Partial parsing: updated file: sumup://models/marts/core/customer_store_ranking.sql
[0m09:09:52.840223 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m09:09:52.842063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58476d85-d1ed-4ce8-ba04-ea8824d33076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c7ae40>]}
[0m09:09:52.868412 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:09:52.869644 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:09:52.879334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58476d85-d1ed-4ce8-ba04-ea8824d33076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f5d7f0>]}
[0m09:09:52.879529 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m09:09:52.879665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58476d85-d1ed-4ce8-ba04-ea8824d33076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f3f6c0>]}
[0m09:09:52.880363 [info ] [MainThread]: 
[0m09:09:52.880497 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:09:52.880603 [info ] [MainThread]: 
[0m09:09:52.880790 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:09:52.882276 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:09:52.886071 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:09:52.933848 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:09:52.934039 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:09:52.934173 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:09:52.934302 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:09:52.934416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:09:52.934518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:09:52.954828 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.020 seconds
[0m09:09:52.954997 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.021 seconds
[0m09:09:52.955561 [debug] [ThreadPool]: On list_postgres: Close
[0m09:09:52.955989 [debug] [ThreadPool]: On list_postgres: Close
[0m09:09:52.956808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m09:09:52.957016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_analytics)
[0m09:09:52.959180 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:09:52.959362 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m09:09:52.960015 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:09:52.960140 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m09:09:52.960922 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:09:52.961037 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m09:09:52.961138 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:09:52.961236 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m09:09:52.961328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:09:52.961470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:09:52.966191 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m09:09:52.966317 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m09:09:52.966420 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m09:09:52.966519 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:09:52.966620 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:09:52.966711 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:09:52.966816 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:09:52.966936 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m09:09:52.967060 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m09:09:52.970989 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m09:09:52.971107 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m09:09:52.971224 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m09:09:52.971737 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m09:09:52.972159 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m09:09:52.972566 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m09:09:52.972807 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m09:09:52.972916 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m09:09:52.973043 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m09:09:52.975282 [debug] [MainThread]: Using postgres connection "master"
[0m09:09:52.975387 [debug] [MainThread]: On master: BEGIN
[0m09:09:52.975472 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:09:52.979056 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:09:52.979152 [debug] [MainThread]: Using postgres connection "master"
[0m09:09:52.979276 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:09:52.984133 [debug] [MainThread]: SQL status: SELECT 7 in 0.005 seconds
[0m09:09:52.985041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58476d85-d1ed-4ce8-ba04-ea8824d33076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109efa990>]}
[0m09:09:52.985204 [debug] [MainThread]: On master: ROLLBACK
[0m09:09:52.985409 [debug] [MainThread]: Using postgres connection "master"
[0m09:09:52.985508 [debug] [MainThread]: On master: BEGIN
[0m09:09:52.985833 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:09:52.985933 [debug] [MainThread]: On master: COMMIT
[0m09:09:52.986027 [debug] [MainThread]: Using postgres connection "master"
[0m09:09:52.986118 [debug] [MainThread]: On master: COMMIT
[0m09:09:52.986308 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:09:52.986405 [debug] [MainThread]: On master: Close
[0m09:09:52.987533 [debug] [Thread-2 (]: Began running node model.sumup.stg_store
[0m09:09:52.987679 [debug] [Thread-3 (]: Began running node model.sumup.stg_transaction
[0m09:09:52.987990 [debug] [Thread-1 (]: Began running node model.sumup.stg_device
[0m09:09:52.987865 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics_staging.stg_store ........................ [RUN]
[0m09:09:52.988214 [info ] [Thread-3 (]: 3 of 5 START sql view model analytics_staging.stg_transaction .................. [RUN]
[0m09:09:52.988391 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics_staging.stg_device ....................... [RUN]
[0m09:09:52.988544 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.stg_store)
[0m09:09:52.988672 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.stg_transaction)
[0m09:09:52.988797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.stg_device)
[0m09:09:52.988924 [debug] [Thread-2 (]: Began compiling node model.sumup.stg_store
[0m09:09:52.989046 [debug] [Thread-3 (]: Began compiling node model.sumup.stg_transaction
[0m09:09:52.989162 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_device
[0m09:09:52.992434 [debug] [Thread-2 (]: Writing injected SQL for node "model.sumup.stg_store"
[0m09:09:52.993465 [debug] [Thread-3 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m09:09:52.994865 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_device"
[0m09:09:52.995262 [debug] [Thread-2 (]: Began executing node model.sumup.stg_store
[0m09:09:53.009534 [debug] [Thread-2 (]: Writing runtime sql for node "model.sumup.stg_store"
[0m09:09:53.009828 [debug] [Thread-3 (]: Began executing node model.sumup.stg_transaction
[0m09:09:53.011269 [debug] [Thread-3 (]: Writing runtime sql for node "model.sumup.stg_transaction"
[0m09:09:53.011468 [debug] [Thread-1 (]: Began executing node model.sumup.stg_device
[0m09:09:53.012646 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_device"
[0m09:09:53.012879 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:09:53.013035 [debug] [Thread-3 (]: On model.sumup.stg_transaction: BEGIN
[0m09:09:53.013162 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:09:53.013303 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:09:53.013454 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:09:53.013641 [debug] [Thread-1 (]: On model.sumup.stg_device: BEGIN
[0m09:09:53.013773 [debug] [Thread-2 (]: On model.sumup.stg_store: BEGIN
[0m09:09:53.013897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:09:53.014029 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:09:53.019140 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m09:09:53.019306 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m09:09:53.019436 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:09:53.019574 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:09:53.019715 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */

  create view "postgres"."analytics_staging"."stg_store__dbt_tmp"
    
    
  as (
    

SELECT
    -- Primary Key: Rename to be explicit
    id AS store_id,
    name AS store_name,

    -- Descriptive Attributes: Rename 'typology' for clarity
    typology AS store_typology,
    country,
    city
    
    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-21 07:09:52.574505+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."store"
  );
[0m09:09:53.019860 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m09:09:53.020021 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  create view "postgres"."analytics_staging"."stg_transaction__dbt_tmp"
    
    
  as (
    SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) / 100 AS amount_eur,
    LOWER(status) AS status,

    -- Card Information 
    REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '') AS card_number,
    CAST(cvv AS VARCHAR) AS cvv,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  );
[0m09:09:53.020194 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:09:53.020345 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */

  create view "postgres"."analytics_staging"."stg_device__dbt_tmp"
    
    
  as (
    

SELECT
    -- Primary Key
    id AS device_id,

    -- Foreign Key to stores (assuming this links the device to a specific store)
    store_id,

    -- Descriptive Attributes
    type as device_type
    
    -- Other fields, if any, standardized here
    -- e.g., CAST(status AS VARCHAR) AS device_status

    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-21 07:09:52.574505+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."device"
  );
[0m09:09:53.023406 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:09:53.023524 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:09:53.026267 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:09:53.026407 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:09:53.027564 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:09:53.027710 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */
alter table "postgres"."analytics_staging"."stg_device" rename to "stg_device__dbt_backup"
[0m09:09:53.028812 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:09:53.028937 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */
alter table "postgres"."analytics_staging"."stg_store" rename to "stg_store__dbt_backup"
[0m09:09:53.029087 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
alter table "postgres"."analytics_staging"."stg_transaction" rename to "stg_transaction__dbt_backup"
[0m09:09:53.029436 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:09:53.030275 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:09:53.030405 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:09:53.030526 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */
alter table "postgres"."analytics_staging"."stg_device__dbt_tmp" rename to "stg_device"
[0m09:09:53.030642 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:09:53.031557 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:09:53.032514 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:09:53.032645 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:09:53.032764 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */
alter table "postgres"."analytics_staging"."stg_store__dbt_tmp" rename to "stg_store"
[0m09:09:53.032884 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
alter table "postgres"."analytics_staging"."stg_transaction__dbt_tmp" rename to "stg_transaction"
[0m09:09:53.038862 [debug] [Thread-1 (]: On model.sumup.stg_device: COMMIT
[0m09:09:53.039054 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:09:53.039173 [debug] [Thread-1 (]: On model.sumup.stg_device: COMMIT
[0m09:09:53.039378 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:09:53.039500 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:09:53.040047 [debug] [Thread-2 (]: On model.sumup.stg_store: COMMIT
[0m09:09:53.040178 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:09:53.040699 [debug] [Thread-3 (]: On model.sumup.stg_transaction: COMMIT
[0m09:09:53.040828 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:09:53.043052 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_device__dbt_backup"
[0m09:09:53.043189 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:09:53.043308 [debug] [Thread-2 (]: On model.sumup.stg_store: COMMIT
[0m09:09:53.044970 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:09:53.045091 [debug] [Thread-3 (]: On model.sumup.stg_transaction: COMMIT
[0m09:09:53.045238 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */
drop view if exists "postgres"."analytics_staging"."stg_device__dbt_backup" cascade
[0m09:09:53.045527 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m09:09:53.046227 [debug] [Thread-2 (]: Applying DROP to: "postgres"."analytics_staging"."stg_store__dbt_backup"
[0m09:09:53.046346 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:09:53.046588 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:09:53.047292 [debug] [Thread-3 (]: Applying DROP to: "postgres"."analytics_staging"."stg_transaction__dbt_backup"
[0m09:09:53.047426 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:09:53.047548 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */
drop view if exists "postgres"."analytics_staging"."stg_store__dbt_backup" cascade
[0m09:09:53.047778 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:09:53.048594 [debug] [Thread-1 (]: On model.sumup.stg_device: Close
[0m09:09:53.048738 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
drop view if exists "postgres"."analytics_staging"."stg_transaction__dbt_backup" cascade
[0m09:09:53.049704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58476d85-d1ed-4ce8-ba04-ea8824d33076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ee9440>]}
[0m09:09:53.049834 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:09:53.050064 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics_staging.stg_device .................. [[32mCREATE VIEW[0m in 0.06s]
[0m09:09:53.050213 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:09:53.050641 [debug] [Thread-2 (]: On model.sumup.stg_store: Close
[0m09:09:53.050822 [debug] [Thread-1 (]: Finished running node model.sumup.stg_device
[0m09:09:53.051223 [debug] [Thread-3 (]: On model.sumup.stg_transaction: Close
[0m09:09:53.051469 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58476d85-d1ed-4ce8-ba04-ea8824d33076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cb2990>]}
[0m09:09:53.051696 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics_staging.stg_store ................... [[32mCREATE VIEW[0m in 0.06s]
[0m09:09:53.051896 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58476d85-d1ed-4ce8-ba04-ea8824d33076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d188d0>]}
[0m09:09:53.052084 [debug] [Thread-2 (]: Finished running node model.sumup.stg_store
[0m09:09:53.052289 [info ] [Thread-3 (]: 3 of 5 OK created sql view model analytics_staging.stg_transaction ............. [[32mCREATE VIEW[0m in 0.06s]
[0m09:09:53.052540 [debug] [Thread-3 (]: Finished running node model.sumup.stg_transaction
[0m09:09:53.052782 [debug] [Thread-4 (]: Began running node model.sumup.int_transaction
[0m09:09:53.052971 [info ] [Thread-4 (]: 4 of 5 START sql view model analytics_analytics.int_transaction ................ [RUN]
[0m09:09:53.053173 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.sumup.int_transaction'
[0m09:09:53.053300 [debug] [Thread-4 (]: Began compiling node model.sumup.int_transaction
[0m09:09:53.054572 [debug] [Thread-4 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m09:09:53.054841 [debug] [Thread-4 (]: Began executing node model.sumup.int_transaction
[0m09:09:53.055996 [debug] [Thread-4 (]: Writing runtime sql for node "model.sumup.int_transaction"
[0m09:09:53.056256 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:09:53.056384 [debug] [Thread-4 (]: On model.sumup.int_transaction: BEGIN
[0m09:09:53.056504 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:09:53.060041 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m09:09:53.060186 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:09:53.060326 [debug] [Thread-4 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

  create view "postgres"."analytics_analytics"."int_transaction__dbt_tmp"
    
    
  as (
    SELECT
    -- Primary and Foreign Keys
    transaction_id,
    device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    amount_eur,
    status,

    --device data
    device_type,
    
    -- store_data
    store_id,
    store_name,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction"
left join "postgres"."analytics_staging"."stg_device" using (device_id)
left join "postgres"."analytics_staging"."stg_store" using (store_id)
  );
[0m09:09:53.065994 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:09:53.067192 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:09:53.067312 [debug] [Thread-4 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */
alter table "postgres"."analytics_analytics"."int_transaction__dbt_tmp" rename to "int_transaction"
[0m09:09:53.067930 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:09:53.068389 [debug] [Thread-4 (]: On model.sumup.int_transaction: COMMIT
[0m09:09:53.068502 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:09:53.068606 [debug] [Thread-4 (]: On model.sumup.int_transaction: COMMIT
[0m09:09:53.069010 [debug] [Thread-4 (]: SQL status: COMMIT in 0.000 seconds
[0m09:09:53.069703 [debug] [Thread-4 (]: Applying DROP to: "postgres"."analytics_analytics"."int_transaction__dbt_backup"
[0m09:09:53.069958 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:09:53.070106 [debug] [Thread-4 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */
drop view if exists "postgres"."analytics_analytics"."int_transaction__dbt_backup" cascade
[0m09:09:53.070386 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:09:53.070867 [debug] [Thread-4 (]: On model.sumup.int_transaction: Close
[0m09:09:53.071058 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58476d85-d1ed-4ce8-ba04-ea8824d33076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a27c280>]}
[0m09:09:53.071275 [info ] [Thread-4 (]: 4 of 5 OK created sql view model analytics_analytics.int_transaction ........... [[32mCREATE VIEW[0m in 0.02s]
[0m09:09:53.071483 [debug] [Thread-4 (]: Finished running node model.sumup.int_transaction
[0m09:09:53.071714 [debug] [Thread-1 (]: Began running node model.sumup.customer_store_ranking
[0m09:09:53.071914 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics_analytics.customer_store_ranking ......... [RUN]
[0m09:09:53.072085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.stg_device, now model.sumup.customer_store_ranking)
[0m09:09:53.072230 [debug] [Thread-1 (]: Began compiling node model.sumup.customer_store_ranking
[0m09:09:53.073139 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m09:09:53.073437 [debug] [Thread-1 (]: Began executing node model.sumup.customer_store_ranking
[0m09:09:53.076614 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.customer_store_ranking"
[0m09:09:53.076853 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m09:09:53.076970 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: BEGIN
[0m09:09:53.077082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:09:53.082121 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m09:09:53.082238 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m09:09:53.082354 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  create view "postgres"."analytics_analytics"."customer_store_ranking__dbt_tmp"
    
    
  as (
    SELECT
    store_name,
    SUM(transacted_amount) AS total_amount
FROM
    "postgres"."analytics_analytics"."int_transaction" 
GROUP BY
    store_name
ORDER BY
    total_amount DESC
LIMIT 10
  );
[0m09:09:53.083456 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "transacted_amount" does not exist
LINE 9:     SUM(transacted_amount) AS total_amount
                ^

[0m09:09:53.083573 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: ROLLBACK
[0m09:09:53.083811 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: Close
[0m09:09:53.088807 [debug] [Thread-1 (]: Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  column "transacted_amount" does not exist
  LINE 9:     SUM(transacted_amount) AS total_amount
                  ^
  compiled code at target/run/sumup/models/marts/core/customer_store_ranking.sql
[0m09:09:53.089045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58476d85-d1ed-4ce8-ba04-ea8824d33076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a168d70>]}
[0m09:09:53.089323 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model analytics_analytics.customer_store_ranking  [[31mERROR[0m in 0.02s]
[0m09:09:53.089552 [debug] [Thread-1 (]: Finished running node model.sumup.customer_store_ranking
[0m09:09:53.089748 [debug] [Thread-7 (]: Marking all children of 'model.sumup.customer_store_ranking' to be skipped because of status 'error'.  Reason: Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  column "transacted_amount" does not exist
  LINE 9:     SUM(transacted_amount) AS total_amount
                  ^
  compiled code at target/run/sumup/models/marts/core/customer_store_ranking.sql.
[0m09:09:53.090467 [debug] [MainThread]: Using postgres connection "master"
[0m09:09:53.090591 [debug] [MainThread]: On master: BEGIN
[0m09:09:53.090691 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:09:53.095766 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:09:53.095914 [debug] [MainThread]: On master: COMMIT
[0m09:09:53.096015 [debug] [MainThread]: Using postgres connection "master"
[0m09:09:53.096101 [debug] [MainThread]: On master: COMMIT
[0m09:09:53.096297 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:09:53.096391 [debug] [MainThread]: On master: Close
[0m09:09:53.096527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:09:53.096614 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m09:09:53.096694 [debug] [MainThread]: Connection 'model.sumup.stg_store' was properly closed.
[0m09:09:53.096774 [debug] [MainThread]: Connection 'model.sumup.stg_transaction' was properly closed.
[0m09:09:53.096851 [debug] [MainThread]: Connection 'model.sumup.int_transaction' was properly closed.
[0m09:09:53.096965 [info ] [MainThread]: 
[0m09:09:53.097078 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m09:09:53.097496 [debug] [MainThread]: Command end result
[0m09:09:53.105762 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:09:53.106577 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:09:53.108857 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:09:53.108967 [info ] [MainThread]: 
[0m09:09:53.109097 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:09:53.109208 [info ] [MainThread]: 
[0m09:09:53.109348 [error] [MainThread]: [31mFailure in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)[0m
[0m09:09:53.109485 [error] [MainThread]:   Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  column "transacted_amount" does not exist
  LINE 9:     SUM(transacted_amount) AS total_amount
                  ^
  compiled code at target/run/sumup/models/marts/core/customer_store_ranking.sql
[0m09:09:53.109586 [info ] [MainThread]: 
[0m09:09:53.109706 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/marts/core/customer_store_ranking.sql
[0m09:09:53.109809 [info ] [MainThread]: 
[0m09:09:53.109921 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m09:09:53.110114 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m09:09:53.112286 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.55566835, "process_in_blocks": "0", "process_kernel_time": 0.11813, "process_mem_max_rss": "130891776", "process_out_blocks": "0", "process_user_time": 0.886548}
[0m09:09:53.112456 [debug] [MainThread]: Command `dbt run` failed at 09:09:53.112425 after 0.56 seconds
[0m09:09:53.112596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10729b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108677cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a373dd0>]}
[0m09:09:53.112731 [debug] [MainThread]: Flushing usage events
[0m09:09:54.014016 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:10:05.719851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111214050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112737c50>]}


============================== 09:10:05.722315 | d84818c4-e140-4685-b1be-6d98a84d2e4a ==============================
[0m09:10:05.722315 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:10:05.722580 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'cache_selected_only': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run -m +customer_store_ranking', 'partial_parse': 'True', 'use_colors': 'True', 'empty': 'False', 'introspect': 'True', 'write_json': 'True', 'version_check': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'no_print': 'None', 'debug': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'log_cache_events': 'False', 'fail_fast': 'False'}
[0m09:10:05.722787 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m09:10:05.722933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd84818c4-e140-4685-b1be-6d98a84d2e4a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11261f6f0>]}
[0m09:10:05.797983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd84818c4-e140-4685-b1be-6d98a84d2e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125cacf0>]}
[0m09:10:05.818478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd84818c4-e140-4685-b1be-6d98a84d2e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125d7d50>]}
[0m09:10:05.819002 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:10:05.859023 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:10:05.907769 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:10:05.908033 [debug] [MainThread]: Partial parsing: updated file: sumup://models/marts/core/customer_store_ranking.sql
[0m09:10:05.992809 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m09:10:05.994624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd84818c4-e140-4685-b1be-6d98a84d2e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11363ee40>]}
[0m09:10:06.020704 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:10:06.021848 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:10:06.031972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd84818c4-e140-4685-b1be-6d98a84d2e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ba1710>]}
[0m09:10:06.032214 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m09:10:06.032348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd84818c4-e140-4685-b1be-6d98a84d2e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b7b6c0>]}
[0m09:10:06.033074 [info ] [MainThread]: 
[0m09:10:06.033218 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:10:06.033323 [info ] [MainThread]: 
[0m09:10:06.033521 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:10:06.035175 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:10:06.039321 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:10:06.084778 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:10:06.084979 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:10:06.085149 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:10:06.085339 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:10:06.085506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:10:06.085633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:10:06.106005 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.020 seconds
[0m09:10:06.106174 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.021 seconds
[0m09:10:06.106665 [debug] [ThreadPool]: On list_postgres: Close
[0m09:10:06.107099 [debug] [ThreadPool]: On list_postgres: Close
[0m09:10:06.107914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m09:10:06.110094 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:10:06.110253 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics)
[0m09:10:06.110360 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m09:10:06.110537 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m09:10:06.111196 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:10:06.111312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:10:06.112105 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:10:06.112212 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m09:10:06.112354 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m09:10:06.112464 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:10:06.112577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:10:06.116874 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m09:10:06.116991 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:10:06.117097 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m09:10:06.117215 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m09:10:06.117351 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:10:06.117495 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m09:10:06.117618 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m09:10:06.117738 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:10:06.117845 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:10:06.127372 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.010 seconds
[0m09:10:06.127487 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.010 seconds
[0m09:10:06.127955 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m09:10:06.128061 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m09:10:06.128476 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m09:10:06.128919 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m09:10:06.129031 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m09:10:06.129350 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m09:10:06.129452 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m09:10:06.131557 [debug] [MainThread]: Using postgres connection "master"
[0m09:10:06.131666 [debug] [MainThread]: On master: BEGIN
[0m09:10:06.131753 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:10:06.135526 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:10:06.135626 [debug] [MainThread]: Using postgres connection "master"
[0m09:10:06.135753 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:10:06.141410 [debug] [MainThread]: SQL status: SELECT 7 in 0.005 seconds
[0m09:10:06.142235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd84818c4-e140-4685-b1be-6d98a84d2e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b32990>]}
[0m09:10:06.142387 [debug] [MainThread]: On master: ROLLBACK
[0m09:10:06.142588 [debug] [MainThread]: Using postgres connection "master"
[0m09:10:06.142682 [debug] [MainThread]: On master: BEGIN
[0m09:10:06.142939 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:10:06.143038 [debug] [MainThread]: On master: COMMIT
[0m09:10:06.143130 [debug] [MainThread]: Using postgres connection "master"
[0m09:10:06.143218 [debug] [MainThread]: On master: COMMIT
[0m09:10:06.143383 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:10:06.143477 [debug] [MainThread]: On master: Close
[0m09:10:06.144568 [debug] [Thread-3 (]: Began running node model.sumup.stg_transaction
[0m09:10:06.144712 [debug] [Thread-2 (]: Began running node model.sumup.stg_store
[0m09:10:06.144851 [debug] [Thread-1 (]: Began running node model.sumup.stg_device
[0m09:10:06.145034 [info ] [Thread-3 (]: 3 of 5 START sql view model analytics_staging.stg_transaction .................. [RUN]
[0m09:10:06.145220 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics_staging.stg_store ........................ [RUN]
[0m09:10:06.145400 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics_staging.stg_device ....................... [RUN]
[0m09:10:06.145558 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.stg_transaction)
[0m09:10:06.145704 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.stg_store)
[0m09:10:06.145847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.stg_device)
[0m09:10:06.145979 [debug] [Thread-3 (]: Began compiling node model.sumup.stg_transaction
[0m09:10:06.146104 [debug] [Thread-2 (]: Began compiling node model.sumup.stg_store
[0m09:10:06.146227 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_device
[0m09:10:06.149222 [debug] [Thread-3 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m09:10:06.150172 [debug] [Thread-2 (]: Writing injected SQL for node "model.sumup.stg_store"
[0m09:10:06.151461 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_device"
[0m09:10:06.151787 [debug] [Thread-3 (]: Began executing node model.sumup.stg_transaction
[0m09:10:06.156982 [debug] [Thread-2 (]: Began executing node model.sumup.stg_store
[0m09:10:06.163417 [debug] [Thread-1 (]: Began executing node model.sumup.stg_device
[0m09:10:06.165982 [debug] [Thread-2 (]: Writing runtime sql for node "model.sumup.stg_store"
[0m09:10:06.166188 [debug] [Thread-3 (]: Writing runtime sql for node "model.sumup.stg_transaction"
[0m09:10:06.167232 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.stg_device"
[0m09:10:06.167589 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:10:06.167753 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:10:06.167884 [debug] [Thread-3 (]: On model.sumup.stg_transaction: BEGIN
[0m09:10:06.168005 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:10:06.168120 [debug] [Thread-1 (]: On model.sumup.stg_device: BEGIN
[0m09:10:06.168234 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:10:06.168352 [debug] [Thread-2 (]: On model.sumup.stg_store: BEGIN
[0m09:10:06.168466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:06.168639 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:10:06.173627 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m09:10:06.173769 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m09:10:06.173892 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:10:06.174018 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:10:06.174173 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  create view "postgres"."analytics_staging"."stg_transaction__dbt_tmp"
    
    
  as (
    SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) / 100 AS amount_eur,
    LOWER(status) AS status,

    -- Card Information 
    REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '') AS card_number,
    CAST(cvv AS VARCHAR) AS cvv,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  );
[0m09:10:06.174329 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m09:10:06.174462 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */

  create view "postgres"."analytics_staging"."stg_store__dbt_tmp"
    
    
  as (
    

SELECT
    -- Primary Key: Rename to be explicit
    id AS store_id,
    name AS store_name,

    -- Descriptive Attributes: Rename 'typology' for clarity
    typology AS store_typology,
    country,
    city
    
    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-21 07:10:05.710063+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."store"
  );
[0m09:10:06.174621 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:10:06.174771 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */

  create view "postgres"."analytics_staging"."stg_device__dbt_tmp"
    
    
  as (
    

SELECT
    -- Primary Key
    id AS device_id,

    -- Foreign Key to stores (assuming this links the device to a specific store)
    store_id,

    -- Descriptive Attributes
    type as device_type
    
    -- Other fields, if any, standardized here
    -- e.g., CAST(status AS VARCHAR) AS device_status

    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-21 07:10:05.710063+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."device"
  );
[0m09:10:06.177500 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:10:06.179983 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:10:06.180135 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:10:06.180255 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:10:06.180376 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */
alter table "postgres"."analytics_staging"."stg_device" rename to "stg_device__dbt_backup"
[0m09:10:06.181411 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:10:06.182460 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:10:06.182605 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */
alter table "postgres"."analytics_staging"."stg_store" rename to "stg_store__dbt_backup"
[0m09:10:06.182727 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
alter table "postgres"."analytics_staging"."stg_transaction" rename to "stg_transaction__dbt_backup"
[0m09:10:06.182939 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:10:06.183780 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:10:06.183906 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:10:06.184037 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */
alter table "postgres"."analytics_staging"."stg_device__dbt_tmp" rename to "stg_device"
[0m09:10:06.184153 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:10:06.185040 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:10:06.186039 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:10:06.186173 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:10:06.186292 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */
alter table "postgres"."analytics_staging"."stg_store__dbt_tmp" rename to "stg_store"
[0m09:10:06.186425 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
alter table "postgres"."analytics_staging"."stg_transaction__dbt_tmp" rename to "stg_transaction"
[0m09:10:06.192300 [debug] [Thread-1 (]: On model.sumup.stg_device: COMMIT
[0m09:10:06.192503 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:10:06.192625 [debug] [Thread-1 (]: On model.sumup.stg_device: COMMIT
[0m09:10:06.192772 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:10:06.193314 [debug] [Thread-2 (]: On model.sumup.stg_store: COMMIT
[0m09:10:06.193442 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:10:06.193555 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:10:06.193673 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:10:06.194161 [debug] [Thread-3 (]: On model.sumup.stg_transaction: COMMIT
[0m09:10:06.196311 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_device__dbt_backup"
[0m09:10:06.196437 [debug] [Thread-2 (]: On model.sumup.stg_store: COMMIT
[0m09:10:06.196552 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:10:06.198156 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_device"
[0m09:10:06.198298 [debug] [Thread-3 (]: On model.sumup.stg_transaction: COMMIT
[0m09:10:06.198421 [debug] [Thread-1 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */
drop view if exists "postgres"."analytics_staging"."stg_device__dbt_backup" cascade
[0m09:10:06.198569 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m09:10:06.199267 [debug] [Thread-2 (]: Applying DROP to: "postgres"."analytics_staging"."stg_store__dbt_backup"
[0m09:10:06.199383 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:10:06.199622 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m09:10:06.200289 [debug] [Thread-3 (]: Applying DROP to: "postgres"."analytics_staging"."stg_transaction__dbt_backup"
[0m09:10:06.200420 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:10:06.200539 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */
drop view if exists "postgres"."analytics_staging"."stg_store__dbt_backup" cascade
[0m09:10:06.200764 [debug] [Thread-3 (]: Using postgres connection "model.sumup.stg_transaction"
[0m09:10:06.201573 [debug] [Thread-1 (]: On model.sumup.stg_device: Close
[0m09:10:06.201716 [debug] [Thread-3 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */
drop view if exists "postgres"."analytics_staging"."stg_transaction__dbt_backup" cascade
[0m09:10:06.202512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd84818c4-e140-4685-b1be-6d98a84d2e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b95a70>]}
[0m09:10:06.202742 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics_staging.stg_device .................. [[32mCREATE VIEW[0m in 0.06s]
[0m09:10:06.202956 [debug] [Thread-1 (]: Finished running node model.sumup.stg_device
[0m09:10:06.204833 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m09:10:06.204959 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m09:10:06.205382 [debug] [Thread-2 (]: On model.sumup.stg_store: Close
[0m09:10:06.205776 [debug] [Thread-3 (]: On model.sumup.stg_transaction: Close
[0m09:10:06.205962 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd84818c4-e140-4685-b1be-6d98a84d2e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11391a8f0>]}
[0m09:10:06.206121 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd84818c4-e140-4685-b1be-6d98a84d2e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113eb3da0>]}
[0m09:10:06.206326 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics_staging.stg_store ................... [[32mCREATE VIEW[0m in 0.06s]
[0m09:10:06.206725 [debug] [Thread-2 (]: Finished running node model.sumup.stg_store
[0m09:10:06.206507 [info ] [Thread-3 (]: 3 of 5 OK created sql view model analytics_staging.stg_transaction ............. [[32mCREATE VIEW[0m in 0.06s]
[0m09:10:06.206981 [debug] [Thread-3 (]: Finished running node model.sumup.stg_transaction
[0m09:10:06.207209 [debug] [Thread-4 (]: Began running node model.sumup.int_transaction
[0m09:10:06.207394 [info ] [Thread-4 (]: 4 of 5 START sql view model analytics_analytics.int_transaction ................ [RUN]
[0m09:10:06.207603 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.sumup.int_transaction'
[0m09:10:06.207748 [debug] [Thread-4 (]: Began compiling node model.sumup.int_transaction
[0m09:10:06.209086 [debug] [Thread-4 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m09:10:06.209364 [debug] [Thread-4 (]: Began executing node model.sumup.int_transaction
[0m09:10:06.210591 [debug] [Thread-4 (]: Writing runtime sql for node "model.sumup.int_transaction"
[0m09:10:06.210862 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:10:06.210977 [debug] [Thread-4 (]: On model.sumup.int_transaction: BEGIN
[0m09:10:06.211091 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:10:06.215582 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m09:10:06.215700 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:10:06.215837 [debug] [Thread-4 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

  create view "postgres"."analytics_analytics"."int_transaction__dbt_tmp"
    
    
  as (
    SELECT
    -- Primary and Foreign Keys
    transaction_id,
    device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    amount_eur,
    status,

    --device data
    device_type,
    
    -- store_data
    store_id,
    store_name,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction"
left join "postgres"."analytics_staging"."stg_device" using (device_id)
left join "postgres"."analytics_staging"."stg_store" using (store_id)
  );
[0m09:10:06.221294 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:10:06.222410 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:10:06.222532 [debug] [Thread-4 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */
alter table "postgres"."analytics_analytics"."int_transaction__dbt_tmp" rename to "int_transaction"
[0m09:10:06.223143 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:10:06.223601 [debug] [Thread-4 (]: On model.sumup.int_transaction: COMMIT
[0m09:10:06.223715 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:10:06.223821 [debug] [Thread-4 (]: On model.sumup.int_transaction: COMMIT
[0m09:10:06.224444 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:10:06.225100 [debug] [Thread-4 (]: Applying DROP to: "postgres"."analytics_analytics"."int_transaction__dbt_backup"
[0m09:10:06.225328 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m09:10:06.225442 [debug] [Thread-4 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */
drop view if exists "postgres"."analytics_analytics"."int_transaction__dbt_backup" cascade
[0m09:10:06.225695 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:10:06.226098 [debug] [Thread-4 (]: On model.sumup.int_transaction: Close
[0m09:10:06.226280 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd84818c4-e140-4685-b1be-6d98a84d2e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113eb4210>]}
[0m09:10:06.226489 [info ] [Thread-4 (]: 4 of 5 OK created sql view model analytics_analytics.int_transaction ........... [[32mCREATE VIEW[0m in 0.02s]
[0m09:10:06.226696 [debug] [Thread-4 (]: Finished running node model.sumup.int_transaction
[0m09:10:06.226954 [debug] [Thread-1 (]: Began running node model.sumup.customer_store_ranking
[0m09:10:06.227140 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics_analytics.customer_store_ranking ......... [RUN]
[0m09:10:06.227289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.stg_device, now model.sumup.customer_store_ranking)
[0m09:10:06.227405 [debug] [Thread-1 (]: Began compiling node model.sumup.customer_store_ranking
[0m09:10:06.228225 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m09:10:06.228451 [debug] [Thread-1 (]: Began executing node model.sumup.customer_store_ranking
[0m09:10:06.231356 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.customer_store_ranking"
[0m09:10:06.231572 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m09:10:06.231691 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: BEGIN
[0m09:10:06.231805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:06.236612 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m09:10:06.236738 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m09:10:06.236863 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  create view "postgres"."analytics_analytics"."customer_store_ranking__dbt_tmp"
    
    
  as (
    SELECT
    store_name,
    SUM(amount_eur) AS total_amount
FROM
    "postgres"."analytics_analytics"."int_transaction" 
GROUP BY
    store_name
ORDER BY
    total_amount DESC
LIMIT 10
  );
[0m09:10:06.240617 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:10:06.241572 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m09:10:06.241689 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */
alter table "postgres"."analytics_analytics"."customer_store_ranking__dbt_tmp" rename to "customer_store_ranking"
[0m09:10:06.242169 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:10:06.242599 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: COMMIT
[0m09:10:06.242710 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m09:10:06.242812 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: COMMIT
[0m09:10:06.243200 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m09:10:06.243988 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_analytics"."customer_store_ranking__dbt_backup"
[0m09:10:06.244213 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m09:10:06.244329 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */
drop view if exists "postgres"."analytics_analytics"."customer_store_ranking__dbt_backup" cascade
[0m09:10:06.244598 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:10:06.244979 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: Close
[0m09:10:06.245176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd84818c4-e140-4685-b1be-6d98a84d2e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b1b290>]}
[0m09:10:06.245383 [info ] [Thread-1 (]: 5 of 5 OK created sql view model analytics_analytics.customer_store_ranking .... [[32mCREATE VIEW[0m in 0.02s]
[0m09:10:06.245585 [debug] [Thread-1 (]: Finished running node model.sumup.customer_store_ranking
[0m09:10:06.246060 [debug] [MainThread]: Using postgres connection "master"
[0m09:10:06.246180 [debug] [MainThread]: On master: BEGIN
[0m09:10:06.246273 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:10:06.250684 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:10:06.250790 [debug] [MainThread]: On master: COMMIT
[0m09:10:06.250884 [debug] [MainThread]: Using postgres connection "master"
[0m09:10:06.250971 [debug] [MainThread]: On master: COMMIT
[0m09:10:06.251156 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:10:06.251247 [debug] [MainThread]: On master: Close
[0m09:10:06.251366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:10:06.251452 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m09:10:06.251533 [debug] [MainThread]: Connection 'model.sumup.stg_store' was properly closed.
[0m09:10:06.251613 [debug] [MainThread]: Connection 'model.sumup.stg_transaction' was properly closed.
[0m09:10:06.251690 [debug] [MainThread]: Connection 'model.sumup.int_transaction' was properly closed.
[0m09:10:06.251809 [info ] [MainThread]: 
[0m09:10:06.251983 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m09:10:06.252412 [debug] [MainThread]: Command end result
[0m09:10:06.261090 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:10:06.261806 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:10:06.264111 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:10:06.264222 [info ] [MainThread]: 
[0m09:10:06.264358 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:10:06.264466 [info ] [MainThread]: 
[0m09:10:06.264583 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m09:10:06.264802 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m09:10:06.266451 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.57412905, "process_in_blocks": "0", "process_kernel_time": 0.116213, "process_mem_max_rss": "129105920", "process_out_blocks": "0", "process_user_time": 0.89248}
[0m09:10:06.266617 [debug] [MainThread]: Command `dbt run` succeeded at 09:10:06.266584 after 0.57 seconds
[0m09:10:06.266749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ab39b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113655a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113eb9f70>]}
[0m09:10:06.266873 [debug] [MainThread]: Flushing usage events
[0m09:10:07.309894 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:10:41.588102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10628c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070cb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070cbc50>]}


============================== 09:10:41.590641 | f628d553-daaa-46e5-8368-b19b626e976e ==============================
[0m09:10:41.590641 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:10:41.590901 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'invocation_command': 'dbt show --select customer_store_ranking', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'target_path': 'None', 'static_parser': 'True', 'warn_error': 'None', 'debug': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'use_colors': 'True', 'write_json': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'no_print': 'None', 'fail_fast': 'False', 'printer_width': '80'}
[0m09:10:41.666247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f628d553-daaa-46e5-8368-b19b626e976e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ef950>]}
[0m09:10:41.686576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f628d553-daaa-46e5-8368-b19b626e976e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f62cf0>]}
[0m09:10:41.696332 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:10:41.735261 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:10:41.785323 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:10:41.785490 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:10:41.787679 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m09:10:41.799663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f628d553-daaa-46e5-8368-b19b626e976e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b8550>]}
[0m09:10:41.824365 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:10:41.825361 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:10:41.826313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f628d553-daaa-46e5-8368-b19b626e976e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f0ad50>]}
[0m09:10:41.826482 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m09:10:41.826610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f628d553-daaa-46e5-8368-b19b626e976e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077f9d30>]}
[0m09:10:41.827250 [info ] [MainThread]: 
[0m09:10:41.827386 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:10:41.827488 [info ] [MainThread]: 
[0m09:10:41.827701 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:10:41.829281 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m09:10:41.833877 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m09:10:41.835039 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m09:10:41.855182 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:10:41.855372 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:10:41.855536 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:10:41.855687 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m09:10:41.855814 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m09:10:41.855940 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m09:10:41.856063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:10:41.856176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:10:41.856280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:10:41.873870 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m09:10:41.874047 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m09:10:41.874168 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:10:41.874287 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m09:10:41.874408 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:10:41.874533 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:10:41.874658 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:10:41.874778 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m09:10:41.874933 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m09:10:41.880385 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m09:10:41.880494 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m09:10:41.880600 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m09:10:41.881158 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m09:10:41.881588 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m09:10:41.881991 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m09:10:41.882242 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m09:10:41.882349 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m09:10:41.882551 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m09:10:41.885127 [debug] [MainThread]: Using postgres connection "master"
[0m09:10:41.885246 [debug] [MainThread]: On master: BEGIN
[0m09:10:41.885337 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:10:41.890286 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:10:41.890393 [debug] [MainThread]: Using postgres connection "master"
[0m09:10:41.890525 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:10:41.896653 [debug] [MainThread]: SQL status: SELECT 8 in 0.006 seconds
[0m09:10:41.897574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f628d553-daaa-46e5-8368-b19b626e976e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082371e0>]}
[0m09:10:41.897725 [debug] [MainThread]: On master: ROLLBACK
[0m09:10:41.897937 [debug] [MainThread]: On master: Close
[0m09:10:41.899076 [debug] [Thread-1 (]: Began running node model.sumup.customer_store_ranking
[0m09:10:41.899229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.customer_store_ranking)
[0m09:10:41.899356 [debug] [Thread-1 (]: Began compiling node model.sumup.customer_store_ranking
[0m09:10:41.902146 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m09:10:41.902425 [debug] [Thread-1 (]: Began executing node model.sumup.customer_store_ranking
[0m09:10:41.905340 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m09:10:41.905489 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  
  SELECT
    store_name,
    SUM(amount_eur) AS total_amount
FROM
    "postgres"."analytics_analytics"."int_transaction" 
GROUP BY
    store_name
ORDER BY
    total_amount DESC
LIMIT 10
  
  limit 5

[0m09:10:41.905612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:41.910009 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "limit"
LINE 15:   limit 5
           ^

[0m09:10:41.910166 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: Close
[0m09:10:41.913306 [debug] [Thread-1 (]: Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  syntax error at or near "limit"
  LINE 15:   limit 5
             ^
[0m09:10:41.913553 [debug] [Thread-1 (]: Finished running node model.sumup.customer_store_ranking
[0m09:10:41.913754 [debug] [Thread-7 (]: Marking all children of 'model.sumup.customer_store_ranking' to be skipped because of status 'error'.  Reason: Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  syntax error at or near "limit"
  LINE 15:   limit 5
             ^.
[0m09:10:41.914146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:10:41.914302 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m09:10:41.914412 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m09:10:41.914503 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m09:10:41.914670 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
    syntax error at or near "limit"
    LINE 15:   limit 5
               ^
[0m09:10:41.916147 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.35482264, "process_in_blocks": "0", "process_kernel_time": 0.121697, "process_mem_max_rss": "124911616", "process_out_blocks": "0", "process_user_time": 0.712927}
[0m09:10:41.916319 [debug] [MainThread]: Command `dbt show` failed at 09:10:41.916285 after 0.36 seconds
[0m09:10:41.916453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f41f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108459390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108459440>]}
[0m09:10:41.916580 [debug] [MainThread]: Flushing usage events
[0m09:10:42.609986 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:10:50.601548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106720050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a33c50>]}


============================== 09:10:50.603508 | 9c235570-7afb-4b5f-9717-911011a5f786 ==============================
[0m09:10:50.603508 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:10:50.603782 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt show --select customer_store_ranking', 'write_json': 'True', 'warn_error': 'None', 'introspect': 'True', 'version_check': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'log_cache_events': 'False', 'log_format': 'default', 'target_path': 'None', 'use_colors': 'True', 'fail_fast': 'False', 'no_print': 'None', 'debug': 'False', 'empty': 'None', 'quiet': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'static_parser': 'True', 'printer_width': '80', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False'}
[0m09:10:50.668142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c235570-7afb-4b5f-9717-911011a5f786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106883950>]}
[0m09:10:50.689930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c235570-7afb-4b5f-9717-911011a5f786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fcacf0>]}
[0m09:10:50.695011 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:10:50.732864 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:10:50.774627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:10:50.774822 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:10:50.777040 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m09:10:50.789170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c235570-7afb-4b5f-9717-911011a5f786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a74550>]}
[0m09:10:50.814605 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:10:50.815469 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:10:50.816412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c235570-7afb-4b5f-9717-911011a5f786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128c6d50>]}
[0m09:10:50.816576 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m09:10:50.816710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c235570-7afb-4b5f-9717-911011a5f786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121b5d30>]}
[0m09:10:50.817290 [info ] [MainThread]: 
[0m09:10:50.817428 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:10:50.817530 [info ] [MainThread]: 
[0m09:10:50.817739 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:10:50.819333 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m09:10:50.819573 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m09:10:50.824974 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m09:10:50.837823 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:10:50.838009 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:10:50.838231 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:10:50.838385 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m09:10:50.838540 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m09:10:50.838668 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m09:10:50.838788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:10:50.838890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:10:50.838982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:10:50.859393 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m09:10:50.859589 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m09:10:50.859738 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:10:50.859886 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:10:50.860016 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m09:10:50.860151 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m09:10:50.860294 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:10:50.860465 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:10:50.860627 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m09:10:50.864160 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m09:10:50.864269 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m09:10:50.864847 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m09:10:50.864978 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m09:10:50.865436 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m09:10:50.865959 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m09:10:50.866082 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m09:10:50.866312 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m09:10:50.866417 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m09:10:50.868988 [debug] [MainThread]: Using postgres connection "master"
[0m09:10:50.869105 [debug] [MainThread]: On master: BEGIN
[0m09:10:50.869199 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:10:50.873342 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:10:50.873446 [debug] [MainThread]: Using postgres connection "master"
[0m09:10:50.873571 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:10:50.878120 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m09:10:50.879030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c235570-7afb-4b5f-9717-911011a5f786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d6f1e0>]}
[0m09:10:50.879179 [debug] [MainThread]: On master: ROLLBACK
[0m09:10:50.879392 [debug] [MainThread]: On master: Close
[0m09:10:50.880558 [debug] [Thread-1 (]: Began running node model.sumup.customer_store_ranking
[0m09:10:50.880721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.customer_store_ranking)
[0m09:10:50.880852 [debug] [Thread-1 (]: Began compiling node model.sumup.customer_store_ranking
[0m09:10:50.883682 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m09:10:50.883955 [debug] [Thread-1 (]: Began executing node model.sumup.customer_store_ranking
[0m09:10:50.886850 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m09:10:50.886982 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  
  SELECT
    store_name,
    SUM(amount_eur) AS total_amount
FROM
    "postgres"."analytics_analytics"."int_transaction" 
GROUP BY
    store_name
ORDER BY
    total_amount DESC
LIMIT 10
  
  limit 5

[0m09:10:50.887100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:50.891895 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "limit"
LINE 15:   limit 5
           ^

[0m09:10:50.892045 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: Close
[0m09:10:50.895004 [debug] [Thread-1 (]: Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  syntax error at or near "limit"
  LINE 15:   limit 5
             ^
[0m09:10:50.895230 [debug] [Thread-1 (]: Finished running node model.sumup.customer_store_ranking
[0m09:10:50.895417 [debug] [Thread-7 (]: Marking all children of 'model.sumup.customer_store_ranking' to be skipped because of status 'error'.  Reason: Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
  syntax error at or near "limit"
  LINE 15:   limit 5
             ^.
[0m09:10:50.895781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:10:50.895926 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m09:10:50.896057 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m09:10:50.896161 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m09:10:50.896322 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model customer_store_ranking (models/marts/core/customer_store_ranking.sql)
    syntax error at or near "limit"
    LINE 15:   limit 5
               ^
[0m09:10:50.897751 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.32287186, "process_in_blocks": "0", "process_kernel_time": 0.097355, "process_mem_max_rss": "126369792", "process_out_blocks": "0", "process_user_time": 0.723028}
[0m09:10:50.897916 [debug] [MainThread]: Command `dbt show` failed at 09:10:50.897882 after 0.32 seconds
[0m09:10:50.898050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fa9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f91390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f91440>]}
[0m09:10:50.898172 [debug] [MainThread]: Flushing usage events
[0m09:10:51.586176 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:11:07.681735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108264050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090a39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090a3c50>]}


============================== 09:11:07.684188 | f07ee81e-5e84-4e36-96d2-0c3aba65b5e2 ==============================
[0m09:11:07.684188 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:11:07.684447 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'fail_fast': 'False', 'empty': 'None', 'invocation_command': 'dbt show --select customer_store_ranking', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'introspect': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'use_colors': 'True', 'warn_error': 'None', 'printer_width': '80', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'write_json': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'version_check': 'True', 'no_print': 'None'}
[0m09:11:07.765428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f07ee81e-5e84-4e36-96d2-0c3aba65b5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083c7950>]}
[0m09:11:07.786091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f07ee81e-5e84-4e36-96d2-0c3aba65b5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f3acf0>]}
[0m09:11:07.795756 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:11:07.834138 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:11:07.886525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:11:07.886808 [debug] [MainThread]: Partial parsing: updated file: sumup://models/marts/core/customer_store_ranking.sql
[0m09:11:07.971996 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m09:11:07.973848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f07ee81e-5e84-4e36-96d2-0c3aba65b5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a090250>]}
[0m09:11:07.998727 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:11:07.999822 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:11:08.000803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f07ee81e-5e84-4e36-96d2-0c3aba65b5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ee2d50>]}
[0m09:11:08.000975 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m09:11:08.001108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f07ee81e-5e84-4e36-96d2-0c3aba65b5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097d09f0>]}
[0m09:11:08.001696 [info ] [MainThread]: 
[0m09:11:08.001829 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:11:08.001929 [info ] [MainThread]: 
[0m09:11:08.002125 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:11:08.003789 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m09:11:08.007865 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m09:11:08.010702 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m09:11:08.053070 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:11:08.053273 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:11:08.053421 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:11:08.053563 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m09:11:08.053695 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m09:11:08.053824 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m09:11:08.053943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:11:08.054057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:11:08.054164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:11:08.071881 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m09:11:08.072110 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m09:11:08.072269 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m09:11:08.072395 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:11:08.072513 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:11:08.072615 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:11:08.072726 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m09:11:08.072851 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m09:11:08.072968 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:11:08.078000 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m09:11:08.078116 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m09:11:08.078682 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m09:11:08.078800 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m09:11:08.079219 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m09:11:08.079694 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m09:11:08.079810 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m09:11:08.080036 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m09:11:08.080346 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m09:11:08.082668 [debug] [MainThread]: Using postgres connection "master"
[0m09:11:08.082796 [debug] [MainThread]: On master: BEGIN
[0m09:11:08.082894 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:11:08.087795 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:11:08.087901 [debug] [MainThread]: Using postgres connection "master"
[0m09:11:08.088029 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:11:08.094043 [debug] [MainThread]: SQL status: SELECT 8 in 0.006 seconds
[0m09:11:08.095002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f07ee81e-5e84-4e36-96d2-0c3aba65b5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a20d3d0>]}
[0m09:11:08.095156 [debug] [MainThread]: On master: ROLLBACK
[0m09:11:08.095370 [debug] [MainThread]: On master: Close
[0m09:11:08.096450 [debug] [Thread-1 (]: Began running node model.sumup.customer_store_ranking
[0m09:11:08.096606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.customer_store_ranking)
[0m09:11:08.096742 [debug] [Thread-1 (]: Began compiling node model.sumup.customer_store_ranking
[0m09:11:08.099783 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m09:11:08.100066 [debug] [Thread-1 (]: Began executing node model.sumup.customer_store_ranking
[0m09:11:08.102575 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m09:11:08.102742 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  
  SELECT
    store_name,
    SUM(amount_eur) AS total_amount
FROM
    "postgres"."analytics_analytics"."int_transaction" 
GROUP BY
    store_name
ORDER BY
    total_amount DESC
  
  limit 5

[0m09:11:08.102883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:11:08.115192 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.012 seconds
[0m09:11:08.116065 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: Close
[0m09:11:08.116332 [debug] [Thread-1 (]: Finished running node model.sumup.customer_store_ranking
[0m09:11:08.116755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:11:08.116870 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m09:11:08.116967 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m09:11:08.117059 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m09:11:08.117288 [debug] [MainThread]: Command end result
[0m09:11:08.125741 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:11:08.126384 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:11:08.128839 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:11:08.129146 [info ] [MainThread]: Previewing node 'customer_store_ranking':
| store_name           | total_amount |
| -------------------- | ------------ |
| Sem Ut Cursus Corp.  |       262.30 |
| Eleifend Cras Ins... |       262.06 |
| Nec Ante Ltd         |       260.47 |
| Magnis Dis Inc.      |       188.51 |
| Mauris Aliquam PC    |       181.93 |

[0m09:11:08.131292 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 0.47530735, "process_in_blocks": "0", "process_kernel_time": 0.11411, "process_mem_max_rss": "129892352", "process_out_blocks": "0", "process_user_time": 0.824867}
[0m09:11:08.131455 [debug] [MainThread]: Command `dbt show` succeeded at 09:11:08.131425 after 0.48 seconds
[0m09:11:08.131579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f19f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3a9bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3a9a70>]}
[0m09:11:08.131703 [debug] [MainThread]: Flushing usage events
[0m09:11:08.881337 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:12:10.113140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105960050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679fc50>]}


============================== 09:12:10.115891 | ef45f3ba-7cc9-493a-8ecb-c9575524c914 ==============================
[0m09:12:10.115891 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:12:10.116154 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'invocation_command': 'dbt show --select customer_store_ranking', 'write_json': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'target_path': 'None', 'quiet': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'log_format': 'default', 'fail_fast': 'False', 'printer_width': '80', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'no_print': 'None', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m09:12:10.197758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef45f3ba-7cc9-493a-8ecb-c9575524c914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac3950>]}
[0m09:12:10.218796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef45f3ba-7cc9-493a-8ecb-c9575524c914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106636cf0>]}
[0m09:12:10.228608 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:12:10.267248 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:12:10.323859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:12:10.324162 [debug] [MainThread]: Partial parsing: updated file: sumup://models/marts/core/customer_store_ranking.sql
[0m09:12:10.411607 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m09:12:10.413498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef45f3ba-7cc9-493a-8ecb-c9575524c914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10778c250>]}
[0m09:12:10.438686 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:12:10.439979 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:12:10.440988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef45f3ba-7cc9-493a-8ecb-c9575524c914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075ded50>]}
[0m09:12:10.441160 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m09:12:10.441288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef45f3ba-7cc9-493a-8ecb-c9575524c914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ecc9f0>]}
[0m09:12:10.441887 [info ] [MainThread]: 
[0m09:12:10.442021 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:12:10.442124 [info ] [MainThread]: 
[0m09:12:10.442318 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:12:10.443910 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m09:12:10.447964 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m09:12:10.450149 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m09:12:10.496812 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:12:10.497009 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:12:10.497174 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:12:10.497329 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m09:12:10.497461 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m09:12:10.497584 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m09:12:10.497702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:10.497821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:10.497941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:10.517105 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m09:12:10.517306 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m09:12:10.517450 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m09:12:10.517578 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:12:10.517703 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:12:10.517823 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:12:10.517951 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m09:12:10.518092 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m09:12:10.518230 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:12:10.524478 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m09:12:10.524582 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m09:12:10.525119 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m09:12:10.525600 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m09:12:10.525720 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m09:12:10.526228 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m09:12:10.526343 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m09:12:10.526462 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m09:12:10.526591 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m09:12:10.529195 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:10.529314 [debug] [MainThread]: On master: BEGIN
[0m09:12:10.529407 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:12:10.534399 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:12:10.534505 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:10.534633 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:12:10.540727 [debug] [MainThread]: SQL status: SELECT 8 in 0.006 seconds
[0m09:12:10.541643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef45f3ba-7cc9-493a-8ecb-c9575524c914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107909160>]}
[0m09:12:10.541795 [debug] [MainThread]: On master: ROLLBACK
[0m09:12:10.542010 [debug] [MainThread]: On master: Close
[0m09:12:10.543206 [debug] [Thread-1 (]: Began running node model.sumup.customer_store_ranking
[0m09:12:10.543358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.customer_store_ranking)
[0m09:12:10.543489 [debug] [Thread-1 (]: Began compiling node model.sumup.customer_store_ranking
[0m09:12:10.546575 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m09:12:10.547063 [debug] [Thread-1 (]: Began executing node model.sumup.customer_store_ranking
[0m09:12:10.549665 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m09:12:10.549801 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  
  SELECT
    store_name,
    SUM(amount_eur) AS total_amount
FROM
    "postgres"."analytics_analytics"."int_transaction" 
WHERE status = 'accepted'
GROUP BY
    store_name
ORDER BY
    total_amount DESC
--limit 10
  
  limit 5

[0m09:12:10.549922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:10.560751 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.011 seconds
[0m09:12:10.561667 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: Close
[0m09:12:10.561944 [debug] [Thread-1 (]: Finished running node model.sumup.customer_store_ranking
[0m09:12:10.562344 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:12:10.562457 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m09:12:10.562554 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m09:12:10.562642 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m09:12:10.562870 [debug] [MainThread]: Command end result
[0m09:12:10.571633 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:12:10.572279 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:12:10.575017 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:12:10.575334 [info ] [MainThread]: Previewing node 'customer_store_ranking':
| store_name           | total_amount |
| -------------------- | ------------ |
| Nec Ante Ltd         |        93.83 |
| Sem Ut Cursus Corp.  |        89.09 |
| Magnis Dis Inc.      |        73.34 |
| Blandit At Nisi Inc. |        73.26 |
| Volutpat Nunc Sit... |        68.53 |

[0m09:12:10.576814 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 0.4962636, "process_in_blocks": "0", "process_kernel_time": 0.130368, "process_mem_max_rss": "129040384", "process_out_blocks": "0", "process_user_time": 0.818253}
[0m09:12:10.576984 [debug] [MainThread]: Command `dbt show` succeeded at 09:12:10.576952 after 0.50 seconds
[0m09:12:10.577115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106615f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a85bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a85860>]}
[0m09:12:10.577241 [debug] [MainThread]: Flushing usage events
[0m09:12:11.269849 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:54:42.269244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108624050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094679d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109467c50>]}


============================== 09:54:42.273262 | 3eb1847b-026e-4faa-b1b3-c19517f7066a ==============================
[0m09:54:42.273262 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:54:42.273541 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'empty': 'None', 'debug': 'False', 'version_check': 'True', 'printer_width': '80', 'no_print': 'None', 'quiet': 'False', 'write_json': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'use_colors': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt show --select customer_store_ranking', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_format': 'default'}
[0m09:54:42.367102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3eb1847b-026e-4faa-b1b3-c19517f7066a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108787950>]}
[0m09:54:42.389697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3eb1847b-026e-4faa-b1b3-c19517f7066a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092facf0>]}
[0m09:54:42.400583 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:54:42.442654 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:54:42.505252 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m09:54:42.505523 [debug] [MainThread]: Partial parsing: added file: sumup://models/intermediate/core/int_transaction.yml
[0m09:54:42.505637 [debug] [MainThread]: Partial parsing: deleted file: sumup://models/intermediate/core/int_analytics_store.sql
[0m09:54:42.505778 [debug] [MainThread]: Partial parsing: updated file: sumup://models/marts/core/device_adoption.sql
[0m09:54:42.598820 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m09:54:42.600866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3eb1847b-026e-4faa-b1b3-c19517f7066a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a453c50>]}
[0m09:54:42.655969 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:54:42.657186 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:54:42.658298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3eb1847b-026e-4faa-b1b3-c19517f7066a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2a2d50>]}
[0m09:54:42.658463 [info ] [MainThread]: Found 3 seeds, 8 models, 447 macros
[0m09:54:42.658589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3eb1847b-026e-4faa-b1b3-c19517f7066a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a23a190>]}
[0m09:54:42.659172 [info ] [MainThread]: 
[0m09:54:42.659299 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:54:42.659400 [info ] [MainThread]: 
[0m09:54:42.659588 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:54:42.661267 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m09:54:42.665521 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m09:54:42.665781 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m09:54:42.692608 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:54:42.692810 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:54:42.692959 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:54:42.693093 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m09:54:42.693216 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m09:54:42.693337 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m09:54:42.693455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:54:42.693567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:54:42.693680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:54:42.837606 [debug] [ThreadPool]: SQL status: BEGIN in 0.144 seconds
[0m09:54:42.837912 [debug] [ThreadPool]: SQL status: BEGIN in 0.144 seconds
[0m09:54:42.838085 [debug] [ThreadPool]: SQL status: BEGIN in 0.144 seconds
[0m09:54:42.838253 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:54:42.838397 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:54:42.838535 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:54:42.838683 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m09:54:42.838842 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m09:54:42.838990 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:54:42.905693 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.066 seconds
[0m09:54:42.905974 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.067 seconds
[0m09:54:42.906761 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m09:54:42.907255 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m09:54:42.908682 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.070 seconds
[0m09:54:42.908811 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m09:54:42.909365 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m09:54:42.909487 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m09:54:42.910020 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m09:54:42.912663 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:42.912804 [debug] [MainThread]: On master: BEGIN
[0m09:54:42.912925 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:54:42.918359 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:54:42.918503 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:42.918647 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:54:42.949955 [debug] [MainThread]: SQL status: SELECT 8 in 0.031 seconds
[0m09:54:42.953083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3eb1847b-026e-4faa-b1b3-c19517f7066a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6f5710>]}
[0m09:54:42.953541 [debug] [MainThread]: On master: ROLLBACK
[0m09:54:42.953968 [debug] [MainThread]: On master: Close
[0m09:54:42.956541 [debug] [Thread-1 (]: Began running node model.sumup.customer_store_ranking
[0m09:54:42.956793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.customer_store_ranking)
[0m09:54:42.956943 [debug] [Thread-1 (]: Began compiling node model.sumup.customer_store_ranking
[0m09:54:42.960464 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m09:54:42.960955 [debug] [Thread-1 (]: Began executing node model.sumup.customer_store_ranking
[0m09:54:42.963821 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m09:54:42.963987 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  
  SELECT
    store_name,
    SUM(amount_eur) AS total_amount
FROM
    "postgres"."analytics_analytics"."int_transaction" 
WHERE status = 'accepted'
GROUP BY
    store_name
ORDER BY
    total_amount DESC
--limit 10
  
  limit 5

[0m09:54:42.964134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:43.117154 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.153 seconds
[0m09:54:43.121432 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: Close
[0m09:54:43.123641 [debug] [Thread-1 (]: Finished running node model.sumup.customer_store_ranking
[0m09:54:43.124934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:54:43.125324 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m09:54:43.125633 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m09:54:43.125918 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m09:54:43.126682 [debug] [MainThread]: Command end result
[0m09:54:43.149699 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:54:43.155234 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:54:43.161195 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:54:43.161605 [info ] [MainThread]: Previewing node 'customer_store_ranking':
| store_name           | total_amount |
| -------------------- | ------------ |
| Nec Ante Ltd         |        93.83 |
| Sem Ut Cursus Corp.  |        89.09 |
| Magnis Dis Inc.      |        73.34 |
| Blandit At Nisi Inc. |        73.26 |
| Volutpat Nunc Sit... |        68.53 |

[0m09:54:43.164969 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 0.93442726, "process_in_blocks": "0", "process_kernel_time": 0.155336, "process_mem_max_rss": "127221760", "process_out_blocks": "0", "process_user_time": 0.8954}
[0m09:54:43.165323 [debug] [MainThread]: Command `dbt show` succeeded at 09:54:43.165254 after 0.93 seconds
[0m09:54:43.165586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092d9e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7d5de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7d5a70>]}
[0m09:54:43.165759 [debug] [MainThread]: Flushing usage events
[0m09:54:43.994267 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:54:50.471239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10864c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10948b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10948bc50>]}


============================== 09:54:50.473783 | 58e9022b-48ca-475c-97ce-29cc3281e369 ==============================
[0m09:54:50.473783 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:54:50.474061 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'write_json': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'partial_parse': 'True', 'version_check': 'True', 'static_parser': 'True', 'target_path': 'None', 'no_print': 'None', 'debug': 'False', 'invocation_command': 'dbt show --select device_adoption', 'introspect': 'True', 'printer_width': '80', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup'}
[0m09:54:50.544195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58e9022b-48ca-475c-97ce-29cc3281e369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087af950>]}
[0m09:54:50.566385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58e9022b-48ca-475c-97ce-29cc3281e369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109322cf0>]}
[0m09:54:50.575812 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:54:50.614182 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:54:50.666110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:54:50.666285 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:54:50.668459 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m09:54:50.680835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58e9022b-48ca-475c-97ce-29cc3281e369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a478550>]}
[0m09:54:50.707508 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:54:50.708430 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:54:50.709445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58e9022b-48ca-475c-97ce-29cc3281e369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2cad50>]}
[0m09:54:50.709623 [info ] [MainThread]: Found 3 seeds, 8 models, 447 macros
[0m09:54:50.709751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58e9022b-48ca-475c-97ce-29cc3281e369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bb8130>]}
[0m09:54:50.710405 [info ] [MainThread]: 
[0m09:54:50.710541 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:54:50.710652 [info ] [MainThread]: 
[0m09:54:50.710863 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:54:50.712465 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m09:54:50.717164 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m09:54:50.718097 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m09:54:50.737522 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:54:50.737746 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:54:50.737888 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m09:54:50.738040 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:54:50.738170 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m09:54:50.738291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:54:50.738404 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m09:54:50.738510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:54:50.738692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:54:50.754311 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m09:54:50.754533 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m09:54:50.754690 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:54:50.754806 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m09:54:50.754945 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:54:50.755080 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m09:54:50.755196 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:54:50.755316 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:54:50.755477 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m09:54:50.758596 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m09:54:50.758721 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m09:54:50.758823 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m09:54:50.759451 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m09:54:50.759877 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m09:54:50.760279 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m09:54:50.760522 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m09:54:50.760645 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m09:54:50.760770 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m09:54:50.763357 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:50.763496 [debug] [MainThread]: On master: BEGIN
[0m09:54:50.763600 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:54:50.767759 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:54:50.767864 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:50.767991 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:54:50.772827 [debug] [MainThread]: SQL status: SELECT 8 in 0.005 seconds
[0m09:54:50.773782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58e9022b-48ca-475c-97ce-29cc3281e369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5f72b0>]}
[0m09:54:50.773934 [debug] [MainThread]: On master: ROLLBACK
[0m09:54:50.774147 [debug] [MainThread]: On master: Close
[0m09:54:50.775280 [debug] [Thread-1 (]: Began running node model.sumup.device_adoption
[0m09:54:50.775433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.device_adoption)
[0m09:54:50.775580 [debug] [Thread-1 (]: Began compiling node model.sumup.device_adoption
[0m09:54:50.778354 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.device_adoption"
[0m09:54:50.778665 [debug] [Thread-1 (]: Began executing node model.sumup.device_adoption
[0m09:54:50.781456 [debug] [Thread-1 (]: Using postgres connection "model.sumup.device_adoption"
[0m09:54:50.781589 [debug] [Thread-1 (]: On model.sumup.device_adoption: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.device_adoption"} */

  
  SELECT
   count(*)
FROM
    "postgres"."analytics_analytics"."int_transaction"
  
  limit 5

[0m09:54:50.781710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:50.790110 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m09:54:50.791117 [debug] [Thread-1 (]: On model.sumup.device_adoption: Close
[0m09:54:50.791431 [debug] [Thread-1 (]: Finished running node model.sumup.device_adoption
[0m09:54:50.791906 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:54:50.792065 [debug] [MainThread]: Connection 'model.sumup.device_adoption' was properly closed.
[0m09:54:50.792172 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m09:54:50.792269 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m09:54:50.792531 [debug] [MainThread]: Command end result
[0m09:54:50.801730 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:54:50.802574 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:54:50.805587 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:54:50.805776 [info ] [MainThread]: Previewing node 'device_adoption':
| count |
| ----- |
|  1500 |

[0m09:54:50.807320 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 0.36393428, "process_in_blocks": "0", "process_kernel_time": 0.119879, "process_mem_max_rss": "126664704", "process_out_blocks": "0", "process_user_time": 0.756768}
[0m09:54:50.807519 [debug] [MainThread]: Command `dbt show` succeeded at 09:54:50.807485 after 0.36 seconds
[0m09:54:50.807669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109301f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a80ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a80cf70>]}
[0m09:54:50.807810 [debug] [MainThread]: Flushing usage events
[0m09:54:51.495821 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:55:05.849265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e88050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ccb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ccbc50>]}


============================== 09:55:05.851874 | 1fe0a744-f3f4-427f-bb15-862b220bcf84 ==============================
[0m09:55:05.851874 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:55:05.852142 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'fail_fast': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'use_colors': 'True', 'introspect': 'True', 'printer_width': '80', 'invocation_command': 'dbt show --select device_adoption', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'log_cache_events': 'False', 'no_print': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'empty': 'None', 'warn_error': 'None', 'quiet': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:55:05.934963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fe0a744-f3f4-427f-bb15-862b220bcf84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fef950>]}
[0m09:55:05.957322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fe0a744-f3f4-427f-bb15-862b220bcf84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b5ecf0>]}
[0m09:55:05.967655 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:55:06.027922 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:55:06.083315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:55:06.084374 [debug] [MainThread]: Partial parsing: updated file: sumup://models/marts/core/device_adoption.sql
[0m09:55:06.177615 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m09:55:06.181112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fe0a744-f3f4-427f-bb15-862b220bcf84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb4250>]}
[0m09:55:06.208189 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:55:06.209285 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:55:06.210327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fe0a744-f3f4-427f-bb15-862b220bcf84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b06d50>]}
[0m09:55:06.210513 [info ] [MainThread]: Found 3 seeds, 8 models, 447 macros
[0m09:55:06.210644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fe0a744-f3f4-427f-bb15-862b220bcf84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053f4130>]}
[0m09:55:06.211282 [info ] [MainThread]: 
[0m09:55:06.211426 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:55:06.211530 [info ] [MainThread]: 
[0m09:55:06.211731 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:55:06.213449 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m09:55:06.217526 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m09:55:06.217775 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m09:55:06.267871 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:55:06.268055 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:55:06.268205 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:55:06.268324 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m09:55:06.268444 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m09:55:06.268579 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m09:55:06.268731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:06.268850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:06.268955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:06.286033 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m09:55:06.286200 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m09:55:06.286329 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m09:55:06.286472 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:55:06.286588 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:55:06.286707 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:55:06.286839 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m09:55:06.286977 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:55:06.287118 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m09:55:06.290226 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m09:55:06.290330 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m09:55:06.290896 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m09:55:06.291324 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m09:55:06.291429 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m09:55:06.291869 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m09:55:06.291985 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m09:55:06.292109 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m09:55:06.292230 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m09:55:06.294760 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:06.294880 [debug] [MainThread]: On master: BEGIN
[0m09:55:06.294974 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:55:06.297878 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m09:55:06.298004 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:06.298168 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:55:06.301044 [debug] [MainThread]: SQL status: SELECT 8 in 0.003 seconds
[0m09:55:06.302021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fe0a744-f3f4-427f-bb15-862b220bcf84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e31230>]}
[0m09:55:06.302180 [debug] [MainThread]: On master: ROLLBACK
[0m09:55:06.302368 [debug] [MainThread]: On master: Close
[0m09:55:06.303460 [debug] [Thread-1 (]: Began running node model.sumup.device_adoption
[0m09:55:06.303605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.device_adoption)
[0m09:55:06.303728 [debug] [Thread-1 (]: Began compiling node model.sumup.device_adoption
[0m09:55:06.306835 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.device_adoption"
[0m09:55:06.307133 [debug] [Thread-1 (]: Began executing node model.sumup.device_adoption
[0m09:55:06.309607 [debug] [Thread-1 (]: Using postgres connection "model.sumup.device_adoption"
[0m09:55:06.309747 [debug] [Thread-1 (]: On model.sumup.device_adoption: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.device_adoption"} */

  
  SELECT
   count(*)
FROM
    "postgres"."analytics_staging"."stg_transaction"
  
  limit 5

[0m09:55:06.309870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:06.314202 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m09:55:06.315110 [debug] [Thread-1 (]: On model.sumup.device_adoption: Close
[0m09:55:06.315377 [debug] [Thread-1 (]: Finished running node model.sumup.device_adoption
[0m09:55:06.315784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:55:06.315904 [debug] [MainThread]: Connection 'model.sumup.device_adoption' was properly closed.
[0m09:55:06.316003 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m09:55:06.316095 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m09:55:06.316318 [debug] [MainThread]: Command end result
[0m09:55:06.324759 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:55:06.325416 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:55:06.327804 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:55:06.327958 [info ] [MainThread]: Previewing node 'device_adoption':
| count |
| ----- |
|  1500 |

[0m09:55:06.329890 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 0.51527035, "process_in_blocks": "0", "process_kernel_time": 0.148276, "process_mem_max_rss": "128712704", "process_out_blocks": "0", "process_user_time": 0.869377}
[0m09:55:06.330050 [debug] [MainThread]: Command `dbt show` succeeded at 09:55:06.330020 after 0.52 seconds
[0m09:55:06.330175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b3de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fca150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc9ff0>]}
[0m09:55:06.330298 [debug] [MainThread]: Flushing usage events
[0m09:55:07.054556 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:57:17.439731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10457c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053bb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053bbc50>]}


============================== 09:57:17.442510 | cef3d56e-e73f-4800-be1f-144e836a20d4 ==============================
[0m09:57:17.442510 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:57:17.442790 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'introspect': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'quiet': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'warn_error': 'None', 'invocation_command': 'dbt show --select products_ranking', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'empty': 'None', 'write_json': 'True', 'static_parser': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'target_path': 'None', 'cache_selected_only': 'False', 'log_format': 'default'}
[0m09:57:17.531187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cef3d56e-e73f-4800-be1f-144e836a20d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046e3950>]}
[0m09:57:17.551929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cef3d56e-e73f-4800-be1f-144e836a20d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105252cf0>]}
[0m09:57:17.561688 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:57:17.603202 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:57:17.659837 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:57:17.660090 [debug] [MainThread]: Partial parsing: updated file: sumup://models/marts/core/products_ranking.sql
[0m09:57:17.744266 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m09:57:17.746142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cef3d56e-e73f-4800-be1f-144e836a20d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a8250>]}
[0m09:57:17.771217 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:57:17.772382 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:57:17.773647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cef3d56e-e73f-4800-be1f-144e836a20d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061fad50>]}
[0m09:57:17.773819 [info ] [MainThread]: Found 3 seeds, 8 models, 447 macros
[0m09:57:17.773953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cef3d56e-e73f-4800-be1f-144e836a20d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ae8130>]}
[0m09:57:17.774734 [info ] [MainThread]: 
[0m09:57:17.774918 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:57:17.775035 [info ] [MainThread]: 
[0m09:57:17.775240 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:57:17.776865 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m09:57:17.780925 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m09:57:17.781111 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m09:57:17.834141 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:57:17.834334 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:57:17.834496 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:57:17.834646 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m09:57:17.834773 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m09:57:17.834900 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m09:57:17.835010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:17.835133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:17.835248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:17.861660 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m09:57:17.861831 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m09:57:17.861963 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m09:57:17.862090 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m09:57:17.862208 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m09:57:17.862326 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m09:57:17.862453 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m09:57:17.862591 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m09:57:17.862724 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:57:17.869784 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m09:57:17.869895 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m09:57:17.870454 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m09:57:17.870579 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m09:57:17.871026 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m09:57:17.871535 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m09:57:17.871673 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m09:57:17.871785 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m09:57:17.872030 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m09:57:17.874560 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:17.874688 [debug] [MainThread]: On master: BEGIN
[0m09:57:17.874783 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:57:17.879981 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:57:17.880093 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:17.880226 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:57:17.886837 [debug] [MainThread]: SQL status: SELECT 8 in 0.006 seconds
[0m09:57:17.887808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cef3d56e-e73f-4800-be1f-144e836a20d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106525230>]}
[0m09:57:17.887965 [debug] [MainThread]: On master: ROLLBACK
[0m09:57:17.888167 [debug] [MainThread]: On master: Close
[0m09:57:17.889373 [debug] [Thread-1 (]: Began running node model.sumup.products_ranking
[0m09:57:17.889533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.products_ranking)
[0m09:57:17.889666 [debug] [Thread-1 (]: Began compiling node model.sumup.products_ranking
[0m09:57:17.892810 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.products_ranking"
[0m09:57:17.893217 [debug] [Thread-1 (]: Began executing node model.sumup.products_ranking
[0m09:57:17.895804 [debug] [Thread-1 (]: Using postgres connection "model.sumup.products_ranking"
[0m09:57:17.895950 [debug] [Thread-1 (]: On model.sumup.products_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.products_ranking"} */

  
  select product_id,
    count(*) as total_sales
from "postgres"."analytics_analytics"."int_transaction"
group by product_id
  
  limit 5

[0m09:57:17.896075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:17.908705 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.013 seconds
[0m09:57:17.909602 [debug] [Thread-1 (]: On model.sumup.products_ranking: Close
[0m09:57:17.909880 [debug] [Thread-1 (]: Finished running node model.sumup.products_ranking
[0m09:57:17.910304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:57:17.910418 [debug] [MainThread]: Connection 'model.sumup.products_ranking' was properly closed.
[0m09:57:17.910518 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m09:57:17.910613 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m09:57:17.910858 [debug] [MainThread]: Command end result
[0m09:57:17.919752 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m09:57:17.920417 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m09:57:17.922940 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m09:57:17.923107 [info ] [MainThread]: Previewing node 'products_ranking':
| product_id           | total_sales |
| -------------------- | ----------- |
| 8b29c32d991422e37... |           2 |
| a7589e9548c892921... |           2 |
| 6bc197316beaa932e... |           1 |
| fdc42f1cf4e34fe13... |           1 |
| bedd09e1b1715a3d2... |           1 |

[0m09:57:17.925115 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 0.52030736, "process_in_blocks": "0", "process_kernel_time": 0.14153, "process_mem_max_rss": "128843776", "process_out_blocks": "0", "process_user_time": 0.838097}
[0m09:57:17.925286 [debug] [MainThread]: Command `dbt show` succeeded at 09:57:17.925255 after 0.52 seconds
[0m09:57:17.925416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105231f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a60a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a5b20>]}
[0m09:57:17.925546 [debug] [MainThread]: Flushing usage events
[0m09:57:18.674528 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:58:24.597689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108114050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109737c50>]}


============================== 09:58:24.600625 | e3400ae6-0105-45de-beec-21f5d8502f6b ==============================
[0m09:58:24.600625 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:58:24.600927 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'introspect': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'invocation_command': 'dbt run -m +products_ranking', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'use_experimental_parser': 'False', 'quiet': 'False', 'partial_parse': 'True', 'write_json': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'printer_width': '80', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m09:58:24.601161 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m09:58:24.601318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e3400ae6-0105-45de-beec-21f5d8502f6b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10961f6f0>]}
[0m09:58:24.684793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3400ae6-0105-45de-beec-21f5d8502f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095cacf0>]}
[0m09:58:24.705219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3400ae6-0105-45de-beec-21f5d8502f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095d3d50>]}
[0m09:58:24.705588 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:58:24.744235 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:58:24.798940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:58:24.799301 [debug] [MainThread]: Partial parsing: updated file: sumup://models/intermediate/core/int_transaction.sql
[0m09:58:24.865172 [error] [MainThread]: Encountered an error:
Compilation Error in model int_transaction (models/intermediate/core/int_transaction.sql)
  invalid syntax for function call expression
    line 2
      config(
[0m09:58:24.865478 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m09:58:24.867468 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.3034675, "process_in_blocks": "0", "process_kernel_time": 0.11784, "process_mem_max_rss": "117604352", "process_out_blocks": "0", "process_user_time": 0.691837}
[0m09:58:24.867648 [debug] [MainThread]: Command `dbt run` failed at 09:58:24.867610 after 0.30 seconds
[0m09:58:24.867794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b400b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b400aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109627e70>]}
[0m09:58:24.867927 [debug] [MainThread]: Flushing usage events
[0m09:58:25.597417 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:59:01.011194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046d8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e37c50>]}


============================== 09:59:01.013850 | d9f6a643-831f-45e5-be3b-b2d139bd646c ==============================
[0m09:59:01.013850 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:59:01.014103 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'target_path': 'None', 'fail_fast': 'False', 'printer_width': '80', 'debug': 'False', 'quiet': 'False', 'static_parser': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'use_colors': 'True', 'version_check': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run -m int_transaction', 'warn_error': 'None', 'log_cache_events': 'False'}
[0m09:59:01.014307 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m09:59:01.014456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd9f6a643-831f-45e5-be3b-b2d139bd646c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d1f6f0>]}
[0m09:59:01.097963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9f6a643-831f-45e5-be3b-b2d139bd646c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ccacf0>]}
[0m09:59:01.119077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9f6a643-831f-45e5-be3b-b2d139bd646c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd7d50>]}
[0m09:59:01.119553 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:59:01.158891 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:59:01.214843 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m09:59:01.215074 [debug] [MainThread]: Partial parsing: added file: sumup://models/marts/core/product_ranking.sql
[0m09:59:01.215183 [debug] [MainThread]: Partial parsing: deleted file: sumup://models/marts/core/products_ranking.sql
[0m09:59:01.215317 [debug] [MainThread]: Partial parsing: updated file: sumup://models/intermediate/core/int_transaction.sql
[0m09:59:01.286575 [error] [MainThread]: Encountered an error:
Compilation Error in model int_transaction (models/intermediate/core/int_transaction.sql)
  invalid syntax for function call expression
    line 2
      config(
[0m09:59:01.286884 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m09:59:01.288867 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.30637607, "process_in_blocks": "0", "process_kernel_time": 0.11635, "process_mem_max_rss": "119865344", "process_out_blocks": "0", "process_user_time": 0.713394}
[0m09:59:01.289082 [debug] [MainThread]: Command `dbt run` failed at 09:59:01.289039 after 0.31 seconds
[0m09:59:01.289240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102754f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110275400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d27e70>]}
[0m09:59:01.289377 [debug] [MainThread]: Flushing usage events
[0m09:59:01.980355 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:59:47.901940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107837c50>]}


============================== 09:59:47.904759 | 3d92082d-c2a6-42f0-a8cd-2f2f65493ebe ==============================
[0m09:59:47.904759 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:59:47.905030 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'version_check': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'static_parser': 'True', 'warn_error': 'None', 'printer_width': '80', 'debug': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run -m int_transaction', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'target_path': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'quiet': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'fail_fast': 'False'}
[0m09:59:47.905242 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m09:59:47.905393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3d92082d-c2a6-42f0-a8cd-2f2f65493ebe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10771f6f0>]}
[0m09:59:47.993877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d92082d-c2a6-42f0-a8cd-2f2f65493ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076cacf0>]}
[0m09:59:48.016437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d92082d-c2a6-42f0-a8cd-2f2f65493ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076d7d50>]}
[0m09:59:48.016934 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:59:48.055705 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:59:48.111605 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m09:59:48.111900 [debug] [MainThread]: Partial parsing: added file: sumup://models/marts/core/product_ranking.sql
[0m09:59:48.112028 [debug] [MainThread]: Partial parsing: deleted file: sumup://models/marts/core/products_ranking.sql
[0m09:59:48.112183 [debug] [MainThread]: Partial parsing: updated file: sumup://models/intermediate/core/int_transaction.sql
[0m09:59:48.187186 [error] [MainThread]: Encountered an error:
Compilation Error in model int_transaction (models/intermediate/core/int_transaction.sql)
  invalid syntax for function call expression
    line 2
      config(
[0m09:59:48.187498 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m09:59:48.189501 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.31884983, "process_in_blocks": "0", "process_kernel_time": 0.128779, "process_mem_max_rss": "119062528", "process_out_blocks": "0", "process_user_time": 0.747841}
[0m09:59:48.189691 [debug] [MainThread]: Command `dbt run` failed at 09:59:48.189654 after 0.32 seconds
[0m09:59:48.189843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a014f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a01400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107727e70>]}
[0m09:59:48.189979 [debug] [MainThread]: Flushing usage events
[0m09:59:48.952723 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:00:46.430824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106300050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071439d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107143c50>]}


============================== 10:00:46.433606 | ec793ace-bb65-44ba-877a-608b83435c2a ==============================
[0m10:00:46.433606 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:00:46.433865 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'version_check': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'use_experimental_parser': 'False', 'introspect': 'True', 'target_path': 'None', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'empty': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select int_transaction', 'no_print': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'log_format': 'default'}
[0m10:00:46.520712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec793ace-bb65-44ba-877a-608b83435c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106467950>]}
[0m10:00:46.541717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec793ace-bb65-44ba-877a-608b83435c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd6cf0>]}
[0m10:00:46.542089 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m10:00:46.579714 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:00:46.634622 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m10:00:46.634852 [debug] [MainThread]: Partial parsing: added file: sumup://models/marts/core/product_ranking.sql
[0m10:00:46.634959 [debug] [MainThread]: Partial parsing: deleted file: sumup://models/marts/core/products_ranking.sql
[0m10:00:46.635092 [debug] [MainThread]: Partial parsing: updated file: sumup://models/intermediate/core/int_transaction.sql
[0m10:00:46.707204 [error] [MainThread]: Encountered an error:
Compilation Error in model int_transaction (models/intermediate/core/int_transaction.sql)
  invalid syntax for function call expression
    line 2
      config(
[0m10:00:46.709238 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.3093626, "process_in_blocks": "0", "process_kernel_time": 0.107403, "process_mem_max_rss": "119472128", "process_out_blocks": "0", "process_user_time": 0.696384}
[0m10:00:46.709427 [debug] [MainThread]: Command `dbt run` failed at 10:00:46.709390 after 0.31 seconds
[0m10:00:46.709576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10807ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10807ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ad4f0>]}
[0m10:00:46.709705 [debug] [MainThread]: Flushing usage events
[0m10:00:47.490832 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:01:11.144459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ab8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ff9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ffc50>]}


============================== 10:01:11.146877 | b9bf1124-dff6-448f-bdfe-6f8eeda877d0 ==============================
[0m10:01:11.146877 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:01:11.147128 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select int_transaction', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'introspect': 'True', 'fail_fast': 'False', 'log_format': 'default', 'use_colors': 'True', 'debug': 'False', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'printer_width': '80', 'quiet': 'False', 'log_cache_events': 'False'}
[0m10:01:11.227078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9bf1124-dff6-448f-bdfe-6f8eeda877d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c1b950>]}
[0m10:01:11.248510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9bf1124-dff6-448f-bdfe-6f8eeda877d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10478ecf0>]}
[0m10:01:11.249051 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m10:01:11.287145 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:01:11.337083 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m10:01:11.337326 [debug] [MainThread]: Partial parsing: added file: sumup://models/marts/core/product_ranking.sql
[0m10:01:11.337435 [debug] [MainThread]: Partial parsing: deleted file: sumup://models/marts/core/products_ranking.sql
[0m10:01:11.337573 [debug] [MainThread]: Partial parsing: updated file: sumup://models/intermediate/core/int_transaction.sql
[0m10:01:11.410846 [error] [MainThread]: Encountered an error:
Compilation Error in model int_transaction (models/intermediate/core/int_transaction.sql)
  invalid syntax for function call expression
    line 1
      {{ config(
[0m10:01:11.412940 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.29870638, "process_in_blocks": "0", "process_kernel_time": 0.110242, "process_mem_max_rss": "118112256", "process_out_blocks": "0", "process_user_time": 0.70401}
[0m10:01:11.413136 [debug] [MainThread]: Command `dbt run` failed at 10:01:11.413094 after 0.30 seconds
[0m10:01:11.413292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10582ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10582ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a695e0>]}
[0m10:01:11.413425 [debug] [MainThread]: Flushing usage events
[0m10:01:12.130391 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:01:37.142238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104074050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10563b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10563bc50>]}


============================== 10:01:37.144685 | 676e59b6-9b19-4d2b-a730-8c6c4ddf0483 ==============================
[0m10:01:37.144685 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:01:37.144960 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --select int_transaction', 'debug': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'write_json': 'True', 'empty': 'False', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'version_check': 'True', 'log_format': 'default', 'target_path': 'None', 'no_print': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'quiet': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True'}
[0m10:01:37.220529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '676e59b6-9b19-4d2b-a730-8c6c4ddf0483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10455b950>]}
[0m10:01:37.241046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '676e59b6-9b19-4d2b-a730-8c6c4ddf0483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054cacf0>]}
[0m10:01:37.241585 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m10:01:37.279839 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:01:37.329512 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m10:01:37.329760 [debug] [MainThread]: Partial parsing: added file: sumup://models/marts/core/product_ranking.sql
[0m10:01:37.329870 [debug] [MainThread]: Partial parsing: deleted file: sumup://models/marts/core/products_ranking.sql
[0m10:01:37.330006 [debug] [MainThread]: Partial parsing: updated file: sumup://models/intermediate/core/int_transaction.sql
[0m10:01:37.421832 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m10:01:37.423644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '676e59b6-9b19-4d2b-a730-8c6c4ddf0483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c2e50>]}
[0m10:01:37.449165 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m10:01:37.451230 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m10:01:37.462459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '676e59b6-9b19-4d2b-a730-8c6c4ddf0483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056a66c0>]}
[0m10:01:37.462645 [info ] [MainThread]: Found 3 seeds, 8 models, 447 macros
[0m10:01:37.462779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '676e59b6-9b19-4d2b-a730-8c6c4ddf0483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081a1390>]}
[0m10:01:37.463376 [info ] [MainThread]: 
[0m10:01:37.463511 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:01:37.463616 [info ] [MainThread]: 
[0m10:01:37.463807 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:01:37.464131 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:01:37.514917 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:01:37.515134 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:01:37.515262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:01:37.537630 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.022 seconds
[0m10:01:37.538269 [debug] [ThreadPool]: On list_postgres: Close
[0m10:01:37.540137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics)
[0m10:01:37.540339 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m10:01:37.542481 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m10:01:37.542672 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m10:01:37.543524 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m10:01:37.543673 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m10:01:37.544269 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m10:01:37.544384 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m10:01:37.544488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:01:37.544583 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m10:01:37.544677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:01:37.544837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:01:37.550312 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:01:37.550435 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:01:37.550548 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:01:37.550658 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m10:01:37.550774 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m10:01:37.550871 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m10:01:37.550980 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m10:01:37.551100 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m10:01:37.551215 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m10:01:37.557587 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m10:01:37.557702 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m10:01:37.558190 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m10:01:37.558300 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m10:01:37.558708 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m10:01:37.559176 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m10:01:37.559306 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m10:01:37.559422 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m10:01:37.559522 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m10:01:37.561875 [debug] [MainThread]: Using postgres connection "master"
[0m10:01:37.561994 [debug] [MainThread]: On master: BEGIN
[0m10:01:37.562084 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:01:37.566806 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:01:37.566912 [debug] [MainThread]: Using postgres connection "master"
[0m10:01:37.567043 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:01:37.573544 [debug] [MainThread]: SQL status: SELECT 8 in 0.006 seconds
[0m10:01:37.574474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '676e59b6-9b19-4d2b-a730-8c6c4ddf0483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10814cd50>]}
[0m10:01:37.574631 [debug] [MainThread]: On master: ROLLBACK
[0m10:01:37.574846 [debug] [MainThread]: Using postgres connection "master"
[0m10:01:37.574944 [debug] [MainThread]: On master: BEGIN
[0m10:01:37.575207 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:01:37.575306 [debug] [MainThread]: On master: COMMIT
[0m10:01:37.575399 [debug] [MainThread]: Using postgres connection "master"
[0m10:01:37.575489 [debug] [MainThread]: On master: COMMIT
[0m10:01:37.575654 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:01:37.575749 [debug] [MainThread]: On master: Close
[0m10:01:37.576993 [debug] [Thread-1 (]: Began running node model.sumup.int_transaction
[0m10:01:37.577177 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics_analytics.int_transaction ......... [RUN]
[0m10:01:37.577337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.int_transaction)
[0m10:01:37.577465 [debug] [Thread-1 (]: Began compiling node model.sumup.int_transaction
[0m10:01:37.580970 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m10:01:37.581627 [debug] [Thread-1 (]: Began executing node model.sumup.int_transaction
[0m10:01:37.602478 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.int_transaction"
[0m10:01:37.602997 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_transaction"
[0m10:01:37.603129 [debug] [Thread-1 (]: On model.sumup.int_transaction: BEGIN
[0m10:01:37.603295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:01:37.608537 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:01:37.608658 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_transaction"
[0m10:01:37.608785 [debug] [Thread-1 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

      
  
    

  create  table "postgres"."analytics_analytics"."int_transaction__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    -- Primary and Foreign Keys
    transaction_id,
    device_id,

    -- Product Information
   
    CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA  AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data and Status
    amount_eur,
    status,

    --device data
    device_type,
    
    -- store_data
    store_id,
    store_name,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction" t
LEFT JOIN "postgres"."analytics_staging"."stg_device" d ON t.device_id = d.device_id
LEFT JOIN "postgres"."analytics_staging"."stg_store" s ON d.store_id = s.store_id

-- Incremental Logic: Only select new records for subsequent runs

  );
  
  
[0m10:01:37.611557 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column reference "device_id" is ambiguous
LINE 18:     device_id,
             ^

[0m10:01:37.611680 [debug] [Thread-1 (]: On model.sumup.int_transaction: ROLLBACK
[0m10:01:37.611924 [debug] [Thread-1 (]: On model.sumup.int_transaction: Close
[0m10:01:37.618105 [debug] [Thread-1 (]: Database Error in model int_transaction (models/intermediate/core/int_transaction.sql)
  column reference "device_id" is ambiguous
  LINE 18:     device_id,
               ^
  compiled code at target/run/sumup/models/intermediate/core/int_transaction.sql
[0m10:01:37.618909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '676e59b6-9b19-4d2b-a730-8c6c4ddf0483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10814b290>]}
[0m10:01:37.619163 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model analytics_analytics.int_transaction  [[31mERROR[0m in 0.04s]
[0m10:01:37.619390 [debug] [Thread-1 (]: Finished running node model.sumup.int_transaction
[0m10:01:37.619592 [debug] [Thread-7 (]: Marking all children of 'model.sumup.int_transaction' to be skipped because of status 'error'.  Reason: Database Error in model int_transaction (models/intermediate/core/int_transaction.sql)
  column reference "device_id" is ambiguous
  LINE 18:     device_id,
               ^
  compiled code at target/run/sumup/models/intermediate/core/int_transaction.sql.
[0m10:01:37.620385 [debug] [MainThread]: Using postgres connection "master"
[0m10:01:37.620505 [debug] [MainThread]: On master: BEGIN
[0m10:01:37.620597 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:01:37.625129 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:01:37.625239 [debug] [MainThread]: On master: COMMIT
[0m10:01:37.625333 [debug] [MainThread]: Using postgres connection "master"
[0m10:01:37.625421 [debug] [MainThread]: On master: COMMIT
[0m10:01:37.625602 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:01:37.625707 [debug] [MainThread]: On master: Close
[0m10:01:37.625850 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:01:37.625950 [debug] [MainThread]: Connection 'model.sumup.int_transaction' was properly closed.
[0m10:01:37.626040 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m10:01:37.626126 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m10:01:37.626223 [info ] [MainThread]: 
[0m10:01:37.626332 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:01:37.626582 [debug] [MainThread]: Command end result
[0m10:01:37.634648 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m10:01:37.635272 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m10:01:37.637663 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m10:01:37.637788 [info ] [MainThread]: 
[0m10:01:37.638020 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:01:37.638158 [info ] [MainThread]: 
[0m10:01:37.638357 [error] [MainThread]: [31mFailure in model int_transaction (models/intermediate/core/int_transaction.sql)[0m
[0m10:01:37.638498 [error] [MainThread]:   Database Error in model int_transaction (models/intermediate/core/int_transaction.sql)
  column reference "device_id" is ambiguous
  LINE 18:     device_id,
               ^
  compiled code at target/run/sumup/models/intermediate/core/int_transaction.sql
[0m10:01:37.638603 [info ] [MainThread]: 
[0m10:01:37.638731 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/intermediate/core/int_transaction.sql
[0m10:01:37.638842 [info ] [MainThread]: 
[0m10:01:37.639021 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m10:01:37.640664 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5268597, "process_in_blocks": "0", "process_kernel_time": 0.129231, "process_mem_max_rss": "129449984", "process_out_blocks": "0", "process_user_time": 0.853489}
[0m10:01:37.640827 [debug] [MainThread]: Command `dbt run` failed at 10:01:37.640794 after 0.53 seconds
[0m10:01:37.640967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081220a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105502210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105460a50>]}
[0m10:01:37.641092 [debug] [MainThread]: Flushing usage events
[0m10:01:38.905696 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:02:27.969599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bdc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a239d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a23c50>]}


============================== 10:02:27.972407 | f169446d-52f2-45a7-8e14-3f90364bebe3 ==============================
[0m10:02:27.972407 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:02:27.972673 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'debug': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select int_transaction', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'empty': 'False', 'write_json': 'True', 'quiet': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'printer_width': '80', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs'}
[0m10:02:28.054754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f169446d-52f2-45a7-8e14-3f90364bebe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d3f950>]}
[0m10:02:28.075299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f169446d-52f2-45a7-8e14-3f90364bebe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b2cf0>]}
[0m10:02:28.075636 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m10:02:28.113486 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:02:28.168676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:02:28.168974 [debug] [MainThread]: Partial parsing: updated file: sumup://models/intermediate/core/int_transaction.sql
[0m10:02:28.257543 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m10:02:28.259363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f169446d-52f2-45a7-8e14-3f90364bebe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107948550>]}
[0m10:02:28.284434 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m10:02:28.285831 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m10:02:28.296100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f169446d-52f2-45a7-8e14-3f90364bebe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a8e6c0>]}
[0m10:02:28.296309 [info ] [MainThread]: Found 3 seeds, 8 models, 447 macros
[0m10:02:28.296445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f169446d-52f2-45a7-8e14-3f90364bebe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb12b0>]}
[0m10:02:28.297140 [info ] [MainThread]: 
[0m10:02:28.297283 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:02:28.297389 [info ] [MainThread]: 
[0m10:02:28.297582 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:02:28.297907 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:02:28.346532 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:02:28.346733 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:02:28.346851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:02:28.368157 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.021 seconds
[0m10:02:28.368746 [debug] [ThreadPool]: On list_postgres: Close
[0m10:02:28.370705 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_analytics)
[0m10:02:28.372932 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m10:02:28.373110 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m10:02:28.373233 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m10:02:28.373423 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m10:02:28.374225 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m10:02:28.374363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:02:28.374971 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m10:02:28.375080 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m10:02:28.375233 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m10:02:28.375344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:02:28.375458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:02:28.380319 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:02:28.380428 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:02:28.380533 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m10:02:28.380636 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:02:28.380743 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m10:02:28.380855 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m10:02:28.380961 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m10:02:28.381067 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m10:02:28.381208 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m10:02:28.386513 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m10:02:28.386618 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m10:02:28.387100 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m10:02:28.387204 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m10:02:28.387598 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m10:02:28.388044 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m10:02:28.388158 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m10:02:28.388575 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m10:02:28.388681 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m10:02:28.394512 [debug] [MainThread]: Using postgres connection "master"
[0m10:02:28.394650 [debug] [MainThread]: On master: BEGIN
[0m10:02:28.394751 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:02:28.400069 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:02:28.400172 [debug] [MainThread]: Using postgres connection "master"
[0m10:02:28.400305 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:02:28.406131 [debug] [MainThread]: SQL status: SELECT 8 in 0.006 seconds
[0m10:02:28.407036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f169446d-52f2-45a7-8e14-3f90364bebe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ebde60>]}
[0m10:02:28.407191 [debug] [MainThread]: On master: ROLLBACK
[0m10:02:28.407392 [debug] [MainThread]: Using postgres connection "master"
[0m10:02:28.407490 [debug] [MainThread]: On master: BEGIN
[0m10:02:28.407754 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:02:28.407854 [debug] [MainThread]: On master: COMMIT
[0m10:02:28.407950 [debug] [MainThread]: Using postgres connection "master"
[0m10:02:28.408043 [debug] [MainThread]: On master: COMMIT
[0m10:02:28.408213 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:02:28.408311 [debug] [MainThread]: On master: Close
[0m10:02:28.409471 [debug] [Thread-1 (]: Began running node model.sumup.int_transaction
[0m10:02:28.409657 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics_analytics.int_transaction ......... [RUN]
[0m10:02:28.409814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.int_transaction)
[0m10:02:28.409945 [debug] [Thread-1 (]: Began compiling node model.sumup.int_transaction
[0m10:02:28.413494 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m10:02:28.413909 [debug] [Thread-1 (]: Began executing node model.sumup.int_transaction
[0m10:02:28.434837 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.int_transaction"
[0m10:02:28.435404 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_transaction"
[0m10:02:28.435531 [debug] [Thread-1 (]: On model.sumup.int_transaction: BEGIN
[0m10:02:28.435644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:02:28.440281 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:02:28.440409 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_transaction"
[0m10:02:28.440541 [debug] [Thread-1 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

      
  
    

  create  table "postgres"."analytics_analytics"."int_transaction__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    -- Primary and Foreign Keys
    transaction_id,
    device_id,

    -- Product Information
   
    CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA  AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data and Status
    amount_eur,
    status,

    --device data
    t.device_type,
    
    -- store_data
    d.store_id,
    store_name,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction" t
LEFT JOIN "postgres"."analytics_staging"."stg_device" d ON t.device_id = d.device_id
LEFT JOIN "postgres"."analytics_staging"."stg_store" s ON d.store_id = s.store_id

-- Incremental Logic: Only select new records for subsequent runs

  );
  
  
[0m10:02:28.441777 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column reference "device_id" is ambiguous
LINE 18:     device_id,
             ^

[0m10:02:28.441894 [debug] [Thread-1 (]: On model.sumup.int_transaction: ROLLBACK
[0m10:02:28.442125 [debug] [Thread-1 (]: On model.sumup.int_transaction: Close
[0m10:02:28.447339 [debug] [Thread-1 (]: Database Error in model int_transaction (models/intermediate/core/int_transaction.sql)
  column reference "device_id" is ambiguous
  LINE 18:     device_id,
               ^
  compiled code at target/run/sumup/models/intermediate/core/int_transaction.sql
[0m10:02:28.448146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f169446d-52f2-45a7-8e14-3f90364bebe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c67350>]}
[0m10:02:28.448399 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model analytics_analytics.int_transaction  [[31mERROR[0m in 0.04s]
[0m10:02:28.448620 [debug] [Thread-1 (]: Finished running node model.sumup.int_transaction
[0m10:02:28.448822 [debug] [Thread-7 (]: Marking all children of 'model.sumup.int_transaction' to be skipped because of status 'error'.  Reason: Database Error in model int_transaction (models/intermediate/core/int_transaction.sql)
  column reference "device_id" is ambiguous
  LINE 18:     device_id,
               ^
  compiled code at target/run/sumup/models/intermediate/core/int_transaction.sql.
[0m10:02:28.449518 [debug] [MainThread]: Using postgres connection "master"
[0m10:02:28.449637 [debug] [MainThread]: On master: BEGIN
[0m10:02:28.449733 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:02:28.454370 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:02:28.454485 [debug] [MainThread]: On master: COMMIT
[0m10:02:28.454582 [debug] [MainThread]: Using postgres connection "master"
[0m10:02:28.454672 [debug] [MainThread]: On master: COMMIT
[0m10:02:28.454874 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:02:28.455047 [debug] [MainThread]: On master: Close
[0m10:02:28.455195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:02:28.455297 [debug] [MainThread]: Connection 'model.sumup.int_transaction' was properly closed.
[0m10:02:28.455385 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m10:02:28.455465 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m10:02:28.455558 [info ] [MainThread]: 
[0m10:02:28.455667 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:02:28.455911 [debug] [MainThread]: Command end result
[0m10:02:28.464349 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m10:02:28.464983 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m10:02:28.467061 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m10:02:28.467167 [info ] [MainThread]: 
[0m10:02:28.467306 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:02:28.467427 [info ] [MainThread]: 
[0m10:02:28.467565 [error] [MainThread]: [31mFailure in model int_transaction (models/intermediate/core/int_transaction.sql)[0m
[0m10:02:28.467699 [error] [MainThread]:   Database Error in model int_transaction (models/intermediate/core/int_transaction.sql)
  column reference "device_id" is ambiguous
  LINE 18:     device_id,
               ^
  compiled code at target/run/sumup/models/intermediate/core/int_transaction.sql
[0m10:02:28.467798 [info ] [MainThread]: 
[0m10:02:28.467973 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/intermediate/core/int_transaction.sql
[0m10:02:28.468087 [info ] [MainThread]: 
[0m10:02:28.468209 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m10:02:28.469782 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.532823, "process_in_blocks": "0", "process_kernel_time": 0.122814, "process_mem_max_rss": "130580480", "process_out_blocks": "0", "process_user_time": 0.849573}
[0m10:02:28.469955 [debug] [MainThread]: Command `dbt run` failed at 10:02:28.469922 after 0.53 seconds
[0m10:02:28.470101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c4a2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077f32f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077f3610>]}
[0m10:02:28.470233 [debug] [MainThread]: Flushing usage events
[0m10:02:29.192508 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:03:47.974799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119837c50>]}


============================== 10:03:47.977593 | 4d68e930-18fc-495e-9e3b-104766d6e0bf ==============================
[0m10:03:47.977593 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:03:47.977842 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'write_json': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'printer_width': '80', 'cache_selected_only': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'indirect_selection': 'eager', 'no_print': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select int_transaction', 'warn_error': 'None'}
[0m10:03:48.064022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d68e930-18fc-495e-9e3b-104766d6e0bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118757950>]}
[0m10:03:48.084668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d68e930-18fc-495e-9e3b-104766d6e0bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195cacf0>]}
[0m10:03:48.085014 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m10:03:48.124392 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:03:48.180978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:03:48.181166 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:03:48.183276 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m10:03:48.196780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d68e930-18fc-495e-9e3b-104766d6e0bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a5b8050>]}
[0m10:03:48.222163 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m10:03:48.223451 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m10:03:48.234608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d68e930-18fc-495e-9e3b-104766d6e0bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198a66c0>]}
[0m10:03:48.234789 [info ] [MainThread]: Found 3 seeds, 8 models, 447 macros
[0m10:03:48.234919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d68e930-18fc-495e-9e3b-104766d6e0bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c1a350>]}
[0m10:03:48.235532 [info ] [MainThread]: 
[0m10:03:48.235668 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:03:48.235776 [info ] [MainThread]: 
[0m10:03:48.235971 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:03:48.236297 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:03:48.260958 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:03:48.261127 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:03:48.261233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:48.284638 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.023 seconds
[0m10:03:48.285202 [debug] [ThreadPool]: On list_postgres: Close
[0m10:03:48.287133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics)
[0m10:03:48.287352 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m10:03:48.289505 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m10:03:48.289685 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m10:03:48.290289 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m10:03:48.290403 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m10:03:48.291200 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m10:03:48.291312 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m10:03:48.291413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:03:48.291514 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m10:03:48.291612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:48.291758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:48.298333 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m10:03:48.298516 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m10:03:48.298658 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m10:03:48.298772 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m10:03:48.298885 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m10:03:48.299001 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m10:03:48.299118 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m10:03:48.299229 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m10:03:48.299373 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m10:03:48.308914 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.009 seconds
[0m10:03:48.309049 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.010 seconds
[0m10:03:48.309584 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m10:03:48.309701 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m10:03:48.310117 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m10:03:48.310590 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m10:03:48.310705 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m10:03:48.311102 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m10:03:48.311204 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m10:03:48.313437 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:48.313551 [debug] [MainThread]: On master: BEGIN
[0m10:03:48.313641 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:03:48.318849 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:03:48.318954 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:48.319087 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:03:48.325761 [debug] [MainThread]: SQL status: SELECT 8 in 0.007 seconds
[0m10:03:48.326712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d68e930-18fc-495e-9e3b-104766d6e0bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a957040>]}
[0m10:03:48.326872 [debug] [MainThread]: On master: ROLLBACK
[0m10:03:48.327094 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:48.327192 [debug] [MainThread]: On master: BEGIN
[0m10:03:48.327459 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:03:48.327558 [debug] [MainThread]: On master: COMMIT
[0m10:03:48.327657 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:48.327748 [debug] [MainThread]: On master: COMMIT
[0m10:03:48.327917 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:03:48.328013 [debug] [MainThread]: On master: Close
[0m10:03:48.329252 [debug] [Thread-1 (]: Began running node model.sumup.int_transaction
[0m10:03:48.329446 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics_analytics.int_transaction ......... [RUN]
[0m10:03:48.329617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.int_transaction)
[0m10:03:48.329746 [debug] [Thread-1 (]: Began compiling node model.sumup.int_transaction
[0m10:03:48.334535 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m10:03:48.334978 [debug] [Thread-1 (]: Began executing node model.sumup.int_transaction
[0m10:03:48.355798 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.int_transaction"
[0m10:03:48.356275 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_transaction"
[0m10:03:48.356397 [debug] [Thread-1 (]: On model.sumup.int_transaction: BEGIN
[0m10:03:48.356506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:03:48.361112 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:03:48.361231 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_transaction"
[0m10:03:48.361360 [debug] [Thread-1 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

      
  
    

  create  table "postgres"."analytics_analytics"."int_transaction__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    -- Primary and Foreign Keys
    transaction_id,
    device_id,

    -- Product Information
   
    CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA  AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data and Status
    amount_eur,
    status,

    --device data
    t.device_type,
    
    -- store_data
    d.store_id,
    store_name,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction" t
LEFT JOIN "postgres"."analytics_staging"."stg_device" d ON t.device_id = d.device_id
LEFT JOIN "postgres"."analytics_staging"."stg_store" s ON d.store_id = s.store_id

-- Incremental Logic: Only select new records for subsequent runs

  );
  
  
[0m10:03:48.362725 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column reference "device_id" is ambiguous
LINE 18:     device_id,
             ^

[0m10:03:48.362843 [debug] [Thread-1 (]: On model.sumup.int_transaction: ROLLBACK
[0m10:03:48.363080 [debug] [Thread-1 (]: On model.sumup.int_transaction: Close
[0m10:03:48.368151 [debug] [Thread-1 (]: Database Error in model int_transaction (models/intermediate/core/int_transaction.sql)
  column reference "device_id" is ambiguous
  LINE 18:     device_id,
               ^
  compiled code at target/run/sumup/models/intermediate/core/int_transaction.sql
[0m10:03:48.368955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d68e930-18fc-495e-9e3b-104766d6e0bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a78ed50>]}
[0m10:03:48.369203 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model analytics_analytics.int_transaction  [[31mERROR[0m in 0.04s]
[0m10:03:48.369428 [debug] [Thread-1 (]: Finished running node model.sumup.int_transaction
[0m10:03:48.369649 [debug] [Thread-7 (]: Marking all children of 'model.sumup.int_transaction' to be skipped because of status 'error'.  Reason: Database Error in model int_transaction (models/intermediate/core/int_transaction.sql)
  column reference "device_id" is ambiguous
  LINE 18:     device_id,
               ^
  compiled code at target/run/sumup/models/intermediate/core/int_transaction.sql.
[0m10:03:48.370420 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:48.370547 [debug] [MainThread]: On master: BEGIN
[0m10:03:48.370642 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:03:48.375529 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:03:48.375643 [debug] [MainThread]: On master: COMMIT
[0m10:03:48.375778 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:48.375899 [debug] [MainThread]: On master: COMMIT
[0m10:03:48.376058 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:03:48.376167 [debug] [MainThread]: On master: Close
[0m10:03:48.376305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:03:48.376399 [debug] [MainThread]: Connection 'model.sumup.int_transaction' was properly closed.
[0m10:03:48.376484 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m10:03:48.376565 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m10:03:48.376666 [info ] [MainThread]: 
[0m10:03:48.376785 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m10:03:48.377040 [debug] [MainThread]: Command end result
[0m10:03:48.387530 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m10:03:48.388378 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m10:03:48.390710 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m10:03:48.390822 [info ] [MainThread]: 
[0m10:03:48.390966 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:03:48.391080 [info ] [MainThread]: 
[0m10:03:48.391217 [error] [MainThread]: [31mFailure in model int_transaction (models/intermediate/core/int_transaction.sql)[0m
[0m10:03:48.391353 [error] [MainThread]:   Database Error in model int_transaction (models/intermediate/core/int_transaction.sql)
  column reference "device_id" is ambiguous
  LINE 18:     device_id,
               ^
  compiled code at target/run/sumup/models/intermediate/core/int_transaction.sql
[0m10:03:48.391453 [info ] [MainThread]: 
[0m10:03:48.391573 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/intermediate/core/int_transaction.sql
[0m10:03:48.391671 [info ] [MainThread]: 
[0m10:03:48.391782 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m10:03:48.393255 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.44984233, "process_in_blocks": "0", "process_kernel_time": 0.13421, "process_mem_max_rss": "128057344", "process_out_blocks": "0", "process_user_time": 0.75424}
[0m10:03:48.393427 [debug] [MainThread]: Command `dbt run` failed at 10:03:48.393394 after 0.45 seconds
[0m10:03:48.393567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aacdb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aa9fbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aa9fb10>]}
[0m10:03:48.393693 [debug] [MainThread]: Flushing usage events
[0m10:03:49.128830 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:37:35.930956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106534050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107837c50>]}


============================== 14:37:35.933672 | 528feb72-fc7b-446a-a288-5bd78a8461aa ==============================
[0m14:37:35.933672 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:37:35.933919 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'version_check': 'True', 'target_path': 'None', 'write_json': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'empty': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'quiet': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run --select int_transaction', 'indirect_selection': 'eager', 'partial_parse': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'static_parser': 'True', 'introspect': 'True', 'debug': 'False', 'log_format': 'default'}
[0m14:37:36.058215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '528feb72-fc7b-446a-a288-5bd78a8461aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106857950>]}
[0m14:37:36.079292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '528feb72-fc7b-446a-a288-5bd78a8461aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076cacf0>]}
[0m14:37:36.080162 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:37:36.121000 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:37:36.178024 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:37:36.178200 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:37:36.180384 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m14:37:36.194237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '528feb72-fc7b-446a-a288-5bd78a8461aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dfc050>]}
[0m14:37:36.222852 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m14:37:36.224156 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m14:37:36.235033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '528feb72-fc7b-446a-a288-5bd78a8461aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a66c0>]}
[0m14:37:36.235245 [info ] [MainThread]: Found 3 seeds, 8 models, 447 macros
[0m14:37:36.235378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '528feb72-fc7b-446a-a288-5bd78a8461aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c1a350>]}
[0m14:37:36.236027 [info ] [MainThread]: 
[0m14:37:36.236167 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:37:36.236268 [info ] [MainThread]: 
[0m14:37:36.236476 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:37:36.236807 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:37:36.270467 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:37:36.270673 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:37:36.270800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:36.384345 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.113 seconds
[0m14:37:36.385033 [debug] [ThreadPool]: On list_postgres: Close
[0m14:37:36.387256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m14:37:36.390176 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m14:37:36.390383 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m14:37:36.390529 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m14:37:36.390741 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m14:37:36.391380 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m14:37:36.391520 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:37:36.392357 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m14:37:36.392501 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m14:37:36.392726 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m14:37:36.392876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:36.393007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:36.420095 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m14:37:36.420336 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m14:37:36.420490 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m14:37:36.420665 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m14:37:36.420833 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m14:37:36.420967 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m14:37:36.421127 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m14:37:36.421302 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m14:37:36.421470 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m14:37:36.435293 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.014 seconds
[0m14:37:36.435471 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.014 seconds
[0m14:37:36.436201 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m14:37:36.436383 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.015 seconds
[0m14:37:36.437066 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m14:37:36.437675 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m14:37:36.437829 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m14:37:36.437992 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m14:37:36.438552 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m14:37:36.442314 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:36.442512 [debug] [MainThread]: On master: BEGIN
[0m14:37:36.442648 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:37:36.450558 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:37:36.450716 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:36.450884 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:37:36.499167 [debug] [MainThread]: SQL status: SELECT 8 in 0.048 seconds
[0m14:37:36.500291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '528feb72-fc7b-446a-a288-5bd78a8461aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ad2c30>]}
[0m14:37:36.500498 [debug] [MainThread]: On master: ROLLBACK
[0m14:37:36.500794 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:36.500897 [debug] [MainThread]: On master: BEGIN
[0m14:37:36.501204 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:37:36.501409 [debug] [MainThread]: On master: COMMIT
[0m14:37:36.501633 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:36.501788 [debug] [MainThread]: On master: COMMIT
[0m14:37:36.502000 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:37:36.502136 [debug] [MainThread]: On master: Close
[0m14:37:36.503455 [debug] [Thread-1 (]: Began running node model.sumup.int_transaction
[0m14:37:36.503676 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics_analytics.int_transaction ......... [RUN]
[0m14:37:36.503854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.int_transaction)
[0m14:37:36.503985 [debug] [Thread-1 (]: Began compiling node model.sumup.int_transaction
[0m14:37:36.509046 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m14:37:36.509809 [debug] [Thread-1 (]: Began executing node model.sumup.int_transaction
[0m14:37:36.532568 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.int_transaction"
[0m14:37:36.533047 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_transaction"
[0m14:37:36.533189 [debug] [Thread-1 (]: On model.sumup.int_transaction: BEGIN
[0m14:37:36.533308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:36.538583 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:37:36.538778 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_transaction"
[0m14:37:36.538968 [debug] [Thread-1 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

      
  
    

  create  table "postgres"."analytics_analytics"."int_transaction__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    -- Primary and Foreign Keys
    transaction_id,
    device_id,

    -- Product Information
   
    CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA  AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data and Status
    amount_eur,
    status,

    --device data
    t.device_type,
    
    -- store_data
    d.store_id,
    store_name,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction" t
LEFT JOIN "postgres"."analytics_staging"."stg_device" d ON t.device_id = d.device_id
LEFT JOIN "postgres"."analytics_staging"."stg_store" s ON d.store_id = s.store_id

-- Incremental Logic: Only select new records for subsequent runs

  );
  
  
[0m14:37:36.540410 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column reference "device_id" is ambiguous
LINE 18:     device_id,
             ^

[0m14:37:36.540559 [debug] [Thread-1 (]: On model.sumup.int_transaction: ROLLBACK
[0m14:37:36.540836 [debug] [Thread-1 (]: On model.sumup.int_transaction: Close
[0m14:37:36.546344 [debug] [Thread-1 (]: Database Error in model int_transaction (models/intermediate/core/int_transaction.sql)
  column reference "device_id" is ambiguous
  LINE 18:     device_id,
               ^
  compiled code at target/run/sumup/models/intermediate/core/int_transaction.sql
[0m14:37:36.547312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '528feb72-fc7b-446a-a288-5bd78a8461aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11190ae10>]}
[0m14:37:36.547598 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model analytics_analytics.int_transaction  [[31mERROR[0m in 0.04s]
[0m14:37:36.547842 [debug] [Thread-1 (]: Finished running node model.sumup.int_transaction
[0m14:37:36.548077 [debug] [Thread-7 (]: Marking all children of 'model.sumup.int_transaction' to be skipped because of status 'error'.  Reason: Database Error in model int_transaction (models/intermediate/core/int_transaction.sql)
  column reference "device_id" is ambiguous
  LINE 18:     device_id,
               ^
  compiled code at target/run/sumup/models/intermediate/core/int_transaction.sql.
[0m14:37:36.548982 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:36.549118 [debug] [MainThread]: On master: BEGIN
[0m14:37:36.549231 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:37:36.556685 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:37:36.556934 [debug] [MainThread]: On master: COMMIT
[0m14:37:36.557059 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:36.557165 [debug] [MainThread]: On master: COMMIT
[0m14:37:36.557407 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:37:36.557526 [debug] [MainThread]: On master: Close
[0m14:37:36.557700 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:36.557814 [debug] [MainThread]: Connection 'model.sumup.int_transaction' was properly closed.
[0m14:37:36.557917 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m14:37:36.558017 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m14:37:36.558144 [info ] [MainThread]: 
[0m14:37:36.558278 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m14:37:36.558562 [debug] [MainThread]: Command end result
[0m14:37:36.601266 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m14:37:36.603522 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m14:37:36.610556 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m14:37:36.610785 [info ] [MainThread]: 
[0m14:37:36.610986 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:37:36.611176 [info ] [MainThread]: 
[0m14:37:36.611386 [error] [MainThread]: [31mFailure in model int_transaction (models/intermediate/core/int_transaction.sql)[0m
[0m14:37:36.611552 [error] [MainThread]:   Database Error in model int_transaction (models/intermediate/core/int_transaction.sql)
  column reference "device_id" is ambiguous
  LINE 18:     device_id,
               ^
  compiled code at target/run/sumup/models/intermediate/core/int_transaction.sql
[0m14:37:36.611685 [info ] [MainThread]: 
[0m14:37:36.611826 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/intermediate/core/int_transaction.sql
[0m14:37:36.612007 [info ] [MainThread]: 
[0m14:37:36.612340 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:37:36.615774 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7165994, "process_in_blocks": "0", "process_kernel_time": 0.158797, "process_mem_max_rss": "126976000", "process_out_blocks": "0", "process_user_time": 0.779678}
[0m14:37:36.616098 [debug] [MainThread]: Command `dbt run` failed at 14:37:36.616051 after 0.72 seconds
[0m14:37:36.616312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c4db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c1bbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c1bb10>]}
[0m14:37:36.616632 [debug] [MainThread]: Flushing usage events
[0m14:37:37.335799 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:37:49.529095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d37c50>]}


============================== 14:37:49.531537 | adc2defe-b3e9-44df-901a-8528c924c1ab ==============================
[0m14:37:49.531537 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:37:49.531807 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'debug': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'indirect_selection': 'eager', 'no_print': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'invocation_command': 'dbt run --select int_transaction', 'log_cache_events': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'warn_error': 'None', 'use_colors': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'write_json': 'True', 'introspect': 'True', 'log_format': 'default', 'empty': 'False', 'target_path': 'None', 'fail_fast': 'False'}
[0m14:37:49.611116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'adc2defe-b3e9-44df-901a-8528c924c1ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c57950>]}
[0m14:37:49.633219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'adc2defe-b3e9-44df-901a-8528c924c1ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105acacf0>]}
[0m14:37:49.633802 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:37:49.672623 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:37:49.725594 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:37:49.725917 [debug] [MainThread]: Partial parsing: updated file: sumup://models/intermediate/core/int_transaction.sql
[0m14:37:49.818965 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m14:37:49.820843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adc2defe-b3e9-44df-901a-8528c924c1ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107538550>]}
[0m14:37:49.848384 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m14:37:49.849550 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m14:37:49.859179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adc2defe-b3e9-44df-901a-8528c924c1ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da66c0>]}
[0m14:37:49.859371 [info ] [MainThread]: Found 3 seeds, 8 models, 447 macros
[0m14:37:49.859503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adc2defe-b3e9-44df-901a-8528c924c1ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a12b0>]}
[0m14:37:49.860114 [info ] [MainThread]: 
[0m14:37:49.860251 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:37:49.860354 [info ] [MainThread]: 
[0m14:37:49.860554 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:37:49.860895 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:37:49.913130 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:37:49.913306 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:37:49.913415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:49.931548 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.018 seconds
[0m14:37:49.932261 [debug] [ThreadPool]: On list_postgres: Close
[0m14:37:49.934262 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics)
[0m14:37:49.934481 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m14:37:49.936661 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m14:37:49.936850 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m14:37:49.937642 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m14:37:49.937757 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m14:37:49.938305 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m14:37:49.938413 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m14:37:49.938511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:37:49.938604 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m14:37:49.938699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:49.938858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:49.944367 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:37:49.944479 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:37:49.944579 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m14:37:49.944679 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:37:49.944784 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m14:37:49.944893 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m14:37:49.945001 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m14:37:49.945115 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m14:37:49.945252 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m14:37:49.952196 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m14:37:49.952690 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m14:37:49.952804 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m14:37:49.952900 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m14:37:49.953364 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m14:37:49.953795 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m14:37:49.953902 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m14:37:49.954109 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m14:37:49.954412 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m14:37:49.956515 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:49.956626 [debug] [MainThread]: On master: BEGIN
[0m14:37:49.956718 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:37:49.959936 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:37:49.960041 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:49.960174 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:37:49.964813 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m14:37:49.965783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adc2defe-b3e9-44df-901a-8528c924c1ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e5d90>]}
[0m14:37:49.965940 [debug] [MainThread]: On master: ROLLBACK
[0m14:37:49.966157 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:49.966253 [debug] [MainThread]: On master: BEGIN
[0m14:37:49.966563 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:37:49.966660 [debug] [MainThread]: On master: COMMIT
[0m14:37:49.966753 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:49.966841 [debug] [MainThread]: On master: COMMIT
[0m14:37:49.967008 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:37:49.967102 [debug] [MainThread]: On master: Close
[0m14:37:49.968238 [debug] [Thread-1 (]: Began running node model.sumup.int_transaction
[0m14:37:49.968428 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics_analytics.int_transaction ......... [RUN]
[0m14:37:49.968588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.int_transaction)
[0m14:37:49.968715 [debug] [Thread-1 (]: Began compiling node model.sumup.int_transaction
[0m14:37:49.972192 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m14:37:49.972448 [debug] [Thread-1 (]: Began executing node model.sumup.int_transaction
[0m14:37:49.993517 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.int_transaction"
[0m14:37:49.993963 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_transaction"
[0m14:37:49.994104 [debug] [Thread-1 (]: On model.sumup.int_transaction: BEGIN
[0m14:37:49.994220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:49.999603 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:37:49.999757 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_transaction"
[0m14:37:49.999900 [debug] [Thread-1 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

      
  
    

  create  table "postgres"."analytics_analytics"."int_transaction__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    -- Primary and Foreign Keys
    transaction_id,
    t.device_id,

    -- Product Information
   
    CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA  AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data and Status
    amount_eur,
    status,

    --device data
    t.device_type,
    
    -- store_data
    d.store_id,
    store_name,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction" t
LEFT JOIN "postgres"."analytics_staging"."stg_device" d ON t.device_id = d.device_id
LEFT JOIN "postgres"."analytics_staging"."stg_store" s ON d.store_id = s.store_id

-- Incremental Logic: Only select new records for subsequent runs

  );
  
  
[0m14:37:50.007121 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column t.device_type does not exist
LINE 32:     t.device_type,
             ^
HINT:  Perhaps you meant to reference the column "d.device_type".

[0m14:37:50.007265 [debug] [Thread-1 (]: On model.sumup.int_transaction: ROLLBACK
[0m14:37:50.011206 [debug] [Thread-1 (]: On model.sumup.int_transaction: Close
[0m14:37:50.016278 [debug] [Thread-1 (]: Database Error in model int_transaction (models/intermediate/core/int_transaction.sql)
  column t.device_type does not exist
  LINE 32:     t.device_type,
               ^
  HINT:  Perhaps you meant to reference the column "d.device_type".
  compiled code at target/run/sumup/models/intermediate/core/int_transaction.sql
[0m14:37:50.017110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adc2defe-b3e9-44df-901a-8528c924c1ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10785f350>]}
[0m14:37:50.017389 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model analytics_analytics.int_transaction  [[31mERROR[0m in 0.05s]
[0m14:37:50.017617 [debug] [Thread-1 (]: Finished running node model.sumup.int_transaction
[0m14:37:50.017840 [debug] [Thread-7 (]: Marking all children of 'model.sumup.int_transaction' to be skipped because of status 'error'.  Reason: Database Error in model int_transaction (models/intermediate/core/int_transaction.sql)
  column t.device_type does not exist
  LINE 32:     t.device_type,
               ^
  HINT:  Perhaps you meant to reference the column "d.device_type".
  compiled code at target/run/sumup/models/intermediate/core/int_transaction.sql.
[0m14:37:50.018764 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:50.018874 [debug] [MainThread]: On master: BEGIN
[0m14:37:50.018965 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:37:50.024537 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:37:50.024653 [debug] [MainThread]: On master: COMMIT
[0m14:37:50.024755 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:50.024851 [debug] [MainThread]: On master: COMMIT
[0m14:37:50.025017 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:37:50.025106 [debug] [MainThread]: On master: Close
[0m14:37:50.025234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:50.025333 [debug] [MainThread]: Connection 'model.sumup.int_transaction' was properly closed.
[0m14:37:50.025422 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m14:37:50.025510 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m14:37:50.025615 [info ] [MainThread]: 
[0m14:37:50.025726 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m14:37:50.025977 [debug] [MainThread]: Command end result
[0m14:37:50.039625 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m14:37:50.040395 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m14:37:50.042660 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m14:37:50.042773 [info ] [MainThread]: 
[0m14:37:50.042911 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:37:50.043023 [info ] [MainThread]: 
[0m14:37:50.043162 [error] [MainThread]: [31mFailure in model int_transaction (models/intermediate/core/int_transaction.sql)[0m
[0m14:37:50.043296 [error] [MainThread]:   Database Error in model int_transaction (models/intermediate/core/int_transaction.sql)
  column t.device_type does not exist
  LINE 32:     t.device_type,
               ^
  HINT:  Perhaps you meant to reference the column "d.device_type".
  compiled code at target/run/sumup/models/intermediate/core/int_transaction.sql
[0m14:37:50.043400 [info ] [MainThread]: 
[0m14:37:50.043519 [info ] [MainThread]:   compiled code at target/compiled/sumup/models/intermediate/core/int_transaction.sql
[0m14:37:50.043614 [info ] [MainThread]: 
[0m14:37:50.043728 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:37:50.045662 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5447137, "process_in_blocks": "0", "process_kernel_time": 0.141614, "process_mem_max_rss": "128827392", "process_out_blocks": "0", "process_user_time": 0.86841}
[0m14:37:50.045820 [debug] [MainThread]: Command `dbt run` failed at 14:37:50.045790 after 0.54 seconds
[0m14:37:50.045959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a60a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d43250>]}
[0m14:37:50.046083 [debug] [MainThread]: Flushing usage events
[0m14:37:51.198952 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:37:59.338634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e78050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111337c50>]}


============================== 14:37:59.341040 | b5d81523-a594-4c96-939e-430d025c6544 ==============================
[0m14:37:59.341040 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:37:59.341297 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select int_transaction', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'warn_error': 'None', 'target_path': 'None', 'fail_fast': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'log_format': 'default', 'empty': 'False', 'printer_width': '80', 'use_colors': 'True', 'introspect': 'True', 'static_parser': 'True', 'quiet': 'False', 'debug': 'False'}
[0m14:37:59.411086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5d81523-a594-4c96-939e-430d025c6544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11015b950>]}
[0m14:37:59.432653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5d81523-a594-4c96-939e-430d025c6544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110cacf0>]}
[0m14:37:59.433588 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:37:59.473443 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:37:59.523642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:37:59.523927 [debug] [MainThread]: Partial parsing: updated file: sumup://models/intermediate/core/int_transaction.sql
[0m14:37:59.615007 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m14:37:59.616837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5d81523-a594-4c96-939e-430d025c6544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c38550>]}
[0m14:37:59.644618 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m14:37:59.645476 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m14:37:59.654905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5d81523-a594-4c96-939e-430d025c6544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113a66c0>]}
[0m14:37:59.655100 [info ] [MainThread]: Found 3 seeds, 8 models, 447 macros
[0m14:37:59.655233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5d81523-a594-4c96-939e-430d025c6544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f992b0>]}
[0m14:37:59.655830 [info ] [MainThread]: 
[0m14:37:59.655963 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:37:59.656069 [info ] [MainThread]: 
[0m14:37:59.656263 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:37:59.656600 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:37:59.704600 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:37:59.704799 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:37:59.704917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:59.722873 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.018 seconds
[0m14:37:59.723487 [debug] [ThreadPool]: On list_postgres: Close
[0m14:37:59.725349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m14:37:59.725578 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m14:37:59.727741 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m14:37:59.727933 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m14:37:59.728717 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m14:37:59.728841 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m14:37:59.729389 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m14:37:59.729496 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m14:37:59.729595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:37:59.729692 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m14:37:59.729782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:59.729933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:59.735233 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:37:59.735385 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m14:37:59.735508 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m14:37:59.735616 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:37:59.735728 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m14:37:59.735842 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m14:37:59.735954 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m14:37:59.736061 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m14:37:59.736205 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m14:37:59.741549 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m14:37:59.741668 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m14:37:59.742162 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m14:37:59.742274 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m14:37:59.742692 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m14:37:59.743168 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m14:37:59.743282 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m14:37:59.743653 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m14:37:59.743753 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m14:37:59.745841 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:59.745949 [debug] [MainThread]: On master: BEGIN
[0m14:37:59.746039 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:37:59.750814 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m14:37:59.750918 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:59.751049 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:37:59.756704 [debug] [MainThread]: SQL status: SELECT 8 in 0.005 seconds
[0m14:37:59.757666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5d81523-a594-4c96-939e-430d025c6544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113aa5bf0>]}
[0m14:37:59.757825 [debug] [MainThread]: On master: ROLLBACK
[0m14:37:59.758037 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:59.758135 [debug] [MainThread]: On master: BEGIN
[0m14:37:59.758410 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:37:59.758509 [debug] [MainThread]: On master: COMMIT
[0m14:37:59.758604 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:59.758694 [debug] [MainThread]: On master: COMMIT
[0m14:37:59.758862 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:37:59.758958 [debug] [MainThread]: On master: Close
[0m14:37:59.760085 [debug] [Thread-1 (]: Began running node model.sumup.int_transaction
[0m14:37:59.760281 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics_analytics.int_transaction ......... [RUN]
[0m14:37:59.760447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.int_transaction)
[0m14:37:59.760575 [debug] [Thread-1 (]: Began compiling node model.sumup.int_transaction
[0m14:37:59.764084 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m14:37:59.764368 [debug] [Thread-1 (]: Began executing node model.sumup.int_transaction
[0m14:37:59.785958 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.int_transaction"
[0m14:37:59.786356 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_transaction"
[0m14:37:59.786492 [debug] [Thread-1 (]: On model.sumup.int_transaction: BEGIN
[0m14:37:59.786609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:59.791663 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:37:59.791795 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_transaction"
[0m14:37:59.791932 [debug] [Thread-1 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

      
  
    

  create  table "postgres"."analytics_analytics"."int_transaction__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    -- Primary and Foreign Keys
    transaction_id,
    t.device_id,

    -- Product Information
   
    CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA  AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data and Status
    amount_eur,
    status,

    --device data
    d.device_type,
    
    -- store_data
    d.store_id,
    store_name,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction" t
LEFT JOIN "postgres"."analytics_staging"."stg_device" d ON t.device_id = d.device_id
LEFT JOIN "postgres"."analytics_staging"."stg_store" s ON d.store_id = s.store_id

-- Incremental Logic: Only select new records for subsequent runs

  );
  
  
[0m14:37:59.834637 [debug] [Thread-1 (]: SQL status: SELECT 1500 in 0.043 seconds
[0m14:37:59.839356 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_transaction"
[0m14:37:59.839507 [debug] [Thread-1 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */
alter table "postgres"."analytics_analytics"."int_transaction" rename to "int_transaction__dbt_backup"
[0m14:37:59.840796 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:37:59.841923 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_transaction"
[0m14:37:59.842068 [debug] [Thread-1 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */
alter table "postgres"."analytics_analytics"."int_transaction__dbt_tmp" rename to "int_transaction"
[0m14:37:59.842744 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:37:59.849874 [debug] [Thread-1 (]: On model.sumup.int_transaction: COMMIT
[0m14:37:59.850043 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_transaction"
[0m14:37:59.850178 [debug] [Thread-1 (]: On model.sumup.int_transaction: COMMIT
[0m14:37:59.851898 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:37:59.854590 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_analytics"."int_transaction__dbt_backup"
[0m14:37:59.856526 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_transaction"
[0m14:37:59.856678 [debug] [Thread-1 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */
drop view if exists "postgres"."analytics_analytics"."int_transaction__dbt_backup" cascade
[0m14:37:59.861244 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:37:59.862268 [debug] [Thread-1 (]: On model.sumup.int_transaction: Close
[0m14:37:59.863191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5d81523-a594-4c96-939e-430d025c6544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f52e10>]}
[0m14:37:59.863465 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics_analytics.int_transaction .... [[32mSELECT 1500[0m in 0.10s]
[0m14:37:59.863704 [debug] [Thread-1 (]: Finished running node model.sumup.int_transaction
[0m14:37:59.864260 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:59.864396 [debug] [MainThread]: On master: BEGIN
[0m14:37:59.864504 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:37:59.870091 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:37:59.870256 [debug] [MainThread]: On master: COMMIT
[0m14:37:59.870380 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:59.870490 [debug] [MainThread]: On master: COMMIT
[0m14:37:59.870717 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:37:59.870829 [debug] [MainThread]: On master: Close
[0m14:37:59.870976 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:59.871083 [debug] [MainThread]: Connection 'model.sumup.int_transaction' was properly closed.
[0m14:37:59.871181 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m14:37:59.871275 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m14:37:59.871422 [info ] [MainThread]: 
[0m14:37:59.871655 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m14:37:59.871952 [debug] [MainThread]: Command end result
[0m14:37:59.885421 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m14:37:59.886309 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m14:37:59.888784 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m14:37:59.888917 [info ] [MainThread]: 
[0m14:37:59.889076 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:37:59.889189 [info ] [MainThread]: 
[0m14:37:59.889312 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:37:59.890818 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5814346, "process_in_blocks": "0", "process_kernel_time": 0.134705, "process_mem_max_rss": "128352256", "process_out_blocks": "0", "process_user_time": 0.888274}
[0m14:37:59.890998 [debug] [MainThread]: Command `dbt run` succeeded at 14:37:59.890962 after 0.58 seconds
[0m14:37:59.891144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f35a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111080b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11132cf50>]}
[0m14:37:59.891279 [debug] [MainThread]: Flushing usage events
[0m14:38:00.582300 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:39:11.495415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039cc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10480b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10480bc50>]}


============================== 14:39:11.499000 | c54c4e05-5eb3-4c1a-b84d-7a0db9f08e2d ==============================
[0m14:39:11.499000 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:39:11.499418 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt show --select products_ranking', 'log_format': 'default', 'cache_selected_only': 'False', 'printer_width': '80', 'no_print': 'None', 'version_check': 'True', 'write_json': 'True', 'warn_error': 'None', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'quiet': 'False', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'use_colors': 'True', 'log_cache_events': 'False', 'empty': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True'}
[0m14:39:11.589909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c54c4e05-5eb3-4c1a-b84d-7a0db9f08e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b2f950>]}
[0m14:39:11.611103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c54c4e05-5eb3-4c1a-b84d-7a0db9f08e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046a2cf0>]}
[0m14:39:11.621380 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:39:11.661764 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:39:11.721035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:39:11.721318 [debug] [MainThread]: Partial parsing: updated file: sumup://models/marts/core/product_ranking.sql
[0m14:39:11.807652 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m14:39:11.809557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c54c4e05-5eb3-4c1a-b84d-7a0db9f08e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a4250>]}
[0m14:39:11.842805 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m14:39:11.843983 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m14:39:11.844949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c54c4e05-5eb3-4c1a-b84d-7a0db9f08e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056f6d50>]}
[0m14:39:11.845123 [info ] [MainThread]: Found 3 seeds, 8 models, 447 macros
[0m14:39:11.845251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c54c4e05-5eb3-4c1a-b84d-7a0db9f08e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe5550>]}
[0m14:39:11.845508 [warn ] [MainThread]: The selection criterion 'products_ranking' does not match any enabled nodes
[0m14:39:11.845955 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:39:11.846166 [debug] [MainThread]: Command end result
[0m14:39:11.887563 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m14:39:11.888298 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m14:39:11.889521 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m14:39:11.891687 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 0.42918918, "process_in_blocks": "0", "process_kernel_time": 0.127953, "process_mem_max_rss": "123273216", "process_out_blocks": "0", "process_user_time": 0.788144}
[0m14:39:11.891849 [debug] [MainThread]: Command `dbt show` succeeded at 14:39:11.891817 after 0.43 seconds
[0m14:39:11.891982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b47860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104681f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b51490>]}
[0m14:39:11.892103 [debug] [MainThread]: Flushing usage events
[0m14:39:12.619321 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:39:17.820433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e3c50>]}


============================== 14:39:17.822269 | 0b672d1c-a25f-4af8-924f-201450550533 ==============================
[0m14:39:17.822269 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:39:17.822525 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'write_json': 'True', 'debug': 'False', 'target_path': 'None', 'no_print': 'None', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'warn_error': 'None', 'introspect': 'True', 'fail_fast': 'False', 'printer_width': '80', 'quiet': 'False', 'invocation_command': 'dbt show --select product_ranking', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'log_format': 'default'}
[0m14:39:17.887281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b672d1c-a25f-4af8-924f-201450550533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c07950>]}
[0m14:39:17.908224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b672d1c-a25f-4af8-924f-201450550533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10877acf0>]}
[0m14:39:17.918055 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:39:17.974447 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:39:18.032002 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:39:18.032519 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:39:18.035061 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m14:39:18.048300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b672d1c-a25f-4af8-924f-201450550533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098d0550>]}
[0m14:39:18.082536 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m14:39:18.083570 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m14:39:18.084737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b672d1c-a25f-4af8-924f-201450550533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109722d50>]}
[0m14:39:18.084936 [info ] [MainThread]: Found 3 seeds, 8 models, 447 macros
[0m14:39:18.085067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b672d1c-a25f-4af8-924f-201450550533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109012430>]}
[0m14:39:18.085726 [info ] [MainThread]: 
[0m14:39:18.085865 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:39:18.085968 [info ] [MainThread]: 
[0m14:39:18.086177 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:39:18.087925 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m14:39:18.093077 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m14:39:18.094156 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m14:39:18.115505 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m14:39:18.115708 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m14:39:18.115865 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m14:39:18.116008 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m14:39:18.116134 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m14:39:18.116253 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m14:39:18.116375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:18.116485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:18.116589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:18.135978 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m14:39:18.136151 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m14:39:18.136275 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m14:39:18.136397 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m14:39:18.136516 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m14:39:18.136629 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m14:39:18.136754 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m14:39:18.136891 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m14:39:18.137025 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m14:39:18.142944 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m14:39:18.143055 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m14:39:18.143149 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m14:39:18.143702 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m14:39:18.144133 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m14:39:18.144553 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m14:39:18.144802 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m14:39:18.144911 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m14:39:18.145018 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m14:39:18.147560 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:18.147687 [debug] [MainThread]: On master: BEGIN
[0m14:39:18.147784 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:39:18.151902 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:39:18.152004 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:18.152130 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:39:18.157710 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m14:39:18.158354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b672d1c-a25f-4af8-924f-201450550533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a4f380>]}
[0m14:39:18.158496 [debug] [MainThread]: On master: ROLLBACK
[0m14:39:18.158698 [debug] [MainThread]: On master: Close
[0m14:39:18.159945 [debug] [Thread-1 (]: Began running node model.sumup.product_ranking
[0m14:39:18.160100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.product_ranking)
[0m14:39:18.160226 [debug] [Thread-1 (]: Began compiling node model.sumup.product_ranking
[0m14:39:18.162984 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.product_ranking"
[0m14:39:18.163640 [debug] [Thread-1 (]: Began executing node model.sumup.product_ranking
[0m14:39:18.166666 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_ranking"
[0m14:39:18.166807 [debug] [Thread-1 (]: On model.sumup.product_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.product_ranking"} */

  
  --Question 2) 

select product_id,
    count(*) as total_sales
from "postgres"."analytics_analytics"."int_transaction"
group by product_id
  
  limit 5

[0m14:39:18.166924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:18.174895 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.008 seconds
[0m14:39:18.175798 [debug] [Thread-1 (]: On model.sumup.product_ranking: Close
[0m14:39:18.176081 [debug] [Thread-1 (]: Finished running node model.sumup.product_ranking
[0m14:39:18.176506 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:18.176612 [debug] [MainThread]: Connection 'model.sumup.product_ranking' was properly closed.
[0m14:39:18.176704 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m14:39:18.176791 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m14:39:18.177017 [debug] [MainThread]: Command end result
[0m14:39:18.189147 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m14:39:18.189752 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m14:39:18.192112 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m14:39:18.192270 [info ] [MainThread]: Previewing node 'product_ranking':
| product_id           | total_sales |
| -------------------- | ----------- |
| <memory at 0x109a... |           1 |
| <memory at 0x109a... |           1 |
| <memory at 0x109a... |           1 |
| <memory at 0x109a... |           1 |
| <memory at 0x109a... |           1 |

[0m14:39:18.193654 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 0.3983932, "process_in_blocks": "0", "process_kernel_time": 0.111869, "process_mem_max_rss": "126451712", "process_out_blocks": "0", "process_user_time": 0.73985}
[0m14:39:18.193828 [debug] [MainThread]: Command `dbt show` succeeded at 14:39:18.193796 after 0.40 seconds
[0m14:39:18.193968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108759e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c68ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c69230>]}
[0m14:39:18.194093 [debug] [MainThread]: Flushing usage events
[0m14:39:18.882416 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:40:05.666867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d04050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112237c50>]}


============================== 14:40:05.670238 | dce76880-6e12-471d-b4bb-97a497c46803 ==============================
[0m14:40:05.670238 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:40:05.670634 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'write_json': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'warn_error': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'log_format': 'default', 'version_check': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'no_print': 'None', 'introspect': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'use_colors': 'True', 'invocation_command': 'dbt show --select product_ranking'}
[0m14:40:05.759454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dce76880-6e12-471d-b4bb-97a497c46803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111157950>]}
[0m14:40:05.780486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dce76880-6e12-471d-b4bb-97a497c46803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fcacf0>]}
[0m14:40:05.790818 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:40:05.833057 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:40:05.890596 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:40:05.890860 [debug] [MainThread]: Partial parsing: updated file: sumup://models/marts/core/product_ranking.sql
[0m14:40:05.992940 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m14:40:05.994809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dce76880-6e12-471d-b4bb-97a497c46803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113074250>]}
[0m14:40:06.024341 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m14:40:06.025492 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m14:40:06.026472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dce76880-6e12-471d-b4bb-97a497c46803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ec6d50>]}
[0m14:40:06.026643 [info ] [MainThread]: Found 3 seeds, 8 models, 447 macros
[0m14:40:06.026771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dce76880-6e12-471d-b4bb-97a497c46803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126d1550>]}
[0m14:40:06.027377 [info ] [MainThread]: 
[0m14:40:06.027512 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:40:06.027615 [info ] [MainThread]: 
[0m14:40:06.027807 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:40:06.029381 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m14:40:06.033543 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m14:40:06.036411 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m14:40:06.082737 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m14:40:06.083020 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m14:40:06.083173 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m14:40:06.083311 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m14:40:06.083445 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m14:40:06.083581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:06.083720 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m14:40:06.083865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:06.084710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:06.112280 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m14:40:06.112457 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m14:40:06.112597 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m14:40:06.112725 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m14:40:06.112849 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m14:40:06.112970 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m14:40:06.113103 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m14:40:06.113246 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m14:40:06.113384 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m14:40:06.133094 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.020 seconds
[0m14:40:06.133213 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.020 seconds
[0m14:40:06.133324 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.020 seconds
[0m14:40:06.133922 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m14:40:06.134401 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m14:40:06.134853 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m14:40:06.135150 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m14:40:06.135273 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m14:40:06.135409 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m14:40:06.138187 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:06.138324 [debug] [MainThread]: On master: BEGIN
[0m14:40:06.138424 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:40:06.143559 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m14:40:06.143670 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:06.143812 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:40:06.150075 [debug] [MainThread]: SQL status: SELECT 4 in 0.006 seconds
[0m14:40:06.150867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dce76880-6e12-471d-b4bb-97a497c46803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131f1300>]}
[0m14:40:06.151039 [debug] [MainThread]: On master: ROLLBACK
[0m14:40:06.151266 [debug] [MainThread]: On master: Close
[0m14:40:06.152569 [debug] [Thread-1 (]: Began running node model.sumup.product_ranking
[0m14:40:06.152752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.product_ranking)
[0m14:40:06.152894 [debug] [Thread-1 (]: Began compiling node model.sumup.product_ranking
[0m14:40:06.156265 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.product_ranking"
[0m14:40:06.156576 [debug] [Thread-1 (]: Began executing node model.sumup.product_ranking
[0m14:40:06.159247 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_ranking"
[0m14:40:06.159391 [debug] [Thread-1 (]: On model.sumup.product_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.product_ranking"} */

  
  --Question 2) 

select product_name,
    count(*) as total_sales
from "postgres"."analytics_analytics"."int_transaction"
group by product_name
  
  limit 5

[0m14:40:06.159519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:06.166496 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.007 seconds
[0m14:40:06.167453 [debug] [Thread-1 (]: On model.sumup.product_ranking: Close
[0m14:40:06.167743 [debug] [Thread-1 (]: Finished running node model.sumup.product_ranking
[0m14:40:06.168172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:06.168285 [debug] [MainThread]: Connection 'model.sumup.product_ranking' was properly closed.
[0m14:40:06.168385 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m14:40:06.168480 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m14:40:06.168718 [debug] [MainThread]: Command end result
[0m14:40:06.181192 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m14:40:06.181879 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m14:40:06.184508 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m14:40:06.184690 [info ] [MainThread]: Previewing node 'product_ranking':
| product_name      | total_sales |
| ----------------- | ----------- |
| cursus a,         |           1 |
| neque. Sed        |           1 |
| molestie pharetra |           1 |
| tempor lorem,     |           4 |
| ultricies sem     |           2 |

[0m14:40:06.186744 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 0.5589082, "process_in_blocks": "0", "process_kernel_time": 0.148687, "process_mem_max_rss": "129859584", "process_out_blocks": "0", "process_user_time": 0.856487}
[0m14:40:06.186918 [debug] [MainThread]: Command `dbt show` succeeded at 14:40:06.186885 after 0.56 seconds
[0m14:40:06.187056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fa9e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11336dff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11336dd30>]}
[0m14:40:06.187187 [debug] [MainThread]: Flushing usage events
[0m14:40:06.947198 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:40:27.825072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108058050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e9b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e9bc50>]}


============================== 14:40:27.827612 | 2ba148fa-301a-4c32-801b-ffa87be95638 ==============================
[0m14:40:27.827612 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:40:27.827889 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'introspect': 'True', 'invocation_command': 'dbt show --select product_ranking', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'fail_fast': 'False', 'version_check': 'True', 'target_path': 'None', 'quiet': 'False', 'partial_parse': 'True', 'printer_width': '80', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'warn_error': 'None', 'debug': 'False', 'log_format': 'default', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'indirect_selection': 'eager', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup'}
[0m14:40:27.905243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ba148fa-301a-4c32-801b-ffa87be95638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081bf950>]}
[0m14:40:27.926785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ba148fa-301a-4c32-801b-ffa87be95638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d2ecf0>]}
[0m14:40:27.935780 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:40:27.975564 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:40:28.028711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:40:28.029021 [debug] [MainThread]: Partial parsing: updated file: sumup://models/marts/core/product_ranking.sql
[0m14:40:28.116779 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m14:40:28.118671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ba148fa-301a-4c32-801b-ffa87be95638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e84250>]}
[0m14:40:28.146290 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m14:40:28.147400 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m14:40:28.148341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ba148fa-301a-4c32-801b-ffa87be95638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cd6d50>]}
[0m14:40:28.148512 [info ] [MainThread]: Found 3 seeds, 8 models, 447 macros
[0m14:40:28.148639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ba148fa-301a-4c32-801b-ffa87be95638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c5550>]}
[0m14:40:28.149290 [info ] [MainThread]: 
[0m14:40:28.149442 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:40:28.149550 [info ] [MainThread]: 
[0m14:40:28.149746 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:40:28.151307 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m14:40:28.155163 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m14:40:28.158026 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m14:40:28.203202 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m14:40:28.203405 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m14:40:28.203565 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m14:40:28.203703 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m14:40:28.203831 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m14:40:28.203957 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m14:40:28.204065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:28.204166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:28.204258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:28.224379 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m14:40:28.224574 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m14:40:28.224725 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m14:40:28.224850 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m14:40:28.224976 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m14:40:28.225101 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m14:40:28.225229 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m14:40:28.225369 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m14:40:28.225511 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m14:40:28.230562 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m14:40:28.230678 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m14:40:28.230778 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m14:40:28.231320 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m14:40:28.231736 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m14:40:28.232149 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m14:40:28.232392 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m14:40:28.232507 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m14:40:28.232625 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m14:40:28.235232 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:28.235354 [debug] [MainThread]: On master: BEGIN
[0m14:40:28.235446 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:40:28.239537 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:40:28.239638 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:28.239766 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:40:28.244518 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m14:40:28.245227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ba148fa-301a-4c32-801b-ffa87be95638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a001300>]}
[0m14:40:28.245377 [debug] [MainThread]: On master: ROLLBACK
[0m14:40:28.245583 [debug] [MainThread]: On master: Close
[0m14:40:28.246721 [debug] [Thread-1 (]: Began running node model.sumup.product_ranking
[0m14:40:28.246876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.product_ranking)
[0m14:40:28.247003 [debug] [Thread-1 (]: Began compiling node model.sumup.product_ranking
[0m14:40:28.250231 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.product_ranking"
[0m14:40:28.250549 [debug] [Thread-1 (]: Began executing node model.sumup.product_ranking
[0m14:40:28.253065 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_ranking"
[0m14:40:28.253210 [debug] [Thread-1 (]: On model.sumup.product_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.product_ranking"} */

  
  --Question 2) 

select product_name,
    count(*) as total_sales
from "postgres"."analytics_analytics"."int_transaction"
group by product_name
order by total_sales desc 
limit 10
  
  limit 5

[0m14:40:28.253335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:28.258382 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "limit"
LINE 13:   limit 5
           ^

[0m14:40:28.258541 [debug] [Thread-1 (]: On model.sumup.product_ranking: Close
[0m14:40:28.261801 [debug] [Thread-1 (]: Database Error in model product_ranking (models/marts/core/product_ranking.sql)
  syntax error at or near "limit"
  LINE 13:   limit 5
             ^
[0m14:40:28.262034 [debug] [Thread-1 (]: Finished running node model.sumup.product_ranking
[0m14:40:28.262231 [debug] [Thread-7 (]: Marking all children of 'model.sumup.product_ranking' to be skipped because of status 'error'.  Reason: Database Error in model product_ranking (models/marts/core/product_ranking.sql)
  syntax error at or near "limit"
  LINE 13:   limit 5
             ^.
[0m14:40:28.262603 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:28.262740 [debug] [MainThread]: Connection 'model.sumup.product_ranking' was properly closed.
[0m14:40:28.262858 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m14:40:28.262961 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m14:40:28.263129 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model product_ranking (models/marts/core/product_ranking.sql)
    syntax error at or near "limit"
    LINE 13:   limit 5
               ^
[0m14:40:28.265130 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.46993005, "process_in_blocks": "0", "process_kernel_time": 0.133015, "process_mem_max_rss": "128942080", "process_out_blocks": "0", "process_user_time": 0.816629}
[0m14:40:28.265295 [debug] [MainThread]: Command `dbt show` failed at 14:40:28.265262 after 0.47 seconds
[0m14:40:28.265432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d0df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1b2200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1b22b0>]}
[0m14:40:28.265592 [debug] [MainThread]: Flushing usage events
[0m14:40:28.959432 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:40:34.115232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043f4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106037c50>]}


============================== 14:40:34.117598 | 425a498a-e9c7-47cf-833d-51d11e321e90 ==============================
[0m14:40:34.117598 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:40:34.117859 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_cache_events': 'False', 'debug': 'False', 'write_json': 'True', 'use_colors': 'True', 'empty': 'None', 'fail_fast': 'False', 'introspect': 'True', 'no_print': 'None', 'warn_error': 'None', 'version_check': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt show --select product_ranking', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'printer_width': '80', 'partial_parse': 'True', 'log_format': 'default'}
[0m14:40:34.234569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '425a498a-e9c7-47cf-833d-51d11e321e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104857950>]}
[0m14:40:34.257409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '425a498a-e9c7-47cf-833d-51d11e321e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056cacf0>]}
[0m14:40:34.267590 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:40:34.310056 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:40:34.361855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:40:34.362132 [debug] [MainThread]: Partial parsing: updated file: sumup://models/marts/core/product_ranking.sql
[0m14:40:34.506598 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m14:40:34.508765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '425a498a-e9c7-47cf-833d-51d11e321e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cf0250>]}
[0m14:40:34.539810 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m14:40:34.541041 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m14:40:34.542358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '425a498a-e9c7-47cf-833d-51d11e321e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a42d50>]}
[0m14:40:34.542570 [info ] [MainThread]: Found 3 seeds, 8 models, 447 macros
[0m14:40:34.542708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '425a498a-e9c7-47cf-833d-51d11e321e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c5550>]}
[0m14:40:34.543368 [info ] [MainThread]: 
[0m14:40:34.543508 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:40:34.543612 [info ] [MainThread]: 
[0m14:40:34.543815 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:40:34.545460 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m14:40:34.549895 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m14:40:34.552313 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m14:40:34.596724 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m14:40:34.596936 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m14:40:34.597099 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m14:40:34.597247 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m14:40:34.597374 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m14:40:34.597499 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m14:40:34.597608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:34.597731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:34.597847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:34.611206 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m14:40:34.611418 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m14:40:34.611544 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m14:40:34.611676 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m14:40:34.611804 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m14:40:34.611935 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m14:40:34.612070 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m14:40:34.612199 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m14:40:34.612356 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m14:40:34.615938 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m14:40:34.616094 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m14:40:34.616690 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m14:40:34.616818 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m14:40:34.617318 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m14:40:34.617818 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m14:40:34.617949 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m14:40:34.618063 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m14:40:34.618581 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m14:40:34.620892 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:34.621011 [debug] [MainThread]: On master: BEGIN
[0m14:40:34.621109 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:40:34.625828 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m14:40:34.625935 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:34.626067 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:40:34.630472 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m14:40:34.631139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '425a498a-e9c7-47cf-833d-51d11e321e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f6d230>]}
[0m14:40:34.631288 [debug] [MainThread]: On master: ROLLBACK
[0m14:40:34.631467 [debug] [MainThread]: On master: Close
[0m14:40:34.632702 [debug] [Thread-1 (]: Began running node model.sumup.product_ranking
[0m14:40:34.632887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.product_ranking)
[0m14:40:34.633013 [debug] [Thread-1 (]: Began compiling node model.sumup.product_ranking
[0m14:40:34.636058 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.product_ranking"
[0m14:40:34.636331 [debug] [Thread-1 (]: Began executing node model.sumup.product_ranking
[0m14:40:34.638825 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_ranking"
[0m14:40:34.638965 [debug] [Thread-1 (]: On model.sumup.product_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.product_ranking"} */

  
  --Question 2) 

select product_name,
    count(*) as total_sales
from "postgres"."analytics_analytics"."int_transaction"
group by product_name
order by total_sales desc 
--limit 10
  
  limit 5

[0m14:40:34.639085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:34.644966 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m14:40:34.645815 [debug] [Thread-1 (]: On model.sumup.product_ranking: Close
[0m14:40:34.646072 [debug] [Thread-1 (]: Finished running node model.sumup.product_ranking
[0m14:40:34.646478 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:34.646597 [debug] [MainThread]: Connection 'model.sumup.product_ranking' was properly closed.
[0m14:40:34.646693 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m14:40:34.646782 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m14:40:34.647008 [debug] [MainThread]: Command end result
[0m14:40:34.657734 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m14:40:34.658387 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m14:40:34.660835 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m14:40:34.661000 [info ] [MainThread]: Previewing node 'product_ranking':
| product_name      | total_sales |
| ----------------- | ----------- |
| sit amet          |          11 |
| natoque penatibus |          10 |
| dis parturient    |           7 |
| dolor. Fusce      |           6 |
| sit amet,         |           6 |

[0m14:40:34.662584 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 0.5754376, "process_in_blocks": "0", "process_kernel_time": 0.116566, "process_mem_max_rss": "129728512", "process_out_blocks": "0", "process_user_time": 0.869556}
[0m14:40:34.662769 [debug] [MainThread]: Command `dbt show` succeeded at 14:40:34.662733 after 0.58 seconds
[0m14:40:34.662908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056a9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a1df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a1dc80>]}
[0m14:40:34.663034 [debug] [MainThread]: Flushing usage events
[0m14:40:35.354546 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:00:52.738205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e64050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ca79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ca7c50>]}


============================== 21:00:52.741094 | 759d604a-40b5-4f98-a5ac-cbc0073a85e2 ==============================
[0m21:00:52.741094 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:00:52.741351 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'quiet': 'False', 'invocation_command': 'dbt run --select int_transaction', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_format': 'default', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'use_colors': 'True', 'version_check': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'empty': 'False', 'warn_error': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'debug': 'False', 'partial_parse': 'True'}
[0m21:00:52.826942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '759d604a-40b5-4f98-a5ac-cbc0073a85e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fc7950>]}
[0m21:00:52.848180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '759d604a-40b5-4f98-a5ac-cbc0073a85e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b3acf0>]}
[0m21:00:52.848584 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:00:52.887852 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:00:52.944857 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 2 files changed.
[0m21:00:52.945092 [debug] [MainThread]: Partial parsing: added file: sumup://models/marts/core/store_adoption_ranking.sql
[0m21:00:52.945215 [debug] [MainThread]: Partial parsing: added file: sumup://models/marts/core/store_attribution_ranking.sql
[0m21:00:52.945314 [debug] [MainThread]: Partial parsing: deleted file: sumup://models/marts/core/store_ranking.sql
[0m21:00:52.945443 [debug] [MainThread]: Partial parsing: updated file: sumup://models/marts/core/device_adoption.sql
[0m21:00:52.945569 [debug] [MainThread]: Partial parsing: updated file: sumup://models/intermediate/core/int_transaction.sql
[0m21:00:53.038127 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m21:00:53.039966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '759d604a-40b5-4f98-a5ac-cbc0073a85e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bd2e50>]}
[0m21:00:53.069520 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m21:00:53.071000 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m21:00:53.082805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '759d604a-40b5-4f98-a5ac-cbc0073a85e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d166c0>]}
[0m21:00:53.083006 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m21:00:53.083143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '759d604a-40b5-4f98-a5ac-cbc0073a85e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bdf070>]}
[0m21:00:53.083767 [info ] [MainThread]: 
[0m21:00:53.083905 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:00:53.084013 [info ] [MainThread]: 
[0m21:00:53.084212 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:00:53.084551 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m21:00:53.149533 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m21:00:53.149721 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m21:00:53.149843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:53.254760 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.105 seconds
[0m21:00:53.255596 [debug] [ThreadPool]: On list_postgres: Close
[0m21:00:53.258262 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m21:00:53.261375 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m21:00:53.261656 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m21:00:53.261823 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m21:00:53.262042 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m21:00:53.263149 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m21:00:53.263321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:53.264066 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m21:00:53.264209 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m21:00:53.264409 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m21:00:53.264542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:53.264667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:53.272893 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m21:00:53.273053 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m21:00:53.273224 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m21:00:53.273362 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m21:00:53.273506 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m21:00:53.273641 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m21:00:53.273789 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:00:53.273958 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m21:00:53.274116 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:00:53.284549 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.010 seconds
[0m21:00:53.284710 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m21:00:53.284845 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.011 seconds
[0m21:00:53.285513 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m21:00:53.286098 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m21:00:53.286635 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m21:00:53.286945 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m21:00:53.287087 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m21:00:53.287226 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m21:00:53.290705 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:53.290856 [debug] [MainThread]: On master: BEGIN
[0m21:00:53.290979 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:00:53.296252 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m21:00:53.296395 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:53.296574 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:00:53.305455 [debug] [MainThread]: SQL status: SELECT 4 in 0.009 seconds
[0m21:00:53.306480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '759d604a-40b5-4f98-a5ac-cbc0073a85e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef9230>]}
[0m21:00:53.306703 [debug] [MainThread]: On master: ROLLBACK
[0m21:00:53.306970 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:53.307110 [debug] [MainThread]: On master: BEGIN
[0m21:00:53.307432 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:00:53.307573 [debug] [MainThread]: On master: COMMIT
[0m21:00:53.307705 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:53.307836 [debug] [MainThread]: On master: COMMIT
[0m21:00:53.308045 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:00:53.308183 [debug] [MainThread]: On master: Close
[0m21:00:53.309743 [debug] [Thread-1 (]: Began running node model.sumup.int_transaction
[0m21:00:53.309992 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics_analytics.int_transaction ......... [RUN]
[0m21:00:53.310208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.int_transaction)
[0m21:00:53.310378 [debug] [Thread-1 (]: Began compiling node model.sumup.int_transaction
[0m21:00:53.316084 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m21:00:53.316878 [debug] [Thread-1 (]: Began executing node model.sumup.int_transaction
[0m21:00:53.341969 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_transaction"
[0m21:00:53.342235 [debug] [Thread-1 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

    
  
    

  create temporary table "int_transaction__dbt_tmp210053331670"
  
  
    as
  
  (
    

SELECT
    -- Primary and Foreign Keys
    transaction_id,
    t.device_id,

    -- Product Information
   
    CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA  AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data and Status
    amount_eur,
    status,

    --device data
    d.device_type,
    
    -- store_data
    d.store_id,
    store_name,
    store_typology,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction" t
LEFT JOIN "postgres"."analytics_staging"."stg_device" d ON t.device_id = d.device_id
LEFT JOIN "postgres"."analytics_staging"."stg_store" s ON d.store_id = s.store_id

-- Incremental Logic: Only select new records for subsequent runs

    WHERE t.created_at_utc > (SELECT MAX(created_at_utc) FROM "postgres"."analytics_analytics"."int_transaction")

  );
  
  
[0m21:00:53.342402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:53.372358 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.030 seconds
[0m21:00:53.378838 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_transaction"
[0m21:00:53.379012 [debug] [Thread-1 (]: On model.sumup.int_transaction: BEGIN
[0m21:00:53.379332 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m21:00:53.379483 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_transaction"
[0m21:00:53.379628 [debug] [Thread-1 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_transaction__dbt_tmp210053331670'
        
      order by ordinal_position

  
[0m21:00:53.402751 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.023 seconds
[0m21:00:53.405389 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_transaction"
[0m21:00:53.405575 [debug] [Thread-1 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_transaction'
        
        and table_schema = 'analytics_analytics'
        
      order by ordinal_position

  
[0m21:00:53.412351 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.007 seconds
[0m21:00:53.416089 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_transaction"
[0m21:00:53.416266 [debug] [Thread-1 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_transaction'
        
        and table_schema = 'analytics_analytics'
        
      order by ordinal_position

  
[0m21:00:53.420655 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.004 seconds
[0m21:00:53.425336 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.int_transaction"
[0m21:00:53.425922 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_transaction"
[0m21:00:53.426118 [debug] [Thread-1 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

      insert into "postgres"."analytics_analytics"."int_transaction" ("transaction_id", "device_id", "product_id", "product_name", "product_sku", "category_name", "amount_eur", "status", "device_type", "store_id", "store_name", "card_number_hashed", "cvv_hashed", "created_at_utc", "happened_at_utc")
    (
        select "transaction_id", "device_id", "product_id", "product_name", "product_sku", "category_name", "amount_eur", "status", "device_type", "store_id", "store_name", "card_number_hashed", "cvv_hashed", "created_at_utc", "happened_at_utc"
        from "int_transaction__dbt_tmp210053331670"
    )


  
[0m21:00:53.426932 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m21:00:53.433857 [debug] [Thread-1 (]: On model.sumup.int_transaction: COMMIT
[0m21:00:53.434053 [debug] [Thread-1 (]: Using postgres connection "model.sumup.int_transaction"
[0m21:00:53.434204 [debug] [Thread-1 (]: On model.sumup.int_transaction: COMMIT
[0m21:00:53.436109 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m21:00:53.436930 [debug] [Thread-1 (]: On model.sumup.int_transaction: Close
[0m21:00:53.437883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '759d604a-40b5-4f98-a5ac-cbc0073a85e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef6bd0>]}
[0m21:00:53.438196 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics_analytics.int_transaction .... [[32mINSERT 0 0[0m in 0.13s]
[0m21:00:53.438459 [debug] [Thread-1 (]: Finished running node model.sumup.int_transaction
[0m21:00:53.439084 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:53.439229 [debug] [MainThread]: On master: BEGIN
[0m21:00:53.439347 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:00:53.446041 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m21:00:53.446181 [debug] [MainThread]: On master: COMMIT
[0m21:00:53.446299 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:53.446413 [debug] [MainThread]: On master: COMMIT
[0m21:00:53.446652 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:00:53.446805 [debug] [MainThread]: On master: Close
[0m21:00:53.446995 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:53.447118 [debug] [MainThread]: Connection 'model.sumup.int_transaction' was properly closed.
[0m21:00:53.447227 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m21:00:53.447331 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m21:00:53.447467 [info ] [MainThread]: 
[0m21:00:53.447619 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m21:00:53.447952 [debug] [MainThread]: Command end result
[0m21:00:53.460878 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m21:00:53.461916 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m21:00:53.465377 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m21:00:53.465573 [info ] [MainThread]: 
[0m21:00:53.465749 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:00:53.465867 [info ] [MainThread]: 
[0m21:00:53.465998 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:00:53.468267 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.76119226, "process_in_blocks": "0", "process_kernel_time": 0.161954, "process_mem_max_rss": "130088960", "process_out_blocks": "0", "process_user_time": 0.896561}
[0m21:00:53.468485 [debug] [MainThread]: Command `dbt run` succeeded at 21:00:53.468446 after 0.76 seconds
[0m21:00:53.468654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105be8cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059bee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059bd1d0>]}
[0m21:00:53.468826 [debug] [MainThread]: Flushing usage events
[0m21:00:53.473962 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:01:01.257358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10620c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10704f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10704fc50>]}


============================== 21:01:01.259590 | fe5e9a20-e0f3-4a0e-9b33-a748d0955803 ==============================
[0m21:01:01.259590 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:01:01.259839 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'static_parser': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'target_path': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'empty': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'debug': 'False', 'no_print': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'use_colors': 'True', 'printer_width': '80', 'invocation_command': 'dbt run --select device_adoption', 'quiet': 'False', 'log_format': 'default'}
[0m21:01:01.327254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe5e9a20-e0f3-4a0e-9b33-a748d0955803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106373950>]}
[0m21:01:01.348082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe5e9a20-e0f3-4a0e-9b33-a748d0955803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee2cf0>]}
[0m21:01:01.348636 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:01:01.385930 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:01:01.434854 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:01:01.435028 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:01:01.437155 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m21:01:01.450893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe5e9a20-e0f3-4a0e-9b33-a748d0955803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f80050>]}
[0m21:01:01.479087 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m21:01:01.480042 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m21:01:01.489961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe5e9a20-e0f3-4a0e-9b33-a748d0955803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070be6c0>]}
[0m21:01:01.490175 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m21:01:01.490315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe5e9a20-e0f3-4a0e-9b33-a748d0955803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c2350>]}
[0m21:01:01.490977 [info ] [MainThread]: 
[0m21:01:01.491116 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:01:01.491220 [info ] [MainThread]: 
[0m21:01:01.491434 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:01:01.491860 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m21:01:01.511738 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m21:01:01.511930 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m21:01:01.512052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:01.525259 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.013 seconds
[0m21:01:01.525931 [debug] [ThreadPool]: On list_postgres: Close
[0m21:01:01.528273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics)
[0m21:01:01.528637 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m21:01:01.531272 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m21:01:01.531510 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m21:01:01.532181 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m21:01:01.532306 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m21:01:01.533209 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m21:01:01.533338 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m21:01:01.533453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:01:01.533566 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m21:01:01.533670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:01.533823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:01.539466 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m21:01:01.539637 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m21:01:01.539759 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m21:01:01.539873 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m21:01:01.539990 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m21:01:01.540107 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m21:01:01.540241 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m21:01:01.540376 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:01:01.540508 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:01:01.545154 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m21:01:01.545296 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m21:01:01.545400 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m21:01:01.545956 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m21:01:01.546378 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m21:01:01.546774 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m21:01:01.547052 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m21:01:01.547175 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m21:01:01.547294 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m21:01:01.550030 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:01.550160 [debug] [MainThread]: On master: BEGIN
[0m21:01:01.550255 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:01:01.554514 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:01:01.554628 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:01.554752 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:01:01.560408 [debug] [MainThread]: SQL status: SELECT 4 in 0.006 seconds
[0m21:01:01.561526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe5e9a20-e0f3-4a0e-9b33-a748d0955803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10831b2b0>]}
[0m21:01:01.561735 [debug] [MainThread]: On master: ROLLBACK
[0m21:01:01.561948 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:01.562042 [debug] [MainThread]: On master: BEGIN
[0m21:01:01.562240 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:01:01.562333 [debug] [MainThread]: On master: COMMIT
[0m21:01:01.562420 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:01.562504 [debug] [MainThread]: On master: COMMIT
[0m21:01:01.562653 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:01:01.562743 [debug] [MainThread]: On master: Close
[0m21:01:01.563893 [debug] [Thread-1 (]: Began running node model.sumup.device_adoption
[0m21:01:01.564101 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_analytics.device_adoption ................ [RUN]
[0m21:01:01.564265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.device_adoption)
[0m21:01:01.564394 [debug] [Thread-1 (]: Began compiling node model.sumup.device_adoption
[0m21:01:01.567325 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.device_adoption"
[0m21:01:01.567992 [debug] [Thread-1 (]: Began executing node model.sumup.device_adoption
[0m21:01:01.581682 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.device_adoption"
[0m21:01:01.582337 [debug] [Thread-1 (]: Using postgres connection "model.sumup.device_adoption"
[0m21:01:01.582474 [debug] [Thread-1 (]: On model.sumup.device_adoption: BEGIN
[0m21:01:01.582592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:01.587144 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m21:01:01.587278 [debug] [Thread-1 (]: Using postgres connection "model.sumup.device_adoption"
[0m21:01:01.587401 [debug] [Thread-1 (]: On model.sumup.device_adoption: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.device_adoption"} */

  create view "postgres"."analytics_analytics"."device_adoption__dbt_tmp"
    
    
  as (
    select device_type,
    case when device_type = 1 then 1 else 0 end as is_type_1
from "postgres"."analytics_analytics"."int_transaction"
  );
[0m21:01:01.590032 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:01:01.592209 [debug] [Thread-1 (]: Using postgres connection "model.sumup.device_adoption"
[0m21:01:01.592337 [debug] [Thread-1 (]: On model.sumup.device_adoption: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.device_adoption"} */
alter table "postgres"."analytics_analytics"."device_adoption__dbt_tmp" rename to "device_adoption"
[0m21:01:01.593106 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:01:01.598408 [debug] [Thread-1 (]: On model.sumup.device_adoption: COMMIT
[0m21:01:01.598559 [debug] [Thread-1 (]: Using postgres connection "model.sumup.device_adoption"
[0m21:01:01.598671 [debug] [Thread-1 (]: On model.sumup.device_adoption: COMMIT
[0m21:01:01.599162 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m21:01:01.601313 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_analytics"."device_adoption__dbt_backup"
[0m21:01:01.603004 [debug] [Thread-1 (]: Using postgres connection "model.sumup.device_adoption"
[0m21:01:01.603133 [debug] [Thread-1 (]: On model.sumup.device_adoption: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.device_adoption"} */
drop view if exists "postgres"."analytics_analytics"."device_adoption__dbt_backup" cascade
[0m21:01:01.603547 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:01:01.604440 [debug] [Thread-1 (]: On model.sumup.device_adoption: Close
[0m21:01:01.605237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe5e9a20-e0f3-4a0e-9b33-a748d0955803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081a2450>]}
[0m21:01:01.605519 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analytics_analytics.device_adoption ........... [[32mCREATE VIEW[0m in 0.04s]
[0m21:01:01.605761 [debug] [Thread-1 (]: Finished running node model.sumup.device_adoption
[0m21:01:01.606290 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:01.606400 [debug] [MainThread]: On master: BEGIN
[0m21:01:01.606494 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:01:01.612236 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m21:01:01.612358 [debug] [MainThread]: On master: COMMIT
[0m21:01:01.612455 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:01.612548 [debug] [MainThread]: On master: COMMIT
[0m21:01:01.612740 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:01:01.612835 [debug] [MainThread]: On master: Close
[0m21:01:01.612960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:01:01.613052 [debug] [MainThread]: Connection 'model.sumup.device_adoption' was properly closed.
[0m21:01:01.613135 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m21:01:01.613214 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m21:01:01.613308 [info ] [MainThread]: 
[0m21:01:01.613428 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m21:01:01.613680 [debug] [MainThread]: Command end result
[0m21:01:01.654242 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m21:01:01.655028 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m21:01:01.657218 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m21:01:01.657332 [info ] [MainThread]: 
[0m21:01:01.657473 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:01:01.657577 [info ] [MainThread]: 
[0m21:01:01.657693 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:01:01.659165 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4278656, "process_in_blocks": "0", "process_kernel_time": 0.114417, "process_mem_max_rss": "126550016", "process_out_blocks": "0", "process_user_time": 0.787648}
[0m21:01:01.659366 [debug] [MainThread]: Command `dbt run` succeeded at 21:01:01.659328 after 0.43 seconds
[0m21:01:01.659514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108488ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d9e7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d9d9f0>]}
[0m21:01:01.659647 [debug] [MainThread]: Flushing usage events
[0m21:01:01.662197 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:01:11.035482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106674050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d33c50>]}


============================== 21:01:11.037948 | 81525dcf-4075-4225-8ad4-cbaebb9155b1 ==============================
[0m21:01:11.037948 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:01:11.038210 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt show --select device_adoption', 'use_experimental_parser': 'False', 'empty': 'None', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'quiet': 'False', 'printer_width': '80', 'introspect': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'no_print': 'None', 'warn_error': 'None', 'debug': 'False', 'target_path': 'None', 'write_json': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'version_check': 'True', 'static_parser': 'True'}
[0m21:01:11.107415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81525dcf-4075-4225-8ad4-cbaebb9155b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c5b950>]}
[0m21:01:11.129497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81525dcf-4075-4225-8ad4-cbaebb9155b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107acacf0>]}
[0m21:01:11.139287 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:01:11.180570 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:01:11.233348 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:01:11.233537 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:01:11.235769 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m21:01:11.248388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81525dcf-4075-4225-8ad4-cbaebb9155b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12127c550>]}
[0m21:01:11.276872 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m21:01:11.278103 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m21:01:11.279379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81525dcf-4075-4225-8ad4-cbaebb9155b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120b36d50>]}
[0m21:01:11.279594 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m21:01:11.279736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81525dcf-4075-4225-8ad4-cbaebb9155b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1209da970>]}
[0m21:01:11.280402 [info ] [MainThread]: 
[0m21:01:11.280550 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:01:11.280654 [info ] [MainThread]: 
[0m21:01:11.280872 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:01:11.282625 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m21:01:11.282845 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m21:01:11.288852 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m21:01:11.308544 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m21:01:11.308742 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m21:01:11.308896 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m21:01:11.309040 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m21:01:11.309174 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m21:01:11.309305 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m21:01:11.309435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:11.309552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:11.309657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:11.322096 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m21:01:11.322308 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m21:01:11.322437 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m21:01:11.322560 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m21:01:11.322668 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m21:01:11.322794 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:01:11.322905 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m21:01:11.323012 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:01:11.323163 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m21:01:11.327331 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m21:01:11.327458 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m21:01:11.328102 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m21:01:11.328244 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m21:01:11.328710 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m21:01:11.329133 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m21:01:11.329243 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m21:01:11.329469 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m21:01:11.329772 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m21:01:11.332032 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:11.332141 [debug] [MainThread]: On master: BEGIN
[0m21:01:11.332230 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:01:11.336256 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:01:11.336353 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:11.336477 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:01:11.341891 [debug] [MainThread]: SQL status: SELECT 5 in 0.005 seconds
[0m21:01:11.342596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81525dcf-4075-4225-8ad4-cbaebb9155b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1215cb040>]}
[0m21:01:11.342741 [debug] [MainThread]: On master: ROLLBACK
[0m21:01:11.342898 [debug] [MainThread]: On master: Close
[0m21:01:11.344033 [debug] [Thread-1 (]: Began running node model.sumup.device_adoption
[0m21:01:11.344219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.device_adoption)
[0m21:01:11.344384 [debug] [Thread-1 (]: Began compiling node model.sumup.device_adoption
[0m21:01:11.347137 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.device_adoption"
[0m21:01:11.347405 [debug] [Thread-1 (]: Began executing node model.sumup.device_adoption
[0m21:01:11.350153 [debug] [Thread-1 (]: Using postgres connection "model.sumup.device_adoption"
[0m21:01:11.350286 [debug] [Thread-1 (]: On model.sumup.device_adoption: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.device_adoption"} */

  
  select device_type,
    case when device_type = 1 then 1 else 0 end as is_type_1
from "postgres"."analytics_analytics"."int_transaction"
  
  limit 5

[0m21:01:11.350401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:11.356054 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m21:01:11.356917 [debug] [Thread-1 (]: On model.sumup.device_adoption: Close
[0m21:01:11.357178 [debug] [Thread-1 (]: Finished running node model.sumup.device_adoption
[0m21:01:11.357596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:01:11.357701 [debug] [MainThread]: Connection 'model.sumup.device_adoption' was properly closed.
[0m21:01:11.357796 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m21:01:11.357888 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m21:01:11.358110 [debug] [MainThread]: Command end result
[0m21:01:11.368341 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m21:01:11.369022 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m21:01:11.371471 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m21:01:11.371634 [info ] [MainThread]: Previewing node 'device_adoption':
| device_type | is_type_1 |
| ----------- | --------- |
|           3 |         0 |
|           4 |         0 |
|           5 |         0 |
|           1 |         1 |
|           3 |         0 |

[0m21:01:11.373065 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 0.36573637, "process_in_blocks": "0", "process_kernel_time": 0.131235, "process_mem_max_rss": "125845504", "process_out_blocks": "0", "process_user_time": 0.747255}
[0m21:01:11.373233 [debug] [MainThread]: Command `dbt show` succeeded at 21:01:11.373202 after 0.37 seconds
[0m21:01:11.373367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa9e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12188c9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12188d2e0>]}
[0m21:01:11.373496 [debug] [MainThread]: Flushing usage events
[0m21:01:11.375966 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:08:09.898580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108128050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f679d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f67c50>]}


============================== 21:08:09.901407 | d5f19eb9-81a3-4c20-a372-67114c402571 ==============================
[0m21:08:09.901407 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:08:09.901670 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'no_print': 'None', 'warn_error': 'None', 'quiet': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'printer_width': '80', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'version_check': 'True', 'target_path': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt show --select device_adoption', 'empty': 'None', 'log_cache_events': 'False', 'static_parser': 'True'}
[0m21:08:10.221387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5f19eb9-81a3-4c20-a372-67114c402571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10828b950>]}
[0m21:08:10.244359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5f19eb9-81a3-4c20-a372-67114c402571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dfecf0>]}
[0m21:08:10.255636 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:08:10.305176 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:08:10.363709 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:08:10.363994 [debug] [MainThread]: Partial parsing: updated file: sumup://models/marts/core/device_adoption.sql
[0m21:08:10.451259 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m21:08:10.453280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5f19eb9-81a3-4c20-a372-67114c402571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f54250>]}
[0m21:08:10.482034 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m21:08:10.483333 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m21:08:10.484870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5f19eb9-81a3-4c20-a372-67114c402571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109da6d50>]}
[0m21:08:10.485092 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m21:08:10.485235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5f19eb9-81a3-4c20-a372-67114c402571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109695550>]}
[0m21:08:10.485899 [info ] [MainThread]: 
[0m21:08:10.486038 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:08:10.486141 [info ] [MainThread]: 
[0m21:08:10.486347 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:08:10.488015 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m21:08:10.492077 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m21:08:10.492300 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m21:08:10.543111 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m21:08:10.543342 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m21:08:10.543505 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m21:08:10.543645 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m21:08:10.543780 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m21:08:10.543901 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m21:08:10.544035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:08:10.544162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:08:10.544274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:08:10.578347 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m21:08:10.578542 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m21:08:10.578694 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m21:08:10.578836 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m21:08:10.578961 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m21:08:10.579085 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m21:08:10.579220 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m21:08:10.579359 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:08:10.579501 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:08:10.596684 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.017 seconds
[0m21:08:10.596819 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.017 seconds
[0m21:08:10.597403 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m21:08:10.597527 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.018 seconds
[0m21:08:10.597975 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m21:08:10.598483 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m21:08:10.598620 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m21:08:10.598730 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m21:08:10.598974 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m21:08:10.601718 [debug] [MainThread]: Using postgres connection "master"
[0m21:08:10.601847 [debug] [MainThread]: On master: BEGIN
[0m21:08:10.601945 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:08:10.607126 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m21:08:10.607236 [debug] [MainThread]: Using postgres connection "master"
[0m21:08:10.607380 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:08:10.613395 [debug] [MainThread]: SQL status: SELECT 5 in 0.006 seconds
[0m21:08:10.614169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5f19eb9-81a3-4c20-a372-67114c402571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a28fc70>]}
[0m21:08:10.614329 [debug] [MainThread]: On master: ROLLBACK
[0m21:08:10.614534 [debug] [MainThread]: On master: Close
[0m21:08:10.615761 [debug] [Thread-1 (]: Began running node model.sumup.device_adoption
[0m21:08:10.615915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.device_adoption)
[0m21:08:10.616048 [debug] [Thread-1 (]: Began compiling node model.sumup.device_adoption
[0m21:08:10.619706 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.device_adoption"
[0m21:08:10.620363 [debug] [Thread-1 (]: Began executing node model.sumup.device_adoption
[0m21:08:10.623025 [debug] [Thread-1 (]: Using postgres connection "model.sumup.device_adoption"
[0m21:08:10.623184 [debug] [Thread-1 (]: On model.sumup.device_adoption: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.device_adoption"} */

  
  select
    device_type,
    count(transaction_id) as transaction_count,
    -- Calculate the percentage: (Count for this device / Total overall count) * 100
    (cast(count(transaction_id) as numeric) * 100.0) / sum(count(transaction_id)) over () as percentage_of_total
from "postgres"."analytics_analytics"."int_transaction"
group by 1 -- Group by device_type
order by 3 desc -- Order by percentage
  
  limit 5

[0m21:08:10.623320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:08:10.633705 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.010 seconds
[0m21:08:10.634769 [debug] [Thread-1 (]: On model.sumup.device_adoption: Close
[0m21:08:10.635087 [debug] [Thread-1 (]: Finished running node model.sumup.device_adoption
[0m21:08:10.635595 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:08:10.635728 [debug] [MainThread]: Connection 'model.sumup.device_adoption' was properly closed.
[0m21:08:10.635829 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m21:08:10.635920 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m21:08:10.636177 [debug] [MainThread]: Command end result
[0m21:08:10.647343 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m21:08:10.648037 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m21:08:10.650676 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m21:08:10.651066 [info ] [MainThread]: Previewing node 'device_adoption':
| device_type | transaction_count | percentage_of_total |
| ----------- | ----------------- | ------------------- |
|           4 |               350 |             23.333… |
|           1 |               326 |             21.733… |
|           3 |               306 |             20.400… |
|           5 |               262 |             17.467… |
|           2 |               256 |             17.067… |

[0m21:08:10.662551 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 0.7947043, "process_in_blocks": "0", "process_kernel_time": 0.160199, "process_mem_max_rss": "129597440", "process_out_blocks": "0", "process_user_time": 0.891889}
[0m21:08:10.662769 [debug] [MainThread]: Command `dbt show` succeeded at 21:08:10.662732 after 0.79 seconds
[0m21:08:10.662918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dddf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a289d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a289bd0>]}
[0m21:08:10.663066 [debug] [MainThread]: Flushing usage events
[0m21:08:11.994965 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:29:01.293575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c33c50>]}


============================== 22:29:01.296377 | dd7a5111-f257-4a29-8600-be6a4bf540cf ==============================
[0m22:29:01.296377 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:29:01.296644 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt show --select store_adoption_ranking', 'debug': 'False', 'log_format': 'default', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'printer_width': '80', 'warn_error': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'empty': 'None', 'introspect': 'True', 'quiet': 'False', 'target_path': 'None', 'use_colors': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m22:29:01.386043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd7a5111-f257-4a29-8600-be6a4bf540cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d57950>]}
[0m22:29:01.408639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd7a5111-f257-4a29-8600-be6a4bf540cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109acacf0>]}
[0m22:29:01.419434 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:29:01.462872 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:29:01.527943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:29:01.528312 [debug] [MainThread]: Partial parsing: updated file: sumup://models/marts/core/store_adoption_ranking.sql
[0m22:29:01.623896 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m22:29:01.626015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd7a5111-f257-4a29-8600-be6a4bf540cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5f0250>]}
[0m22:29:01.656383 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m22:29:01.658257 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m22:29:01.659381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd7a5111-f257-4a29-8600-be6a4bf540cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b442d50>]}
[0m22:29:01.659578 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m22:29:01.659713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd7a5111-f257-4a29-8600-be6a4bf540cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9d9550>]}
[0m22:29:01.660334 [info ] [MainThread]: 
[0m22:29:01.660470 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:29:01.660573 [info ] [MainThread]: 
[0m22:29:01.660774 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:29:01.662526 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m22:29:01.667380 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m22:29:01.667647 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m22:29:01.724014 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m22:29:01.724223 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m22:29:01.724389 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m22:29:01.724533 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m22:29:01.724664 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m22:29:01.724787 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m22:29:01.724909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:01.725028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:01.725131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:01.762119 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m22:29:01.762334 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m22:29:01.762463 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m22:29:01.762579 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m22:29:01.762706 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m22:29:01.762853 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m22:29:01.763006 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m22:29:01.763157 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m22:29:01.763358 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m22:29:01.824769 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.061 seconds
[0m22:29:01.824982 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.061 seconds
[0m22:29:01.825092 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.062 seconds
[0m22:29:01.825711 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m22:29:01.826190 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m22:29:01.826632 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m22:29:01.827235 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m22:29:01.827368 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m22:29:01.827524 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m22:29:01.830721 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:01.830913 [debug] [MainThread]: On master: BEGIN
[0m22:29:01.831046 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:29:01.836209 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m22:29:01.836345 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:01.836506 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:29:01.844187 [debug] [MainThread]: SQL status: SELECT 5 in 0.008 seconds
[0m22:29:01.845169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd7a5111-f257-4a29-8600-be6a4bf540cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b92bc70>]}
[0m22:29:01.845353 [debug] [MainThread]: On master: ROLLBACK
[0m22:29:01.845566 [debug] [MainThread]: On master: Close
[0m22:29:01.846868 [debug] [Thread-1 (]: Began running node model.sumup.store_adoption_ranking
[0m22:29:01.847016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.store_adoption_ranking)
[0m22:29:01.847157 [debug] [Thread-1 (]: Began compiling node model.sumup.store_adoption_ranking
[0m22:29:01.851048 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.store_adoption_ranking"
[0m22:29:01.851521 [debug] [Thread-1 (]: Began executing node model.sumup.store_adoption_ranking
[0m22:29:01.854495 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_adoption_ranking"
[0m22:29:01.854698 [debug] [Thread-1 (]: On model.sumup.store_adoption_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.store_adoption_ranking"} */

  
  --Question 5

with ranking_transactions as (

    select
        store_id,
        happened_at_utc,
        -- Assign a sequential rank to each transaction within a store based on its time
        ROW_NUMBER() over(partition by store_id order by happened_at_utc) as transaction_rank
    from
        "postgres"."analytics_analytics"."int_transaction"
),
first_five_transactions as (
    -- 2. Filter for the first 5 transactions and find the time of the 1st and 5th
    select
        store_id,
        happened_at_utc,
        transaction_rank,
        -- Get the timestamp of the very first transaction (rank 1) for the store
        max(case when transaction_rank = 1 then happened_at_utc end) over(partition by store_id) as first_transaction_time,
        -- Get the timestamp of the fifth transaction (rank 5) for the store
        max(case when transaction_rank = 5 then happened_at_utc end) over(partition by store_id) as fifth_transaction_time
    from
        ranking_transactions
    where
        transaction_rank <= 5
)

select
    store_id,
    -- Calculate the duration between the 5th and 1st transaction in seconds (or your desired unit)
    extract(epoch from (fifth_transaction_time - first_transaction_time)) as time_for_5_transactions_seconds
    -- Convert to minutes/hours/etc. if desired: (fifth_transaction_time - first_transaction_time) / INTERVAL '1 minute'
from
    first_five_transactions
where
    transaction_rank = 5 
group by
    store_id,
    time_for_5_transactions_seconds
order by
    store_id
  
  limit 5

[0m22:29:01.854885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:01.867881 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.013 seconds
[0m22:29:01.869027 [debug] [Thread-1 (]: On model.sumup.store_adoption_ranking: Close
[0m22:29:01.869369 [debug] [Thread-1 (]: Finished running node model.sumup.store_adoption_ranking
[0m22:29:01.869880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:29:01.870005 [debug] [MainThread]: Connection 'model.sumup.store_adoption_ranking' was properly closed.
[0m22:29:01.870114 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m22:29:01.870218 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m22:29:01.870486 [debug] [MainThread]: Command end result
[0m22:29:01.883292 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m22:29:01.884045 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m22:29:01.886943 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m22:29:01.887303 [info ] [MainThread]: Previewing node 'store_adoption_ranking':
| store_id | time_for_5_transa... |
| -------- | -------------------- |
|        1 |           17,589,960 |
|        3 |            2,490,442 |
|        4 |           38,102,618 |
|        5 |           17,864,412 |
|        7 |           10,727,095 |

[0m22:29:01.888974 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 0.62692875, "process_in_blocks": "0", "process_kernel_time": 0.184383, "process_mem_max_rss": "129531904", "process_out_blocks": "0", "process_user_time": 0.901853}
[0m22:29:01.889157 [debug] [MainThread]: Command `dbt show` succeeded at 22:29:01.889121 after 0.63 seconds
[0m22:29:01.889302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aa9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b90dc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b90db20>]}
[0m22:29:01.889447 [debug] [MainThread]: Flushing usage events
[0m22:29:01.892624 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:32:16.777742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dc8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c0b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c0bc50>]}


============================== 22:32:16.780501 | 63d8bd26-c73f-4376-aac0-636f83a4373c ==============================
[0m22:32:16.780501 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:32:16.780774 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'write_json': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'invocation_command': 'dbt show --select store_adoption_ranking', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'debug': 'False', 'warn_error': 'None', 'target_path': 'None', 'quiet': 'False', 'log_format': 'default', 'empty': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'fail_fast': 'False', 'use_colors': 'True', 'partial_parse': 'True'}
[0m22:32:16.865089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63d8bd26-c73f-4376-aac0-636f83a4373c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f2b950>]}
[0m22:32:16.887000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63d8bd26-c73f-4376-aac0-636f83a4373c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a9ecf0>]}
[0m22:32:16.897548 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:32:16.941111 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:32:17.000869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:32:17.001169 [debug] [MainThread]: Partial parsing: updated file: sumup://models/marts/core/store_adoption_ranking.sql
[0m22:32:17.090791 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m22:32:17.092759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63d8bd26-c73f-4376-aac0-636f83a4373c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bf4250>]}
[0m22:32:17.119451 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m22:32:17.120592 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m22:32:17.121823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63d8bd26-c73f-4376-aac0-636f83a4373c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a46d50>]}
[0m22:32:17.121998 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m22:32:17.122126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63d8bd26-c73f-4376-aac0-636f83a4373c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105335550>]}
[0m22:32:17.122780 [info ] [MainThread]: 
[0m22:32:17.122934 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:32:17.123046 [info ] [MainThread]: 
[0m22:32:17.123242 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:32:17.125120 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m22:32:17.129211 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m22:32:17.129426 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m22:32:17.179840 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m22:32:17.180035 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m22:32:17.180181 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m22:32:17.180329 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m22:32:17.180457 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m22:32:17.180623 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m22:32:17.180752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:32:17.180893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:32:17.181047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:32:17.205769 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m22:32:17.205975 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m22:32:17.206130 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m22:32:17.206242 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m22:32:17.206372 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m22:32:17.206505 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m22:32:17.206643 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m22:32:17.206780 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m22:32:17.206984 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m22:32:17.211780 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m22:32:17.211907 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m22:32:17.212011 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m22:32:17.212585 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m22:32:17.213028 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m22:32:17.213439 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m22:32:17.213701 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m22:32:17.213814 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m22:32:17.213927 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m22:32:17.216648 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:17.216766 [debug] [MainThread]: On master: BEGIN
[0m22:32:17.216856 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:32:17.222094 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m22:32:17.222201 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:17.222335 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:32:17.226539 [debug] [MainThread]: SQL status: SELECT 5 in 0.004 seconds
[0m22:32:17.227380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63d8bd26-c73f-4376-aac0-636f83a4373c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f2bc70>]}
[0m22:32:17.227544 [debug] [MainThread]: On master: ROLLBACK
[0m22:32:17.227740 [debug] [MainThread]: On master: Close
[0m22:32:17.229065 [debug] [Thread-1 (]: Began running node model.sumup.store_adoption_ranking
[0m22:32:17.229224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.store_adoption_ranking)
[0m22:32:17.229356 [debug] [Thread-1 (]: Began compiling node model.sumup.store_adoption_ranking
[0m22:32:17.232611 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.store_adoption_ranking"
[0m22:32:17.232897 [debug] [Thread-1 (]: Began executing node model.sumup.store_adoption_ranking
[0m22:32:17.235378 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_adoption_ranking"
[0m22:32:17.235539 [debug] [Thread-1 (]: On model.sumup.store_adoption_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.store_adoption_ranking"} */

  
  --Question 5

with ranking_transactions as (

    select
        store_id,
        happened_at_utc,
        -- Assign a sequential rank to each transaction within a store based on its time
        ROW_NUMBER() over(partition by store_id order by happened_at_utc) as transaction_rank
    from
        "postgres"."analytics_analytics"."int_transaction"
),
first_five_transactions as (
    -- 2. Filter for the first 5 transactions and find the time of the 1st and 5th
    select
        store_id,
        happened_at_utc,
        transaction_rank,
        -- Get the timestamp of the very first transaction (rank 1) for the store
        max(case when transaction_rank = 1 then happened_at_utc end) over(partition by store_id) as first_transaction_time,
        -- Get the timestamp of the fifth transaction (rank 5) for the store
        max(case when transaction_rank = 5 then happened_at_utc end) over(partition by store_id) as fifth_transaction_time
    from
        ranking_transactions
    where
        transaction_rank <= 5
)

select
    store_id,
    -- Calculate the duration between the 5th and 1st transaction in seconds 
    extract(epoch from (fifth_transaction_time - first_transaction_time))/ interval '1 day' as time_for_5_transactions_days
    
from
    first_five_transactions
where
    transaction_rank = 5 
group by
    store_id,
    time_for_5_transactions_days
order by
    store_id
  
  limit 5

[0m22:32:17.235685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:17.241941 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: numeric / interval
LINE 35: ...(fifth_transaction_time - first_transaction_time))/ interval...
                                                              ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m22:32:17.242139 [debug] [Thread-1 (]: On model.sumup.store_adoption_ranking: Close
[0m22:32:17.245471 [debug] [Thread-1 (]: Database Error in model store_adoption_ranking (models/marts/core/store_adoption_ranking.sql)
  operator does not exist: numeric / interval
  LINE 35: ...(fifth_transaction_time - first_transaction_time))/ interval...
                                                                ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
[0m22:32:17.245729 [debug] [Thread-1 (]: Finished running node model.sumup.store_adoption_ranking
[0m22:32:17.245926 [debug] [Thread-7 (]: Marking all children of 'model.sumup.store_adoption_ranking' to be skipped because of status 'error'.  Reason: Database Error in model store_adoption_ranking (models/marts/core/store_adoption_ranking.sql)
  operator does not exist: numeric / interval
  LINE 35: ...(fifth_transaction_time - first_transaction_time))/ interval...
                                                                ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts..
[0m22:32:17.246306 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:32:17.246449 [debug] [MainThread]: Connection 'model.sumup.store_adoption_ranking' was properly closed.
[0m22:32:17.246582 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m22:32:17.246688 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m22:32:17.246855 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model store_adoption_ranking (models/marts/core/store_adoption_ranking.sql)
    operator does not exist: numeric / interval
    LINE 35: ...(fifth_transaction_time - first_transaction_time))/ interval...
                                                                  ^
    HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
[0m22:32:17.248801 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.5013028, "process_in_blocks": "0", "process_kernel_time": 0.143704, "process_mem_max_rss": "129024000", "process_out_blocks": "0", "process_user_time": 0.836445}
[0m22:32:17.248970 [debug] [MainThread]: Command `dbt show` failed at 22:32:17.248936 after 0.50 seconds
[0m22:32:17.249098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a7df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f062b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f06360>]}
[0m22:32:17.249228 [debug] [MainThread]: Flushing usage events
[0m22:32:17.251828 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:32:29.862027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104314050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105933c50>]}


============================== 22:32:29.864626 | 040a4560-f6eb-4458-8135-7d00ca852db4 ==============================
[0m22:32:29.864626 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:32:29.864896 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_colors': 'True', 'no_print': 'None', 'version_check': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'quiet': 'False', 'printer_width': '80', 'warn_error': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'partial_parse': 'True', 'write_json': 'True', 'invocation_command': 'dbt show --select store_adoption_ranking', 'indirect_selection': 'eager', 'empty': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_format': 'default', 'debug': 'False'}
[0m22:32:29.949852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '040a4560-f6eb-4458-8135-7d00ca852db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10475b950>]}
[0m22:32:29.971592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '040a4560-f6eb-4458-8135-7d00ca852db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056cacf0>]}
[0m22:32:29.981538 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:32:30.020694 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:32:30.074509 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:32:30.074838 [debug] [MainThread]: Partial parsing: updated file: sumup://models/marts/core/store_adoption_ranking.sql
[0m22:32:30.164189 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m22:32:30.166185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '040a4560-f6eb-4458-8135-7d00ca852db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106674250>]}
[0m22:32:30.192723 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m22:32:30.194017 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m22:32:30.195014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '040a4560-f6eb-4458-8135-7d00ca852db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f2ed50>]}
[0m22:32:30.195188 [info ] [MainThread]: Found 3 seeds, 9 models, 447 macros
[0m22:32:30.195318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '040a4560-f6eb-4458-8135-7d00ca852db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dd1550>]}
[0m22:32:30.195936 [info ] [MainThread]: 
[0m22:32:30.196069 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:32:30.196173 [info ] [MainThread]: 
[0m22:32:30.196367 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:32:30.197971 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m22:32:30.201974 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m22:32:30.202206 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m22:32:30.258708 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m22:32:30.258929 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m22:32:30.259064 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m22:32:30.259184 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m22:32:30.259302 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m22:32:30.259416 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m22:32:30.259531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:32:30.259642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:32:30.259748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:32:30.276275 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m22:32:30.276503 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m22:32:30.276632 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m22:32:30.276749 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m22:32:30.276869 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m22:32:30.277002 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m22:32:30.277129 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m22:32:30.277255 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m22:32:30.277423 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m22:32:30.281472 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m22:32:30.281596 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m22:32:30.282196 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m22:32:30.282314 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m22:32:30.282786 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m22:32:30.283253 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m22:32:30.283377 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m22:32:30.283635 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m22:32:30.283970 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m22:32:30.286512 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:30.286632 [debug] [MainThread]: On master: BEGIN
[0m22:32:30.286733 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:32:30.290348 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m22:32:30.290465 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:30.290602 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:32:30.296290 [debug] [MainThread]: SQL status: SELECT 5 in 0.006 seconds
[0m22:32:30.297187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '040a4560-f6eb-4458-8135-7d00ca852db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107524d50>]}
[0m22:32:30.297361 [debug] [MainThread]: On master: ROLLBACK
[0m22:32:30.297608 [debug] [MainThread]: On master: Close
[0m22:32:30.298781 [debug] [Thread-1 (]: Began running node model.sumup.store_adoption_ranking
[0m22:32:30.298972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.store_adoption_ranking)
[0m22:32:30.299117 [debug] [Thread-1 (]: Began compiling node model.sumup.store_adoption_ranking
[0m22:32:30.302534 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.store_adoption_ranking"
[0m22:32:30.302866 [debug] [Thread-1 (]: Began executing node model.sumup.store_adoption_ranking
[0m22:32:30.305563 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_adoption_ranking"
[0m22:32:30.305743 [debug] [Thread-1 (]: On model.sumup.store_adoption_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.store_adoption_ranking"} */

  
  --Question 5

with ranking_transactions as (

    select
        store_id,
        happened_at_utc,
        -- Assign a sequential rank to each transaction within a store based on its time
        ROW_NUMBER() over(partition by store_id order by happened_at_utc) as transaction_rank
    from
        "postgres"."analytics_analytics"."int_transaction"
),
first_five_transactions as (
    -- 2. Filter for the first 5 transactions and find the time of the 1st and 5th
    select
        store_id,
        happened_at_utc,
        transaction_rank,
        -- Get the timestamp of the very first transaction (rank 1) for the store
        max(case when transaction_rank = 1 then happened_at_utc end) over(partition by store_id) as first_transaction_time,
        -- Get the timestamp of the fifth transaction (rank 5) for the store
        max(case when transaction_rank = 5 then happened_at_utc end) over(partition by store_id) as fifth_transaction_time
    from
        ranking_transactions
    where
        transaction_rank <= 5
)

select
    store_id,
    -- Calculate the duration between the 5th and 1st transaction in seconds 
    extract(epoch from (fifth_transaction_time - first_transaction_time))/86400 as time_for_5_transactions_days
from
    first_five_transactions
where
    transaction_rank = 5 
group by
    store_id,
    time_for_5_transactions_days
order by
    store_id
  
  limit 5

[0m22:32:30.305902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:30.312453 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.007 seconds
[0m22:32:30.313476 [debug] [Thread-1 (]: On model.sumup.store_adoption_ranking: Close
[0m22:32:30.313790 [debug] [Thread-1 (]: Finished running node model.sumup.store_adoption_ranking
[0m22:32:30.314466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:32:30.314579 [debug] [MainThread]: Connection 'model.sumup.store_adoption_ranking' was properly closed.
[0m22:32:30.314678 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m22:32:30.314770 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m22:32:30.315014 [debug] [MainThread]: Command end result
[0m22:32:30.325675 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m22:32:30.326413 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m22:32:30.329236 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m22:32:30.329614 [info ] [MainThread]: Previewing node 'store_adoption_ranking':
| store_id | time_for_5_transa... |
| -------- | -------------------- |
|        1 |             203.588… |
|        3 |              28.825… |
|        4 |             441.003… |
|        5 |             206.764… |
|        7 |             124.156… |

[0m22:32:30.332491 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 0.4988037, "process_in_blocks": "0", "process_kernel_time": 0.139563, "process_mem_max_rss": "129564672", "process_out_blocks": "0", "process_user_time": 0.848215}
[0m22:32:30.332734 [debug] [MainThread]: Command `dbt show` succeeded at 22:32:30.332696 after 0.50 seconds
[0m22:32:30.332904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056a9e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107501d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107501bd0>]}
[0m22:32:30.333057 [debug] [MainThread]: Flushing usage events
[0m22:32:30.337115 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:02:17.052327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e44050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c879d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c87c50>]}


============================== 23:02:17.056047 | 417a3650-a90c-491b-8263-0d6f0c19d955 ==============================
[0m23:02:17.056047 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:02:17.056301 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'version_check': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt show --select customer_store_ranking', 'no_print': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'static_parser': 'True', 'log_format': 'default', 'warn_error': 'None', 'printer_width': '80', 'target_path': 'None', 'empty': 'None', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup'}
[0m23:02:17.142473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '417a3650-a90c-491b-8263-0d6f0c19d955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa7950>]}
[0m23:02:17.164064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '417a3650-a90c-491b-8263-0d6f0c19d955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b1acf0>]}
[0m23:02:17.173016 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:02:17.214892 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:02:17.250549 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:02:17.250788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '417a3650-a90c-491b-8263-0d6f0c19d955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109abb850>]}
[0m23:02:17.710775 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_expectations.expression_is_true`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m23:02:17.711034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '417a3650-a90c-491b-8263-0d6f0c19d955', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d6b200>]}
[0m23:02:17.729045 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/staging/stg_transaction.yml:
  	test definition dictionary must have exactly one key, got [('name', 'fraud_check_high_frequency_declines'), ('tags', ['fraud']), ('warn_if', "SELECT \n  COUNT(t1.transaction_id) \nFROM {{ this }} t1 JOIN {{ this }} t2\n  ON t1.card_number_hashed = t2.card_number_hashed -- Same card\n  AND t1.transaction_id != t2.transaction_id      -- Different transactions\nWHERE t1.status = 'refused'\n  AND t2.status = 'refused'\n  -- Time check: Two declined transactions by the same card within 60 minutes\n  AND t2.happened_at_utc BETWEEN t1.happened_at_utc AND (t1.happened_at_utc + INTERVAL '60 minutes')\n  -- Only flag if it happens frequently e.g., more than 2 refused attempts in the window\nHAVING COUNT(t1.transaction_id) > 2")] instead (3 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m23:02:17.729394 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:02:17.731403 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.7114017, "process_in_blocks": "0", "process_kernel_time": 0.119987, "process_mem_max_rss": "125747200", "process_out_blocks": "0", "process_user_time": 1.092737}
[0m23:02:17.731593 [debug] [MainThread]: Command `dbt show` failed at 23:02:17.731557 after 0.71 seconds
[0m23:02:17.731747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a149b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a14a970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e6e820>]}
[0m23:02:17.731882 [debug] [MainThread]: Flushing usage events
[0m23:02:17.736617 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:03:14.959773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b14050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106933c50>]}


============================== 23:03:14.962288 | 891be3df-4b3f-4733-9831-a7f9e8f28de4 ==============================
[0m23:03:14.962288 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:03:14.962544 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'write_json': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'introspect': 'True', 'fail_fast': 'False', 'version_check': 'True', 'partial_parse': 'True', 'debug': 'False', 'target_path': 'None', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'invocation_command': 'dbt show --select customer_store_ranking', 'quiet': 'False', 'static_parser': 'True'}
[0m23:03:15.039710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '891be3df-4b3f-4733-9831-a7f9e8f28de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f57950>]}
[0m23:03:15.061527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '891be3df-4b3f-4733-9831-a7f9e8f28de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ecacf0>]}
[0m23:03:15.070937 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:03:15.111612 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:03:15.146333 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:03:15.146554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '891be3df-4b3f-4733-9831-a7f9e8f28de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b7850>]}
[0m23:03:15.610285 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_expectations.expression_is_true`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m23:03:15.610539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '891be3df-4b3f-4733-9831-a7f9e8f28de4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107867200>]}
[0m23:03:15.628379 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/staging/stg_transaction.yml:
  	test definition dictionary must have exactly one key, got [('name', 'fraud_check_high_frequency_declines'), ('tags', ['fraud']), ('warn_if', "SELECT \n  COUNT(t1.transaction_id) \nFROM {{ this }} t1 JOIN {{ this }} t2\n  ON t1.card_number_hashed = t2.card_number_hashed -- Same card\n  AND t1.transaction_id != t2.transaction_id      -- Different transactions\nWHERE t1.status = 'refused'\n  AND t2.status = 'refused'\n  -- Time check: Two declined transactions by the same card within 60 minutes\n  AND t2.happened_at_utc BETWEEN t1.happened_at_utc AND (t1.happened_at_utc + INTERVAL '60 minutes')\n  -- Only flag if it happens frequently e.g., more than 2 refused attempts in the window\nHAVING COUNT(t1.transaction_id) > 2")] instead (3 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m23:03:15.628709 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:03:15.630255 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.6981131, "process_in_blocks": "0", "process_kernel_time": 0.117368, "process_mem_max_rss": "125435904", "process_out_blocks": "0", "process_user_time": 1.091882}
[0m23:03:15.630448 [debug] [MainThread]: Command `dbt show` failed at 23:03:15.630412 after 0.70 seconds
[0m23:03:15.630592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec9b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eca970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10796e270>]}
[0m23:03:15.630720 [debug] [MainThread]: Flushing usage events
[0m23:03:15.635366 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:03:30.752778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106f4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111933c50>]}


============================== 23:03:30.755269 | 442f550d-3276-4881-9b15-aec718d87460 ==============================
[0m23:03:30.755269 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:03:30.755549 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'introspect': 'True', 'warn_error': 'None', 'empty': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'static_parser': 'True', 'quiet': 'False', 'version_check': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'invocation_command': 'dbt show --select customer_store_ranking', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'debug': 'False', 'write_json': 'True', 'target_path': 'None'}
[0m23:03:30.832456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '442f550d-3276-4881-9b15-aec718d87460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110957950>]}
[0m23:03:30.854159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '442f550d-3276-4881-9b15-aec718d87460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117cacf0>]}
[0m23:03:30.863819 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:03:30.902780 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:03:30.936982 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:03:30.937204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '442f550d-3276-4881-9b15-aec718d87460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112833850>]}
[0m23:03:31.388734 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_expectations.expression_is_true`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m23:03:31.388989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '442f550d-3276-4881-9b15-aec718d87460', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112be3200>]}
[0m23:03:31.434247 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m23:03:31.436211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '442f550d-3276-4881-9b15-aec718d87460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149c8bb0>]}
[0m23:03:31.471658 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m23:03:31.472782 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m23:03:31.474370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '442f550d-3276-4881-9b15-aec718d87460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b8b450>]}
[0m23:03:31.474541 [info ] [MainThread]: Found 9 models, 3 seeds, 11 data tests, 447 macros
[0m23:03:31.474669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '442f550d-3276-4881-9b15-aec718d87460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114871e50>]}
[0m23:03:31.475312 [info ] [MainThread]: 
[0m23:03:31.475445 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:03:31.475546 [info ] [MainThread]: 
[0m23:03:31.475739 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:03:31.477380 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m23:03:31.481561 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m23:03:31.482520 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m23:03:31.503611 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m23:03:31.503787 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m23:03:31.503955 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m23:03:31.504087 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m23:03:31.504211 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m23:03:31.504334 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m23:03:31.504450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:31.504563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:31.504673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:31.526952 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m23:03:31.527147 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m23:03:31.527279 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m23:03:31.527399 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m23:03:31.527534 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m23:03:31.527647 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m23:03:31.527775 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m23:03:31.527906 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:03:31.528024 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m23:03:31.535716 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m23:03:31.535825 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m23:03:31.536390 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m23:03:31.536495 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m23:03:31.536900 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m23:03:31.537367 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m23:03:31.537489 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m23:03:31.537614 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m23:03:31.537892 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m23:03:31.540448 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:31.540579 [debug] [MainThread]: On master: BEGIN
[0m23:03:31.540678 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:03:31.546290 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m23:03:31.546400 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:31.546532 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:03:31.551558 [debug] [MainThread]: SQL status: SELECT 5 in 0.005 seconds
[0m23:03:31.552287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '442f550d-3276-4881-9b15-aec718d87460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b3d700>]}
[0m23:03:31.552438 [debug] [MainThread]: On master: ROLLBACK
[0m23:03:31.552643 [debug] [MainThread]: On master: Close
[0m23:03:31.553847 [debug] [Thread-1 (]: Began running node model.sumup.customer_store_ranking
[0m23:03:31.553996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.customer_store_ranking)
[0m23:03:31.554123 [debug] [Thread-1 (]: Began compiling node model.sumup.customer_store_ranking
[0m23:03:31.556890 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m23:03:31.557524 [debug] [Thread-1 (]: Began executing node model.sumup.customer_store_ranking
[0m23:03:31.560392 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m23:03:31.560536 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  
  --Question 1) 

SELECT
    store_name,
    SUM(amount_eur) AS total_amount
FROM
    "postgres"."analytics_analytics"."int_transaction" 
WHERE status = 'accepted'
GROUP BY
    store_name
ORDER BY
    total_amount DESC
--limit 10
  
  limit 5

[0m23:03:31.560664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:03:31.569061 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.008 seconds
[0m23:03:31.569960 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: Close
[0m23:03:31.570226 [debug] [Thread-1 (]: Finished running node model.sumup.customer_store_ranking
[0m23:03:31.570667 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:03:31.570774 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m23:03:31.570864 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m23:03:31.570950 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m23:03:31.571182 [debug] [MainThread]: Command end result
[0m23:03:31.581493 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m23:03:31.582120 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m23:03:31.584500 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m23:03:31.584796 [info ] [MainThread]: Previewing node 'customer_store_ranking':
| store_name           | total_amount |
| -------------------- | ------------ |
| Nec Ante Ltd         |        93.83 |
| Sem Ut Cursus Corp.  |        89.09 |
| Magnis Dis Inc.      |        73.34 |
| Blandit At Nisi Inc. |        73.26 |
| Volutpat Nunc Sit... |        68.53 |

[0m23:03:31.585030 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:03:31.586649 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 0.860555, "process_in_blocks": "0", "process_kernel_time": 0.136986, "process_mem_max_rss": "134643712", "process_out_blocks": "0", "process_user_time": 1.200844}
[0m23:03:31.586804 [debug] [MainThread]: Command `dbt show` succeeded at 23:03:31.586774 after 0.86 seconds
[0m23:03:31.586931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148ddb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b3bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b76e50>]}
[0m23:03:31.587052 [debug] [MainThread]: Flushing usage events
[0m23:03:31.589474 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:04:12.006018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108328050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091679d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109167c50>]}


============================== 23:04:12.008998 | 24cd268d-b36d-4f5b-a90c-f8fcee67d70a ==============================
[0m23:04:12.008998 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:04:12.009274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'log_format': 'default', 'write_json': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'invocation_command': 'dbt show --select customer_store_ranking', 'empty': 'None', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'use_colors': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'version_check': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'introspect': 'True'}
[0m23:04:12.093254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24cd268d-b36d-4f5b-a90c-f8fcee67d70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10848f950>]}
[0m23:04:12.114956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24cd268d-b36d-4f5b-a90c-f8fcee67d70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ffecf0>]}
[0m23:04:12.125328 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:04:12.168238 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:04:12.236780 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:04:12.237068 [debug] [MainThread]: Partial parsing: updated file: sumup://models/marts/store/customer_store_ranking.sql
[0m23:04:12.329675 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m23:04:12.331676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24cd268d-b36d-4f5b-a90c-f8fcee67d70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab7ea50>]}
[0m23:04:12.366352 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m23:04:12.367513 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m23:04:12.369086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24cd268d-b36d-4f5b-a90c-f8fcee67d70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9ced50>]}
[0m23:04:12.369262 [info ] [MainThread]: Found 9 models, 3 seeds, 11 data tests, 447 macros
[0m23:04:12.369388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24cd268d-b36d-4f5b-a90c-f8fcee67d70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca082f0>]}
[0m23:04:12.370041 [info ] [MainThread]: 
[0m23:04:12.370175 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:04:12.370278 [info ] [MainThread]: 
[0m23:04:12.370473 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:04:12.372166 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m23:04:12.376196 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m23:04:12.403273 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m23:04:12.424393 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m23:04:12.424587 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m23:04:12.424743 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m23:04:12.424878 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m23:04:12.425004 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m23:04:12.425127 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m23:04:12.425245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:12.425363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:12.425474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:12.446738 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m23:04:12.446926 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m23:04:12.447050 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m23:04:12.447162 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m23:04:12.447295 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m23:04:12.447426 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m23:04:12.447554 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m23:04:12.447693 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:04:12.447835 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m23:04:12.454736 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m23:04:12.454850 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m23:04:12.455423 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m23:04:12.455537 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m23:04:12.455954 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m23:04:12.456407 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m23:04:12.456523 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m23:04:12.456747 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m23:04:12.457093 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m23:04:12.459373 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:12.459490 [debug] [MainThread]: On master: BEGIN
[0m23:04:12.459580 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:04:12.464846 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:04:12.464953 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:12.465089 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:04:12.471435 [debug] [MainThread]: SQL status: SELECT 5 in 0.006 seconds
[0m23:04:12.472199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24cd268d-b36d-4f5b-a90c-f8fcee67d70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10caba410>]}
[0m23:04:12.472350 [debug] [MainThread]: On master: ROLLBACK
[0m23:04:12.472509 [debug] [MainThread]: On master: Close
[0m23:04:12.473704 [debug] [Thread-1 (]: Began running node model.sumup.customer_store_ranking
[0m23:04:12.473850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.customer_store_ranking)
[0m23:04:12.473977 [debug] [Thread-1 (]: Began compiling node model.sumup.customer_store_ranking
[0m23:04:12.477051 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m23:04:12.477330 [debug] [Thread-1 (]: Began executing node model.sumup.customer_store_ranking
[0m23:04:12.479819 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m23:04:12.479971 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  
  --Question 1) 

SELECT
    store_id,
    store_name,
    SUM(amount_eur) AS total_amount
FROM
    "postgres"."analytics_analytics"."int_transaction" 
WHERE status = 'accepted'
GROUP BY
    store_id,
    store_name
ORDER BY
    total_amount DESC
--limit 10
  
  limit 5

[0m23:04:12.480105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:12.488675 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.009 seconds
[0m23:04:12.489605 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: Close
[0m23:04:12.489895 [debug] [Thread-1 (]: Finished running node model.sumup.customer_store_ranking
[0m23:04:12.490311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:04:12.490419 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m23:04:12.490514 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m23:04:12.490603 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m23:04:12.490829 [debug] [MainThread]: Command end result
[0m23:04:12.500791 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m23:04:12.501446 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m23:04:12.503853 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m23:04:12.504157 [info ] [MainThread]: Previewing node 'customer_store_ranking':
| store_id | store_name           | total_amount |
| -------- | -------------------- | ------------ |
|        3 | Nec Ante Ltd         |        93.83 |
|       97 | Sem Ut Cursus Corp.  |        89.09 |
|       19 | Magnis Dis Inc.      |        73.34 |
|       82 | Blandit At Nisi Inc. |        73.26 |
|       42 | Volutpat Nunc Sit... |        68.53 |

[0m23:04:12.506320 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 0.5306026, "process_in_blocks": "0", "process_kernel_time": 0.13975, "process_mem_max_rss": "129138688", "process_out_blocks": "0", "process_user_time": 0.859742}
[0m23:04:12.506545 [debug] [MainThread]: Command `dbt show` succeeded at 23:04:12.506500 after 0.53 seconds
[0m23:04:12.506704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fddf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb5f6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb5f750>]}
[0m23:04:12.506842 [debug] [MainThread]: Flushing usage events
[0m23:04:12.509472 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:07:11.433089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108068050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eaf9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eafc50>]}


============================== 23:07:11.435941 | c1c187e9-96e8-4163-a443-7ae35f6a98fb ==============================
[0m23:07:11.435941 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:07:11.436290 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'warn_error': 'None', 'target_path': 'None', 'static_parser': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'write_json': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'cache_selected_only': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'partial_parse': 'True', 'empty': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt show --select customer_store_ranking', 'no_print': 'None', 'use_colors': 'True'}
[0m23:07:11.525170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1c187e9-96e8-4163-a443-7ae35f6a98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081cb950>]}
[0m23:07:11.547257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1c187e9-96e8-4163-a443-7ae35f6a98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d3ecf0>]}
[0m23:07:11.559689 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:07:11.601603 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:07:11.704727 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:07:11.705081 [debug] [MainThread]: Partial parsing: updated file: sumup://models/marts/store/customer_store_ranking.sql
[0m23:07:11.800941 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m23:07:11.803074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1c187e9-96e8-4163-a443-7ae35f6a98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e96950>]}
[0m23:07:11.838977 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m23:07:11.840264 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m23:07:11.841672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1c187e9-96e8-4163-a443-7ae35f6a98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce6d50>]}
[0m23:07:11.841862 [info ] [MainThread]: Found 9 models, 3 seeds, 11 data tests, 447 macros
[0m23:07:11.841991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1c187e9-96e8-4163-a443-7ae35f6a98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0ac2f0>]}
[0m23:07:11.842654 [info ] [MainThread]: 
[0m23:07:11.842789 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:07:11.842892 [info ] [MainThread]: 
[0m23:07:11.843087 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:07:11.844766 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m23:07:11.844977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m23:07:11.849194 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m23:07:11.899395 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m23:07:11.899651 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m23:07:11.899826 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m23:07:11.899974 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m23:07:11.900121 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m23:07:11.900245 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m23:07:11.900358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:11.900465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:11.900564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:11.922271 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m23:07:11.922476 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m23:07:11.922633 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m23:07:11.922768 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m23:07:11.922902 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m23:07:11.923029 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m23:07:11.923162 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m23:07:11.923307 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:07:11.923446 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m23:07:11.932990 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.009 seconds
[0m23:07:11.933095 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.010 seconds
[0m23:07:11.933653 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m23:07:11.934093 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m23:07:11.934203 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m23:07:11.934647 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m23:07:11.934758 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m23:07:11.934888 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m23:07:11.935018 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m23:07:11.937714 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:11.937859 [debug] [MainThread]: On master: BEGIN
[0m23:07:11.937972 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:07:11.943189 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:07:11.943302 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:11.943449 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:07:11.949609 [debug] [MainThread]: SQL status: SELECT 5 in 0.006 seconds
[0m23:07:11.950433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1c187e9-96e8-4163-a443-7ae35f6a98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a15e4e0>]}
[0m23:07:11.950593 [debug] [MainThread]: On master: ROLLBACK
[0m23:07:11.950834 [debug] [MainThread]: On master: Close
[0m23:07:11.952119 [debug] [Thread-1 (]: Began running node model.sumup.customer_store_ranking
[0m23:07:11.952286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.customer_store_ranking)
[0m23:07:11.952416 [debug] [Thread-1 (]: Began compiling node model.sumup.customer_store_ranking
[0m23:07:11.955764 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m23:07:11.956104 [debug] [Thread-1 (]: Began executing node model.sumup.customer_store_ranking
[0m23:07:11.958646 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m23:07:11.958791 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  
  --Question 1) 

SELECT
    store_name,
    SUM(amount_eur) AS total_amount
FROM
    "postgres"."analytics_analytics"."int_transaction" 
WHERE status = 'accepted' and store_name = 'Nec Ante Ltd'


--GROUP BY

--    store_name
--ORDER BY
--    total_amount DESC
--limit 10
  
  limit 5

[0m23:07:11.958917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:07:11.965987 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "int_transaction.store_name" must appear in the GROUP BY clause or be used in an aggregate function
LINE 7:     store_name,
            ^

[0m23:07:11.966161 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: Close
[0m23:07:11.969495 [debug] [Thread-1 (]: Database Error in model customer_store_ranking (models/marts/store/customer_store_ranking.sql)
  column "int_transaction.store_name" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 7:     store_name,
              ^
[0m23:07:11.969749 [debug] [Thread-1 (]: Finished running node model.sumup.customer_store_ranking
[0m23:07:11.969963 [debug] [Thread-7 (]: Marking all children of 'model.sumup.customer_store_ranking' to be skipped because of status 'error'.  Reason: Database Error in model customer_store_ranking (models/marts/store/customer_store_ranking.sql)
  column "int_transaction.store_name" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 7:     store_name,
              ^.
[0m23:07:11.970381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:07:11.970519 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m23:07:11.970637 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m23:07:11.970739 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m23:07:11.970914 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model customer_store_ranking (models/marts/store/customer_store_ranking.sql)
    column "int_transaction.store_name" must appear in the GROUP BY clause or be used in an aggregate function
    LINE 7:     store_name,
                ^
[0m23:07:11.972466 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.5706466, "process_in_blocks": "0", "process_kernel_time": 0.144883, "process_mem_max_rss": "130203648", "process_out_blocks": "0", "process_user_time": 0.877647}
[0m23:07:11.972640 [debug] [MainThread]: Command `dbt show` failed at 23:07:11.972607 after 0.57 seconds
[0m23:07:11.972776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d1df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1c3960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1c3a10>]}
[0m23:07:11.972908 [debug] [MainThread]: Flushing usage events
[0m23:07:11.975729 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:07:31.837731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106437c50>]}


============================== 23:07:31.840320 | 7a66b84f-7f59-4d27-97da-e9179b7bc9df ==============================
[0m23:07:31.840320 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:07:31.840596 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_colors': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_format': 'default', 'quiet': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'empty': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'no_print': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'introspect': 'True', 'write_json': 'True', 'invocation_command': 'dbt show --select customer_store_ranking'}
[0m23:07:31.924016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a66b84f-7f59-4d27-97da-e9179b7bc9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105177950>]}
[0m23:07:31.946247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a66b84f-7f59-4d27-97da-e9179b7bc9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062cacf0>]}
[0m23:07:31.955632 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:07:31.998956 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:07:32.060507 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:07:32.060866 [debug] [MainThread]: Partial parsing: updated file: sumup://models/marts/store/customer_store_ranking.sql
[0m23:07:32.153577 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m23:07:32.155653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a66b84f-7f59-4d27-97da-e9179b7bc9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f2950>]}
[0m23:07:32.190461 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m23:07:32.191507 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m23:07:32.192822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a66b84f-7f59-4d27-97da-e9179b7bc9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107342d50>]}
[0m23:07:32.193002 [info ] [MainThread]: Found 9 models, 3 seeds, 11 data tests, 447 macros
[0m23:07:32.193130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a66b84f-7f59-4d27-97da-e9179b7bc9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078082f0>]}
[0m23:07:32.193788 [info ] [MainThread]: 
[0m23:07:32.193921 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:07:32.194020 [info ] [MainThread]: 
[0m23:07:32.194207 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:07:32.195847 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m23:07:32.199926 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m23:07:32.227701 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m23:07:32.248360 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m23:07:32.248531 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m23:07:32.248686 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m23:07:32.248828 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m23:07:32.248957 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m23:07:32.249079 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m23:07:32.249190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:32.249308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:32.249421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:32.273197 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m23:07:32.273408 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m23:07:32.273534 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m23:07:32.273660 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m23:07:32.273784 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m23:07:32.273899 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m23:07:32.274025 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:07:32.274166 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m23:07:32.274303 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m23:07:32.280454 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m23:07:32.280577 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m23:07:32.281163 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m23:07:32.281287 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m23:07:32.281727 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m23:07:32.282203 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m23:07:32.282333 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m23:07:32.282590 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m23:07:32.282944 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m23:07:32.285289 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:32.285408 [debug] [MainThread]: On master: BEGIN
[0m23:07:32.285503 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:07:32.289663 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m23:07:32.289771 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:32.289908 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:07:32.295933 [debug] [MainThread]: SQL status: SELECT 5 in 0.006 seconds
[0m23:07:32.296682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a66b84f-7f59-4d27-97da-e9179b7bc9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b5f30>]}
[0m23:07:32.296834 [debug] [MainThread]: On master: ROLLBACK
[0m23:07:32.297047 [debug] [MainThread]: On master: Close
[0m23:07:32.298152 [debug] [Thread-1 (]: Began running node model.sumup.customer_store_ranking
[0m23:07:32.298307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.sumup.customer_store_ranking)
[0m23:07:32.298438 [debug] [Thread-1 (]: Began compiling node model.sumup.customer_store_ranking
[0m23:07:32.301541 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m23:07:32.301819 [debug] [Thread-1 (]: Began executing node model.sumup.customer_store_ranking
[0m23:07:32.304497 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m23:07:32.304638 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  
  --Question 1) 

SELECT
    store_name,
    --SUM(amount_eur) AS total_amount
    amount_eur
FROM
    "postgres"."analytics_analytics"."int_transaction" 
WHERE status = 'accepted' and store_id = 3



--GROUP BY

--    store_name
--ORDER BY
--    total_amount DESC
--limit 10
  
  limit 5

[0m23:07:32.304765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:07:32.310820 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m23:07:32.311759 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: Close
[0m23:07:32.312034 [debug] [Thread-1 (]: Finished running node model.sumup.customer_store_ranking
[0m23:07:32.312444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:07:32.312557 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m23:07:32.312655 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m23:07:32.312745 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m23:07:32.312978 [debug] [MainThread]: Command end result
[0m23:07:32.323669 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m23:07:32.324316 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m23:07:32.326808 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m23:07:32.327191 [info ] [MainThread]: Previewing node 'customer_store_ranking':
| store_name   | amount_eur |
| ------------ | ---------- |
| Nec Ante Ltd |       3.29 |
| Nec Ante Ltd |       1.25 |
| Nec Ante Ltd |       8.23 |
| Nec Ante Ltd |       7.14 |
| Nec Ante Ltd |       4.12 |

[0m23:07:32.328862 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 0.5186928, "process_in_blocks": "0", "process_kernel_time": 0.137702, "process_mem_max_rss": "129204224", "process_out_blocks": "0", "process_user_time": 0.869266}
[0m23:07:32.329042 [debug] [MainThread]: Command `dbt show` succeeded at 23:07:32.329006 after 0.52 seconds
[0m23:07:32.329191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062a9e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a27750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a27800>]}
[0m23:07:32.329321 [debug] [MainThread]: Flushing usage events
[0m23:07:32.331697 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:08:36.395308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c74050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106237c50>]}


============================== 23:08:36.398054 | 96c720b4-542c-4146-ba46-90cff9c34190 ==============================
[0m23:08:36.398054 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:08:36.398322 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'empty': 'None', 'warn_error': 'None', 'debug': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'invocation_command': 'dbt show --select customer_store_ranking', 'printer_width': '80', 'introspect': 'True', 'static_parser': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'version_check': 'True', 'quiet': 'False', 'use_colors': 'True', 'write_json': 'True', 'no_print': 'None', 'fail_fast': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup'}
[0m23:08:36.481862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96c720b4-542c-4146-ba46-90cff9c34190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105157950>]}
[0m23:08:36.503418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96c720b4-542c-4146-ba46-90cff9c34190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fcacf0>]}
[0m23:08:36.513513 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:08:36.552977 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:08:36.619350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:08:36.619661 [debug] [MainThread]: Partial parsing: updated file: sumup://models/staging/stg_transaction.sql
[0m23:08:36.740878 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_expectations.expression_is_true`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m23:08:36.741146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '96c720b4-542c-4146-ba46-90cff9c34190', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180f2550>]}
[0m23:08:36.812596 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m23:08:36.814579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96c720b4-542c-4146-ba46-90cff9c34190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022fba70>]}
[0m23:08:36.848110 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m23:08:36.849432 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m23:08:36.850863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96c720b4-542c-4146-ba46-90cff9c34190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10661aeb0>]}
[0m23:08:36.851027 [info ] [MainThread]: Found 9 models, 3 seeds, 11 data tests, 447 macros
[0m23:08:36.851152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96c720b4-542c-4146-ba46-90cff9c34190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1186e3520>]}
[0m23:08:36.851790 [info ] [MainThread]: 
[0m23:08:36.851918 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:08:36.852021 [info ] [MainThread]: 
[0m23:08:36.852200 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:08:36.853918 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m23:08:36.857913 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m23:08:36.858869 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m23:08:36.880677 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m23:08:36.880867 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m23:08:36.881024 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m23:08:36.881173 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m23:08:36.881297 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m23:08:36.881417 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m23:08:36.881537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:36.881642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:36.881750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:36.908344 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m23:08:36.908551 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m23:08:36.908692 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m23:08:36.908816 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m23:08:36.908942 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m23:08:36.909057 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m23:08:36.909184 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:08:36.909326 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m23:08:36.909463 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m23:08:36.916418 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m23:08:36.916532 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m23:08:36.917094 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m23:08:36.917213 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m23:08:36.917642 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m23:08:36.918133 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m23:08:36.918262 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m23:08:36.918369 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m23:08:36.918619 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m23:08:36.921140 [debug] [MainThread]: Using postgres connection "master"
[0m23:08:36.921272 [debug] [MainThread]: On master: BEGIN
[0m23:08:36.921371 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:08:36.926476 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:08:36.926581 [debug] [MainThread]: Using postgres connection "master"
[0m23:08:36.926713 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:08:36.933466 [debug] [MainThread]: SQL status: SELECT 5 in 0.007 seconds
[0m23:08:36.934214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96c720b4-542c-4146-ba46-90cff9c34190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183e71d0>]}
[0m23:08:36.934363 [debug] [MainThread]: On master: ROLLBACK
[0m23:08:36.934579 [debug] [MainThread]: On master: Close
[0m23:08:36.935778 [debug] [Thread-1 (]: Began running node model.sumup.customer_store_ranking
[0m23:08:36.935928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now model.sumup.customer_store_ranking)
[0m23:08:36.936057 [debug] [Thread-1 (]: Began compiling node model.sumup.customer_store_ranking
[0m23:08:36.939173 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m23:08:36.939457 [debug] [Thread-1 (]: Began executing node model.sumup.customer_store_ranking
[0m23:08:36.941982 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m23:08:36.942120 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  
  --Question 1) 

SELECT
    store_name,
    --SUM(amount_eur) AS total_amount
    amount_eur
FROM
    "postgres"."analytics_analytics"."int_transaction" 
WHERE status = 'accepted' and store_id = 3



--GROUP BY

--    store_name
--ORDER BY
--    total_amount DESC
--limit 10
  
  limit 5

[0m23:08:36.942245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:08:36.947854 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m23:08:36.948770 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: Close
[0m23:08:36.949056 [debug] [Thread-1 (]: Finished running node model.sumup.customer_store_ranking
[0m23:08:36.949462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:08:36.949576 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m23:08:36.949670 [debug] [MainThread]: Connection 'list_postgres_analytics' was properly closed.
[0m23:08:36.949758 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m23:08:36.949982 [debug] [MainThread]: Command end result
[0m23:08:36.961301 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m23:08:36.961948 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m23:08:36.964316 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m23:08:36.964617 [info ] [MainThread]: Previewing node 'customer_store_ranking':
| store_name   | amount_eur |
| ------------ | ---------- |
| Nec Ante Ltd |       3.29 |
| Nec Ante Ltd |       1.25 |
| Nec Ante Ltd |       8.23 |
| Nec Ante Ltd |       7.14 |
| Nec Ante Ltd |       4.12 |

[0m23:08:36.964852 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:08:36.966557 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 0.6000458, "process_in_blocks": "0", "process_kernel_time": 0.136762, "process_mem_max_rss": "129548288", "process_out_blocks": "0", "process_user_time": 0.924892}
[0m23:08:36.966719 [debug] [MainThread]: Command `dbt show` succeeded at 23:08:36.966687 after 0.60 seconds
[0m23:08:36.966847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1182af960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105993e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e85c70>]}
[0m23:08:36.966976 [debug] [MainThread]: Flushing usage events
[0m23:08:36.969852 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:08:40.520690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105acc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10690f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10690fc50>]}


============================== 23:08:40.522703 | 51792cd8-8cf6-4221-8873-ffb33d9084dc ==============================
[0m23:08:40.522703 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:08:40.522967 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'write_json': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'version_check': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt show --select customer_store_ranking', 'use_colors': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'printer_width': '80', 'empty': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs'}
[0m23:08:40.588465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51792cd8-8cf6-4221-8873-ffb33d9084dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c2f950>]}
[0m23:08:40.609741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51792cd8-8cf6-4221-8873-ffb33d9084dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067a2cf0>]}
[0m23:08:40.614528 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:08:40.652428 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:08:40.701238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:08:40.701415 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:08:40.703661 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m23:08:40.720720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51792cd8-8cf6-4221-8873-ffb33d9084dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078faf50>]}
[0m23:08:40.753945 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m23:08:40.754789 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m23:08:40.756642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51792cd8-8cf6-4221-8873-ffb33d9084dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10774ad50>]}
[0m23:08:40.756817 [info ] [MainThread]: Found 9 models, 3 seeds, 11 data tests, 447 macros
[0m23:08:40.756950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51792cd8-8cf6-4221-8873-ffb33d9084dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107039010>]}
[0m23:08:40.757583 [info ] [MainThread]: 
[0m23:08:40.757719 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:08:40.757819 [info ] [MainThread]: 
[0m23:08:40.758015 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:08:40.759645 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m23:08:40.764408 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m23:08:40.765305 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m23:08:40.778792 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m23:08:40.778982 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m23:08:40.779125 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m23:08:40.779247 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m23:08:40.779363 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m23:08:40.779464 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m23:08:40.779573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:40.779672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:40.779762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:40.798123 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m23:08:40.798327 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m23:08:40.798437 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m23:08:40.798545 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m23:08:40.798657 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:08:40.798778 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m23:08:40.800344 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m23:08:40.800491 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m23:08:40.800614 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m23:08:40.804370 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m23:08:40.804494 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m23:08:40.805067 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m23:08:40.805186 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m23:08:40.805608 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m23:08:40.806064 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m23:08:40.806179 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m23:08:40.806403 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m23:08:40.806708 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m23:08:40.808972 [debug] [MainThread]: Using postgres connection "master"
[0m23:08:40.809086 [debug] [MainThread]: On master: BEGIN
[0m23:08:40.809175 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:08:40.813418 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m23:08:40.813521 [debug] [MainThread]: Using postgres connection "master"
[0m23:08:40.813652 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:08:40.818047 [debug] [MainThread]: SQL status: SELECT 5 in 0.004 seconds
[0m23:08:40.818772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51792cd8-8cf6-4221-8873-ffb33d9084dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0fee0>]}
[0m23:08:40.818921 [debug] [MainThread]: On master: ROLLBACK
[0m23:08:40.819118 [debug] [MainThread]: On master: Close
[0m23:08:40.819934 [debug] [Thread-1 (]: Began running node model.sumup.customer_store_ranking
[0m23:08:40.820117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now model.sumup.customer_store_ranking)
[0m23:08:40.820262 [debug] [Thread-1 (]: Began compiling node model.sumup.customer_store_ranking
[0m23:08:40.823148 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m23:08:40.823450 [debug] [Thread-1 (]: Began executing node model.sumup.customer_store_ranking
[0m23:08:40.826230 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m23:08:40.826372 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  
  --Question 1) 

SELECT
    store_name,
    --SUM(amount_eur) AS total_amount
    amount_eur
FROM
    "postgres"."analytics_analytics"."int_transaction" 
WHERE status = 'accepted' and store_id = 3



--GROUP BY

--    store_name
--ORDER BY
--    total_amount DESC
--limit 10
  
  limit 5

[0m23:08:40.826499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:08:40.831894 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m23:08:40.832759 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: Close
[0m23:08:40.833024 [debug] [Thread-1 (]: Finished running node model.sumup.customer_store_ranking
[0m23:08:40.833451 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:08:40.833562 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m23:08:40.833654 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m23:08:40.833740 [debug] [MainThread]: Connection 'list_postgres_analytics_analytics' was properly closed.
[0m23:08:40.833962 [debug] [MainThread]: Command end result
[0m23:08:40.868754 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m23:08:40.869507 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m23:08:40.872020 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m23:08:40.872346 [info ] [MainThread]: Previewing node 'customer_store_ranking':
| store_name   | amount_eur |
| ------------ | ---------- |
| Nec Ante Ltd |       3.29 |
| Nec Ante Ltd |       1.25 |
| Nec Ante Ltd |       8.23 |
| Nec Ante Ltd |       7.14 |
| Nec Ante Ltd |       4.12 |

[0m23:08:40.873601 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 0.38021183, "process_in_blocks": "0", "process_kernel_time": 0.10169, "process_mem_max_rss": "126795776", "process_out_blocks": "0", "process_user_time": 0.780633}
[0m23:08:40.873759 [debug] [MainThread]: Command `dbt show` succeeded at 23:08:40.873728 after 0.38 seconds
[0m23:08:40.873887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106781f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ad1020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ad2410>]}
[0m23:08:40.874008 [debug] [MainThread]: Flushing usage events
[0m23:08:40.876253 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:08:50.721195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106827c50>]}


============================== 23:08:50.723703 | 469fecef-f623-4b9d-a680-d6811b2be9d6 ==============================
[0m23:08:50.723703 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:08:50.723959 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'static_parser': 'True', 'write_json': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'invocation_command': 'dbt show --select +customer_store_ranking', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'quiet': 'False', 'no_print': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs'}
[0m23:08:50.801544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '469fecef-f623-4b9d-a680-d6811b2be9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b47950>]}
[0m23:08:50.823421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '469fecef-f623-4b9d-a680-d6811b2be9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066bacf0>]}
[0m23:08:50.833043 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:08:50.875612 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:08:50.938406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:08:50.938587 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:08:50.940777 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m23:08:50.957905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '469fecef-f623-4b9d-a680-d6811b2be9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107812f50>]}
[0m23:08:50.990713 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m23:08:50.991754 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m23:08:50.993130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '469fecef-f623-4b9d-a680-d6811b2be9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107662d50>]}
[0m23:08:50.993303 [info ] [MainThread]: Found 9 models, 3 seeds, 11 data tests, 447 macros
[0m23:08:50.993437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '469fecef-f623-4b9d-a680-d6811b2be9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f51010>]}
[0m23:08:50.994236 [info ] [MainThread]: 
[0m23:08:50.994378 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:08:50.994482 [info ] [MainThread]: 
[0m23:08:50.994673 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:08:50.996236 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m23:08:51.000998 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m23:08:51.001998 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m23:08:51.022072 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m23:08:51.022256 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m23:08:51.022412 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m23:08:51.022572 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m23:08:51.022705 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m23:08:51.022830 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m23:08:51.022947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:51.023070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:51.023187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:51.043587 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m23:08:51.043753 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m23:08:51.043881 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m23:08:51.044001 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m23:08:51.044122 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m23:08:51.044235 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m23:08:51.044366 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m23:08:51.044504 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:08:51.044642 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m23:08:51.050010 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m23:08:51.050123 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m23:08:51.050675 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m23:08:51.050791 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m23:08:51.051202 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m23:08:51.051693 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m23:08:51.051831 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m23:08:51.051982 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m23:08:51.052254 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m23:08:51.054763 [debug] [MainThread]: Using postgres connection "master"
[0m23:08:51.054875 [debug] [MainThread]: On master: BEGIN
[0m23:08:51.054967 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:08:51.059627 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:08:51.059745 [debug] [MainThread]: Using postgres connection "master"
[0m23:08:51.059877 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:08:51.063910 [debug] [MainThread]: SQL status: SELECT 5 in 0.004 seconds
[0m23:08:51.064651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '469fecef-f623-4b9d-a680-d6811b2be9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a27e10>]}
[0m23:08:51.064798 [debug] [MainThread]: On master: ROLLBACK
[0m23:08:51.064989 [debug] [MainThread]: On master: Close
[0m23:08:51.066137 [debug] [Thread-2 (]: Began running node seed.sumup.store
[0m23:08:51.066293 [debug] [Thread-3 (]: Began running node seed.sumup.transaction
[0m23:08:51.066630 [debug] [Thread-1 (]: Began running node seed.sumup.device
[0m23:08:51.066508 [info ] [Thread-2 (]: 2 of 19 START seed file analytics.store ........................................ [RUN]
[0m23:08:51.066870 [info ] [Thread-3 (]: 3 of 19 START seed file analytics.transaction .................................. [RUN]
[0m23:08:51.067061 [info ] [Thread-1 (]: 1 of 19 START seed file analytics.device ....................................... [RUN]
[0m23:08:51.067238 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now seed.sumup.store)
[0m23:08:51.067381 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now seed.sumup.transaction)
[0m23:08:51.067511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now seed.sumup.device)
[0m23:08:51.067642 [debug] [Thread-2 (]: Began compiling node seed.sumup.store
[0m23:08:51.067762 [debug] [Thread-3 (]: Began compiling node seed.sumup.transaction
[0m23:08:51.067884 [debug] [Thread-1 (]: Began compiling node seed.sumup.device
[0m23:08:51.068009 [debug] [Thread-2 (]: Began executing node seed.sumup.store
[0m23:08:51.068133 [debug] [Thread-3 (]: Began executing node seed.sumup.transaction
[0m23:08:51.068252 [debug] [Thread-1 (]: Began executing node seed.sumup.device
[0m23:08:51.083669 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m23:08:51.086457 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m23:08:51.086604 [debug] [Thread-1 (]: On seed.sumup.device: BEGIN
[0m23:08:51.128096 [debug] [Thread-2 (]: On seed.sumup.store: BEGIN
[0m23:08:51.130463 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m23:08:51.130634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:08:51.130774 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:08:51.130902 [debug] [Thread-3 (]: On seed.sumup.transaction: BEGIN
[0m23:08:51.131165 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:08:51.137976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m23:08:51.138115 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m23:08:51.138245 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m23:08:51.138386 [debug] [Thread-1 (]: On seed.sumup.device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.device"} */
truncate table "postgres"."analytics"."device"
[0m23:08:51.138513 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m23:08:51.138650 [debug] [Thread-2 (]: On seed.sumup.store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.store"} */
truncate table "postgres"."analytics"."store"
[0m23:08:51.139388 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:08:51.139502 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m23:08:51.139614 [debug] [Thread-3 (]: On seed.sumup.transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.transaction"} */
truncate table "postgres"."analytics"."transaction"
[0m23:08:51.143718 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.005 seconds
[0m23:08:51.150936 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0.011 seconds
[0m23:08:51.163441 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.025 seconds
[0m23:08:51.228541 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m23:08:51.234964 [debug] [Thread-1 (]: On seed.sumup.device: 
          insert into "postgres"."analytics"."device" ("id", "type", "store_id") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s...
[0m23:08:51.255901 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m23:08:51.256063 [debug] [Thread-1 (]: SQL status: INSERT 0 200 in 0.008 seconds
[0m23:08:51.268578 [debug] [Thread-2 (]: On seed.sumup.store: 
          insert into "postgres"."analytics"."store" ("id", "name", "address", "city", "country", "created_at", "typology", "customer_id") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%...
[0m23:08:51.295742 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.sumup.device"
[0m23:08:51.326342 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.015 seconds
[0m23:08:51.339206 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.sumup.store"
[0m23:08:51.376141 [debug] [Thread-1 (]: On seed.sumup.device: COMMIT
[0m23:08:51.376728 [debug] [Thread-2 (]: On seed.sumup.store: COMMIT
[0m23:08:51.388834 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m23:08:51.407621 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m23:08:51.426386 [debug] [Thread-1 (]: On seed.sumup.device: COMMIT
[0m23:08:51.450798 [debug] [Thread-2 (]: On seed.sumup.store: COMMIT
[0m23:08:51.485362 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m23:08:51.512081 [debug] [Thread-2 (]: SQL status: COMMIT in 0.014 seconds
[0m23:08:51.512901 [debug] [Thread-1 (]: On seed.sumup.device: Close
[0m23:08:51.531242 [debug] [Thread-2 (]: On seed.sumup.store: Close
[0m23:08:51.594233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '469fecef-f623-4b9d-a680-d6811b2be9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079e3290>]}
[0m23:08:51.594372 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '469fecef-f623-4b9d-a680-d6811b2be9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a1a8e0>]}
[0m23:08:51.606811 [info ] [Thread-1 (]: 1 of 19 OK loaded seed file analytics.device ................................... [[32mINSERT 200[0m in 0.49s]
[0m23:08:51.613324 [info ] [Thread-2 (]: 2 of 19 OK loaded seed file analytics.store .................................... [[32mINSERT 100[0m in 0.50s]
[0m23:08:51.632149 [debug] [Thread-1 (]: Finished running node seed.sumup.device
[0m23:08:51.650837 [debug] [Thread-2 (]: Finished running node seed.sumup.store
[0m23:08:51.688325 [debug] [Thread-4 (]: Began running node model.sumup.stg_device
[0m23:08:51.694791 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.sumup.stg_device'
[0m23:08:51.694979 [debug] [Thread-4 (]: Began compiling node model.sumup.stg_device
[0m23:08:51.704187 [debug] [Thread-4 (]: Writing injected SQL for node "model.sumup.stg_device"
[0m23:08:51.710616 [debug] [Thread-1 (]: Began running node model.sumup.stg_store
[0m23:08:51.723137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.sumup.device, now model.sumup.stg_store)
[0m23:08:51.731176 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_store
[0m23:08:51.738471 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_store"
[0m23:08:51.762747 [debug] [Thread-4 (]: Began executing node model.sumup.stg_device
[0m23:08:51.772142 [debug] [Thread-4 (]: Using postgres connection "model.sumup.stg_device"
[0m23:08:51.772351 [debug] [Thread-1 (]: Began executing node model.sumup.stg_store
[0m23:08:51.783702 [debug] [Thread-4 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */

  
  

SELECT
    -- Primary Key
    id AS device_id,

    -- Foreign Key to stores (assuming this links the device to a specific store)
    store_id,

    -- Descriptive Attributes
    type as device_type
    
    -- Other fields, if any, standardized here
    -- e.g., CAST(status AS VARCHAR) AS device_status

    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-21 21:08:50.710583+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."device"
  
  limit 5

[0m23:08:51.809732 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_store"
[0m23:08:51.827473 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:08:51.846281 [debug] [Thread-1 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */

  
  

SELECT
    -- Primary Key: Rename to be explicit
    id AS store_id,
    name AS store_name,

    -- Descriptive Attributes: Rename 'typology' for clarity
    typology AS store_typology,
    country,
    city
    
    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-21 21:08:50.710583+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."store"
  
  limit 5

[0m23:08:51.882582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:08:51.889007 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.062 seconds
[0m23:08:51.915062 [debug] [Thread-4 (]: On model.sumup.stg_device: Close
[0m23:08:51.915223 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.033 seconds
[0m23:08:51.940420 [debug] [Thread-4 (]: Finished running node model.sumup.stg_device
[0m23:08:51.940891 [debug] [Thread-1 (]: On model.sumup.stg_store: Close
[0m23:08:51.971757 [debug] [Thread-1 (]: Finished running node model.sumup.stg_store
[0m23:08:52.047995 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m23:08:52.048148 [debug] [Thread-3 (]: On seed.sumup.transaction: 
          insert into "postgres"."analytics"."transaction" ("id", "device_id", "product_name", "product_sku", "category_name", "amount", "status", "card_number", "cvv", "created_at", "happened_at") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m23:08:52.076182 [debug] [Thread-3 (]: SQL status: INSERT 0 1500 in 0.028 seconds
[0m23:08:52.076542 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.sumup.transaction"
[0m23:08:52.077880 [debug] [Thread-3 (]: On seed.sumup.transaction: COMMIT
[0m23:08:52.078020 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m23:08:52.078145 [debug] [Thread-3 (]: On seed.sumup.transaction: COMMIT
[0m23:08:52.081715 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m23:08:52.081974 [debug] [Thread-3 (]: On seed.sumup.transaction: Close
[0m23:08:52.082177 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '469fecef-f623-4b9d-a680-d6811b2be9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078bb110>]}
[0m23:08:52.082383 [info ] [Thread-3 (]: 3 of 19 OK loaded seed file analytics.transaction .............................. [[32mINSERT 1500[0m in 1.01s]
[0m23:08:52.082597 [debug] [Thread-3 (]: Finished running node seed.sumup.transaction
[0m23:08:52.082844 [debug] [Thread-2 (]: Began running node model.sumup.stg_transaction
[0m23:08:52.083042 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.sumup.store, now model.sumup.stg_transaction)
[0m23:08:52.083208 [debug] [Thread-2 (]: Began compiling node model.sumup.stg_transaction
[0m23:08:52.084504 [debug] [Thread-2 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m23:08:52.084766 [debug] [Thread-2 (]: Began executing node model.sumup.stg_transaction
[0m23:08:52.085826 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_transaction"
[0m23:08:52.085981 [debug] [Thread-2 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  
  SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) AS amount_eur,
    LOWER(status) AS status,

    -- Card Information 
    REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '') AS card_number,
    CAST(cvv AS VARCHAR) AS cvv,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  
  limit 5

[0m23:08:52.086130 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:08:52.092845 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.007 seconds
[0m23:08:52.093418 [debug] [Thread-2 (]: On model.sumup.stg_transaction: Close
[0m23:08:52.093671 [debug] [Thread-2 (]: Finished running node model.sumup.stg_transaction
[0m23:08:52.093982 [debug] [Thread-3 (]: Began running node test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3
[0m23:08:52.094123 [debug] [Thread-4 (]: Began running node model.sumup.int_transaction
[0m23:08:52.094252 [debug] [Thread-1 (]: Began running node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m23:08:52.094393 [debug] [Thread-2 (]: Began running node test.sumup.dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed.1150af2be1
[0m23:08:52.094525 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.sumup.transaction, now test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3)
[0m23:08:52.094659 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.sumup.stg_device, now model.sumup.int_transaction)
[0m23:08:52.094794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.stg_store, now test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad)
[0m23:08:52.094919 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sumup.stg_transaction, now test.sumup.dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed.1150af2be1)
[0m23:08:52.095049 [debug] [Thread-3 (]: Began compiling node test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3
[0m23:08:52.095167 [debug] [Thread-4 (]: Began compiling node model.sumup.int_transaction
[0m23:08:52.095282 [debug] [Thread-1 (]: Began compiling node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m23:08:52.095401 [debug] [Thread-2 (]: Began compiling node test.sumup.dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed.1150af2be1
[0m23:08:52.101141 [debug] [Thread-4 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m23:08:52.104565 [debug] [Thread-1 (]: Writing injected SQL for node "test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad"
[0m23:08:52.107211 [debug] [Thread-1 (]: Began executing node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m23:08:52.108354 [debug] [Thread-1 (]: Using postgres connection "test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad"
[0m23:08:52.108539 [debug] [Thread-1 (]: On test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad"} */

  
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "postgres"."analytics_staging"."stg_transaction"
    group by status

)

select *
from all_values
where value_field not in (
    'accepted','refused','cancelled'
)



  
  limit 5

[0m23:08:52.108684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:08:52.108895 [debug] [Thread-4 (]: Began executing node model.sumup.int_transaction
[0m23:08:52.110184 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m23:08:52.110363 [debug] [Thread-4 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

  
  

SELECT
    -- Primary and Foreign Keys
    transaction_id,
    t.device_id,

    -- Product Information
   
    CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA  AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data and Status
    amount_eur,
    status,

    --device data
    d.device_type,
    
    -- store_data
    d.store_id,
    store_name,
    store_typology,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction" t
LEFT JOIN "postgres"."analytics_staging"."stg_device" d ON t.device_id = d.device_id
LEFT JOIN "postgres"."analytics_staging"."stg_store" s ON d.store_id = s.store_id

-- Incremental Logic: Only select new records for subsequent runs

    WHERE t.created_at_utc > (SELECT MAX(created_at_utc) FROM "postgres"."analytics_analytics"."int_transaction")

  
  limit 5

[0m23:08:52.110553 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:08:52.115246 [debug] [Thread-3 (]: Compilation Error in test dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13 (models/staging/stg_transaction.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:08:52.115487 [debug] [Thread-2 (]: Compilation Error in test dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed (models/staging/stg_transaction.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:08:52.115714 [debug] [Thread-3 (]: Finished running node test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3
[0m23:08:52.115934 [debug] [Thread-2 (]: Finished running node test.sumup.dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed.1150af2be1
[0m23:08:52.116115 [debug] [Thread-3 (]: Began running node test.sumup.dbt_expectations_expression_is_true_stg_transaction_amount_eur___0.3bf59a08a8
[0m23:08:52.116260 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m23:08:52.116422 [debug] [Thread-7 (]: Marking all children of 'test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13 (models/staging/stg_transaction.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m23:08:52.116608 [debug] [Thread-2 (]: Began running node test.sumup.dbt_expectations_expression_is_true_stg_transaction_card_number__NOT_REGEXP_LIKE_REPLACE_REPLACE_card_number_0_.4706ab93df
[0m23:08:52.116767 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3, now test.sumup.dbt_expectations_expression_is_true_stg_transaction_amount_eur___0.3bf59a08a8)
[0m23:08:52.117258 [debug] [Thread-1 (]: On test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad: Close
[0m23:08:52.117641 [debug] [Thread-7 (]: Marking all children of 'test.sumup.dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed.1150af2be1' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed (models/staging/stg_transaction.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m23:08:52.117804 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sumup.dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed.1150af2be1, now test.sumup.dbt_expectations_expression_is_true_stg_transaction_card_number__NOT_REGEXP_LIKE_REPLACE_REPLACE_card_number_0_.4706ab93df)
[0m23:08:52.117955 [debug] [Thread-3 (]: Began compiling node test.sumup.dbt_expectations_expression_is_true_stg_transaction_amount_eur___0.3bf59a08a8
[0m23:08:52.118235 [debug] [Thread-1 (]: Finished running node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m23:08:52.118381 [debug] [Thread-2 (]: Began compiling node test.sumup.dbt_expectations_expression_is_true_stg_transaction_card_number__NOT_REGEXP_LIKE_REPLACE_REPLACE_card_number_0_.4706ab93df
[0m23:08:52.120236 [debug] [Thread-1 (]: Began running node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m23:08:52.122066 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.011 seconds
[0m23:08:52.122224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad, now test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411)
[0m23:08:52.122956 [debug] [Thread-4 (]: On model.sumup.int_transaction: Close
[0m23:08:52.123416 [debug] [Thread-1 (]: Began compiling node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m23:08:52.123987 [debug] [Thread-3 (]: Compilation Error in test dbt_expectations_expression_is_true_stg_transaction_amount_eur___0 (models/staging/stg_transaction.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:08:52.124549 [debug] [Thread-2 (]: Compilation Error in test dbt_expectations_expression_is_true_stg_transaction_card_number__NOT_REGEXP_LIKE_REPLACE_REPLACE_card_number_0_ (models/staging/stg_transaction.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:08:52.127438 [debug] [Thread-1 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411"
[0m23:08:52.127658 [debug] [Thread-3 (]: Finished running node test.sumup.dbt_expectations_expression_is_true_stg_transaction_amount_eur___0.3bf59a08a8
[0m23:08:52.127888 [debug] [Thread-4 (]: Finished running node model.sumup.int_transaction
[0m23:08:52.128073 [debug] [Thread-2 (]: Finished running node test.sumup.dbt_expectations_expression_is_true_stg_transaction_card_number__NOT_REGEXP_LIKE_REPLACE_REPLACE_card_number_0_.4706ab93df
[0m23:08:52.128285 [debug] [Thread-3 (]: Began running node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m23:08:52.128426 [debug] [Thread-4 (]: Began running node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m23:08:52.128608 [debug] [Thread-2 (]: Began running node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m23:08:52.128746 [debug] [Thread-7 (]: Marking all children of 'test.sumup.dbt_expectations_expression_is_true_stg_transaction_amount_eur___0.3bf59a08a8' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expression_is_true_stg_transaction_amount_eur___0 (models/staging/stg_transaction.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m23:08:52.128902 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sumup.dbt_expectations_expression_is_true_stg_transaction_amount_eur___0.3bf59a08a8, now test.sumup.not_null_stg_transaction_card_number.fb1135c280)
[0m23:08:52.129038 [debug] [Thread-1 (]: Began executing node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m23:08:52.129170 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.sumup.int_transaction, now test.sumup.not_null_stg_transaction_device_id.b84ae0844e)
[0m23:08:52.129306 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sumup.dbt_expectations_expression_is_true_stg_transaction_card_number__NOT_REGEXP_LIKE_REPLACE_REPLACE_card_number_0_.4706ab93df, now test.sumup.not_null_stg_transaction_id.f3ec2fc021)
[0m23:08:52.129488 [debug] [Thread-7 (]: Marking all children of 'test.sumup.dbt_expectations_expression_is_true_stg_transaction_card_number__NOT_REGEXP_LIKE_REPLACE_REPLACE_card_number_0_.4706ab93df' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expression_is_true_stg_transaction_card_number__NOT_REGEXP_LIKE_REPLACE_REPLACE_card_number_0_ (models/staging/stg_transaction.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m23:08:52.129612 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:08:52.129739 [debug] [Thread-3 (]: Began compiling node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m23:08:52.130894 [debug] [Thread-4 (]: Began compiling node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m23:08:52.131024 [debug] [Thread-2 (]: Began compiling node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m23:08:52.131152 [debug] [MainThread]: Connection 'test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411' was properly closed.
[0m23:08:52.132449 [debug] [Thread-3 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_card_number.fb1135c280"
[0m23:08:52.133631 [debug] [Thread-4 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_device_id.b84ae0844e"
[0m23:08:52.134997 [debug] [Thread-2 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_id.f3ec2fc021"
[0m23:08:52.135102 [debug] [MainThread]: Connection 'test.sumup.not_null_stg_transaction_id.f3ec2fc021' was properly closed.
[0m23:08:52.135288 [debug] [MainThread]: Connection 'test.sumup.not_null_stg_transaction_card_number.fb1135c280' was properly closed.
[0m23:08:52.135403 [debug] [MainThread]: Connection 'test.sumup.not_null_stg_transaction_device_id.b84ae0844e' was properly closed.
[0m23:08:52.135601 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test dbt_expectations_expression_is_true_stg_transaction_card_number__NOT_REGEXP_LIKE_REPLACE_REPLACE_card_number_0_ (models/staging/stg_transaction.yml)
    'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:08:52.135987 [debug] [Thread-3 (]: Began executing node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m23:08:52.137153 [debug] [Thread-4 (]: Began executing node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m23:08:52.139320 [debug] [Thread-2 (]: Began executing node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m23:08:52.141856 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 1.4498918, "process_in_blocks": "0", "process_kernel_time": 0.136083, "process_mem_max_rss": "130793472", "process_out_blocks": "0", "process_user_time": 1.766803}
[0m23:08:52.142097 [debug] [MainThread]: Command `dbt show` failed at 23:08:52.142043 after 1.45 seconds
[0m23:08:52.142290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c206b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1ca9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b83d0>]}
[0m23:08:52.142574 [debug] [MainThread]: Flushing usage events
[0m23:08:52.144709 [debug] [Thread-3 (]: Runtime Error in test not_null_stg_transaction_card_number (models/staging/stg_transaction.yml)
  connection never acquired for thread (66312, 6187397120), have []
[0m23:08:52.144986 [debug] [Thread-4 (]: Runtime Error in test not_null_stg_transaction_device_id (models/staging/stg_transaction.yml)
  connection never acquired for thread (66312, 6205943808), have []
[0m23:08:52.145375 [debug] [Thread-3 (]: Finished running node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m23:08:52.146121 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_transaction_amount_eur (models/staging/stg_transaction.yml)
  connection never acquired for thread (66312, 6153744384), have []
[0m23:08:52.146679 [debug] [Thread-4 (]: Finished running node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m23:08:52.146883 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_transaction_id (models/staging/stg_transaction.yml)
  connection never acquired for thread (66312, 6170570752), have []
[0m23:08:52.147264 [debug] [Thread-3 (]: Began running node test.sumup.not_null_stg_transaction_status.87ab6c4b42
[0m23:08:52.147449 [debug] [Thread-7 (]: Marking all children of 'test.sumup.not_null_stg_transaction_card_number.fb1135c280' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transaction_card_number (models/staging/stg_transaction.yml)
  connection never acquired for thread (66312, 6187397120), have [].
[0m23:08:52.147661 [debug] [Thread-1 (]: Finished running node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m23:08:52.147836 [debug] [Thread-4 (]: Began running node test.sumup.unique_stg_transaction_id.f181c9397b
[0m23:08:52.148051 [debug] [Thread-2 (]: Finished running node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m23:08:52.148255 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.sumup.not_null_stg_transaction_status.87ab6c4b42'
[0m23:08:52.148419 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:08:52.148620 [debug] [Thread-7 (]: Marking all children of 'test.sumup.not_null_stg_transaction_device_id.b84ae0844e' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transaction_device_id (models/staging/stg_transaction.yml)
  connection never acquired for thread (66312, 6205943808), have [].
[0m23:08:52.148834 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.sumup.unique_stg_transaction_id.f181c9397b'
[0m23:08:52.149013 [debug] [Thread-3 (]: Began compiling node test.sumup.not_null_stg_transaction_status.87ab6c4b42
[0m23:08:52.149438 [debug] [Thread-4 (]: Began compiling node test.sumup.unique_stg_transaction_id.f181c9397b
[0m23:08:52.150915 [debug] [Thread-3 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_status.87ab6c4b42"
[0m23:08:52.153354 [debug] [Thread-4 (]: Writing injected SQL for node "test.sumup.unique_stg_transaction_id.f181c9397b"
[0m23:09:35.008718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082e4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091239d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109123c50>]}


============================== 23:09:35.011810 | 70a12776-ec7a-488f-9b16-a8342b6f908f ==============================
[0m23:09:35.011810 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:09:35.012077 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'use_colors': 'True', 'no_print': 'None', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'fail_fast': 'False', 'printer_width': '80', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'write_json': 'True', 'invocation_command': 'dbt show --select +customer_store_ranking', 'empty': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'quiet': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'partial_parse': 'True', 'warn_error': 'None'}
[0m23:09:35.102655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70a12776-ec7a-488f-9b16-a8342b6f908f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108447950>]}
[0m23:09:35.125852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70a12776-ec7a-488f-9b16-a8342b6f908f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fbacf0>]}
[0m23:09:35.136480 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:09:35.179505 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:09:35.265055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:09:35.265483 [debug] [MainThread]: Partial parsing: updated file: sumup://models/staging/stg_transaction.yml
[0m23:09:35.413358 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_expectations.expression_is_true`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m23:09:35.413636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '70a12776-ec7a-488f-9b16-a8342b6f908f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a112250>]}
[0m23:09:35.451153 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m23:09:35.453205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70a12776-ec7a-488f-9b16-a8342b6f908f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de3a70>]}
[0m23:09:35.486123 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m23:09:35.487201 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m23:09:35.488422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70a12776-ec7a-488f-9b16-a8342b6f908f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e8b930>]}
[0m23:09:35.488590 [info ] [MainThread]: Found 9 models, 3 seeds, 10 data tests, 447 macros
[0m23:09:35.488714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70a12776-ec7a-488f-9b16-a8342b6f908f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a55c1f0>]}
[0m23:09:35.489521 [info ] [MainThread]: 
[0m23:09:35.489652 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:09:35.489752 [info ] [MainThread]: 
[0m23:09:35.489937 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:09:35.491606 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m23:09:35.495663 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m23:09:35.496613 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m23:09:35.518143 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m23:09:35.518344 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m23:09:35.518509 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m23:09:35.518659 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m23:09:35.518780 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m23:09:35.518905 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m23:09:35.519028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:35.519141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:35.519258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:35.543241 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m23:09:35.543425 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m23:09:35.543560 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m23:09:35.543696 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m23:09:35.543849 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m23:09:35.543981 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m23:09:35.544120 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m23:09:35.544254 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m23:09:35.544415 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:09:35.549862 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m23:09:35.549984 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m23:09:35.550090 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m23:09:35.550676 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m23:09:35.551144 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m23:09:35.551581 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m23:09:35.551828 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m23:09:35.551941 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m23:09:35.552049 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m23:09:35.554721 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:35.554844 [debug] [MainThread]: On master: BEGIN
[0m23:09:35.554940 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:09:35.559073 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m23:09:35.559185 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:35.559317 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:09:35.563725 [debug] [MainThread]: SQL status: SELECT 5 in 0.004 seconds
[0m23:09:35.564446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70a12776-ec7a-488f-9b16-a8342b6f908f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a45b4d0>]}
[0m23:09:35.564593 [debug] [MainThread]: On master: ROLLBACK
[0m23:09:35.564801 [debug] [MainThread]: On master: Close
[0m23:09:35.566026 [debug] [Thread-2 (]: Began running node seed.sumup.store
[0m23:09:35.566178 [debug] [Thread-3 (]: Began running node seed.sumup.transaction
[0m23:09:35.566304 [debug] [Thread-1 (]: Began running node seed.sumup.device
[0m23:09:35.566481 [info ] [Thread-2 (]: 2 of 18 START seed file analytics.store ........................................ [RUN]
[0m23:09:35.566706 [info ] [Thread-3 (]: 3 of 18 START seed file analytics.transaction .................................. [RUN]
[0m23:09:35.566892 [info ] [Thread-1 (]: 1 of 18 START seed file analytics.device ....................................... [RUN]
[0m23:09:35.567057 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now seed.sumup.store)
[0m23:09:35.567189 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now seed.sumup.transaction)
[0m23:09:35.567317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now seed.sumup.device)
[0m23:09:35.567445 [debug] [Thread-2 (]: Began compiling node seed.sumup.store
[0m23:09:35.567565 [debug] [Thread-3 (]: Began compiling node seed.sumup.transaction
[0m23:09:35.567680 [debug] [Thread-1 (]: Began compiling node seed.sumup.device
[0m23:09:35.567803 [debug] [Thread-2 (]: Began executing node seed.sumup.store
[0m23:09:35.567927 [debug] [Thread-3 (]: Began executing node seed.sumup.transaction
[0m23:09:35.568072 [debug] [Thread-1 (]: Began executing node seed.sumup.device
[0m23:09:35.583714 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m23:09:35.585852 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m23:09:35.585992 [debug] [Thread-2 (]: On seed.sumup.store: BEGIN
[0m23:09:35.601640 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m23:09:35.601782 [debug] [Thread-1 (]: On seed.sumup.device: BEGIN
[0m23:09:35.601912 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:09:35.602039 [debug] [Thread-3 (]: On seed.sumup.transaction: BEGIN
[0m23:09:35.602160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:09:35.602343 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:09:35.607735 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m23:09:35.607859 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m23:09:35.607977 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m23:09:35.608118 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m23:09:35.608240 [debug] [Thread-2 (]: On seed.sumup.store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.store"} */
truncate table "postgres"."analytics"."store"
[0m23:09:35.608360 [debug] [Thread-1 (]: On seed.sumup.device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.device"} */
truncate table "postgres"."analytics"."device"
[0m23:09:35.608483 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m23:09:35.608629 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m23:09:35.608740 [debug] [Thread-3 (]: On seed.sumup.transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.transaction"} */
truncate table "postgres"."analytics"."transaction"
[0m23:09:35.609944 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.001 seconds
[0m23:09:35.617250 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.009 seconds
[0m23:09:35.617403 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0.009 seconds
[0m23:09:35.690329 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m23:09:35.703048 [debug] [Thread-1 (]: On seed.sumup.device: 
          insert into "postgres"."analytics"."device" ("id", "type", "store_id") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s...
[0m23:09:35.717371 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m23:09:35.723803 [debug] [Thread-1 (]: SQL status: INSERT 0 200 in 0.008 seconds
[0m23:09:35.736329 [debug] [Thread-2 (]: On seed.sumup.store: 
          insert into "postgres"."analytics"."store" ("id", "name", "address", "city", "country", "created_at", "typology", "customer_id") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%...
[0m23:09:35.757354 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.sumup.device"
[0m23:09:35.790702 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.017 seconds
[0m23:09:35.803370 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.sumup.store"
[0m23:09:35.833969 [debug] [Thread-1 (]: On seed.sumup.device: COMMIT
[0m23:09:35.834147 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m23:09:35.834280 [debug] [Thread-1 (]: On seed.sumup.device: COMMIT
[0m23:09:35.846988 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m23:09:35.847737 [debug] [Thread-2 (]: On seed.sumup.store: COMMIT
[0m23:09:35.860066 [debug] [Thread-1 (]: On seed.sumup.device: Close
[0m23:09:35.878247 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m23:09:35.908092 [debug] [Thread-2 (]: On seed.sumup.store: COMMIT
[0m23:09:35.926886 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m23:09:35.927209 [debug] [Thread-2 (]: On seed.sumup.store: Close
[0m23:09:35.946250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70a12776-ec7a-488f-9b16-a8342b6f908f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a297070>]}
[0m23:09:35.959072 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70a12776-ec7a-488f-9b16-a8342b6f908f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1689b0>]}
[0m23:09:35.952615 [info ] [Thread-1 (]: 1 of 18 OK loaded seed file analytics.device ................................... [[32mINSERT 200[0m in 0.34s]
[0m23:09:35.978257 [debug] [Thread-1 (]: Finished running node seed.sumup.device
[0m23:09:35.965618 [info ] [Thread-2 (]: 2 of 18 OK loaded seed file analytics.store .................................... [[32mINSERT 100[0m in 0.39s]
[0m23:09:35.984580 [debug] [Thread-2 (]: Finished running node seed.sumup.store
[0m23:09:36.009511 [debug] [Thread-4 (]: Began running node model.sumup.stg_device
[0m23:09:36.015719 [debug] [Thread-1 (]: Began running node model.sumup.stg_store
[0m23:09:36.015922 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.sumup.stg_device'
[0m23:09:36.034506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.sumup.device, now model.sumup.stg_store)
[0m23:09:36.058734 [debug] [Thread-4 (]: Began compiling node model.sumup.stg_device
[0m23:09:36.077515 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_store
[0m23:09:36.099309 [debug] [Thread-4 (]: Writing injected SQL for node "model.sumup.stg_device"
[0m23:09:36.116120 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_store"
[0m23:09:36.172021 [debug] [Thread-4 (]: Began executing node model.sumup.stg_device
[0m23:09:36.172167 [debug] [Thread-1 (]: Began executing node model.sumup.stg_store
[0m23:09:36.187177 [debug] [Thread-4 (]: Using postgres connection "model.sumup.stg_device"
[0m23:09:36.204233 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_store"
[0m23:09:36.228001 [debug] [Thread-4 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */

  
  

SELECT
    -- Primary Key
    id AS device_id,

    -- Foreign Key to stores (assuming this links the device to a specific store)
    store_id,

    -- Descriptive Attributes
    type as device_type
    
    -- Other fields, if any, standardized here
    -- e.g., CAST(status AS VARCHAR) AS device_status

    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-21 21:09:34.998325+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."device"
  
  limit 5

[0m23:09:36.244990 [debug] [Thread-1 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */

  
  

SELECT
    -- Primary Key: Rename to be explicit
    id AS store_id,
    name AS store_name,

    -- Descriptive Attributes: Rename 'typology' for clarity
    typology AS store_typology,
    country,
    city
    
    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-21 21:09:34.998325+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."store"
  
  limit 5

[0m23:09:36.270036 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:09:36.288810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:09:36.338493 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.068 seconds
[0m23:09:36.344926 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.056 seconds
[0m23:09:36.345453 [debug] [Thread-4 (]: On model.sumup.stg_device: Close
[0m23:09:36.363986 [debug] [Thread-1 (]: On model.sumup.stg_store: Close
[0m23:09:36.388873 [debug] [Thread-4 (]: Finished running node model.sumup.stg_device
[0m23:09:36.407625 [debug] [Thread-1 (]: Finished running node model.sumup.stg_store
[0m23:09:36.509646 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m23:09:36.509792 [debug] [Thread-3 (]: On seed.sumup.transaction: 
          insert into "postgres"."analytics"."transaction" ("id", "device_id", "product_name", "product_sku", "category_name", "amount", "status", "card_number", "cvv", "created_at", "happened_at") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m23:09:36.541554 [debug] [Thread-3 (]: SQL status: INSERT 0 1500 in 0.032 seconds
[0m23:09:36.541900 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.sumup.transaction"
[0m23:09:36.543063 [debug] [Thread-3 (]: On seed.sumup.transaction: COMMIT
[0m23:09:36.543201 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m23:09:36.543322 [debug] [Thread-3 (]: On seed.sumup.transaction: COMMIT
[0m23:09:36.545035 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m23:09:36.545297 [debug] [Thread-3 (]: On seed.sumup.transaction: Close
[0m23:09:36.545506 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70a12776-ec7a-488f-9b16-a8342b6f908f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7e3550>]}
[0m23:09:36.545713 [info ] [Thread-3 (]: 3 of 18 OK loaded seed file analytics.transaction .............................. [[32mINSERT 1500[0m in 0.98s]
[0m23:09:36.545910 [debug] [Thread-3 (]: Finished running node seed.sumup.transaction
[0m23:09:36.546146 [debug] [Thread-2 (]: Began running node model.sumup.stg_transaction
[0m23:09:36.546327 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.sumup.store, now model.sumup.stg_transaction)
[0m23:09:36.546489 [debug] [Thread-2 (]: Began compiling node model.sumup.stg_transaction
[0m23:09:36.547861 [debug] [Thread-2 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m23:09:36.548130 [debug] [Thread-2 (]: Began executing node model.sumup.stg_transaction
[0m23:09:36.549221 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_transaction"
[0m23:09:36.549381 [debug] [Thread-2 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  
  SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) AS amount_eur,
    LOWER(status) AS status,

    -- Card Information 
    REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '') AS card_number,
    CAST(cvv AS VARCHAR) AS cvv,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  
  limit 5

[0m23:09:36.549530 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:09:36.555004 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.005 seconds
[0m23:09:36.555698 [debug] [Thread-2 (]: On model.sumup.stg_transaction: Close
[0m23:09:36.555972 [debug] [Thread-2 (]: Finished running node model.sumup.stg_transaction
[0m23:09:36.556314 [debug] [Thread-3 (]: Began running node test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3
[0m23:09:36.556464 [debug] [Thread-4 (]: Began running node model.sumup.int_transaction
[0m23:09:36.556598 [debug] [Thread-1 (]: Began running node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m23:09:36.556733 [debug] [Thread-2 (]: Began running node test.sumup.dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed.1150af2be1
[0m23:09:36.556872 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.sumup.transaction, now test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3)
[0m23:09:36.557031 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.sumup.stg_device, now model.sumup.int_transaction)
[0m23:09:36.557189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.stg_store, now test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad)
[0m23:09:36.557344 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sumup.stg_transaction, now test.sumup.dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed.1150af2be1)
[0m23:09:36.557487 [debug] [Thread-3 (]: Began compiling node test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3
[0m23:09:36.557629 [debug] [Thread-4 (]: Began compiling node model.sumup.int_transaction
[0m23:09:36.557763 [debug] [Thread-1 (]: Began compiling node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m23:09:36.557899 [debug] [Thread-2 (]: Began compiling node test.sumup.dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed.1150af2be1
[0m23:09:36.562448 [debug] [Thread-4 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m23:09:36.563877 [debug] [Thread-1 (]: Writing injected SQL for node "test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad"
[0m23:09:36.565974 [debug] [Thread-1 (]: Began executing node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m23:09:36.567017 [debug] [Thread-1 (]: Using postgres connection "test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad"
[0m23:09:36.567225 [debug] [Thread-4 (]: Began executing node model.sumup.int_transaction
[0m23:09:36.567377 [debug] [Thread-1 (]: On test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad"} */

  
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "postgres"."analytics_staging"."stg_transaction"
    group by status

)

select *
from all_values
where value_field not in (
    'accepted','refused','cancelled'
)



  
  limit 5

[0m23:09:36.568703 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m23:09:36.568852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:09:36.569060 [debug] [Thread-4 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

  
  

SELECT
    -- Primary and Foreign Keys
    transaction_id,
    t.device_id,

    -- Product Information
   
    CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA  AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data and Status
    amount_eur,
    status,

    --device data
    d.device_type,
    
    -- store_data
    d.store_id,
    store_name,
    store_typology,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction" t
LEFT JOIN "postgres"."analytics_staging"."stg_device" d ON t.device_id = d.device_id
LEFT JOIN "postgres"."analytics_staging"."stg_store" s ON d.store_id = s.store_id

-- Incremental Logic: Only select new records for subsequent runs

    WHERE t.created_at_utc > (SELECT MAX(created_at_utc) FROM "postgres"."analytics_analytics"."int_transaction")

  
  limit 5

[0m23:09:36.569319 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:09:36.573711 [debug] [Thread-3 (]: Compilation Error in test dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13 (models/staging/stg_transaction.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:09:36.573981 [debug] [Thread-3 (]: Finished running node test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3
[0m23:09:36.574553 [debug] [Thread-2 (]: Compilation Error in test dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed (models/staging/stg_transaction.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:09:36.574758 [debug] [Thread-3 (]: Began running node test.sumup.dbt_expectations_expression_is_true_stg_transaction_amount_eur___0.3bf59a08a8
[0m23:09:36.574934 [debug] [Thread-7 (]: Marking all children of 'test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13 (models/staging/stg_transaction.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m23:09:36.575144 [debug] [Thread-2 (]: Finished running node test.sumup.dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed.1150af2be1
[0m23:09:36.575312 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3, now test.sumup.dbt_expectations_expression_is_true_stg_transaction_amount_eur___0.3bf59a08a8)
[0m23:09:36.575786 [debug] [Thread-2 (]: Began running node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m23:09:36.575948 [debug] [Thread-7 (]: Marking all children of 'test.sumup.dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed.1150af2be1' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed (models/staging/stg_transaction.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m23:09:36.576091 [debug] [Thread-3 (]: Began compiling node test.sumup.dbt_expectations_expression_is_true_stg_transaction_amount_eur___0.3bf59a08a8
[0m23:09:36.576242 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sumup.dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed.1150af2be1, now test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411)
[0m23:09:36.577854 [debug] [Thread-2 (]: Began compiling node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m23:09:36.580889 [debug] [Thread-2 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411"
[0m23:09:36.581086 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.012 seconds
[0m23:09:36.581222 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.012 seconds
[0m23:09:36.581907 [debug] [Thread-1 (]: On test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad: Close
[0m23:09:36.582415 [debug] [Thread-4 (]: On model.sumup.int_transaction: Close
[0m23:09:36.583046 [debug] [Thread-3 (]: Compilation Error in test dbt_expectations_expression_is_true_stg_transaction_amount_eur___0 (models/staging/stg_transaction.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:09:36.583358 [debug] [Thread-1 (]: Finished running node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m23:09:36.583595 [debug] [Thread-4 (]: Finished running node model.sumup.int_transaction
[0m23:09:36.583780 [debug] [Thread-3 (]: Finished running node test.sumup.dbt_expectations_expression_is_true_stg_transaction_amount_eur___0.3bf59a08a8
[0m23:09:36.583903 [debug] [Thread-2 (]: Began executing node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m23:09:36.584046 [debug] [Thread-1 (]: Began running node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m23:09:36.584204 [debug] [Thread-4 (]: Began running node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m23:09:36.584381 [debug] [Thread-3 (]: Began running node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m23:09:36.584480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:09:36.584631 [debug] [Thread-7 (]: Marking all children of 'test.sumup.dbt_expectations_expression_is_true_stg_transaction_amount_eur___0.3bf59a08a8' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expression_is_true_stg_transaction_amount_eur___0 (models/staging/stg_transaction.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m23:09:36.585764 [debug] [MainThread]: Connection 'test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad' was properly closed.
[0m23:09:36.585891 [debug] [MainThread]: Connection 'test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411' was properly closed.
[0m23:09:36.585981 [debug] [MainThread]: Connection 'test.sumup.dbt_expectations_expression_is_true_stg_transaction_amount_eur___0.3bf59a08a8' was properly closed.
[0m23:09:36.586060 [debug] [MainThread]: Connection 'model.sumup.int_transaction' was properly closed.
[0m23:09:36.586204 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test dbt_expectations_expression_is_true_stg_transaction_amount_eur___0 (models/staging/stg_transaction.yml)
    'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:09:36.586399 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.sumup.not_null_stg_transaction_card_number.fb1135c280'
[0m23:09:36.586737 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.sumup.not_null_stg_transaction_device_id.b84ae0844e'
[0m23:09:36.586878 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.sumup.not_null_stg_transaction_id.f3ec2fc021'
[0m23:09:36.586603 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:09:36.587046 [debug] [Thread-1 (]: Began compiling node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m23:09:36.587301 [debug] [Thread-4 (]: Began compiling node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m23:09:36.587443 [debug] [Thread-3 (]: Began compiling node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m23:09:36.588764 [debug] [Thread-1 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_card_number.fb1135c280"
[0m23:09:36.591124 [debug] [Thread-4 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_device_id.b84ae0844e"
[0m23:09:36.592612 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 1.6140854, "process_in_blocks": "0", "process_kernel_time": 0.157848, "process_mem_max_rss": "137281536", "process_out_blocks": "0", "process_user_time": 1.899632}
[0m23:09:36.594039 [debug] [Thread-3 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_id.f3ec2fc021"
[0m23:09:36.594355 [debug] [MainThread]: Command `dbt show` failed at 23:09:36.594316 after 1.62 seconds
[0m23:09:36.594561 [debug] [Thread-1 (]: Began executing node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m23:09:36.594687 [debug] [MainThread]: Connection 'test.sumup.not_null_stg_transaction_card_number.fb1135c280' was properly closed.
[0m23:09:36.595986 [debug] [Thread-3 (]: Began executing node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m23:09:36.596112 [debug] [MainThread]: Connection 'test.sumup.not_null_stg_transaction_device_id.b84ae0844e' was properly closed.
[0m23:09:36.596248 [debug] [Thread-4 (]: Began executing node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m23:09:36.597240 [debug] [MainThread]: Connection 'test.sumup.not_null_stg_transaction_id.f3ec2fc021' was properly closed.
[0m23:09:36.598247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091b83d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acaea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a50fb90>]}
[0m23:09:36.598949 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_transaction_amount_eur (models/staging/stg_transaction.yml)
  connection never acquired for thread (66453, 6144716800), have []
[0m23:09:36.599068 [debug] [MainThread]: Flushing usage events
[0m23:09:36.599667 [debug] [Thread-2 (]: Finished running node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m23:09:36.600040 [debug] [Thread-2 (]: Began running node test.sumup.not_null_stg_transaction_status.87ab6c4b42
[0m23:09:36.600213 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.sumup.not_null_stg_transaction_status.87ab6c4b42'
[0m23:09:36.600385 [debug] [Thread-7 (]: Marking all children of 'test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transaction_amount_eur (models/staging/stg_transaction.yml)
  connection never acquired for thread (66453, 6144716800), have [].
[0m23:09:36.600887 [debug] [Thread-4 (]: Runtime Error in test not_null_stg_transaction_device_id (models/staging/stg_transaction.yml)
  connection never acquired for thread (66453, 6179516416), have []
[0m23:09:36.601357 [debug] [Thread-3 (]: Runtime Error in test not_null_stg_transaction_id (models/staging/stg_transaction.yml)
  connection never acquired for thread (66453, 6161543168), have []
[0m23:09:36.601818 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_transaction_card_number (models/staging/stg_transaction.yml)
  connection never acquired for thread (66453, 6127890432), have []
[0m23:09:36.601941 [debug] [Thread-2 (]: Began compiling node test.sumup.not_null_stg_transaction_status.87ab6c4b42
[0m23:09:36.602188 [debug] [Thread-4 (]: Finished running node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m23:09:36.602392 [debug] [Thread-3 (]: Finished running node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m23:09:36.602866 [debug] [Thread-1 (]: Finished running node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m23:09:36.604515 [debug] [Thread-2 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_status.87ab6c4b42"
[0m23:09:36.604766 [debug] [Thread-4 (]: Began running node test.sumup.unique_stg_transaction_id.f181c9397b
[0m23:09:36.605033 [debug] [Thread-7 (]: Marking all children of 'test.sumup.not_null_stg_transaction_device_id.b84ae0844e' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transaction_device_id (models/staging/stg_transaction.yml)
  connection never acquired for thread (66453, 6179516416), have [].
[0m23:09:36.605743 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.sumup.unique_stg_transaction_id.f181c9397b'
[0m23:09:36.605975 [debug] [Thread-7 (]: Marking all children of 'test.sumup.not_null_stg_transaction_id.f3ec2fc021' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transaction_id (models/staging/stg_transaction.yml)
  connection never acquired for thread (66453, 6161543168), have [].
[0m23:09:36.606148 [debug] [Thread-4 (]: Began compiling node test.sumup.unique_stg_transaction_id.f181c9397b
[0m23:09:36.606344 [debug] [Thread-7 (]: Marking all children of 'test.sumup.not_null_stg_transaction_card_number.fb1135c280' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transaction_card_number (models/staging/stg_transaction.yml)
  connection never acquired for thread (66453, 6127890432), have [].
[0m23:09:36.606483 [debug] [Thread-2 (]: Began executing node test.sumup.not_null_stg_transaction_status.87ab6c4b42
[0m23:09:36.608709 [debug] [Thread-4 (]: Writing injected SQL for node "test.sumup.unique_stg_transaction_id.f181c9397b"
[0m23:09:36.608857 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:09:36.610067 [debug] [Thread-2 (]: Using postgres connection "test.sumup.not_null_stg_transaction_status.87ab6c4b42"
[0m23:09:36.610495 [debug] [Thread-2 (]: On test.sumup.not_null_stg_transaction_status.87ab6c4b42: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.not_null_stg_transaction_status.87ab6c4b42"} */

  
  
    
    



select status
from "postgres"."analytics_staging"."stg_transaction"
where status is null



  
  limit 5

[0m23:09:36.610640 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:09:36.610772 [debug] [Thread-4 (]: Began executing node test.sumup.unique_stg_transaction_id.f181c9397b
[0m23:09:36.611887 [debug] [Thread-4 (]: Using postgres connection "test.sumup.unique_stg_transaction_id.f181c9397b"
[0m23:09:36.612033 [debug] [Thread-4 (]: On test.sumup.unique_stg_transaction_id.f181c9397b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.unique_stg_transaction_id.f181c9397b"} */

  
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."analytics_staging"."stg_transaction"
where id is not null
group by id
having count(*) > 1



  
  limit 5

[0m23:09:36.612166 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:09:58.436497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d14050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106333c50>]}


============================== 23:09:58.439058 | 20afbdd8-8b7f-4b02-80ba-2929713d37ec ==============================
[0m23:09:58.439058 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:09:58.439318 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'invocation_command': 'dbt show --select +customer_store_ranking', 'log_format': 'default', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'quiet': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'write_json': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'debug': 'False', 'empty': 'None', 'target_path': 'None'}
[0m23:09:58.521012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20afbdd8-8b7f-4b02-80ba-2929713d37ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10525b950>]}
[0m23:09:58.542849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20afbdd8-8b7f-4b02-80ba-2929713d37ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060cacf0>]}
[0m23:09:58.552592 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:09:58.593553 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:09:58.656860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:09:58.657270 [debug] [MainThread]: Partial parsing: updated file: sumup://models/staging/stg_transaction.yml
[0m23:09:58.817522 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_expectations.expression_is_true`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m23:09:58.817826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '20afbdd8-8b7f-4b02-80ba-2929713d37ec', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107175f50>]}
[0m23:09:58.855624 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m23:09:58.857695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20afbdd8-8b7f-4b02-80ba-2929713d37ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10724bc50>]}
[0m23:09:58.891216 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m23:09:58.892371 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m23:09:58.893870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20afbdd8-8b7f-4b02-80ba-2929713d37ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069489f0>]}
[0m23:09:58.894042 [info ] [MainThread]: Found 9 models, 3 seeds, 9 data tests, 447 macros
[0m23:09:58.894175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20afbdd8-8b7f-4b02-80ba-2929713d37ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11014c6d0>]}
[0m23:09:58.894958 [info ] [MainThread]: 
[0m23:09:58.895092 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:09:58.895199 [info ] [MainThread]: 
[0m23:09:58.895386 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:09:58.897025 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m23:09:58.901097 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m23:09:58.902100 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m23:09:58.922578 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m23:09:58.922752 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m23:09:58.922909 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m23:09:58.923060 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m23:09:58.923186 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m23:09:58.923314 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m23:09:58.923442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:58.923557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:58.923660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:58.941462 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m23:09:58.941655 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m23:09:58.941775 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m23:09:58.941898 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m23:09:58.942023 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m23:09:58.942135 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m23:09:58.942265 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m23:09:58.942406 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m23:09:58.942539 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:09:58.948242 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m23:09:58.948374 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m23:09:58.948474 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m23:09:58.949009 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m23:09:58.949438 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m23:09:58.949828 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m23:09:58.950076 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m23:09:58.950198 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m23:09:58.950304 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m23:09:58.952952 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:58.953083 [debug] [MainThread]: On master: BEGIN
[0m23:09:58.953266 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:09:58.958285 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:09:58.958405 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:58.958541 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:09:58.964633 [debug] [MainThread]: SQL status: SELECT 5 in 0.006 seconds
[0m23:09:58.965397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20afbdd8-8b7f-4b02-80ba-2929713d37ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10762f590>]}
[0m23:09:58.965552 [debug] [MainThread]: On master: ROLLBACK
[0m23:09:58.965771 [debug] [MainThread]: On master: Close
[0m23:09:58.966886 [debug] [Thread-3 (]: Began running node seed.sumup.transaction
[0m23:09:58.967037 [debug] [Thread-2 (]: Began running node seed.sumup.store
[0m23:09:58.967178 [debug] [Thread-1 (]: Began running node seed.sumup.device
[0m23:09:58.967373 [info ] [Thread-3 (]: 3 of 17 START seed file analytics.transaction .................................. [RUN]
[0m23:09:58.967574 [info ] [Thread-2 (]: 2 of 17 START seed file analytics.store ........................................ [RUN]
[0m23:09:58.967767 [info ] [Thread-1 (]: 1 of 17 START seed file analytics.device ....................................... [RUN]
[0m23:09:58.967943 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now seed.sumup.transaction)
[0m23:09:58.968092 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now seed.sumup.store)
[0m23:09:58.968238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now seed.sumup.device)
[0m23:09:58.968375 [debug] [Thread-3 (]: Began compiling node seed.sumup.transaction
[0m23:09:58.968502 [debug] [Thread-2 (]: Began compiling node seed.sumup.store
[0m23:09:58.968625 [debug] [Thread-1 (]: Began compiling node seed.sumup.device
[0m23:09:58.968757 [debug] [Thread-3 (]: Began executing node seed.sumup.transaction
[0m23:09:58.968885 [debug] [Thread-2 (]: Began executing node seed.sumup.store
[0m23:09:58.969011 [debug] [Thread-1 (]: Began executing node seed.sumup.device
[0m23:09:58.984635 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m23:09:58.986712 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m23:09:58.986880 [debug] [Thread-2 (]: On seed.sumup.store: BEGIN
[0m23:09:58.987106 [debug] [Thread-1 (]: On seed.sumup.device: BEGIN
[0m23:09:59.002715 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m23:09:59.002852 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:09:59.002975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:09:59.003125 [debug] [Thread-3 (]: On seed.sumup.transaction: BEGIN
[0m23:09:59.003399 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:09:59.008850 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m23:09:59.009001 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m23:09:59.009130 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m23:09:59.009254 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m23:09:59.009376 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m23:09:59.009491 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m23:09:59.009607 [debug] [Thread-1 (]: On seed.sumup.device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.device"} */
truncate table "postgres"."analytics"."device"
[0m23:09:59.009727 [debug] [Thread-2 (]: On seed.sumup.store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.store"} */
truncate table "postgres"."analytics"."store"
[0m23:09:59.009840 [debug] [Thread-3 (]: On seed.sumup.transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.transaction"} */
truncate table "postgres"."analytics"."transaction"
[0m23:09:59.010883 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.001 seconds
[0m23:09:59.018084 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.008 seconds
[0m23:09:59.030617 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0.021 seconds
[0m23:09:59.095813 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m23:09:59.108517 [debug] [Thread-1 (]: On seed.sumup.device: 
          insert into "postgres"."analytics"."device" ("id", "type", "store_id") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s...
[0m23:09:59.117793 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m23:09:59.132947 [debug] [Thread-1 (]: SQL status: INSERT 0 200 in 0.015 seconds
[0m23:09:59.145458 [debug] [Thread-2 (]: On seed.sumup.store: 
          insert into "postgres"."analytics"."store" ("id", "name", "address", "city", "country", "created_at", "typology", "customer_id") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%...
[0m23:09:59.166485 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.sumup.device"
[0m23:09:59.197839 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.009 seconds
[0m23:09:59.210687 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.sumup.store"
[0m23:09:59.240832 [debug] [Thread-2 (]: On seed.sumup.store: COMMIT
[0m23:09:59.253133 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m23:09:59.259949 [debug] [Thread-1 (]: On seed.sumup.device: COMMIT
[0m23:09:59.260079 [debug] [Thread-2 (]: On seed.sumup.store: COMMIT
[0m23:09:59.278869 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m23:09:59.306130 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m23:09:59.306265 [debug] [Thread-1 (]: On seed.sumup.device: COMMIT
[0m23:09:59.319389 [debug] [Thread-2 (]: On seed.sumup.store: Close
[0m23:09:59.357743 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m23:09:59.389142 [debug] [Thread-1 (]: On seed.sumup.device: Close
[0m23:09:59.445672 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20afbdd8-8b7f-4b02-80ba-2929713d37ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10734fcd0>]}
[0m23:09:59.445841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20afbdd8-8b7f-4b02-80ba-2929713d37ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105215db0>]}
[0m23:09:59.458464 [info ] [Thread-2 (]: 2 of 17 OK loaded seed file analytics.store .................................... [[32mINSERT 100[0m in 0.41s]
[0m23:09:59.464977 [info ] [Thread-1 (]: 1 of 17 OK loaded seed file analytics.device ................................... [[32mINSERT 200[0m in 0.43s]
[0m23:09:59.489858 [debug] [Thread-2 (]: Finished running node seed.sumup.store
[0m23:09:59.508584 [debug] [Thread-1 (]: Finished running node seed.sumup.device
[0m23:09:59.526265 [debug] [Thread-4 (]: Began running node model.sumup.stg_store
[0m23:09:59.532419 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.sumup.stg_store'
[0m23:09:59.532603 [debug] [Thread-4 (]: Began compiling node model.sumup.stg_store
[0m23:09:59.535662 [debug] [Thread-4 (]: Writing injected SQL for node "model.sumup.stg_store"
[0m23:09:59.535811 [debug] [Thread-2 (]: Began running node model.sumup.stg_device
[0m23:09:59.554687 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.sumup.store, now model.sumup.stg_device)
[0m23:09:59.554829 [debug] [Thread-2 (]: Began compiling node model.sumup.stg_device
[0m23:09:59.561886 [debug] [Thread-2 (]: Writing injected SQL for node "model.sumup.stg_device"
[0m23:09:59.586466 [debug] [Thread-4 (]: Began executing node model.sumup.stg_store
[0m23:09:59.595058 [debug] [Thread-4 (]: Using postgres connection "model.sumup.stg_store"
[0m23:09:59.607830 [debug] [Thread-4 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */

  
  

SELECT
    -- Primary Key: Rename to be explicit
    id AS store_id,
    name AS store_name,

    -- Descriptive Attributes: Rename 'typology' for clarity
    typology AS store_typology,
    country,
    city
    
    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-21 21:09:58.428182+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."store"
  
  limit 5

[0m23:09:59.613966 [debug] [Thread-2 (]: Began executing node model.sumup.stg_device
[0m23:09:59.614090 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:09:59.633792 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_device"
[0m23:09:59.668183 [debug] [Thread-2 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */

  
  

SELECT
    -- Primary Key
    id AS device_id,

    -- Foreign Key to stores (assuming this links the device to a specific store)
    store_id,

    -- Descriptive Attributes
    type as device_type
    
    -- Other fields, if any, standardized here
    -- e.g., CAST(status AS VARCHAR) AS device_status

    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-21 21:09:58.428182+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."device"
  
  limit 5

[0m23:09:59.674617 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.061 seconds
[0m23:09:59.674748 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:09:59.686843 [debug] [Thread-4 (]: On model.sumup.stg_store: Close
[0m23:09:59.724836 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.050 seconds
[0m23:09:59.731195 [debug] [Thread-4 (]: Finished running node model.sumup.stg_store
[0m23:09:59.731664 [debug] [Thread-2 (]: On model.sumup.stg_device: Close
[0m23:09:59.755517 [debug] [Thread-2 (]: Finished running node model.sumup.stg_device
[0m23:09:59.907375 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m23:09:59.907541 [debug] [Thread-3 (]: On seed.sumup.transaction: 
          insert into "postgres"."analytics"."transaction" ("id", "device_id", "product_name", "product_sku", "category_name", "amount", "status", "card_number", "cvv", "created_at", "happened_at") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m23:09:59.932615 [debug] [Thread-3 (]: SQL status: INSERT 0 1500 in 0.025 seconds
[0m23:09:59.932961 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.sumup.transaction"
[0m23:09:59.933777 [debug] [Thread-3 (]: On seed.sumup.transaction: COMMIT
[0m23:09:59.933914 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m23:09:59.934035 [debug] [Thread-3 (]: On seed.sumup.transaction: COMMIT
[0m23:09:59.935576 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:09:59.935828 [debug] [Thread-3 (]: On seed.sumup.transaction: Close
[0m23:09:59.936028 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20afbdd8-8b7f-4b02-80ba-2929713d37ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107cf950>]}
[0m23:09:59.936230 [info ] [Thread-3 (]: 3 of 17 OK loaded seed file analytics.transaction .............................. [[32mINSERT 1500[0m in 0.97s]
[0m23:09:59.936436 [debug] [Thread-3 (]: Finished running node seed.sumup.transaction
[0m23:09:59.936693 [debug] [Thread-1 (]: Began running node model.sumup.stg_transaction
[0m23:09:59.936880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.sumup.device, now model.sumup.stg_transaction)
[0m23:09:59.937029 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_transaction
[0m23:09:59.938334 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m23:09:59.938614 [debug] [Thread-1 (]: Began executing node model.sumup.stg_transaction
[0m23:09:59.939681 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m23:09:59.939834 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  
  SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) AS amount_eur,
    LOWER(status) AS status,

    -- Card Information 
    REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '') AS card_number,
    CAST(cvv AS VARCHAR) AS cvv,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  
  limit 5

[0m23:09:59.939982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:09:59.945379 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m23:09:59.946079 [debug] [Thread-1 (]: On model.sumup.stg_transaction: Close
[0m23:09:59.946379 [debug] [Thread-1 (]: Finished running node model.sumup.stg_transaction
[0m23:09:59.946710 [debug] [Thread-3 (]: Began running node test.sumup.dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed.1150af2be1
[0m23:09:59.946849 [debug] [Thread-4 (]: Began running node model.sumup.int_transaction
[0m23:09:59.946998 [debug] [Thread-2 (]: Began running node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m23:09:59.947150 [debug] [Thread-1 (]: Began running node test.sumup.dbt_expectations_expression_is_true_stg_transaction_amount_eur___0.3bf59a08a8
[0m23:09:59.947294 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.sumup.transaction, now test.sumup.dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed.1150af2be1)
[0m23:09:59.947446 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.sumup.stg_store, now model.sumup.int_transaction)
[0m23:09:59.947588 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sumup.stg_device, now test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad)
[0m23:09:59.947733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.stg_transaction, now test.sumup.dbt_expectations_expression_is_true_stg_transaction_amount_eur___0.3bf59a08a8)
[0m23:09:59.947876 [debug] [Thread-3 (]: Began compiling node test.sumup.dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed.1150af2be1
[0m23:09:59.948008 [debug] [Thread-4 (]: Began compiling node model.sumup.int_transaction
[0m23:09:59.948140 [debug] [Thread-2 (]: Began compiling node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m23:09:59.948271 [debug] [Thread-1 (]: Began compiling node test.sumup.dbt_expectations_expression_is_true_stg_transaction_amount_eur___0.3bf59a08a8
[0m23:09:59.952599 [debug] [Thread-4 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m23:09:59.954211 [debug] [Thread-2 (]: Writing injected SQL for node "test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad"
[0m23:09:59.956405 [debug] [Thread-4 (]: Began executing node model.sumup.int_transaction
[0m23:09:59.957428 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m23:09:59.957619 [debug] [Thread-4 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

  
  

SELECT
    -- Primary and Foreign Keys
    transaction_id,
    t.device_id,

    -- Product Information
   
    CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA  AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data and Status
    amount_eur,
    status,

    --device data
    d.device_type,
    
    -- store_data
    d.store_id,
    store_name,
    store_typology,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction" t
LEFT JOIN "postgres"."analytics_staging"."stg_device" d ON t.device_id = d.device_id
LEFT JOIN "postgres"."analytics_staging"."stg_store" s ON d.store_id = s.store_id

-- Incremental Logic: Only select new records for subsequent runs

    WHERE t.created_at_utc > (SELECT MAX(created_at_utc) FROM "postgres"."analytics_analytics"."int_transaction")

  
  limit 5

[0m23:09:59.957818 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:09:59.957968 [debug] [Thread-2 (]: Began executing node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m23:09:59.959316 [debug] [Thread-2 (]: Using postgres connection "test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad"
[0m23:09:59.959488 [debug] [Thread-2 (]: On test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad"} */

  
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "postgres"."analytics_staging"."stg_transaction"
    group by status

)

select *
from all_values
where value_field not in (
    'accepted','refused','cancelled'
)



  
  limit 5

[0m23:09:59.959659 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:09:59.963933 [debug] [Thread-1 (]: Compilation Error in test dbt_expectations_expression_is_true_stg_transaction_amount_eur___0 (models/staging/stg_transaction.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:09:59.964255 [debug] [Thread-1 (]: Finished running node test.sumup.dbt_expectations_expression_is_true_stg_transaction_amount_eur___0.3bf59a08a8
[0m23:09:59.964661 [debug] [Thread-1 (]: Began running node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m23:09:59.964820 [debug] [Thread-7 (]: Marking all children of 'test.sumup.dbt_expectations_expression_is_true_stg_transaction_amount_eur___0.3bf59a08a8' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expression_is_true_stg_transaction_amount_eur___0 (models/staging/stg_transaction.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m23:09:59.965114 [debug] [Thread-3 (]: Compilation Error in test dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed (models/staging/stg_transaction.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:09:59.965284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sumup.dbt_expectations_expression_is_true_stg_transaction_amount_eur___0.3bf59a08a8, now test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411)
[0m23:09:59.965768 [debug] [Thread-3 (]: Finished running node test.sumup.dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed.1150af2be1
[0m23:09:59.965921 [debug] [Thread-1 (]: Began compiling node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m23:09:59.966090 [debug] [Thread-3 (]: Began running node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m23:09:59.966252 [debug] [Thread-7 (]: Marking all children of 'test.sumup.dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed.1150af2be1' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed (models/staging/stg_transaction.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m23:09:59.969214 [debug] [Thread-1 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411"
[0m23:09:59.969374 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sumup.dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed.1150af2be1, now test.sumup.not_null_stg_transaction_card_number.fb1135c280)
[0m23:09:59.969574 [debug] [Thread-3 (]: Began compiling node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m23:09:59.970920 [debug] [Thread-3 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_card_number.fb1135c280"
[0m23:09:59.971071 [debug] [Thread-1 (]: Began executing node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m23:09:59.972270 [debug] [Thread-1 (]: Using postgres connection "test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411"
[0m23:09:59.972404 [debug] [Thread-1 (]: On test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411"} */

  
  
    
    



select amount_eur
from "postgres"."analytics_staging"."stg_transaction"
where amount_eur is null



  
  limit 5

[0m23:09:59.972522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:09:59.972645 [debug] [Thread-3 (]: Began executing node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m23:09:59.973688 [debug] [Thread-3 (]: Using postgres connection "test.sumup.not_null_stg_transaction_card_number.fb1135c280"
[0m23:09:59.973821 [debug] [Thread-3 (]: On test.sumup.not_null_stg_transaction_card_number.fb1135c280: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.not_null_stg_transaction_card_number.fb1135c280"} */

  
  
    
    



select card_number
from "postgres"."analytics_staging"."stg_transaction"
where card_number is null



  
  limit 5

[0m23:09:59.973947 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:09:59.980696 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.023 seconds
[0m23:09:59.981152 [debug] [Thread-4 (]: On model.sumup.int_transaction: Close
[0m23:09:59.981392 [debug] [Thread-4 (]: Finished running node model.sumup.int_transaction
[0m23:09:59.981526 [debug] [Thread-4 (]: Began running node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m23:09:59.981683 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.sumup.int_transaction, now test.sumup.not_null_stg_transaction_device_id.b84ae0844e)
[0m23:09:59.981796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:09:59.981929 [debug] [Thread-4 (]: Began compiling node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m23:09:59.982026 [debug] [MainThread]: Connection 'test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411' was properly closed.
[0m23:09:59.983963 [debug] [Thread-4 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_device_id.b84ae0844e"
[0m23:09:59.984090 [debug] [MainThread]: Connection 'test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad' was left open.
[0m23:09:59.984239 [debug] [MainThread]: On test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad: Close
[0m23:09:59.984493 [debug] [Thread-4 (]: Began executing node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m23:09:59.991135 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.017 seconds
[0m23:09:59.992119 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.032 seconds
[0m23:09:59.992234 [debug] [MainThread]: Connection 'test.sumup.not_null_stg_transaction_card_number.fb1135c280' was left open.
[0m23:09:59.992368 [debug] [MainThread]: On test.sumup.not_null_stg_transaction_card_number.fb1135c280: Close
[0m23:09:59.992502 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.020 seconds
[0m23:09:59.992921 [debug] [MainThread]: Connection 'test.sumup.not_null_stg_transaction_device_id.b84ae0844e' was properly closed.
[0m23:09:59.993133 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed (models/staging/stg_transaction.yml)
    'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:09:59.993451 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:09:59.993617 [error] [Thread-2 (]: [31mUnhandled error while executing [0m
cursor already closed
[0m23:09:59.994170 [debug] [Thread-3 (]: Finished running node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m23:09:59.994365 [debug] [Thread-3 (]: Began running node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m23:09:59.994605 [debug] [Thread-1 (]: Finished running node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m23:09:59.994765 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.sumup.not_null_stg_transaction_id.f3ec2fc021'
[0m23:09:59.994967 [debug] [Thread-1 (]: Began running node test.sumup.not_null_stg_transaction_status.87ab6c4b42
[0m23:09:59.996338 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 1.5867938, "process_in_blocks": "0", "process_kernel_time": 0.149099, "process_mem_max_rss": "136298496", "process_out_blocks": "0", "process_user_time": 1.90052}
[0m23:09:59.996496 [debug] [Thread-3 (]: Began compiling node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m23:09:59.996749 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.sumup.not_null_stg_transaction_status.87ab6c4b42'
[0m23:09:59.996924 [debug] [MainThread]: Command `dbt show` failed at 23:09:59.996886 after 1.59 seconds
[0m23:09:59.998381 [debug] [Thread-3 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_id.f3ec2fc021"
[0m23:09:59.998519 [debug] [Thread-1 (]: Began compiling node test.sumup.not_null_stg_transaction_status.87ab6c4b42
[0m23:09:59.998701 [debug] [MainThread]: Connection 'test.sumup.not_null_stg_transaction_id.f3ec2fc021' was properly closed.
[0m23:10:00.000495 [debug] [Thread-1 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_status.87ab6c4b42"
[0m23:10:00.000627 [debug] [MainThread]: Connection 'test.sumup.not_null_stg_transaction_status.87ab6c4b42' was properly closed.
[0m23:10:00.000808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150be7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076312b0>]}
[0m23:10:00.001046 [debug] [MainThread]: Flushing usage events
[0m23:10:00.001371 [debug] [Thread-3 (]: Began executing node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m23:10:00.003025 [debug] [Thread-2 (]: Traceback (most recent call last):
  File "/Users/andre/Desktop/sumup/venv/lib/python3.13/site-packages/dbt/task/base.py", line 363, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/andre/Desktop/sumup/venv/lib/python3.13/site-packages/dbt/task/base.py", line 310, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/andre/Desktop/sumup/venv/lib/python3.13/site-packages/dbt/task/base.py", line 410, in run
    return self.execute(compiled_node, manifest)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andre/Desktop/sumup/venv/lib/python3.13/site-packages/dbt/task/show.py", line 42, in execute
    adapter_response, execute_result = self.adapter.execute(
                                       ~~~~~~~~~~~~~~~~~~~~^
        compiled_node.compiled_code, fetch=True
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/andre/Desktop/sumup/venv/lib/python3.13/site-packages/dbt_common/record.py", line 512, in record_replay_wrapper
    return func_to_record(*call_args, **kwargs)
  File "/Users/andre/Desktop/sumup/venv/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 450, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andre/Desktop/sumup/venv/lib/python3.13/site-packages/dbt/adapters/sql/connections.py", line 222, in execute
    table = self.get_result_from_cursor(cursor, limit)
  File "/Users/andre/Desktop/sumup/venv/lib/python3.13/site-packages/dbt/adapters/sql/connections.py", line 204, in get_result_from_cursor
    rows = cursor.fetchall()
psycopg2.InterfaceError: cursor already closed

[0m23:10:00.003222 [debug] [Thread-1 (]: Began executing node test.sumup.not_null_stg_transaction_status.87ab6c4b42
[0m23:10:00.003455 [debug] [Thread-2 (]: Finished running node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m23:10:00.004343 [debug] [Thread-3 (]: Runtime Error in test not_null_stg_transaction_id (models/staging/stg_transaction.yml)
  connection never acquired for thread (66589, 6223785984), have []
[0m23:10:00.004669 [debug] [Thread-4 (]: Runtime Error in test not_null_stg_transaction_device_id (models/staging/stg_transaction.yml)
  connection never acquired for thread (66589, 6241759232), have []
[0m23:10:00.007078 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_transaction_status (models/staging/stg_transaction.yml)
  connection never acquired for thread (66589, 6190133248), have []
[0m23:10:00.007324 [debug] [Thread-2 (]: Began running node test.sumup.unique_stg_transaction_id.f181c9397b
[0m23:10:00.007536 [debug] [Thread-7 (]: Marking all children of 'test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad' to be skipped because of status 'error'.  Reason: cursor already closed.
[0m23:10:00.007915 [debug] [Thread-3 (]: Finished running node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m23:10:00.008247 [debug] [Thread-4 (]: Finished running node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m23:10:00.008466 [debug] [Thread-1 (]: Finished running node test.sumup.not_null_stg_transaction_status.87ab6c4b42
[0m23:10:00.008947 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.sumup.unique_stg_transaction_id.f181c9397b'
[0m23:10:00.009230 [debug] [Thread-7 (]: Marking all children of 'test.sumup.not_null_stg_transaction_id.f3ec2fc021' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transaction_id (models/staging/stg_transaction.yml)
  connection never acquired for thread (66589, 6223785984), have [].
[0m23:10:00.009452 [debug] [Thread-2 (]: Began compiling node test.sumup.unique_stg_transaction_id.f181c9397b
[0m23:10:00.009638 [debug] [Thread-7 (]: Marking all children of 'test.sumup.not_null_stg_transaction_device_id.b84ae0844e' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transaction_device_id (models/staging/stg_transaction.yml)
  connection never acquired for thread (66589, 6241759232), have [].
[0m23:10:00.013052 [debug] [Thread-2 (]: Writing injected SQL for node "test.sumup.unique_stg_transaction_id.f181c9397b"
[0m23:10:00.013252 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:10:00.013476 [debug] [Thread-7 (]: Marking all children of 'test.sumup.not_null_stg_transaction_status.87ab6c4b42' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transaction_status (models/staging/stg_transaction.yml)
  connection never acquired for thread (66589, 6190133248), have [].
[0m08:34:14.697513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039bc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f3c50>]}


============================== 08:34:14.700400 | 64976c8e-eefe-499c-a151-651d666c7950 ==============================
[0m08:34:14.700400 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:34:14.700679 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'target_path': 'None', 'introspect': 'True', 'version_check': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'printer_width': '80', 'fail_fast': 'False', 'use_colors': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'indirect_selection': 'eager', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'warn_error': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'debug': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True'}
[0m08:34:14.749397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64976c8e-eefe-499c-a151-651d666c7950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b1f950>]}
[0m08:34:14.760091 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m08:34:14.760478 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m08:34:14.762238 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.09614975, "process_in_blocks": "0", "process_kernel_time": 0.104065, "process_mem_max_rss": "107757568", "process_out_blocks": "0", "process_user_time": 0.5658}
[0m08:34:14.762424 [debug] [MainThread]: Command `dbt deps` succeeded at 08:34:14.762385 after 0.10 seconds
[0m08:34:14.762559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104692250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104692f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10469ad50>]}
[0m08:34:14.762686 [debug] [MainThread]: Flushing usage events
[0m08:34:15.266519 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:34:46.492129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f14050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642bc50>]}


============================== 08:34:46.495768 | d6903914-1b61-47ff-b5c3-f642c884f405 ==============================
[0m08:34:46.495768 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:34:46.496039 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt deps', 'log_format': 'default', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'introspect': 'True', 'debug': 'False', 'static_parser': 'True', 'empty': 'None', 'version_check': 'True', 'target_path': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'use_colors': 'True', 'cache_selected_only': 'False'}
[0m08:34:46.546338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6903914-1b61-47ff-b5c3-f642c884f405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10535b950>]}
[0m08:34:46.558510 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m08:34:46.559143 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m08:34:46.560419 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.09667717, "process_in_blocks": "0", "process_kernel_time": 0.112702, "process_mem_max_rss": "107659264", "process_out_blocks": "0", "process_user_time": 0.580062}
[0m08:34:46.560593 [debug] [MainThread]: Command `dbt deps` succeeded at 08:34:46.560553 after 0.10 seconds
[0m08:34:46.560726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ca250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061caf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d6d50>]}
[0m08:34:46.560857 [debug] [MainThread]: Flushing usage events
[0m08:34:47.018285 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:34:54.746698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108438050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109273c50>]}


============================== 08:34:54.748986 | 6a8e510a-137b-4a2a-8c99-febac25ffe7b ==============================
[0m08:34:54.748986 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:34:54.749230 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'quiet': 'False', 'target_path': 'None', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'use_experimental_parser': 'False', 'use_colors': 'True', 'debug': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'partial_parse': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'cache_selected_only': 'False', 'warn_error': 'None', 'write_json': 'True'}
[0m08:34:54.792341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a8e510a-137b-4a2a-8c99-febac25ffe7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10859b950>]}
[0m08:34:54.801836 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m08:34:54.802257 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m08:34:54.803461 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.082649544, "process_in_blocks": "0", "process_kernel_time": 0.088047, "process_mem_max_rss": "108036096", "process_out_blocks": "0", "process_user_time": 0.548587}
[0m08:34:54.803652 [debug] [MainThread]: Command `dbt deps` succeeded at 08:34:54.803613 after 0.08 seconds
[0m08:34:54.803783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10910e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10910ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10911ad50>]}
[0m08:34:54.803907 [debug] [MainThread]: Flushing usage events
[0m08:34:55.402236 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:35:15.667086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110914050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e2b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e2bc50>]}


============================== 08:35:15.669799 | 30fbae66-e84e-41df-8d40-88752db0e788 ==============================
[0m08:35:15.669799 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:35:15.670085 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'introspect': 'True', 'target_path': 'None', 'warn_error': 'None', 'fail_fast': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'no_print': 'None', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'printer_width': '80', 'static_parser': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'write_json': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'debug': 'False'}
[0m08:35:15.716968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30fbae66-e84e-41df-8d40-88752db0e788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d57950>]}
[0m08:35:15.727405 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m08:35:15.727986 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m08:35:15.730059 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.09306425, "process_in_blocks": "0", "process_kernel_time": 0.097415, "process_mem_max_rss": "108068864", "process_out_blocks": "0", "process_user_time": 0.562799}
[0m08:35:15.730258 [debug] [MainThread]: Command `dbt deps` succeeded at 08:35:15.730213 after 0.09 seconds
[0m08:35:15.730395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cca250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ccaf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cd2d50>]}
[0m08:35:15.730528 [debug] [MainThread]: Flushing usage events
[0m08:35:16.210458 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:41:44.493877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a50050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10888b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10888bc50>]}


============================== 08:41:44.496689 | 12687470-ca30-437b-8d9d-b538c021e085 ==============================
[0m08:41:44.496689 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:41:44.496960 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'target_path': 'None', 'no_print': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'use_colors': 'True', 'printer_width': '80', 'version_check': 'True', 'debug': 'False', 'empty': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt deps', 'partial_parse': 'True', 'warn_error': 'None', 'write_json': 'True', 'log_format': 'default', 'introspect': 'True', 'cache_selected_only': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m08:41:44.547407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12687470-ca30-437b-8d9d-b538c021e085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb3950>]}
[0m08:41:44.558619 [debug] [MainThread]: Set downloads directory='/var/folders/p3/pftn60p54m3_wj4v5x8kh4k00000gn/T/dbt-downloads-ukw06mwt'
[0m08:41:44.558839 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m08:41:44.676924 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m08:41:44.677956 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m08:41:44.961517 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m08:41:44.965022 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m08:41:44.965694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '12687470-ca30-437b-8d9d-b538c021e085', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108726f10>]}
[0m08:41:44.972900 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m08:41:45.065522 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m08:41:45.087400 [info ] [MainThread]: Updating lock file in file path: /Users/andre/Desktop/sumup/sumup/package-lock.yml
[0m08:41:45.097867 [debug] [MainThread]: Set downloads directory='/var/folders/p3/pftn60p54m3_wj4v5x8kh4k00000gn/T/dbt-downloads-r6bzrw2o'
[0m08:41:45.112839 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m08:41:47.149772 [info ] [MainThread]: Installed from version 0.10.4
[0m08:41:47.150839 [info ] [MainThread]: Up to date!
[0m08:41:47.151088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '12687470-ca30-437b-8d9d-b538c021e085', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a89b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a89650>]}
[0m08:41:47.151292 [info ] [MainThread]: Installing calogica/dbt_date
[0m08:41:47.478579 [info ] [MainThread]: Installed from version 0.10.1
[0m08:41:47.478938 [info ] [MainThread]: Up to date!
[0m08:41:47.479224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '12687470-ca30-437b-8d9d-b538c021e085', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108713020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aa9010>]}
[0m08:41:47.480374 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageRedirectDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:41:47.483088 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.0165985, "process_in_blocks": "0", "process_kernel_time": 0.159133, "process_mem_max_rss": "112738304", "process_out_blocks": "0", "process_user_time": 0.682908}
[0m08:41:47.483457 [debug] [MainThread]: Command `dbt deps` succeeded at 08:41:47.483380 after 3.02 seconds
[0m08:41:47.483685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b3c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108705f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b30710>]}
[0m08:41:47.483895 [debug] [MainThread]: Flushing usage events
[0m08:41:48.071909 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:41:55.785326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a14050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e37c50>]}


============================== 08:41:55.787810 | 54c7a5c9-65cb-4275-8335-24bd377ae874 ==============================
[0m08:41:55.787810 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:41:55.788087 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'printer_width': '80', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'partial_parse': 'True', 'write_json': 'True', 'use_colors': 'True', 'debug': 'False', 'empty': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'warn_error': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'no_print': 'None', 'static_parser': 'True', 'invocation_command': 'dbt show --select +customer_store_ranking', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False'}
[0m08:41:55.873166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54c7a5c9-65cb-4275-8335-24bd377ae874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d57950>]}
[0m08:41:55.895306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54c7a5c9-65cb-4275-8335-24bd377ae874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ccacf0>]}
[0m08:41:55.904890 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:41:55.949731 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:41:55.990873 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m08:41:55.991085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '54c7a5c9-65cb-4275-8335-24bd377ae874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12368ad50>]}
[0m08:41:56.591534 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_expectations.expression_is_true`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m08:41:56.591789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '54c7a5c9-65cb-4275-8335-24bd377ae874', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12372a3f0>]}
[0m08:41:56.598967 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_expectations_expression_is_true_stg_transaction_amount_eur___0 (models/staging/stg_transaction.yml)
  macro 'dbt_macro__test_expression_is_true' takes no keyword argument 'column_name'
[0m08:41:56.599276 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:41:56.600931 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.8426627, "process_in_blocks": "0", "process_kernel_time": 0.119547, "process_mem_max_rss": "126238720", "process_out_blocks": "0", "process_user_time": 1.215435}
[0m08:41:56.601116 [debug] [MainThread]: Command `dbt show` failed at 08:41:56.601081 after 0.84 seconds
[0m08:41:56.601263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121d27e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12389e7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236d75f0>]}
[0m08:41:56.601415 [debug] [MainThread]: Flushing usage events
[0m08:41:57.090767 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:42:48.082728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104474050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b3b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b3bc50>]}


============================== 08:42:48.085260 | 0049ae1a-6e49-44ca-9f36-cdf435293bd7 ==============================
[0m08:42:48.085260 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:42:48.085532 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'invocation_command': 'dbt show --select +customer_store_ranking', 'no_print': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'version_check': 'True', 'quiet': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'warn_error': 'None', 'static_parser': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'printer_width': '80', 'empty': 'None', 'cache_selected_only': 'False'}
[0m08:42:48.174970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0049ae1a-6e49-44ca-9f36-cdf435293bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104957950>]}
[0m08:42:48.196945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0049ae1a-6e49-44ca-9f36-cdf435293bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058cacf0>]}
[0m08:42:48.206950 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:42:48.253932 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:42:48.297045 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m08:42:48.297275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0049ae1a-6e49-44ca-9f36-cdf435293bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107206d50>]}
[0m08:42:48.901112 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_expectations.expression_is_true`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m08:42:48.901365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0049ae1a-6e49-44ca-9f36-cdf435293bd7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d63f0>]}
[0m08:42:48.908606 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_expectations_expression_is_true_stg_transaction_amount_eur___0 (models/staging/stg_transaction.yml)
  macro 'dbt_macro__test_expression_is_true' takes no keyword argument 'column_name'
[0m08:42:48.908911 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:42:48.910458 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.85600936, "process_in_blocks": "0", "process_kernel_time": 0.124676, "process_mem_max_rss": "125829120", "process_out_blocks": "0", "process_user_time": 1.224897}
[0m08:42:48.910663 [debug] [MainThread]: Command `dbt show` failed at 08:42:48.910625 after 0.86 seconds
[0m08:42:48.910812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a27e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10741a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072420d0>]}
[0m08:42:48.910943 [debug] [MainThread]: Flushing usage events
[0m08:42:49.517079 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:44:10.848409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b0c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10494f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10494fc50>]}


============================== 08:44:10.851097 | 92d22125-ee69-49a7-baeb-c600ee98eec4 ==============================
[0m08:44:10.851097 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:44:10.851361 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'write_json': 'True', 'use_colors': 'True', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'debug': 'False', 'printer_width': '80', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt show --select +customer_store_ranking', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'indirect_selection': 'eager', 'warn_error': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'no_print': 'None'}
[0m08:44:10.940381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92d22125-ee69-49a7-baeb-c600ee98eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c6f950>]}
[0m08:44:10.962395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92d22125-ee69-49a7-baeb-c600ee98eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047e2cf0>]}
[0m08:44:10.972441 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:44:11.018659 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:44:11.061867 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m08:44:11.062124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '92d22125-ee69-49a7-baeb-c600ee98eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10594ad50>]}
[0m08:44:11.665738 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_expectations.expression_is_true`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m08:44:11.665989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '92d22125-ee69-49a7-baeb-c600ee98eec4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a223f0>]}
[0m08:44:11.672713 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_expectations_expression_is_true_stg_transaction_amount_eur___0 (models/staging/stg_transaction.yml)
  macro 'dbt_macro__test_expression_is_true' takes no keyword argument 'column_name'
[0m08:44:11.672969 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:44:11.675085 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.8582492, "process_in_blocks": "0", "process_kernel_time": 0.122744, "process_mem_max_rss": "126746624", "process_out_blocks": "0", "process_user_time": 1.219492}
[0m08:44:11.675277 [debug] [MainThread]: Command `dbt show` failed at 08:44:11.675237 after 0.86 seconds
[0m08:44:11.675445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10483fe70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b627b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059775f0>]}
[0m08:44:11.675579 [debug] [MainThread]: Flushing usage events
[0m08:44:12.243382 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:44:19.023860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107637c50>]}


============================== 08:44:19.026155 | 7f8a0e85-bb0b-4cb3-b2ec-bdfda8561dcb ==============================
[0m08:44:19.026155 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:44:19.026412 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'invocation_command': 'dbt show --select +customer_store_ranking', 'fail_fast': 'False', 'partial_parse': 'True', 'write_json': 'True', 'empty': 'None', 'version_check': 'True', 'introspect': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'use_experimental_parser': 'False', 'warn_error': 'None', 'use_colors': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'static_parser': 'True', 'debug': 'False'}
[0m08:44:19.096197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f8a0e85-bb0b-4cb3-b2ec-bdfda8561dcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106557950>]}
[0m08:44:19.118299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f8a0e85-bb0b-4cb3-b2ec-bdfda8561dcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074cacf0>]}
[0m08:44:19.127339 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:44:19.169459 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:44:19.209618 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m08:44:19.209853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7f8a0e85-bb0b-4cb3-b2ec-bdfda8561dcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10858ad50>]}
[0m08:44:19.800811 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_expectations.expression_is_true`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m08:44:19.801073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7f8a0e85-bb0b-4cb3-b2ec-bdfda8561dcb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10862a3f0>]}
[0m08:44:19.808476 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_expectations_expression_is_true_stg_transaction_amount_eur___0 (models/staging/stg_transaction.yml)
  macro 'dbt_macro__test_expression_is_true' takes no keyword argument 'column_name'
[0m08:44:19.808805 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:44:19.810337 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.8136377, "process_in_blocks": "0", "process_kernel_time": 0.101313, "process_mem_max_rss": "126074880", "process_out_blocks": "0", "process_user_time": 1.222915}
[0m08:44:19.810522 [debug] [MainThread]: Command `dbt show` failed at 08:44:19.810488 after 0.81 seconds
[0m08:44:19.810666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107527e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10891a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085cb5f0>]}
[0m08:44:19.810796 [debug] [MainThread]: Flushing usage events
[0m08:44:20.408150 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:44:33.515510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107928050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087679d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108767c50>]}


============================== 08:44:33.517916 | 82d231a0-5f4b-47f5-8e79-eaf7fa6abfd4 ==============================
[0m08:44:33.517916 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:44:33.518168 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'warn_error': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'target_path': 'None', 'version_check': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'static_parser': 'True', 'printer_width': '80', 'introspect': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'debug': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'invocation_command': 'dbt show --select +customer_store_ranking'}
[0m08:44:33.601391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82d231a0-5f4b-47f5-8e79-eaf7fa6abfd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a8f950>]}
[0m08:44:33.622892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82d231a0-5f4b-47f5-8e79-eaf7fa6abfd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085fecf0>]}
[0m08:44:33.631861 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:44:33.679256 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:44:33.720204 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m08:44:33.720430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '82d231a0-5f4b-47f5-8e79-eaf7fa6abfd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10976ad50>]}
[0m08:44:34.313282 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_expectations.expression_is_true`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m08:44:34.313547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '82d231a0-5f4b-47f5-8e79-eaf7fa6abfd4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10983e3f0>]}
[0m08:44:34.320712 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_expectations_expression_is_true_stg_transaction_amount_eur___0 (models/staging/stg_transaction.yml)
  macro 'dbt_macro__test_expression_is_true' takes no keyword argument 'column_name'
[0m08:44:34.320971 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:44:34.322566 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.83317065, "process_in_blocks": "0", "process_kernel_time": 0.11146, "process_mem_max_rss": "126730240", "process_out_blocks": "0", "process_user_time": 1.219386}
[0m08:44:34.322752 [debug] [MainThread]: Command `dbt show` failed at 08:44:34.322717 after 0.83 seconds
[0m08:44:34.322894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10865be70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a6a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097a20d0>]}
[0m08:44:34.323022 [debug] [MainThread]: Flushing usage events
[0m08:44:34.898847 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:45:22.879713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a58050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10889b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10889bc50>]}


============================== 08:45:22.882607 | a776dd66-dd0a-47cb-8482-38c91b97ad83 ==============================
[0m08:45:22.882607 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:45:22.882881 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'empty': 'None', 'introspect': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'write_json': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'printer_width': '80', 'use_experimental_parser': 'False', 'static_parser': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'cache_selected_only': 'False', 'target_path': 'None', 'debug': 'False', 'invocation_command': 'dbt show --select +customer_store_ranking'}
[0m08:45:22.979549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a776dd66-dd0a-47cb-8482-38c91b97ad83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bbb950>]}
[0m08:45:23.003046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a776dd66-dd0a-47cb-8482-38c91b97ad83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10872ecf0>]}
[0m08:45:23.014460 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:45:23.063499 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:45:23.107606 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m08:45:23.107871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a776dd66-dd0a-47cb-8482-38c91b97ad83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10989ad50>]}
[0m08:45:23.735953 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_expectations_expression_is_true_stg_transaction_amount_eur__amount_eur_0 (models/staging/stg_transaction.yml)
  macro 'dbt_macro__test_expression_is_true' takes no keyword argument 'column_name'
[0m08:45:23.738031 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.8890611, "process_in_blocks": "0", "process_kernel_time": 0.141445, "process_mem_max_rss": "126484480", "process_out_blocks": "0", "process_user_time": 1.282157}
[0m08:45:23.738222 [debug] [MainThread]: Command `dbt show` failed at 08:45:23.738185 after 0.89 seconds
[0m08:45:23.738367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e94e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e94f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10878be70>]}
[0m08:45:23.738497 [debug] [MainThread]: Flushing usage events
[0m08:45:24.290302 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:45:48.687494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e08050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c479d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c47c50>]}


============================== 08:45:48.689970 | 205d47ed-d7d4-4dc3-bb2e-e2aaa042536a ==============================
[0m08:45:48.689970 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:45:48.690231 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'printer_width': '80', 'no_print': 'None', 'log_format': 'default', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'warn_error': 'None', 'empty': 'None', 'quiet': 'False', 'static_parser': 'True', 'introspect': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'invocation_command': 'dbt show --select +customer_store_ranking', 'indirect_selection': 'eager', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'log_cache_events': 'False', 'partial_parse': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False'}
[0m08:45:48.769440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '205d47ed-d7d4-4dc3-bb2e-e2aaa042536a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f6b950>]}
[0m08:45:48.791352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '205d47ed-d7d4-4dc3-bb2e-e2aaa042536a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108adecf0>]}
[0m08:45:48.801015 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:45:48.848104 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:45:48.888877 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m08:45:48.889108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '205d47ed-d7d4-4dc3-bb2e-e2aaa042536a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c4ad50>]}
[0m08:45:49.485951 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m08:45:49.486199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '205d47ed-d7d4-4dc3-bb2e-e2aaa042536a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d1e4e0>]}
[0m08:45:49.529887 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m08:45:49.531932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '205d47ed-d7d4-4dc3-bb2e-e2aaa042536a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a25def0>]}
[0m08:45:49.577788 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:45:49.579476 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:45:49.580843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '205d47ed-d7d4-4dc3-bb2e-e2aaa042536a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2afd40>]}
[0m08:45:49.581013 [info ] [MainThread]: Found 9 models, 3 seeds, 5 data tests, 714 macros
[0m08:45:49.581143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '205d47ed-d7d4-4dc3-bb2e-e2aaa042536a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e6a5d0>]}
[0m08:45:49.581919 [info ] [MainThread]: 
[0m08:45:49.582050 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:49.582153 [info ] [MainThread]: 
[0m08:45:49.582336 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:49.583952 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m08:45:49.588023 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m08:45:49.589071 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m08:45:49.610281 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:45:49.610495 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:45:49.610659 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:45:49.610792 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m08:45:49.610915 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m08:45:49.611038 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m08:45:49.611155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:49.611269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:49.611375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:49.656467 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m08:45:49.656695 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m08:45:49.656822 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m08:45:49.656925 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:45:49.657039 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:45:49.657139 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:45:49.657257 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:45:49.657385 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m08:45:49.657512 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m08:45:49.673705 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.016 seconds
[0m08:45:49.673861 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.016 seconds
[0m08:45:49.673987 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.016 seconds
[0m08:45:49.674574 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m08:45:49.675051 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m08:45:49.675500 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:45:49.675881 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:45:49.675992 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m08:45:49.676101 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m08:45:49.679124 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:49.679272 [debug] [MainThread]: On master: BEGIN
[0m08:45:49.679383 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:49.684683 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:45:49.684816 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:49.684973 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:45:49.692572 [debug] [MainThread]: SQL status: SELECT 5 in 0.007 seconds
[0m08:45:49.693516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '205d47ed-d7d4-4dc3-bb2e-e2aaa042536a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a200b50>]}
[0m08:45:49.693691 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:49.693915 [debug] [MainThread]: On master: Close
[0m08:45:49.695207 [debug] [Thread-2 (]: Began running node seed.sumup.store
[0m08:45:49.695369 [debug] [Thread-3 (]: Began running node seed.sumup.transaction
[0m08:45:49.695700 [debug] [Thread-1 (]: Began running node seed.sumup.device
[0m08:45:49.695566 [info ] [Thread-2 (]: 2 of 13 START seed file analytics.store ........................................ [RUN]
[0m08:45:49.695906 [info ] [Thread-3 (]: 3 of 13 START seed file analytics.transaction .................................. [RUN]
[0m08:45:49.696285 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now seed.sumup.store)
[0m08:45:49.696102 [info ] [Thread-1 (]: 1 of 13 START seed file analytics.device ....................................... [RUN]
[0m08:45:49.696463 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now seed.sumup.transaction)
[0m08:45:49.696601 [debug] [Thread-2 (]: Began compiling node seed.sumup.store
[0m08:45:49.696748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now seed.sumup.device)
[0m08:45:49.696884 [debug] [Thread-3 (]: Began compiling node seed.sumup.transaction
[0m08:45:49.697023 [debug] [Thread-2 (]: Began executing node seed.sumup.store
[0m08:45:49.697152 [debug] [Thread-1 (]: Began compiling node seed.sumup.device
[0m08:45:49.697277 [debug] [Thread-3 (]: Began executing node seed.sumup.transaction
[0m08:45:49.704227 [debug] [Thread-1 (]: Began executing node seed.sumup.device
[0m08:45:49.713490 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m08:45:49.714003 [debug] [Thread-2 (]: On seed.sumup.store: BEGIN
[0m08:45:49.714160 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:45:49.716509 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m08:45:49.736931 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m08:45:49.737137 [debug] [Thread-1 (]: On seed.sumup.device: BEGIN
[0m08:45:49.737277 [debug] [Thread-3 (]: On seed.sumup.transaction: BEGIN
[0m08:45:49.737401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:49.737545 [debug] [Thread-2 (]: SQL status: BEGIN in 0.023 seconds
[0m08:45:49.737672 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:45:49.737850 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m08:45:49.738030 [debug] [Thread-2 (]: On seed.sumup.store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.store"} */
truncate table "postgres"."analytics"."store"
[0m08:45:49.743661 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.006 seconds
[0m08:45:49.750012 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m08:45:49.756468 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m08:45:49.762876 [debug] [Thread-3 (]: On seed.sumup.transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.transaction"} */
truncate table "postgres"."analytics"."transaction"
[0m08:45:49.763019 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m08:45:49.783285 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0.008 seconds
[0m08:45:49.788822 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m08:45:49.788935 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m08:45:49.801607 [debug] [Thread-2 (]: On seed.sumup.store: 
          insert into "postgres"."analytics"."store" ("id", "name", "address", "city", "country", "created_at", "typology", "customer_id") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%...
[0m08:45:49.820383 [debug] [Thread-1 (]: On seed.sumup.device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.device"} */
truncate table "postgres"."analytics"."device"
[0m08:45:49.848115 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.015 seconds
[0m08:45:49.880171 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.014 seconds
[0m08:45:49.894746 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.sumup.store"
[0m08:45:49.992835 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m08:45:50.004917 [debug] [Thread-2 (]: On seed.sumup.store: COMMIT
[0m08:45:50.011856 [debug] [Thread-1 (]: On seed.sumup.device: 
          insert into "postgres"."analytics"."device" ("id", "type", "store_id") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s...
[0m08:45:50.030611 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m08:45:50.064566 [debug] [Thread-1 (]: SQL status: INSERT 0 200 in 0.015 seconds
[0m08:45:50.077078 [debug] [Thread-2 (]: On seed.sumup.store: COMMIT
[0m08:45:50.096048 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.sumup.device"
[0m08:45:50.130908 [debug] [Thread-2 (]: SQL status: COMMIT in 0.016 seconds
[0m08:45:50.156530 [debug] [Thread-2 (]: On seed.sumup.store: Close
[0m08:45:50.181863 [debug] [Thread-1 (]: On seed.sumup.device: COMMIT
[0m08:45:50.187654 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m08:45:50.193901 [debug] [Thread-1 (]: On seed.sumup.device: COMMIT
[0m08:45:50.206417 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m08:45:50.212908 [debug] [Thread-1 (]: On seed.sumup.device: Close
[0m08:45:50.225704 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '205d47ed-d7d4-4dc3-bb2e-e2aaa042536a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e8b7f0>]}
[0m08:45:50.225867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '205d47ed-d7d4-4dc3-bb2e-e2aaa042536a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a446d50>]}
[0m08:45:50.244573 [info ] [Thread-2 (]: 2 of 13 OK loaded seed file analytics.store .................................... [[32mINSERT 100[0m in 0.47s]
[0m08:45:50.254671 [debug] [Thread-2 (]: Finished running node seed.sumup.store
[0m08:45:50.287726 [debug] [Thread-4 (]: Began running node model.sumup.stg_store
[0m08:45:50.288713 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.sumup.stg_store'
[0m08:45:50.294418 [debug] [Thread-4 (]: Began compiling node model.sumup.stg_store
[0m08:45:50.251895 [info ] [Thread-1 (]: 1 of 13 OK loaded seed file analytics.device ................................... [[32mINSERT 200[0m in 0.52s]
[0m08:45:50.322999 [debug] [Thread-1 (]: Finished running node seed.sumup.device
[0m08:45:50.386571 [debug] [Thread-4 (]: Writing injected SQL for node "model.sumup.stg_store"
[0m08:45:50.393022 [debug] [Thread-2 (]: Began running node model.sumup.stg_device
[0m08:45:50.412362 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.sumup.store, now model.sumup.stg_device)
[0m08:45:50.425280 [debug] [Thread-2 (]: Began compiling node model.sumup.stg_device
[0m08:45:50.439357 [debug] [Thread-2 (]: Writing injected SQL for node "model.sumup.stg_device"
[0m08:45:50.445858 [debug] [Thread-4 (]: Began executing node model.sumup.stg_store
[0m08:45:50.454896 [debug] [Thread-4 (]: Using postgres connection "model.sumup.stg_store"
[0m08:45:50.461361 [debug] [Thread-4 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */

  
  

SELECT
    -- Primary Key: Rename to be explicit
    id AS store_id,
    name AS store_name,

    -- Descriptive Attributes: Rename 'typology' for clarity
    typology AS store_typology,
    country,
    city
    
    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-22 06:45:48.679771+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."store"
  
  limit 5

[0m08:45:50.480395 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:45:50.486211 [debug] [Thread-2 (]: Began executing node model.sumup.stg_device
[0m08:45:50.494059 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_device"
[0m08:45:50.500526 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.020 seconds
[0m08:45:50.513066 [debug] [Thread-2 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */

  
  

SELECT
    -- Primary Key
    id AS device_id,

    -- Foreign Key to stores (assuming this links the device to a specific store)
    store_id,

    -- Descriptive Attributes
    type as device_type
    
    -- Other fields, if any, standardized here
    -- e.g., CAST(status AS VARCHAR) AS device_status

    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-22 06:45:48.679771+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."device"
  
  limit 5

[0m08:45:50.532200 [debug] [Thread-4 (]: On model.sumup.stg_store: Close
[0m08:45:50.550571 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:45:50.588276 [debug] [Thread-4 (]: Finished running node model.sumup.stg_store
[0m08:45:50.616319 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.066 seconds
[0m08:45:50.623060 [debug] [Thread-2 (]: On model.sumup.stg_device: Close
[0m08:45:50.635885 [debug] [Thread-2 (]: Finished running node model.sumup.stg_device
[0m08:45:50.828970 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m08:45:50.829200 [debug] [Thread-3 (]: On seed.sumup.transaction: 
          insert into "postgres"."analytics"."transaction" ("id", "device_id", "product_name", "product_sku", "category_name", "amount", "status", "card_number", "cvv", "created_at", "happened_at") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m08:45:50.858558 [debug] [Thread-3 (]: SQL status: INSERT 0 1500 in 0.029 seconds
[0m08:45:50.858957 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.sumup.transaction"
[0m08:45:50.860028 [debug] [Thread-3 (]: On seed.sumup.transaction: COMMIT
[0m08:45:50.860211 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m08:45:50.860352 [debug] [Thread-3 (]: On seed.sumup.transaction: COMMIT
[0m08:45:50.862221 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m08:45:50.862518 [debug] [Thread-3 (]: On seed.sumup.transaction: Close
[0m08:45:50.862780 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '205d47ed-d7d4-4dc3-bb2e-e2aaa042536a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5183d0>]}
[0m08:45:50.863048 [info ] [Thread-3 (]: 3 of 13 OK loaded seed file analytics.transaction .............................. [[32mINSERT 1500[0m in 1.17s]
[0m08:45:50.863358 [debug] [Thread-3 (]: Finished running node seed.sumup.transaction
[0m08:45:50.863686 [debug] [Thread-1 (]: Began running node model.sumup.stg_transaction
[0m08:45:50.863879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.sumup.device, now model.sumup.stg_transaction)
[0m08:45:50.864036 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_transaction
[0m08:45:50.865582 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m08:45:50.865949 [debug] [Thread-1 (]: Began executing node model.sumup.stg_transaction
[0m08:45:50.867187 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:45:50.867341 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  
  SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) AS amount_eur,
    LOWER(status) AS status,

    -- Card Information 
    REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '') AS card_number,
    CAST(cvv AS VARCHAR) AS cvv,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  
  limit 5

[0m08:45:50.867487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:50.875565 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.008 seconds
[0m08:45:50.876167 [debug] [Thread-1 (]: On model.sumup.stg_transaction: Close
[0m08:45:50.876487 [debug] [Thread-1 (]: Finished running node model.sumup.stg_transaction
[0m08:45:50.876822 [debug] [Thread-3 (]: Began running node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m08:45:50.876966 [debug] [Thread-2 (]: Began running node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m08:45:50.877144 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.sumup.transaction, now test.sumup.not_null_stg_transaction_device_id.b84ae0844e)
[0m08:45:50.877282 [debug] [Thread-1 (]: Began running node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m08:45:50.877417 [debug] [Thread-4 (]: Began running node model.sumup.int_transaction
[0m08:45:50.877586 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sumup.stg_device, now test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad)
[0m08:45:50.877729 [debug] [Thread-3 (]: Began compiling node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m08:45:50.877867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.stg_transaction, now test.sumup.not_null_stg_transaction_id.f3ec2fc021)
[0m08:45:50.878003 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.sumup.stg_store, now model.sumup.int_transaction)
[0m08:45:50.878135 [debug] [Thread-2 (]: Began compiling node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m08:45:50.882257 [debug] [Thread-3 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_device_id.b84ae0844e"
[0m08:45:50.882468 [debug] [Thread-1 (]: Began compiling node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m08:45:50.882605 [debug] [Thread-4 (]: Began compiling node model.sumup.int_transaction
[0m08:45:50.884115 [debug] [Thread-2 (]: Writing injected SQL for node "test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad"
[0m08:45:50.885797 [debug] [Thread-1 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_id.f3ec2fc021"
[0m08:45:50.887243 [debug] [Thread-4 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m08:45:50.887606 [debug] [Thread-3 (]: Began executing node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m08:45:50.887757 [debug] [Thread-2 (]: Began executing node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m08:45:50.889123 [debug] [Thread-3 (]: Using postgres connection "test.sumup.not_null_stg_transaction_device_id.b84ae0844e"
[0m08:45:50.889250 [debug] [Thread-1 (]: Began executing node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m08:45:50.890491 [debug] [Thread-2 (]: Using postgres connection "test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad"
[0m08:45:50.890645 [debug] [Thread-3 (]: On test.sumup.not_null_stg_transaction_device_id.b84ae0844e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.not_null_stg_transaction_device_id.b84ae0844e"} */

  
  
    
    



select device_id
from "postgres"."analytics_staging"."stg_transaction"
where device_id is null



  
  limit 5

[0m08:45:50.891894 [debug] [Thread-1 (]: Using postgres connection "test.sumup.not_null_stg_transaction_id.f3ec2fc021"
[0m08:45:50.892062 [debug] [Thread-4 (]: Began executing node model.sumup.int_transaction
[0m08:45:50.892216 [debug] [Thread-2 (]: On test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad"} */

  
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "postgres"."analytics_staging"."stg_transaction"
    group by status

)

select *
from all_values
where value_field not in (
    'accepted','refused','cancelled'
)



  
  limit 5

[0m08:45:50.892371 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:45:50.892509 [debug] [Thread-1 (]: On test.sumup.not_null_stg_transaction_id.f3ec2fc021: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.not_null_stg_transaction_id.f3ec2fc021"} */

  
  
    
    



select id
from "postgres"."analytics_staging"."stg_transaction"
where id is null



  
  limit 5

[0m08:45:50.893865 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m08:45:50.894016 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:45:50.894206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:50.894366 [debug] [Thread-4 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

  
  

SELECT
    -- Primary and Foreign Keys
    transaction_id,
    t.device_id,

    -- Product Information
   
    CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA  AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data and Status
    amount_eur,
    status,

    --device data
    d.device_type,
    
    -- store_data
    d.store_id,
    store_name,
    store_typology,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction" t
LEFT JOIN "postgres"."analytics_staging"."stg_device" d ON t.device_id = d.device_id
LEFT JOIN "postgres"."analytics_staging"."stg_store" s ON d.store_id = s.store_id

-- Incremental Logic: Only select new records for subsequent runs

    WHERE t.created_at_utc > (SELECT MAX(created_at_utc) FROM "postgres"."analytics_analytics"."int_transaction")

  
  limit 5

[0m08:45:50.894758 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:45:50.907976 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 10: select id
                ^

[0m08:45:50.908191 [debug] [Thread-1 (]: On test.sumup.not_null_stg_transaction_id.f3ec2fc021: Close
[0m08:45:50.908344 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.016 seconds
[0m08:45:50.908832 [debug] [Thread-3 (]: On test.sumup.not_null_stg_transaction_device_id.b84ae0844e: Close
[0m08:45:50.909291 [debug] [Thread-3 (]: Finished running node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m08:45:50.909434 [debug] [Thread-3 (]: Began running node test.sumup.not_null_stg_transaction_status.87ab6c4b42
[0m08:45:50.909570 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sumup.not_null_stg_transaction_device_id.b84ae0844e, now test.sumup.not_null_stg_transaction_status.87ab6c4b42)
[0m08:45:50.909741 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.016 seconds
[0m08:45:50.909863 [debug] [Thread-3 (]: Began compiling node test.sumup.not_null_stg_transaction_status.87ab6c4b42
[0m08:45:50.910372 [debug] [Thread-2 (]: On test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad: Close
[0m08:45:50.912103 [debug] [Thread-3 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_status.87ab6c4b42"
[0m08:45:50.912488 [debug] [Thread-2 (]: Finished running node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m08:45:50.912646 [debug] [Thread-2 (]: Began running node test.sumup.unique_stg_transaction_id.f181c9397b
[0m08:45:50.912802 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad, now test.sumup.unique_stg_transaction_id.f181c9397b)
[0m08:45:50.912954 [debug] [Thread-2 (]: Began compiling node test.sumup.unique_stg_transaction_id.f181c9397b
[0m08:45:50.915500 [debug] [Thread-2 (]: Writing injected SQL for node "test.sumup.unique_stg_transaction_id.f181c9397b"
[0m08:45:50.915682 [debug] [Thread-3 (]: Began executing node test.sumup.not_null_stg_transaction_status.87ab6c4b42
[0m08:45:50.917054 [debug] [Thread-3 (]: Using postgres connection "test.sumup.not_null_stg_transaction_status.87ab6c4b42"
[0m08:45:50.917207 [debug] [Thread-3 (]: On test.sumup.not_null_stg_transaction_status.87ab6c4b42: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.not_null_stg_transaction_status.87ab6c4b42"} */

  
  
    
    



select status
from "postgres"."analytics_staging"."stg_transaction"
where status is null



  
  limit 5

[0m08:45:50.917370 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.023 seconds
[0m08:45:50.917506 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:45:50.917998 [debug] [Thread-4 (]: On model.sumup.int_transaction: Close
[0m08:45:50.918182 [debug] [Thread-2 (]: Began executing node test.sumup.unique_stg_transaction_id.f181c9397b
[0m08:45:50.919515 [debug] [Thread-2 (]: Using postgres connection "test.sumup.unique_stg_transaction_id.f181c9397b"
[0m08:45:50.919774 [debug] [Thread-4 (]: Finished running node model.sumup.int_transaction
[0m08:45:50.919916 [debug] [Thread-2 (]: On test.sumup.unique_stg_transaction_id.f181c9397b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.unique_stg_transaction_id.f181c9397b"} */

  
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."analytics_staging"."stg_transaction"
where id is not null
group by id
having count(*) > 1



  
  limit 5

[0m08:45:50.920177 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:45:50.920332 [debug] [Thread-4 (]: Began running node model.sumup.customer_store_ranking
[0m08:45:50.920514 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.sumup.int_transaction, now model.sumup.customer_store_ranking)
[0m08:45:50.920677 [debug] [Thread-4 (]: Began compiling node model.sumup.customer_store_ranking
[0m08:45:50.921752 [debug] [Thread-4 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m08:45:50.922360 [debug] [Thread-4 (]: Began executing node model.sumup.customer_store_ranking
[0m08:45:50.923547 [debug] [Thread-4 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m08:45:50.923717 [debug] [Thread-4 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  
  --Question 1) 

SELECT
    store_name,
    --SUM(amount_eur) AS total_amount
    amount_eur
FROM
    "postgres"."analytics_analytics"."int_transaction" 
WHERE status = 'accepted' and store_id = 3



--GROUP BY

--    store_name
--ORDER BY
--    total_amount DESC
--limit 10
  
  limit 5

[0m08:45:50.923888 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.006 seconds
[0m08:45:50.924030 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:45:50.924472 [debug] [Thread-3 (]: On test.sumup.not_null_stg_transaction_status.87ab6c4b42: Close
[0m08:45:50.924633 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 9:     id as unique_field,
            ^

[0m08:45:50.924942 [debug] [Thread-3 (]: Finished running node test.sumup.not_null_stg_transaction_status.87ab6c4b42
[0m08:45:50.925106 [debug] [Thread-2 (]: On test.sumup.unique_stg_transaction_id.f181c9397b: Close
[0m08:45:50.926133 [debug] [Thread-1 (]: Database Error in test not_null_stg_transaction_id (models/staging/stg_transaction.yml)
  column "id" does not exist
  LINE 10: select id
                  ^
[0m08:45:50.926507 [debug] [Thread-1 (]: Finished running node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m08:45:50.926722 [debug] [Thread-7 (]: Marking all children of 'test.sumup.not_null_stg_transaction_id.f3ec2fc021' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_transaction_id (models/staging/stg_transaction.yml)
  column "id" does not exist
  LINE 10: select id
                  ^.
[0m08:45:50.927853 [debug] [Thread-2 (]: Database Error in test unique_stg_transaction_id (models/staging/stg_transaction.yml)
  column "id" does not exist
  LINE 9:     id as unique_field,
              ^
[0m08:45:50.928090 [debug] [Thread-2 (]: Finished running node test.sumup.unique_stg_transaction_id.f181c9397b
[0m08:45:50.928295 [debug] [Thread-7 (]: Marking all children of 'test.sumup.unique_stg_transaction_id.f181c9397b' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_transaction_id (models/staging/stg_transaction.yml)
  column "id" does not exist
  LINE 9:     id as unique_field,
              ^.
[0m08:45:50.929445 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.005 seconds
[0m08:45:50.929899 [debug] [Thread-4 (]: On model.sumup.customer_store_ranking: Close
[0m08:45:50.930133 [debug] [Thread-4 (]: Finished running node model.sumup.customer_store_ranking
[0m08:45:50.930285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:50.930400 [debug] [MainThread]: Connection 'test.sumup.not_null_stg_transaction_id.f3ec2fc021' was properly closed.
[0m08:45:50.930522 [debug] [MainThread]: Connection 'test.sumup.unique_stg_transaction_id.f181c9397b' was properly closed.
[0m08:45:50.930644 [debug] [MainThread]: Connection 'test.sumup.not_null_stg_transaction_status.87ab6c4b42' was properly closed.
[0m08:45:50.930738 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m08:45:50.930909 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in test unique_stg_transaction_id (models/staging/stg_transaction.yml)
    column "id" does not exist
    LINE 9:     id as unique_field,
                ^
[0m08:45:50.931125 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:45:50.932613 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 2.2721097, "process_in_blocks": "0", "process_kernel_time": 0.163046, "process_mem_max_rss": "139182080", "process_out_blocks": "0", "process_user_time": 2.385667}
[0m08:45:50.932769 [debug] [MainThread]: Command `dbt show` failed at 08:45:50.932735 after 2.27 seconds
[0m08:45:50.932892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0a30b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0a3ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1609b0>]}
[0m08:45:50.933020 [debug] [MainThread]: Flushing usage events
[0m08:45:51.447245 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:46:46.406869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10434c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051939d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105193c50>]}


============================== 08:46:46.409526 | dbedb36a-33b4-4a2b-ac24-6376dca3f210 ==============================
[0m08:46:46.409526 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:46:46.409815 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'invocation_command': 'dbt show --no-partial-parse --select +customer_store_ranking', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'quiet': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'cache_selected_only': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'no_print': 'None', 'partial_parse': 'False', 'log_cache_events': 'False', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'indirect_selection': 'eager', 'empty': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'introspect': 'True', 'warn_error': 'None', 'use_colors': 'True', 'write_json': 'True'}
[0m08:46:46.506034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbedb36a-33b4-4a2b-ac24-6376dca3f210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044af950>]}
[0m08:46:46.528375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbedb36a-33b4-4a2b-ac24-6376dca3f210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105022cf0>]}
[0m08:46:46.538415 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:46:46.590850 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:46:46.591228 [debug] [MainThread]: Partial parsing not enabled
[0m08:46:47.246809 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m08:46:47.247074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dbedb36a-33b4-4a2b-ac24-6376dca3f210', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bfbe50>]}
[0m08:46:47.293632 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m08:46:47.295699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbedb36a-33b4-4a2b-ac24-6376dca3f210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e0c8c0>]}
[0m08:46:47.340949 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:46:47.342495 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:46:47.343735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbedb36a-33b4-4a2b-ac24-6376dca3f210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f67a10>]}
[0m08:46:47.343912 [info ] [MainThread]: Found 9 models, 3 seeds, 5 data tests, 714 macros
[0m08:46:47.344042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbedb36a-33b4-4a2b-ac24-6376dca3f210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b3790>]}
[0m08:46:47.344824 [info ] [MainThread]: 
[0m08:46:47.344962 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:46:47.345067 [info ] [MainThread]: 
[0m08:46:47.345255 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:46:47.346912 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m08:46:47.351030 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m08:46:47.352111 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m08:46:47.373825 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:46:47.373991 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:46:47.374130 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:46:47.374234 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m08:46:47.374344 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m08:46:47.374449 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m08:46:47.374555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:46:47.374650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:46:47.374742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:46:47.403443 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m08:46:47.403661 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m08:46:47.403824 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:46:47.403941 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m08:46:47.404063 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:46:47.404196 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:46:47.404320 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:46:47.404442 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m08:46:47.404593 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m08:46:47.410578 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m08:46:47.410719 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m08:46:47.410821 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m08:46:47.411396 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:46:47.411840 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m08:46:47.412255 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m08:46:47.412525 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:46:47.412634 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m08:46:47.412739 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m08:46:47.415994 [debug] [MainThread]: Using postgres connection "master"
[0m08:46:47.416127 [debug] [MainThread]: On master: BEGIN
[0m08:46:47.416221 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:46:47.421413 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:46:47.421518 [debug] [MainThread]: Using postgres connection "master"
[0m08:46:47.421652 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:46:47.427961 [debug] [MainThread]: SQL status: SELECT 5 in 0.006 seconds
[0m08:46:47.428711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbedb36a-33b4-4a2b-ac24-6376dca3f210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fff650>]}
[0m08:46:47.428863 [debug] [MainThread]: On master: ROLLBACK
[0m08:46:47.429080 [debug] [MainThread]: On master: Close
[0m08:46:47.430231 [debug] [Thread-2 (]: Began running node seed.sumup.store
[0m08:46:47.430396 [debug] [Thread-3 (]: Began running node seed.sumup.transaction
[0m08:46:47.430736 [debug] [Thread-1 (]: Began running node seed.sumup.device
[0m08:46:47.430613 [info ] [Thread-2 (]: 2 of 13 START seed file analytics.store ........................................ [RUN]
[0m08:46:47.430964 [info ] [Thread-3 (]: 3 of 13 START seed file analytics.transaction .................................. [RUN]
[0m08:46:47.431162 [info ] [Thread-1 (]: 1 of 13 START seed file analytics.device ....................................... [RUN]
[0m08:46:47.431330 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now seed.sumup.store)
[0m08:46:47.431488 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now seed.sumup.transaction)
[0m08:46:47.431637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now seed.sumup.device)
[0m08:46:47.431770 [debug] [Thread-2 (]: Began compiling node seed.sumup.store
[0m08:46:47.431900 [debug] [Thread-3 (]: Began compiling node seed.sumup.transaction
[0m08:46:47.432028 [debug] [Thread-1 (]: Began compiling node seed.sumup.device
[0m08:46:47.432161 [debug] [Thread-2 (]: Began executing node seed.sumup.store
[0m08:46:47.432295 [debug] [Thread-3 (]: Began executing node seed.sumup.transaction
[0m08:46:47.432424 [debug] [Thread-1 (]: Began executing node seed.sumup.device
[0m08:46:47.446500 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m08:46:47.447811 [debug] [Thread-2 (]: On seed.sumup.store: BEGIN
[0m08:46:47.454230 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:46:47.463723 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m08:46:47.465838 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m08:46:47.465983 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m08:46:47.466106 [debug] [Thread-3 (]: On seed.sumup.transaction: BEGIN
[0m08:46:47.466229 [debug] [Thread-1 (]: On seed.sumup.device: BEGIN
[0m08:46:47.466345 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m08:46:47.466456 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:46:47.466565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:46:47.466681 [debug] [Thread-2 (]: On seed.sumup.store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.store"} */
truncate table "postgres"."analytics"."store"
[0m08:46:47.469830 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.003 seconds
[0m08:46:47.482957 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m08:46:47.483138 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m08:46:47.495699 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m08:46:47.514473 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m08:46:47.516938 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m08:46:47.517072 [debug] [Thread-1 (]: On seed.sumup.device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.device"} */
truncate table "postgres"."analytics"."device"
[0m08:46:47.517195 [debug] [Thread-3 (]: On seed.sumup.transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.transaction"} */
truncate table "postgres"."analytics"."transaction"
[0m08:46:47.517320 [debug] [Thread-2 (]: On seed.sumup.store: 
          insert into "postgres"."analytics"."store" ("id", "name", "address", "city", "country", "created_at", "typology", "customer_id") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%...
[0m08:46:47.518580 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.001 seconds
[0m08:46:47.526387 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.009 seconds
[0m08:46:47.534743 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.sumup.store"
[0m08:46:47.534892 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0.017 seconds
[0m08:46:47.550785 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m08:46:47.560831 [debug] [Thread-1 (]: On seed.sumup.device: 
          insert into "postgres"."analytics"."device" ("id", "type", "store_id") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s...
[0m08:46:47.600578 [debug] [Thread-2 (]: On seed.sumup.store: COMMIT
[0m08:46:47.601012 [debug] [Thread-1 (]: SQL status: INSERT 0 200 in 0.039 seconds
[0m08:46:47.612551 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m08:46:47.631490 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.sumup.device"
[0m08:46:47.648326 [debug] [Thread-2 (]: On seed.sumup.store: COMMIT
[0m08:46:47.697692 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m08:46:47.704091 [debug] [Thread-2 (]: On seed.sumup.store: Close
[0m08:46:47.716789 [debug] [Thread-1 (]: On seed.sumup.device: COMMIT
[0m08:46:47.722350 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m08:46:47.728966 [debug] [Thread-1 (]: On seed.sumup.device: COMMIT
[0m08:46:47.821995 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbedb36a-33b4-4a2b-ac24-6376dca3f210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10716b5f0>]}
[0m08:46:47.834998 [debug] [Thread-1 (]: SQL status: COMMIT in 0.106 seconds
[0m08:46:47.835363 [debug] [Thread-1 (]: On seed.sumup.device: Close
[0m08:46:47.828576 [info ] [Thread-2 (]: 2 of 13 OK loaded seed file analytics.store .................................... [[32mINSERT 100[0m in 0.28s]
[0m08:46:47.841905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbedb36a-33b4-4a2b-ac24-6376dca3f210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e36b0>]}
[0m08:46:47.854407 [debug] [Thread-2 (]: Finished running node seed.sumup.store
[0m08:46:47.872385 [info ] [Thread-1 (]: 1 of 13 OK loaded seed file analytics.device ................................... [[32mINSERT 200[0m in 0.41s]
[0m08:46:47.895878 [debug] [Thread-1 (]: Finished running node seed.sumup.device
[0m08:46:47.896077 [debug] [Thread-4 (]: Began running node model.sumup.stg_store
[0m08:46:47.908236 [debug] [Thread-2 (]: Began running node model.sumup.stg_device
[0m08:46:47.919160 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.sumup.stg_store'
[0m08:46:47.937937 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.sumup.store, now model.sumup.stg_device)
[0m08:46:47.956783 [debug] [Thread-4 (]: Began compiling node model.sumup.stg_store
[0m08:46:47.973760 [debug] [Thread-2 (]: Began compiling node model.sumup.stg_device
[0m08:46:48.002217 [debug] [Thread-4 (]: Writing injected SQL for node "model.sumup.stg_store"
[0m08:46:48.018957 [debug] [Thread-2 (]: Writing injected SQL for node "model.sumup.stg_device"
[0m08:46:48.117956 [debug] [Thread-2 (]: Began executing node model.sumup.stg_device
[0m08:46:48.118318 [debug] [Thread-4 (]: Began executing node model.sumup.stg_store
[0m08:46:48.133659 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_device"
[0m08:46:48.150921 [debug] [Thread-4 (]: Using postgres connection "model.sumup.stg_store"
[0m08:46:48.168193 [debug] [Thread-2 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */

  
  

SELECT
    -- Primary Key
    id AS device_id,

    -- Foreign Key to stores (assuming this links the device to a specific store)
    store_id,

    -- Descriptive Attributes
    type as device_type
    
    -- Other fields, if any, standardized here
    -- e.g., CAST(status AS VARCHAR) AS device_status

    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-22 06:46:46.395186+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."device"
  
  limit 5

[0m08:46:48.186991 [debug] [Thread-4 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */

  
  

SELECT
    -- Primary Key: Rename to be explicit
    id AS store_id,
    name AS store_name,

    -- Descriptive Attributes: Rename 'typology' for clarity
    typology AS store_typology,
    country,
    city
    
    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-22 06:46:46.395186+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."store"
  
  limit 5

[0m08:46:48.211850 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:46:48.230619 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:46:48.367162 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.150 seconds
[0m08:46:48.418339 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.187 seconds
[0m08:46:48.420579 [debug] [Thread-2 (]: On model.sumup.stg_device: Close
[0m08:46:48.431140 [debug] [Thread-4 (]: On model.sumup.stg_store: Close
[0m08:46:48.438016 [debug] [Thread-2 (]: Finished running node model.sumup.stg_device
[0m08:46:48.454596 [debug] [Thread-4 (]: Finished running node model.sumup.stg_store
[0m08:46:48.764105 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m08:46:48.764349 [debug] [Thread-3 (]: On seed.sumup.transaction: 
          insert into "postgres"."analytics"."transaction" ("id", "device_id", "product_name", "product_sku", "category_name", "amount", "status", "card_number", "cvv", "created_at", "happened_at") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m08:46:48.796614 [debug] [Thread-3 (]: SQL status: INSERT 0 1500 in 0.032 seconds
[0m08:46:48.797157 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.sumup.transaction"
[0m08:46:48.798160 [debug] [Thread-3 (]: On seed.sumup.transaction: COMMIT
[0m08:46:48.798347 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m08:46:48.798487 [debug] [Thread-3 (]: On seed.sumup.transaction: COMMIT
[0m08:46:48.802333 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m08:46:48.802672 [debug] [Thread-3 (]: On seed.sumup.transaction: Close
[0m08:46:48.802935 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbedb36a-33b4-4a2b-ac24-6376dca3f210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073cb050>]}
[0m08:46:48.803160 [info ] [Thread-3 (]: 3 of 13 OK loaded seed file analytics.transaction .............................. [[32mINSERT 1500[0m in 1.37s]
[0m08:46:48.803372 [debug] [Thread-3 (]: Finished running node seed.sumup.transaction
[0m08:46:48.803669 [debug] [Thread-1 (]: Began running node model.sumup.stg_transaction
[0m08:46:48.803872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.sumup.device, now model.sumup.stg_transaction)
[0m08:46:48.804028 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_transaction
[0m08:46:48.805310 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m08:46:48.805643 [debug] [Thread-1 (]: Began executing node model.sumup.stg_transaction
[0m08:46:48.807159 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:46:48.807319 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  
  SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) AS amount_eur,
    LOWER(status) AS status,

    -- Card Information 
    REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '') AS card_number,
    CAST(cvv AS VARCHAR) AS cvv,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  
  limit 5

[0m08:46:48.807467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:46:48.813440 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m08:46:48.814161 [debug] [Thread-1 (]: On model.sumup.stg_transaction: Close
[0m08:46:48.814518 [debug] [Thread-1 (]: Finished running node model.sumup.stg_transaction
[0m08:46:48.814857 [debug] [Thread-3 (]: Began running node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m08:46:48.815011 [debug] [Thread-1 (]: Began running node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m08:46:48.815150 [debug] [Thread-4 (]: Began running node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m08:46:48.815288 [debug] [Thread-2 (]: Began running node model.sumup.int_transaction
[0m08:46:48.815433 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.sumup.transaction, now test.sumup.not_null_stg_transaction_device_id.b84ae0844e)
[0m08:46:48.815563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.stg_transaction, now test.sumup.not_null_stg_transaction_id.f3ec2fc021)
[0m08:46:48.815688 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.sumup.stg_store, now test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad)
[0m08:46:48.815809 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sumup.stg_device, now model.sumup.int_transaction)
[0m08:46:48.815933 [debug] [Thread-3 (]: Began compiling node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m08:46:48.816050 [debug] [Thread-1 (]: Began compiling node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m08:46:48.816170 [debug] [Thread-4 (]: Began compiling node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m08:46:48.816285 [debug] [Thread-2 (]: Began compiling node model.sumup.int_transaction
[0m08:46:48.820076 [debug] [Thread-3 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_device_id.b84ae0844e"
[0m08:46:48.821514 [debug] [Thread-1 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_id.f3ec2fc021"
[0m08:46:48.823154 [debug] [Thread-4 (]: Writing injected SQL for node "test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad"
[0m08:46:48.824600 [debug] [Thread-2 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m08:46:48.825292 [debug] [Thread-3 (]: Began executing node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m08:46:48.825465 [debug] [Thread-4 (]: Began executing node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m08:46:48.826959 [debug] [Thread-3 (]: Using postgres connection "test.sumup.not_null_stg_transaction_device_id.b84ae0844e"
[0m08:46:48.827265 [debug] [Thread-1 (]: Began executing node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m08:46:48.827416 [debug] [Thread-2 (]: Began executing node model.sumup.int_transaction
[0m08:46:48.828739 [debug] [Thread-4 (]: Using postgres connection "test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad"
[0m08:46:48.828903 [debug] [Thread-3 (]: On test.sumup.not_null_stg_transaction_device_id.b84ae0844e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.not_null_stg_transaction_device_id.b84ae0844e"} */

  
  
    
    



select device_id
from "postgres"."analytics_staging"."stg_transaction"
where device_id is null



  
  limit 5

[0m08:46:48.830395 [debug] [Thread-1 (]: Using postgres connection "test.sumup.not_null_stg_transaction_id.f3ec2fc021"
[0m08:46:48.831609 [debug] [Thread-2 (]: Using postgres connection "model.sumup.int_transaction"
[0m08:46:48.831759 [debug] [Thread-4 (]: On test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad"} */

  
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "postgres"."analytics_staging"."stg_transaction"
    group by status

)

select *
from all_values
where value_field not in (
    'accepted','refused','cancelled'
)



  
  limit 5

[0m08:46:48.831908 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:46:48.832040 [debug] [Thread-1 (]: On test.sumup.not_null_stg_transaction_id.f3ec2fc021: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.not_null_stg_transaction_id.f3ec2fc021"} */

  
  
    
    



select id
from "postgres"."analytics_staging"."stg_transaction"
where id is null



  
  limit 5

[0m08:46:48.832188 [debug] [Thread-2 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

  
  

SELECT
    -- Primary and Foreign Keys
    transaction_id,
    t.device_id,

    -- Product Information
   
    CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA  AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data and Status
    amount_eur,
    status,

    --device data
    d.device_type,
    
    -- store_data
    d.store_id,
    store_name,
    store_typology,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction" t
LEFT JOIN "postgres"."analytics_staging"."stg_device" d ON t.device_id = d.device_id
LEFT JOIN "postgres"."analytics_staging"."stg_store" s ON d.store_id = s.store_id

-- Incremental Logic: Only select new records for subsequent runs

    WHERE t.created_at_utc > (SELECT MAX(created_at_utc) FROM "postgres"."analytics_analytics"."int_transaction")

  
  limit 5

[0m08:46:48.832331 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:46:48.832492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:46:48.832632 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:46:48.839887 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 10: select id
                ^

[0m08:46:48.840048 [debug] [Thread-1 (]: On test.sumup.not_null_stg_transaction_id.f3ec2fc021: Close
[0m08:46:48.841478 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.010 seconds
[0m08:46:48.841986 [debug] [Thread-3 (]: On test.sumup.not_null_stg_transaction_device_id.b84ae0844e: Close
[0m08:46:48.842274 [debug] [Thread-3 (]: Finished running node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m08:46:48.842414 [debug] [Thread-3 (]: Began running node test.sumup.not_null_stg_transaction_status.87ab6c4b42
[0m08:46:48.842598 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sumup.not_null_stg_transaction_device_id.b84ae0844e, now test.sumup.not_null_stg_transaction_status.87ab6c4b42)
[0m08:46:48.842779 [debug] [Thread-3 (]: Began compiling node test.sumup.not_null_stg_transaction_status.87ab6c4b42
[0m08:46:48.844646 [debug] [Thread-3 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_status.87ab6c4b42"
[0m08:46:48.844806 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.012 seconds
[0m08:46:48.845279 [debug] [Thread-4 (]: On test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad: Close
[0m08:46:48.845557 [debug] [Thread-4 (]: Finished running node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m08:46:48.845717 [debug] [Thread-4 (]: Began running node test.sumup.unique_stg_transaction_id.f181c9397b
[0m08:46:48.845848 [debug] [Thread-3 (]: Began executing node test.sumup.not_null_stg_transaction_status.87ab6c4b42
[0m08:46:48.846020 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad, now test.sumup.unique_stg_transaction_id.f181c9397b)
[0m08:46:48.847368 [debug] [Thread-3 (]: Using postgres connection "test.sumup.not_null_stg_transaction_status.87ab6c4b42"
[0m08:46:48.847554 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.015 seconds
[0m08:46:48.847684 [debug] [Thread-4 (]: Began compiling node test.sumup.unique_stg_transaction_id.f181c9397b
[0m08:46:48.847828 [debug] [Thread-3 (]: On test.sumup.not_null_stg_transaction_status.87ab6c4b42: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.not_null_stg_transaction_status.87ab6c4b42"} */

  
  
    
    



select status
from "postgres"."analytics_staging"."stg_transaction"
where status is null



  
  limit 5

[0m08:46:48.848288 [debug] [Thread-2 (]: On model.sumup.int_transaction: Close
[0m08:46:48.850641 [debug] [Thread-4 (]: Writing injected SQL for node "test.sumup.unique_stg_transaction_id.f181c9397b"
[0m08:46:48.850860 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:46:48.851744 [debug] [Thread-1 (]: Database Error in test not_null_stg_transaction_id (models/staging/stg_transaction.yml)
  column "id" does not exist
  LINE 10: select id
                  ^
[0m08:46:48.852011 [debug] [Thread-2 (]: Finished running node model.sumup.int_transaction
[0m08:46:48.852278 [debug] [Thread-1 (]: Finished running node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m08:46:48.852552 [debug] [Thread-7 (]: Marking all children of 'test.sumup.not_null_stg_transaction_id.f3ec2fc021' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_transaction_id (models/staging/stg_transaction.yml)
  column "id" does not exist
  LINE 10: select id
                  ^.
[0m08:46:48.852922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:46:48.853070 [debug] [Thread-4 (]: Began executing node test.sumup.unique_stg_transaction_id.f181c9397b
[0m08:46:48.853173 [debug] [MainThread]: Connection 'test.sumup.not_null_stg_transaction_id.f3ec2fc021' was properly closed.
[0m08:46:48.854490 [debug] [MainThread]: Connection 'model.sumup.int_transaction' was properly closed.
[0m08:46:48.854584 [debug] [MainThread]: Connection 'test.sumup.not_null_stg_transaction_status.87ab6c4b42' was properly closed.
[0m08:46:48.854669 [debug] [MainThread]: Connection 'test.sumup.unique_stg_transaction_id.f181c9397b' was properly closed.
[0m08:46:48.854829 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in test not_null_stg_transaction_id (models/staging/stg_transaction.yml)
    column "id" does not exist
    LINE 10: select id
                    ^
[0m08:46:48.855193 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:46:48.856706 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 2.482242, "process_in_blocks": "0", "process_kernel_time": 0.193163, "process_mem_max_rss": "138002432", "process_out_blocks": "0", "process_user_time": 2.515268}
[0m08:46:48.856903 [debug] [MainThread]: Command `dbt show` failed at 08:46:48.856865 after 2.48 seconds
[0m08:46:48.857076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10521c440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d03f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110303dd0>]}
[0m08:46:48.857631 [debug] [Thread-4 (]: Runtime Error in test unique_stg_transaction_id (models/staging/stg_transaction.yml)
  connection never acquired for thread (69351, 6246166528), have []
[0m08:46:48.857785 [debug] [MainThread]: Flushing usage events
[0m08:46:48.857984 [debug] [Thread-4 (]: Finished running node test.sumup.unique_stg_transaction_id.f181c9397b
[0m08:46:48.858313 [debug] [Thread-7 (]: Marking all children of 'test.sumup.unique_stg_transaction_id.f181c9397b' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_stg_transaction_id (models/staging/stg_transaction.yml)
  connection never acquired for thread (69351, 6246166528), have [].
[0m08:46:48.858843 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.008 seconds
[0m08:46:48.859594 [debug] [Thread-3 (]: Finished running node test.sumup.not_null_stg_transaction_status.87ab6c4b42
[0m08:46:49.417808 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:47:15.142581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10687c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076bf9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076bfc50>]}


============================== 08:47:15.145057 | ecabf91d-6011-4309-bdab-563df32881b5 ==============================
[0m08:47:15.145057 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:47:15.145311 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'log_cache_events': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'invocation_command': 'dbt show --no-partial-parse --select +customer_store_ranking', 'no_print': 'None', 'cache_selected_only': 'False', 'partial_parse': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'target_path': 'None', 'debug': 'False', 'write_json': 'True', 'empty': 'None', 'printer_width': '80', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'warn_error': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'quiet': 'False'}
[0m08:47:15.224912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecabf91d-6011-4309-bdab-563df32881b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069df950>]}
[0m08:47:15.247322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecabf91d-6011-4309-bdab-563df32881b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107552cf0>]}
[0m08:47:15.256618 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:47:15.300177 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:47:15.300577 [debug] [MainThread]: Partial parsing not enabled
[0m08:47:15.918353 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_expectations.expression_is_true`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m08:47:15.918610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ecabf91d-6011-4309-bdab-563df32881b5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086afe50>]}
[0m08:47:15.925716 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_expectations_expression_is_true_stg_transaction_amount_eur__amount_eur_0 (models/staging/stg_transaction.yml)
  macro 'dbt_macro__test_expression_is_true' takes no keyword argument 'column_name'
[0m08:47:15.925985 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:47:15.927712 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.81550545, "process_in_blocks": "0", "process_kernel_time": 0.121326, "process_mem_max_rss": "128450560", "process_out_blocks": "0", "process_user_time": 1.205853}
[0m08:47:15.928016 [debug] [MainThread]: Command `dbt show` failed at 08:47:15.927962 after 0.82 seconds
[0m08:47:15.928206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c656d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c657c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075afe70>]}
[0m08:47:15.928364 [debug] [MainThread]: Flushing usage events
[0m08:47:16.376919 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:47:25.776622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085c0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093ff9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093ffc50>]}


============================== 08:47:25.778869 | 3c6cc6e4-6a2f-4858-8d13-31c545515527 ==============================
[0m08:47:25.778869 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:47:25.779119 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'target_path': 'None', 'empty': 'None', 'printer_width': '80', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt show --no-partial-parse --select +customer_store_ranking', 'log_format': 'default', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'debug': 'False', 'write_json': 'True', 'use_colors': 'True', 'partial_parse': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'version_check': 'True'}
[0m08:47:25.849214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c6cc6e4-6a2f-4858-8d13-31c545515527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108723950>]}
[0m08:47:25.871181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c6cc6e4-6a2f-4858-8d13-31c545515527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109296cf0>]}
[0m08:47:25.880256 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:47:25.925441 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:47:25.925806 [debug] [MainThread]: Partial parsing not enabled
[0m08:47:26.531809 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_expectations.expression_is_true`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m08:47:26.532063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3c6cc6e4-6a2f-4858-8d13-31c545515527', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3f3e50>]}
[0m08:47:26.538598 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_expectations_expression_is_true_stg_transaction_amount_eur___0 (models/staging/stg_transaction.yml)
  macro 'dbt_macro__test_expression_is_true' takes no keyword argument 'column_name'
[0m08:47:26.538849 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:47:26.540442 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.79022133, "process_in_blocks": "0", "process_kernel_time": 0.110134, "process_mem_max_rss": "126009344", "process_out_blocks": "0", "process_user_time": 1.198754}
[0m08:47:26.540633 [debug] [MainThread]: Command `dbt show` failed at 08:47:26.540596 after 0.79 seconds
[0m08:47:26.540783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9a96d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9a97c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092f3e70>]}
[0m08:47:26.540914 [debug] [MainThread]: Flushing usage events
[0m08:47:27.013326 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:48:46.506552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083ac050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091eb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ebc50>]}


============================== 08:48:46.509329 | 0ceaa06b-8d0f-4589-b3eb-e2803617bbb4 ==============================
[0m08:48:46.509329 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:48:46.509583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'warn_error': 'None', 'use_colors': 'True', 'invocation_command': 'dbt show --no-partial-parse --select +customer_store_ranking', 'log_format': 'default', 'cache_selected_only': 'False', 'partial_parse': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'no_print': 'None', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'target_path': 'None', 'quiet': 'False', 'version_check': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'debug': 'False'}
[0m08:48:46.595546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ceaa06b-8d0f-4589-b3eb-e2803617bbb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108513950>]}
[0m08:48:46.617626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ceaa06b-8d0f-4589-b3eb-e2803617bbb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109082cf0>]}
[0m08:48:46.628091 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:48:46.678318 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:48:46.678694 [debug] [MainThread]: Partial parsing not enabled
[0m08:48:47.299173 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_expectations.expression_is_true`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m08:48:47.299428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0ceaa06b-8d0f-4589-b3eb-e2803617bbb4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1e3e50>]}
[0m08:48:47.306428 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_expectations_expression_is_true_stg_transaction_amount_eur__amount_eur_0 (models/staging/stg_transaction.yml)
  macro 'dbt_macro__test_expression_is_true' takes no keyword argument 'column_name'
[0m08:48:47.306709 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:48:47.308801 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.8327866, "process_in_blocks": "0", "process_kernel_time": 0.128641, "process_mem_max_rss": "127336448", "process_out_blocks": "0", "process_user_time": 1.20487}
[0m08:48:47.308989 [debug] [MainThread]: Command `dbt show` failed at 08:48:47.308955 after 0.83 seconds
[0m08:48:47.309134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7956d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7957c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090dfe70>]}
[0m08:48:47.309261 [debug] [MainThread]: Flushing usage events
[0m08:48:47.855045 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:49:41.691991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b48050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069879d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106987c50>]}


============================== 08:49:41.694973 | 1d0f3f87-1f35-4a18-86e6-43c728b53606 ==============================
[0m08:49:41.694973 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:49:41.695229 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'warn_error': 'None', 'no_print': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'introspect': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'use_colors': 'True', 'debug': 'False', 'version_check': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'invocation_command': 'dbt show --no-partial-parse --select +customer_store_ranking', 'target_path': 'None'}
[0m08:49:41.784370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d0f3f87-1f35-4a18-86e6-43c728b53606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cab950>]}
[0m08:49:41.806792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d0f3f87-1f35-4a18-86e6-43c728b53606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10681ecf0>]}
[0m08:49:41.817122 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:49:41.861707 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:49:41.862071 [debug] [MainThread]: Partial parsing not enabled
[0m08:49:42.488092 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_expectations_expression_is_true_stg_transaction_amount_eur__amount_eur_0 (models/staging/stg_transaction.yml)
  macro 'dbt_macro__test_expression_is_true' takes no keyword argument 'column_name'
[0m08:49:42.489680 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.82728314, "process_in_blocks": "0", "process_kernel_time": 0.129187, "process_mem_max_rss": "128417792", "process_out_blocks": "0", "process_user_time": 1.222083}
[0m08:49:42.489863 [debug] [MainThread]: Command `dbt show` failed at 08:49:42.489828 after 0.83 seconds
[0m08:49:42.490002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797f450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f316d0>]}
[0m08:49:42.490132 [debug] [MainThread]: Flushing usage events
[0m08:49:43.218229 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:50:17.848731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e78050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11542b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11542bc50>]}


============================== 08:50:17.851659 | f9d48f16-ead9-4ae9-968a-6a5273186037 ==============================
[0m08:50:17.851659 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:50:17.851928 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'printer_width': '80', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'version_check': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'warn_error': 'None', 'invocation_command': 'dbt deps', 'use_colors': 'True', 'partial_parse': 'True', 'empty': 'None'}
[0m08:50:17.903878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9d48f16-ead9-4ae9-968a-6a5273186037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11435b950>]}
[0m08:50:17.915957 [debug] [MainThread]: Set downloads directory='/var/folders/p3/pftn60p54m3_wj4v5x8kh4k00000gn/T/dbt-downloads-3p_pi6zd'
[0m08:50:17.916185 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m08:50:18.146916 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m08:50:18.149356 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m08:50:18.248038 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m08:50:18.252095 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m08:50:18.252801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f9d48f16-ead9-4ae9-968a-6a5273186037', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152caf10>]}
[0m08:50:18.262259 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m08:50:18.381198 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m08:50:18.394808 [info ] [MainThread]: Updating lock file in file path: /Users/andre/Desktop/sumup/sumup/package-lock.yml
[0m08:50:18.427941 [debug] [MainThread]: Set downloads directory='/var/folders/p3/pftn60p54m3_wj4v5x8kh4k00000gn/T/dbt-downloads-emnt88sq'
[0m08:50:18.430170 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m08:50:19.467326 [info ] [MainThread]: Installed from version 0.10.4
[0m08:50:19.467543 [info ] [MainThread]: Up to date!
[0m08:50:19.467701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f9d48f16-ead9-4ae9-968a-6a5273186037', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11572db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11572d650>]}
[0m08:50:19.467863 [info ] [MainThread]: Installing calogica/dbt_date
[0m08:50:19.821588 [info ] [MainThread]: Installed from version 0.10.1
[0m08:50:19.821910 [info ] [MainThread]: Up to date!
[0m08:50:19.822143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f9d48f16-ead9-4ae9-968a-6a5273186037', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152b5d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11574ce50>]}
[0m08:50:19.823311 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageRedirectDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:50:19.825414 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.0075724, "process_in_blocks": "0", "process_kernel_time": 0.216996, "process_mem_max_rss": "121061376", "process_out_blocks": "0", "process_user_time": 0.738374}
[0m08:50:19.825778 [debug] [MainThread]: Command `dbt deps` succeeded at 08:50:19.825702 after 2.01 seconds
[0m08:50:19.826040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1157e46d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152a9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1157c8710>]}
[0m08:50:19.826274 [debug] [MainThread]: Flushing usage events
[0m08:50:20.977873 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:50:29.551997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106240050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707fc50>]}


============================== 08:50:29.554594 | d69dcd88-03f9-42d8-a241-1225a5d13036 ==============================
[0m08:50:29.554594 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:50:29.554841 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'invocation_command': 'dbt show --no-partial-parse --select +customer_store_ranking', 'empty': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'printer_width': '80', 'partial_parse': 'False', 'no_print': 'None', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'debug': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'fail_fast': 'False', 'target_path': 'None'}
[0m08:50:29.636042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd69dcd88-03f9-42d8-a241-1225a5d13036', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a7950>]}
[0m08:50:29.658567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd69dcd88-03f9-42d8-a241-1225a5d13036', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f16cf0>]}
[0m08:50:29.668181 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:50:29.713632 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:50:29.714406 [debug] [MainThread]: Partial parsing not enabled
[0m08:50:30.359827 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_expectations_expression_is_true_stg_transaction_amount_eur__amount_eur_0 (models/staging/stg_transaction.yml)
  macro 'dbt_macro__test_expression_is_true' takes no keyword argument 'column_name'
[0m08:50:30.361388 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.8361047, "process_in_blocks": "0", "process_kernel_time": 0.118929, "process_mem_max_rss": "125861888", "process_out_blocks": "0", "process_user_time": 1.211683}
[0m08:50:30.361570 [debug] [MainThread]: Command `dbt show` failed at 08:50:30.361536 after 0.84 seconds
[0m08:50:30.361714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108077450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108077550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10862d6d0>]}
[0m08:50:30.361843 [debug] [MainThread]: Flushing usage events
[0m08:50:30.834966 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:51:03.879448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1182f4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11972f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11972fc50>]}


============================== 08:51:03.881893 | 406631df-d29b-4afd-8ecf-46671233bf12 ==============================
[0m08:51:03.881893 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:51:03.882147 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt deps', 'partial_parse': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'no_print': 'None', 'empty': 'None', 'warn_error': 'None', 'printer_width': '80', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'indirect_selection': 'eager', 'write_json': 'True', 'debug': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'version_check': 'True', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True'}
[0m08:51:03.934102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '406631df-d29b-4afd-8ecf-46671233bf12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118757950>]}
[0m08:51:03.973739 [debug] [MainThread]: Set downloads directory='/var/folders/p3/pftn60p54m3_wj4v5x8kh4k00000gn/T/dbt-downloads-rv_o7hne'
[0m08:51:03.973948 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m08:51:04.042173 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m08:51:04.043064 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m08:51:04.216024 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m08:51:04.219049 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m08:51:04.219659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '406631df-d29b-4afd-8ecf-46671233bf12', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195cbac0>]}
[0m08:51:04.222390 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m08:51:04.312145 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m08:51:04.316150 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m08:51:05.049392 [info ] [MainThread]: Installed from version 0.10.4
[0m08:51:05.049608 [info ] [MainThread]: Up to date!
[0m08:51:05.049764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '406631df-d29b-4afd-8ecf-46671233bf12', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a22db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a22d850>]}
[0m08:51:05.049926 [info ] [MainThread]: Installing calogica/dbt_date
[0m08:51:05.413983 [info ] [MainThread]: Installed from version 0.10.1
[0m08:51:05.414319 [info ] [MainThread]: Up to date!
[0m08:51:05.414558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '406631df-d29b-4afd-8ecf-46671233bf12', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195b5d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a24cd70>]}
[0m08:51:05.416223 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageRedirectDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:51:05.418392 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.5679332, "process_in_blocks": "0", "process_kernel_time": 0.201356, "process_mem_max_rss": "121552896", "process_out_blocks": "0", "process_user_time": 0.694556}
[0m08:51:05.418684 [debug] [MainThread]: Command `dbt deps` succeeded at 08:51:05.418624 after 1.57 seconds
[0m08:51:05.418894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2b24e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195a9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2e4650>]}
[0m08:51:05.419092 [debug] [MainThread]: Flushing usage events
[0m08:51:05.956860 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:51:51.034185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085e4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094239d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109423c50>]}


============================== 08:51:51.037074 | baec584c-d95c-4f26-ac38-e0a1ab0e12f0 ==============================
[0m08:51:51.037074 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:51:51.037338 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'partial_parse': 'False', 'static_parser': 'True', 'no_print': 'None', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'write_json': 'True', 'introspect': 'True', 'invocation_command': 'dbt show --no-partial-parse --select +customer_store_ranking', 'log_format': 'default', 'debug': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'empty': 'None', 'fail_fast': 'False', 'warn_error': 'None', 'target_path': 'None', 'printer_width': '80', 'version_check': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'use_experimental_parser': 'False'}
[0m08:51:51.126795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'baec584c-d95c-4f26-ac38-e0a1ab0e12f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10874b950>]}
[0m08:51:51.149620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'baec584c-d95c-4f26-ac38-e0a1ab0e12f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092bacf0>]}
[0m08:51:51.159603 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:51:51.205238 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:51:51.205606 [debug] [MainThread]: Partial parsing not enabled
[0m08:51:51.840034 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_expectations_expression_is_true_stg_transaction_amount_eur__amount_eur_0 (models/staging/stg_transaction.yml)
  macro 'dbt_macro__test_expression_is_true' takes no keyword argument 'column_name'
[0m08:51:51.842479 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.8404384, "process_in_blocks": "0", "process_kernel_time": 0.12906, "process_mem_max_rss": "126763008", "process_out_blocks": "0", "process_user_time": 1.236124}
[0m08:51:51.842787 [debug] [MainThread]: Command `dbt show` failed at 08:51:51.842731 after 0.84 seconds
[0m08:51:51.842984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a41b450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a41b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9cd6d0>]}
[0m08:51:51.843144 [debug] [MainThread]: Flushing usage events
[0m08:51:52.404475 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:54:01.612680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118504050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a33c50>]}


============================== 08:54:01.615475 | 3b11feec-b4e0-4f57-86cb-2aed3557ea71 ==============================
[0m08:54:01.615475 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:54:01.615748 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'write_json': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'printer_width': '80', 'version_check': 'True', 'static_parser': 'True', 'target_path': 'None', 'debug': 'False', 'partial_parse': 'False', 'invocation_command': 'dbt show --no-partial-parse --select +customer_store_ranking', 'introspect': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'no_print': 'None'}
[0m08:54:01.704624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b11feec-b4e0-4f57-86cb-2aed3557ea71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118957950>]}
[0m08:54:01.727117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b11feec-b4e0-4f57-86cb-2aed3557ea71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198cacf0>]}
[0m08:54:01.736902 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:54:01.783284 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:54:01.783820 [debug] [MainThread]: Partial parsing not enabled
[0m08:54:02.428881 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/staging/stg_transaction.yml:
  	test definition dictionary must have exactly one key, got [('name', 'fraud_check_high_frequency_declines'), ('tags', ['fraud']), ('warn_if', "SELECT \n  COUNT(t1.transaction_id) \nFROM {{ this }} t1 JOIN {{ this }} t2\n  ON t1.card_number_hashed = t2.card_number_hashed\n  AND t1.transaction_id != t2.transaction_id\nWHERE t1.status = 'refused'\n  AND t2.status = 'refused'\n  AND t2.happened_at_utc BETWEEN t1.happened_at_utc AND (t1.happened_at_utc + INTERVAL '60 minutes')\nHAVING COUNT(t1.transaction_id) > 2\n")] instead (3 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m08:54:02.431664 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.84787893, "process_in_blocks": "0", "process_kernel_time": 0.124173, "process_mem_max_rss": "125861888", "process_out_blocks": "0", "process_user_time": 1.217563}
[0m08:54:02.431860 [debug] [MainThread]: Command `dbt show` failed at 08:54:02.431822 after 0.85 seconds
[0m08:54:02.432014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aafb550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aafb150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b8adb80>]}
[0m08:54:02.432151 [debug] [MainThread]: Flushing usage events
[0m08:54:02.954377 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:54:19.332857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081dc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10901f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10901fc50>]}


============================== 08:54:19.335432 | 4be3ba8e-dd26-4de0-a8a9-9b0299ab6627 ==============================
[0m08:54:19.335432 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:54:19.335709 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'log_cache_events': 'False', 'write_json': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'partial_parse': 'False', 'quiet': 'False', 'fail_fast': 'False', 'introspect': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt show --no-partial-parse --select +customer_store_ranking', 'static_parser': 'True', 'debug': 'False', 'target_path': 'None'}
[0m08:54:19.421379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4be3ba8e-dd26-4de0-a8a9-9b0299ab6627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108343950>]}
[0m08:54:19.443892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4be3ba8e-dd26-4de0-a8a9-9b0299ab6627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eb2cf0>]}
[0m08:54:19.453735 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:54:19.498239 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:54:19.498608 [debug] [MainThread]: Partial parsing not enabled
[0m08:54:20.168857 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m08:54:20.170923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4be3ba8e-dd26-4de0-a8a9-9b0299ab6627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e52950>]}
[0m08:54:20.213139 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:54:20.214707 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:54:20.216132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4be3ba8e-dd26-4de0-a8a9-9b0299ab6627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a11e7b0>]}
[0m08:54:20.216311 [info ] [MainThread]: Found 9 models, 3 seeds, 5 data tests, 714 macros
[0m08:54:20.216440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4be3ba8e-dd26-4de0-a8a9-9b0299ab6627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a281e10>]}
[0m08:54:20.217208 [info ] [MainThread]: 
[0m08:54:20.217340 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:54:20.217442 [info ] [MainThread]: 
[0m08:54:20.217629 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:54:20.219250 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m08:54:20.219466 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m08:54:20.223650 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m08:54:20.282818 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:54:20.283021 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:54:20.283165 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:54:20.283278 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m08:54:20.283408 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m08:54:20.283550 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m08:54:20.283703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:54:20.283816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:54:20.283929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:54:20.311293 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m08:54:20.311520 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m08:54:20.311663 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m08:54:20.311784 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:54:20.311931 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:54:20.312061 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:54:20.312190 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m08:54:20.312331 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m08:54:20.312470 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:54:20.318062 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m08:54:20.318182 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m08:54:20.318288 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m08:54:20.318861 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:54:20.319308 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m08:54:20.319726 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m08:54:20.319995 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m08:54:20.320108 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m08:54:20.320219 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:54:20.323098 [debug] [MainThread]: Using postgres connection "master"
[0m08:54:20.323235 [debug] [MainThread]: On master: BEGIN
[0m08:54:20.323342 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:54:20.328465 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:54:20.328572 [debug] [MainThread]: Using postgres connection "master"
[0m08:54:20.328705 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:54:20.335563 [debug] [MainThread]: SQL status: SELECT 5 in 0.007 seconds
[0m08:54:20.336360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4be3ba8e-dd26-4de0-a8a9-9b0299ab6627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a15c1f0>]}
[0m08:54:20.336517 [debug] [MainThread]: On master: ROLLBACK
[0m08:54:20.336720 [debug] [MainThread]: On master: Close
[0m08:54:20.337958 [debug] [Thread-1 (]: Began running node seed.sumup.device
[0m08:54:20.338110 [debug] [Thread-2 (]: Began running node seed.sumup.store
[0m08:54:20.338428 [debug] [Thread-3 (]: Began running node seed.sumup.transaction
[0m08:54:20.338300 [info ] [Thread-1 (]: 1 of 13 START seed file analytics.device ....................................... [RUN]
[0m08:54:20.338648 [info ] [Thread-2 (]: 2 of 13 START seed file analytics.store ........................................ [RUN]
[0m08:54:20.338836 [info ] [Thread-3 (]: 3 of 13 START seed file analytics.transaction .................................. [RUN]
[0m08:54:20.339018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now seed.sumup.device)
[0m08:54:20.339175 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now seed.sumup.store)
[0m08:54:20.339318 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now seed.sumup.transaction)
[0m08:54:20.339454 [debug] [Thread-1 (]: Began compiling node seed.sumup.device
[0m08:54:20.339595 [debug] [Thread-2 (]: Began compiling node seed.sumup.store
[0m08:54:20.339721 [debug] [Thread-3 (]: Began compiling node seed.sumup.transaction
[0m08:54:20.339855 [debug] [Thread-1 (]: Began executing node seed.sumup.device
[0m08:54:20.339984 [debug] [Thread-2 (]: Began executing node seed.sumup.store
[0m08:54:20.340109 [debug] [Thread-3 (]: Began executing node seed.sumup.transaction
[0m08:54:20.354897 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m08:54:20.357156 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m08:54:20.357302 [debug] [Thread-2 (]: On seed.sumup.store: BEGIN
[0m08:54:20.357487 [debug] [Thread-1 (]: On seed.sumup.device: BEGIN
[0m08:54:20.357650 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:54:20.364930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:54:20.404190 [debug] [Thread-2 (]: SQL status: BEGIN in 0.046 seconds
[0m08:54:20.406579 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m08:54:20.406807 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m08:54:20.406959 [debug] [Thread-3 (]: On seed.sumup.transaction: BEGIN
[0m08:54:20.407150 [debug] [Thread-2 (]: On seed.sumup.store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.store"} */
truncate table "postgres"."analytics"."store"
[0m08:54:20.407296 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:54:20.410566 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.003 seconds
[0m08:54:20.410765 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m08:54:20.422989 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m08:54:20.429248 [debug] [Thread-1 (]: On seed.sumup.device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.device"} */
truncate table "postgres"."analytics"."device"
[0m08:54:20.435744 [debug] [Thread-3 (]: SQL status: BEGIN in 0.028 seconds
[0m08:54:20.458981 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m08:54:20.459166 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.011 seconds
[0m08:54:20.459306 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m08:54:20.459444 [debug] [Thread-2 (]: On seed.sumup.store: 
          insert into "postgres"."analytics"."store" ("id", "name", "address", "city", "country", "created_at", "typology", "customer_id") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%...
[0m08:54:20.471826 [debug] [Thread-3 (]: On seed.sumup.transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.transaction"} */
truncate table "postgres"."analytics"."transaction"
[0m08:54:20.490851 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m08:54:20.491060 [debug] [Thread-1 (]: On seed.sumup.device: 
          insert into "postgres"."analytics"."device" ("id", "type", "store_id") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s...
[0m08:54:20.493287 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.004 seconds
[0m08:54:20.495438 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.sumup.store"
[0m08:54:20.495598 [debug] [Thread-1 (]: SQL status: INSERT 0 200 in 0.004 seconds
[0m08:54:20.495737 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0.005 seconds
[0m08:54:20.496017 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.sumup.device"
[0m08:54:20.577565 [debug] [Thread-2 (]: On seed.sumup.store: COMMIT
[0m08:54:20.584045 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m08:54:20.590076 [debug] [Thread-1 (]: On seed.sumup.device: COMMIT
[0m08:54:20.590225 [debug] [Thread-2 (]: On seed.sumup.store: COMMIT
[0m08:54:20.614865 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m08:54:20.672241 [debug] [Thread-2 (]: SQL status: COMMIT in 0.017 seconds
[0m08:54:20.672453 [debug] [Thread-1 (]: On seed.sumup.device: COMMIT
[0m08:54:20.691865 [debug] [Thread-2 (]: On seed.sumup.store: Close
[0m08:54:20.725775 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m08:54:20.751572 [debug] [Thread-1 (]: On seed.sumup.device: Close
[0m08:54:20.776420 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4be3ba8e-dd26-4de0-a8a9-9b0299ab6627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a10f890>]}
[0m08:54:20.783025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4be3ba8e-dd26-4de0-a8a9-9b0299ab6627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a532c50>]}
[0m08:54:20.783265 [info ] [Thread-2 (]: 2 of 13 OK loaded seed file analytics.store .................................... [[32mINSERT 100[0m in 0.41s]
[0m08:54:20.789848 [info ] [Thread-1 (]: 1 of 13 OK loaded seed file analytics.device ................................... [[32mINSERT 200[0m in 0.44s]
[0m08:54:20.814157 [debug] [Thread-2 (]: Finished running node seed.sumup.store
[0m08:54:20.839242 [debug] [Thread-1 (]: Finished running node seed.sumup.device
[0m08:54:20.883096 [debug] [Thread-2 (]: Began running node model.sumup.stg_store
[0m08:54:20.889554 [debug] [Thread-4 (]: Began running node model.sumup.stg_device
[0m08:54:20.889737 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.sumup.store, now model.sumup.stg_store)
[0m08:54:20.908731 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.sumup.stg_device'
[0m08:54:20.933759 [debug] [Thread-2 (]: Began compiling node model.sumup.stg_store
[0m08:54:20.951952 [debug] [Thread-4 (]: Began compiling node model.sumup.stg_device
[0m08:54:20.974247 [debug] [Thread-2 (]: Writing injected SQL for node "model.sumup.stg_store"
[0m08:54:20.991196 [debug] [Thread-4 (]: Writing injected SQL for node "model.sumup.stg_device"
[0m08:54:21.077567 [debug] [Thread-4 (]: Began executing node model.sumup.stg_device
[0m08:54:21.089369 [debug] [Thread-2 (]: Began executing node model.sumup.stg_store
[0m08:54:21.092584 [debug] [Thread-4 (]: Using postgres connection "model.sumup.stg_device"
[0m08:54:21.108638 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_store"
[0m08:54:21.125264 [debug] [Thread-4 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */

  
  

SELECT
    -- Primary Key
    id AS device_id,

    -- Foreign Key to stores (assuming this links the device to a specific store)
    store_id,

    -- Descriptive Attributes
    type as device_type
    
    -- Other fields, if any, standardized here
    -- e.g., CAST(status AS VARCHAR) AS device_status

    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-22 06:54:19.324908+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."device"
  
  limit 5

[0m08:54:21.144049 [debug] [Thread-2 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */

  
  

SELECT
    -- Primary Key: Rename to be explicit
    id AS store_id,
    name AS store_name,

    -- Descriptive Attributes: Rename 'typology' for clarity
    typology AS store_typology,
    country,
    city
    
    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-22 06:54:19.324908+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."store"
  
  limit 5

[0m08:54:21.169076 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:54:21.193652 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:54:21.236667 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.068 seconds
[0m08:54:21.242898 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.049 seconds
[0m08:54:21.243423 [debug] [Thread-4 (]: On model.sumup.stg_device: Close
[0m08:54:21.268232 [debug] [Thread-2 (]: On model.sumup.stg_store: Close
[0m08:54:21.298380 [debug] [Thread-4 (]: Finished running node model.sumup.stg_device
[0m08:54:21.317615 [debug] [Thread-2 (]: Finished running node model.sumup.stg_store
[0m08:54:21.387027 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m08:54:21.387262 [debug] [Thread-3 (]: On seed.sumup.transaction: 
          insert into "postgres"."analytics"."transaction" ("id", "device_id", "product_name", "product_sku", "category_name", "amount", "status", "card_number", "cvv", "created_at", "happened_at") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m08:54:21.416985 [debug] [Thread-3 (]: SQL status: INSERT 0 1500 in 0.030 seconds
[0m08:54:21.417522 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.sumup.transaction"
[0m08:54:21.418865 [debug] [Thread-3 (]: On seed.sumup.transaction: COMMIT
[0m08:54:21.419013 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m08:54:21.419135 [debug] [Thread-3 (]: On seed.sumup.transaction: COMMIT
[0m08:54:21.424326 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m08:54:21.424607 [debug] [Thread-3 (]: On seed.sumup.transaction: Close
[0m08:54:21.424835 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4be3ba8e-dd26-4de0-a8a9-9b0299ab6627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6834d0>]}
[0m08:54:21.425047 [info ] [Thread-3 (]: 3 of 13 OK loaded seed file analytics.transaction .............................. [[32mINSERT 1500[0m in 1.09s]
[0m08:54:21.425258 [debug] [Thread-3 (]: Finished running node seed.sumup.transaction
[0m08:54:21.425631 [debug] [Thread-1 (]: Began running node model.sumup.stg_transaction
[0m08:54:21.425875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.sumup.device, now model.sumup.stg_transaction)
[0m08:54:21.426055 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_transaction
[0m08:54:21.427326 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m08:54:21.427650 [debug] [Thread-1 (]: Began executing node model.sumup.stg_transaction
[0m08:54:21.429158 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:54:21.429312 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  
  SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) AS amount_eur,
    LOWER(status) AS status,

    -- Card Information 
    REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '') AS card_number,
    CAST(cvv AS VARCHAR) AS cvv,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  
  limit 5

[0m08:54:21.429461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:54:21.435349 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m08:54:21.435909 [debug] [Thread-1 (]: On model.sumup.stg_transaction: Close
[0m08:54:21.436173 [debug] [Thread-1 (]: Finished running node model.sumup.stg_transaction
[0m08:54:21.436486 [debug] [Thread-3 (]: Began running node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m08:54:21.436670 [debug] [Thread-4 (]: Began running node model.sumup.int_transaction
[0m08:54:21.436811 [debug] [Thread-2 (]: Began running node test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3
[0m08:54:21.436952 [debug] [Thread-1 (]: Began running node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m08:54:21.437092 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.sumup.transaction, now test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411)
[0m08:54:21.437232 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.sumup.stg_device, now model.sumup.int_transaction)
[0m08:54:21.437368 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sumup.stg_store, now test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3)
[0m08:54:21.437501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.stg_transaction, now test.sumup.not_null_stg_transaction_card_number.fb1135c280)
[0m08:54:21.437633 [debug] [Thread-3 (]: Began compiling node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m08:54:21.437763 [debug] [Thread-4 (]: Began compiling node model.sumup.int_transaction
[0m08:54:21.437888 [debug] [Thread-2 (]: Began compiling node test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3
[0m08:54:21.438013 [debug] [Thread-1 (]: Began compiling node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m08:54:21.442133 [debug] [Thread-3 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411"
[0m08:54:21.443946 [debug] [Thread-4 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m08:54:21.446016 [debug] [Thread-2 (]: Writing injected SQL for node "test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3"
[0m08:54:21.447398 [debug] [Thread-1 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_card_number.fb1135c280"
[0m08:54:21.447903 [debug] [Thread-2 (]: Began executing node test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3
[0m08:54:21.448061 [debug] [Thread-3 (]: Began executing node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m08:54:21.449459 [debug] [Thread-2 (]: Using postgres connection "test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3"
[0m08:54:21.449584 [debug] [Thread-1 (]: Began executing node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m08:54:21.449731 [debug] [Thread-4 (]: Began executing node model.sumup.int_transaction
[0m08:54:21.450874 [debug] [Thread-3 (]: Using postgres connection "test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411"
[0m08:54:21.451026 [debug] [Thread-2 (]: On test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3"} */

  
  





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        card_number
    ) >= 13 and length(
        card_number
    ) <= 25
)
 as expression


    from "postgres"."analytics_staging"."stg_transaction"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







  
  limit 5

[0m08:54:21.452303 [debug] [Thread-1 (]: Using postgres connection "test.sumup.not_null_stg_transaction_card_number.fb1135c280"
[0m08:54:21.453487 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m08:54:21.453619 [debug] [Thread-3 (]: On test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411"} */

  
  
    
    



select amount_eur
from "postgres"."analytics_staging"."stg_transaction"
where amount_eur is null



  
  limit 5

[0m08:54:21.453761 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:54:21.453904 [debug] [Thread-1 (]: On test.sumup.not_null_stg_transaction_card_number.fb1135c280: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.not_null_stg_transaction_card_number.fb1135c280"} */

  
  
    
    



select card_number
from "postgres"."analytics_staging"."stg_transaction"
where card_number is null



  
  limit 5

[0m08:54:21.454064 [debug] [Thread-4 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

  
  

SELECT
    -- Primary and Foreign Keys
    transaction_id,
    t.device_id,

    -- Product Information
   
    CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA  AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data and Status
    amount_eur,
    status,

    --device data
    d.device_type,
    
    -- store_data
    d.store_id,
    store_name,
    store_typology,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction" t
LEFT JOIN "postgres"."analytics_staging"."stg_device" d ON t.device_id = d.device_id
LEFT JOIN "postgres"."analytics_staging"."stg_store" s ON d.store_id = s.store_id

-- Incremental Logic: Only select new records for subsequent runs

    WHERE t.created_at_utc > (SELECT MAX(created_at_utc) FROM "postgres"."analytics_analytics"."int_transaction")

  
  limit 5

[0m08:54:21.454217 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:54:21.454395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:54:21.454538 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:54:21.461504 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.007 seconds
[0m08:54:21.462007 [debug] [Thread-3 (]: On test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411: Close
[0m08:54:21.462284 [debug] [Thread-3 (]: Finished running node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m08:54:21.462437 [debug] [Thread-3 (]: Began running node test.sumup.stg_transaction__amount_eur_is_positive.7336890e7d
[0m08:54:21.462587 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.009 seconds
[0m08:54:21.462754 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411, now test.sumup.stg_transaction__amount_eur_is_positive.7336890e7d)
[0m08:54:21.463240 [debug] [Thread-2 (]: On test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3: Close
[0m08:54:21.463391 [debug] [Thread-3 (]: Began compiling node test.sumup.stg_transaction__amount_eur_is_positive.7336890e7d
[0m08:54:21.463517 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m08:54:21.463756 [debug] [Thread-2 (]: Finished running node test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3
[0m08:54:21.465638 [debug] [Thread-3 (]: Writing injected SQL for node "test.sumup.stg_transaction__amount_eur_is_positive.7336890e7d"
[0m08:54:21.465791 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.011 seconds
[0m08:54:21.466210 [debug] [Thread-1 (]: On test.sumup.not_null_stg_transaction_card_number.fb1135c280: Close
[0m08:54:21.466358 [debug] [Thread-2 (]: Began running node test.sumup.stg_transaction__card_number_not_all_zeros.65f1e170f2
[0m08:54:21.466785 [debug] [Thread-4 (]: On model.sumup.int_transaction: Close
[0m08:54:21.467030 [debug] [Thread-1 (]: Finished running node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m08:54:21.467165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3, now test.sumup.stg_transaction__card_number_not_all_zeros.65f1e170f2)
[0m08:54:21.467429 [debug] [Thread-4 (]: Finished running node model.sumup.int_transaction
[0m08:54:21.467597 [debug] [Thread-3 (]: Began executing node test.sumup.stg_transaction__amount_eur_is_positive.7336890e7d
[0m08:54:21.467718 [debug] [Thread-2 (]: Began compiling node test.sumup.stg_transaction__card_number_not_all_zeros.65f1e170f2
[0m08:54:21.467928 [debug] [Thread-1 (]: Began running node model.sumup.customer_store_ranking
[0m08:54:21.469277 [debug] [Thread-3 (]: Using postgres connection "test.sumup.stg_transaction__amount_eur_is_positive.7336890e7d"
[0m08:54:21.470706 [debug] [Thread-2 (]: Writing injected SQL for node "test.sumup.stg_transaction__card_number_not_all_zeros.65f1e170f2"
[0m08:54:21.470864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sumup.not_null_stg_transaction_card_number.fb1135c280, now model.sumup.customer_store_ranking)
[0m08:54:21.471013 [debug] [Thread-3 (]: On test.sumup.stg_transaction__amount_eur_is_positive.7336890e7d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.stg_transaction__amount_eur_is_positive.7336890e7d"} */

  
  

    
    with grouped_expression as (
    select
        
        
    
  amount_eur > 0 as expression


    from "postgres"."analytics_staging"."stg_transaction"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  
  limit 5

[0m08:54:21.471189 [debug] [Thread-1 (]: Began compiling node model.sumup.customer_store_ranking
[0m08:54:21.471344 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:54:21.472440 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m08:54:21.472580 [debug] [Thread-2 (]: Began executing node test.sumup.stg_transaction__card_number_not_all_zeros.65f1e170f2
[0m08:54:21.474046 [debug] [Thread-2 (]: Using postgres connection "test.sumup.stg_transaction__card_number_not_all_zeros.65f1e170f2"
[0m08:54:21.474214 [debug] [Thread-2 (]: On test.sumup.stg_transaction__card_number_not_all_zeros.65f1e170f2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.stg_transaction__card_number_not_all_zeros.65f1e170f2"} */

  
  

    
    with grouped_expression as (
    select
        
        
    
  NOT REGEXP_LIKE(REPLACE(REPLACE(card_number, ' ', ''), '-', ''), '^0+$') as expression


    from "postgres"."analytics_staging"."stg_transaction"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  
  limit 5

[0m08:54:21.474355 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:54:21.474608 [debug] [Thread-1 (]: Began executing node model.sumup.customer_store_ranking
[0m08:54:21.476136 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m08:54:21.476339 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  
  --Question 1) 

SELECT
    store_name,
    --SUM(amount_eur) AS total_amount
    amount_eur
FROM
    "postgres"."analytics_analytics"."int_transaction" 
WHERE status = 'accepted' and store_id = 3



--GROUP BY

--    store_name
--ORDER BY
--    total_amount DESC
--limit 10
  
  limit 5

[0m08:54:21.476521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:54:21.478319 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.007 seconds
[0m08:54:21.478772 [debug] [Thread-3 (]: On test.sumup.stg_transaction__amount_eur_is_positive.7336890e7d: Close
[0m08:54:21.478937 [debug] [Thread-2 (]: Postgres adapter: Postgres error: function regexp_like(text, unknown) does not exist
LINE 12:   NOT REGEXP_LIKE(REPLACE(REPLACE(card_number, ' ', ''), '-'...
               ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m08:54:21.479210 [debug] [Thread-3 (]: Finished running node test.sumup.stg_transaction__amount_eur_is_positive.7336890e7d
[0m08:54:21.479358 [debug] [Thread-2 (]: On test.sumup.stg_transaction__card_number_not_all_zeros.65f1e170f2: Close
[0m08:54:21.481792 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m08:54:21.482270 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: Close
[0m08:54:21.482604 [debug] [Thread-1 (]: Finished running node model.sumup.customer_store_ranking
[0m08:54:21.483595 [debug] [Thread-2 (]: Database Error in test stg_transaction__card_number_not_all_zeros (models/staging/stg_transaction.yml)
  function regexp_like(text, unknown) does not exist
  LINE 12:   NOT REGEXP_LIKE(REPLACE(REPLACE(card_number, ' ', ''), '-'...
                 ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m08:54:21.483816 [debug] [Thread-2 (]: Finished running node test.sumup.stg_transaction__card_number_not_all_zeros.65f1e170f2
[0m08:54:21.484015 [debug] [Thread-7 (]: Marking all children of 'test.sumup.stg_transaction__card_number_not_all_zeros.65f1e170f2' to be skipped because of status 'error'.  Reason: Database Error in test stg_transaction__card_number_not_all_zeros (models/staging/stg_transaction.yml)
  function regexp_like(text, unknown) does not exist
  LINE 12:   NOT REGEXP_LIKE(REPLACE(REPLACE(card_number, ' ', ''), '-'...
                 ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts..
[0m08:54:21.484408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:54:21.484547 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m08:54:21.484658 [debug] [MainThread]: Connection 'test.sumup.stg_transaction__card_number_not_all_zeros.65f1e170f2' was properly closed.
[0m08:54:21.484751 [debug] [MainThread]: Connection 'test.sumup.stg_transaction__amount_eur_is_positive.7336890e7d' was properly closed.
[0m08:54:21.484841 [debug] [MainThread]: Connection 'model.sumup.int_transaction' was properly closed.
[0m08:54:21.485017 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in test stg_transaction__card_number_not_all_zeros (models/staging/stg_transaction.yml)
    function regexp_like(text, unknown) does not exist
    LINE 12:   NOT REGEXP_LIKE(REPLACE(REPLACE(card_number, ' ', ''), '-'...
                   ^
    HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m08:54:21.486523 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 2.1809015, "process_in_blocks": "0", "process_kernel_time": 0.166068, "process_mem_max_rss": "140492800", "process_out_blocks": "0", "process_user_time": 2.40037}
[0m08:54:21.486687 [debug] [MainThread]: Command `dbt show` failed at 08:54:21.486653 after 2.18 seconds
[0m08:54:21.486812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4b6450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4b7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090ac440>]}
[0m08:54:21.486946 [debug] [MainThread]: Flushing usage events
[0m08:54:22.046310 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:54:30.407532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d37c50>]}


============================== 08:54:30.409888 | ddf2b3e1-9b51-4311-b03f-7b8449e31659 ==============================
[0m08:54:30.409888 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:54:30.410149 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'fail_fast': 'False', 'write_json': 'True', 'quiet': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'use_colors': 'True', 'invocation_command': 'dbt show --no-partial-parse --select +customer_store_ranking', 'no_print': 'None', 'debug': 'False', 'partial_parse': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'warn_error': 'None', 'version_check': 'True', 'log_cache_events': 'False'}
[0m08:54:30.481553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddf2b3e1-9b51-4311-b03f-7b8449e31659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c57950>]}
[0m08:54:30.503846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ddf2b3e1-9b51-4311-b03f-7b8449e31659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bcacf0>]}
[0m08:54:30.512612 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:54:30.557476 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:54:30.557839 [debug] [MainThread]: Partial parsing not enabled
[0m08:54:31.230229 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m08:54:31.232445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddf2b3e1-9b51-4311-b03f-7b8449e31659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c3a950>]}
[0m08:54:31.276052 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:54:31.277202 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:54:31.278315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddf2b3e1-9b51-4311-b03f-7b8449e31659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0e7b0>]}
[0m08:54:31.278484 [info ] [MainThread]: Found 9 models, 3 seeds, 4 data tests, 714 macros
[0m08:54:31.278609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddf2b3e1-9b51-4311-b03f-7b8449e31659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100658d0>]}
[0m08:54:31.279355 [info ] [MainThread]: 
[0m08:54:31.279488 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:54:31.279591 [info ] [MainThread]: 
[0m08:54:31.279777 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:54:31.281448 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m08:54:31.281660 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m08:54:31.285962 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m08:54:31.304648 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:54:31.304829 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:54:31.304978 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:54:31.305106 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m08:54:31.305231 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m08:54:31.305349 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m08:54:31.305459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:54:31.305572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:54:31.305679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:54:31.320174 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m08:54:31.320371 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m08:54:31.320509 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:54:31.320618 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m08:54:31.320735 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:54:31.320849 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m08:54:31.320962 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:54:31.321068 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m08:54:31.321221 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:54:31.324420 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m08:54:31.324565 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m08:54:31.324674 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m08:54:31.325259 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:54:31.325691 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m08:54:31.326075 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m08:54:31.326363 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:54:31.326479 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m08:54:31.326611 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m08:54:31.329271 [debug] [MainThread]: Using postgres connection "master"
[0m08:54:31.329382 [debug] [MainThread]: On master: BEGIN
[0m08:54:31.329471 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:54:31.333929 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:54:31.334028 [debug] [MainThread]: Using postgres connection "master"
[0m08:54:31.334156 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:54:31.339444 [debug] [MainThread]: SQL status: SELECT 5 in 0.005 seconds
[0m08:54:31.340169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddf2b3e1-9b51-4311-b03f-7b8449e31659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f57c70>]}
[0m08:54:31.340312 [debug] [MainThread]: On master: ROLLBACK
[0m08:54:31.340521 [debug] [MainThread]: On master: Close
[0m08:54:31.341571 [debug] [Thread-2 (]: Began running node seed.sumup.store
[0m08:54:31.341723 [debug] [Thread-3 (]: Began running node seed.sumup.transaction
[0m08:54:31.342027 [debug] [Thread-1 (]: Began running node seed.sumup.device
[0m08:54:31.341899 [info ] [Thread-2 (]: 2 of 12 START seed file analytics.store ........................................ [RUN]
[0m08:54:31.342252 [info ] [Thread-3 (]: 3 of 12 START seed file analytics.transaction .................................. [RUN]
[0m08:54:31.342426 [info ] [Thread-1 (]: 1 of 12 START seed file analytics.device ....................................... [RUN]
[0m08:54:31.342588 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now seed.sumup.store)
[0m08:54:31.342715 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now seed.sumup.transaction)
[0m08:54:31.342833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now seed.sumup.device)
[0m08:54:31.342952 [debug] [Thread-2 (]: Began compiling node seed.sumup.store
[0m08:54:31.343067 [debug] [Thread-3 (]: Began compiling node seed.sumup.transaction
[0m08:54:31.343173 [debug] [Thread-1 (]: Began compiling node seed.sumup.device
[0m08:54:31.343287 [debug] [Thread-2 (]: Began executing node seed.sumup.store
[0m08:54:31.343401 [debug] [Thread-3 (]: Began executing node seed.sumup.transaction
[0m08:54:31.343510 [debug] [Thread-1 (]: Began executing node seed.sumup.device
[0m08:54:31.358405 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m08:54:31.364710 [debug] [Thread-2 (]: On seed.sumup.store: BEGIN
[0m08:54:31.371128 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:54:31.374307 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m08:54:31.376446 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m08:54:31.376644 [debug] [Thread-3 (]: On seed.sumup.transaction: BEGIN
[0m08:54:31.376780 [debug] [Thread-1 (]: On seed.sumup.device: BEGIN
[0m08:54:31.376912 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:54:31.377031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:54:31.381429 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m08:54:31.381548 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m08:54:31.381676 [debug] [Thread-2 (]: On seed.sumup.store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.store"} */
truncate table "postgres"."analytics"."store"
[0m08:54:31.381925 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:54:31.382046 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m08:54:31.382166 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m08:54:31.382283 [debug] [Thread-1 (]: On seed.sumup.device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.device"} */
truncate table "postgres"."analytics"."device"
[0m08:54:31.382398 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m08:54:31.382523 [debug] [Thread-3 (]: On seed.sumup.transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.transaction"} */
truncate table "postgres"."analytics"."transaction"
[0m08:54:31.383264 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.001 seconds
[0m08:54:31.389577 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0.007 seconds
[0m08:54:31.389729 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.008 seconds
[0m08:54:31.457112 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m08:54:31.463551 [debug] [Thread-1 (]: On seed.sumup.device: 
          insert into "postgres"."analytics"."device" ("id", "type", "store_id") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s...
[0m08:54:31.492472 [debug] [Thread-1 (]: SQL status: INSERT 0 200 in 0.016 seconds
[0m08:54:31.500821 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.sumup.device"
[0m08:54:31.504676 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m08:54:31.525032 [debug] [Thread-2 (]: On seed.sumup.store: 
          insert into "postgres"."analytics"."store" ("id", "name", "address", "city", "country", "created_at", "typology", "customer_id") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%...
[0m08:54:31.543081 [debug] [Thread-1 (]: On seed.sumup.device: COMMIT
[0m08:54:31.559375 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.016 seconds
[0m08:54:31.571888 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m08:54:31.622948 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.sumup.store"
[0m08:54:31.641586 [debug] [Thread-1 (]: On seed.sumup.device: COMMIT
[0m08:54:31.679346 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m08:54:31.692670 [debug] [Thread-1 (]: On seed.sumup.device: Close
[0m08:54:31.698758 [debug] [Thread-2 (]: On seed.sumup.store: COMMIT
[0m08:54:31.711946 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m08:54:31.712105 [debug] [Thread-2 (]: On seed.sumup.store: COMMIT
[0m08:54:31.718205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddf2b3e1-9b51-4311-b03f-7b8449e31659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eff950>]}
[0m08:54:31.724616 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m08:54:31.737195 [info ] [Thread-1 (]: 1 of 12 OK loaded seed file analytics.device ................................... [[32mINSERT 200[0m in 0.36s]
[0m08:54:31.737490 [debug] [Thread-2 (]: On seed.sumup.store: Close
[0m08:54:31.762535 [debug] [Thread-1 (]: Finished running node seed.sumup.device
[0m08:54:31.793953 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddf2b3e1-9b51-4311-b03f-7b8449e31659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110622c50>]}
[0m08:54:31.794229 [debug] [Thread-4 (]: Began running node model.sumup.stg_device
[0m08:54:31.806645 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.sumup.stg_device'
[0m08:54:31.812929 [debug] [Thread-4 (]: Began compiling node model.sumup.stg_device
[0m08:54:31.806456 [info ] [Thread-2 (]: 2 of 12 OK loaded seed file analytics.store .................................... [[32mINSERT 100[0m in 0.45s]
[0m08:54:31.816116 [debug] [Thread-4 (]: Writing injected SQL for node "model.sumup.stg_device"
[0m08:54:31.831994 [debug] [Thread-2 (]: Finished running node seed.sumup.store
[0m08:54:31.874778 [debug] [Thread-1 (]: Began running node model.sumup.stg_store
[0m08:54:31.881029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.sumup.device, now model.sumup.stg_store)
[0m08:54:31.881186 [debug] [Thread-4 (]: Began executing node model.sumup.stg_device
[0m08:54:31.881321 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_store
[0m08:54:31.902640 [debug] [Thread-4 (]: Using postgres connection "model.sumup.stg_device"
[0m08:54:31.919743 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_store"
[0m08:54:31.937527 [debug] [Thread-4 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */

  
  

SELECT
    -- Primary Key
    id AS device_id,

    -- Foreign Key to stores (assuming this links the device to a specific store)
    store_id,

    -- Descriptive Attributes
    type as device_type
    
    -- Other fields, if any, standardized here
    -- e.g., CAST(status AS VARCHAR) AS device_status

    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-22 06:54:30.398165+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."device"
  
  limit 5

[0m08:54:31.956224 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:54:31.985437 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.029 seconds
[0m08:54:31.985579 [debug] [Thread-1 (]: Began executing node model.sumup.stg_store
[0m08:54:31.998461 [debug] [Thread-4 (]: On model.sumup.stg_device: Close
[0m08:54:32.011735 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_store"
[0m08:54:32.048313 [debug] [Thread-4 (]: Finished running node model.sumup.stg_device
[0m08:54:32.048460 [debug] [Thread-1 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */

  
  

SELECT
    -- Primary Key: Rename to be explicit
    id AS store_id,
    name AS store_name,

    -- Descriptive Attributes: Rename 'typology' for clarity
    typology AS store_typology,
    country,
    city
    
    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-22 06:54:30.398165+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."store"
  
  limit 5

[0m08:54:32.066957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:54:32.090565 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.024 seconds
[0m08:54:32.097321 [debug] [Thread-1 (]: On model.sumup.stg_store: Close
[0m08:54:32.109576 [debug] [Thread-1 (]: Finished running node model.sumup.stg_store
[0m08:54:32.313234 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m08:54:32.313421 [debug] [Thread-3 (]: On seed.sumup.transaction: 
          insert into "postgres"."analytics"."transaction" ("id", "device_id", "product_name", "product_sku", "category_name", "amount", "status", "card_number", "cvv", "created_at", "happened_at") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m08:54:32.341836 [debug] [Thread-3 (]: SQL status: INSERT 0 1500 in 0.028 seconds
[0m08:54:32.342191 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.sumup.transaction"
[0m08:54:32.343329 [debug] [Thread-3 (]: On seed.sumup.transaction: COMMIT
[0m08:54:32.343467 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m08:54:32.343590 [debug] [Thread-3 (]: On seed.sumup.transaction: COMMIT
[0m08:54:32.345419 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m08:54:32.345678 [debug] [Thread-3 (]: On seed.sumup.transaction: Close
[0m08:54:32.345885 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddf2b3e1-9b51-4311-b03f-7b8449e31659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11061e2b0>]}
[0m08:54:32.346090 [info ] [Thread-3 (]: 3 of 12 OK loaded seed file analytics.transaction .............................. [[32mINSERT 1500[0m in 1.00s]
[0m08:54:32.346304 [debug] [Thread-3 (]: Finished running node seed.sumup.transaction
[0m08:54:32.346599 [debug] [Thread-2 (]: Began running node model.sumup.stg_transaction
[0m08:54:32.346770 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.sumup.store, now model.sumup.stg_transaction)
[0m08:54:32.346904 [debug] [Thread-2 (]: Began compiling node model.sumup.stg_transaction
[0m08:54:32.348107 [debug] [Thread-2 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m08:54:32.348350 [debug] [Thread-2 (]: Began executing node model.sumup.stg_transaction
[0m08:54:32.349789 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:54:32.349942 [debug] [Thread-2 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  
  SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) AS amount_eur,
    LOWER(status) AS status,

    -- Card Information 
    REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '') AS card_number,
    CAST(cvv AS VARCHAR) AS cvv,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  
  limit 5

[0m08:54:32.350089 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:54:32.355473 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.005 seconds
[0m08:54:32.356222 [debug] [Thread-2 (]: On model.sumup.stg_transaction: Close
[0m08:54:32.356642 [debug] [Thread-2 (]: Finished running node model.sumup.stg_transaction
[0m08:54:32.356939 [debug] [Thread-2 (]: Began running node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m08:54:32.357094 [debug] [Thread-1 (]: Began running node test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3
[0m08:54:32.357272 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sumup.stg_transaction, now test.sumup.not_null_stg_transaction_card_number.fb1135c280)
[0m08:54:32.357410 [debug] [Thread-3 (]: Began running node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m08:54:32.357538 [debug] [Thread-4 (]: Began running node model.sumup.int_transaction
[0m08:54:32.357697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.stg_store, now test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3)
[0m08:54:32.357837 [debug] [Thread-2 (]: Began compiling node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m08:54:32.357979 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.sumup.transaction, now test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411)
[0m08:54:32.358121 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.sumup.stg_device, now model.sumup.int_transaction)
[0m08:54:32.358256 [debug] [Thread-1 (]: Began compiling node test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3
[0m08:54:32.362009 [debug] [Thread-2 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_card_number.fb1135c280"
[0m08:54:32.362162 [debug] [Thread-3 (]: Began compiling node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m08:54:32.362295 [debug] [Thread-4 (]: Began compiling node model.sumup.int_transaction
[0m08:54:32.363884 [debug] [Thread-1 (]: Writing injected SQL for node "test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3"
[0m08:54:32.365497 [debug] [Thread-3 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411"
[0m08:54:32.366881 [debug] [Thread-4 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m08:54:32.367119 [debug] [Thread-2 (]: Began executing node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m08:54:32.368445 [debug] [Thread-2 (]: Using postgres connection "test.sumup.not_null_stg_transaction_card_number.fb1135c280"
[0m08:54:32.368592 [debug] [Thread-2 (]: On test.sumup.not_null_stg_transaction_card_number.fb1135c280: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.not_null_stg_transaction_card_number.fb1135c280"} */

  
  
    
    



select card_number
from "postgres"."analytics_staging"."stg_transaction"
where card_number is null



  
  limit 5

[0m08:54:32.368758 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:54:32.368960 [debug] [Thread-1 (]: Began executing node test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3
[0m08:54:32.370240 [debug] [Thread-1 (]: Using postgres connection "test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3"
[0m08:54:32.370383 [debug] [Thread-4 (]: Began executing node model.sumup.int_transaction
[0m08:54:32.370538 [debug] [Thread-1 (]: On test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3"} */

  
  





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        card_number
    ) >= 13 and length(
        card_number
    ) <= 25
)
 as expression


    from "postgres"."analytics_staging"."stg_transaction"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







  
  limit 5

[0m08:54:32.370675 [debug] [Thread-3 (]: Began executing node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m08:54:32.371953 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m08:54:32.372097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:54:32.373173 [debug] [Thread-3 (]: Using postgres connection "test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411"
[0m08:54:32.373343 [debug] [Thread-4 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

  
  

SELECT
    -- Primary and Foreign Keys
    transaction_id,
    t.device_id,

    -- Product Information
   
    CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA  AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data and Status
    amount_eur,
    status,

    --device data
    d.device_type,
    
    -- store_data
    d.store_id,
    store_name,
    store_typology,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction" t
LEFT JOIN "postgres"."analytics_staging"."stg_device" d ON t.device_id = d.device_id
LEFT JOIN "postgres"."analytics_staging"."stg_store" s ON d.store_id = s.store_id

-- Incremental Logic: Only select new records for subsequent runs

    WHERE t.created_at_utc > (SELECT MAX(created_at_utc) FROM "postgres"."analytics_analytics"."int_transaction")

  
  limit 5

[0m08:54:32.373539 [debug] [Thread-3 (]: On test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411"} */

  
  
    
    



select amount_eur
from "postgres"."analytics_staging"."stg_transaction"
where amount_eur is null



  
  limit 5

[0m08:54:32.373675 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:54:32.373806 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:54:32.374636 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.006 seconds
[0m08:54:32.375081 [debug] [Thread-2 (]: On test.sumup.not_null_stg_transaction_card_number.fb1135c280: Close
[0m08:54:32.375316 [debug] [Thread-2 (]: Finished running node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m08:54:32.375454 [debug] [Thread-2 (]: Began running node test.sumup.stg_transaction__amount_eur_is_positive.7336890e7d
[0m08:54:32.375604 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sumup.not_null_stg_transaction_card_number.fb1135c280, now test.sumup.stg_transaction__amount_eur_is_positive.7336890e7d)
[0m08:54:32.375722 [debug] [Thread-2 (]: Began compiling node test.sumup.stg_transaction__amount_eur_is_positive.7336890e7d
[0m08:54:32.377290 [debug] [Thread-2 (]: Writing injected SQL for node "test.sumup.stg_transaction__amount_eur_is_positive.7336890e7d"
[0m08:54:32.377532 [debug] [Thread-2 (]: Began executing node test.sumup.stg_transaction__amount_eur_is_positive.7336890e7d
[0m08:54:32.378726 [debug] [Thread-2 (]: Using postgres connection "test.sumup.stg_transaction__amount_eur_is_positive.7336890e7d"
[0m08:54:32.378850 [debug] [Thread-2 (]: On test.sumup.stg_transaction__amount_eur_is_positive.7336890e7d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.stg_transaction__amount_eur_is_positive.7336890e7d"} */

  
  

    
    with grouped_expression as (
    select
        
        
    
  amount_eur > 0 as expression


    from "postgres"."analytics_staging"."stg_transaction"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  
  limit 5

[0m08:54:32.378968 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:54:32.379144 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.007 seconds
[0m08:54:32.379286 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.005 seconds
[0m08:54:32.379767 [debug] [Thread-1 (]: On test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3: Close
[0m08:54:32.380197 [debug] [Thread-3 (]: On test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411: Close
[0m08:54:32.380449 [debug] [Thread-1 (]: Finished running node test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3
[0m08:54:32.380723 [debug] [Thread-3 (]: Finished running node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m08:54:32.380885 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.007 seconds
[0m08:54:32.381330 [debug] [Thread-4 (]: On model.sumup.int_transaction: Close
[0m08:54:32.381546 [debug] [Thread-4 (]: Finished running node model.sumup.int_transaction
[0m08:54:32.381721 [debug] [Thread-1 (]: Began running node model.sumup.customer_store_ranking
[0m08:54:32.381853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3, now model.sumup.customer_store_ranking)
[0m08:54:32.381975 [debug] [Thread-1 (]: Began compiling node model.sumup.customer_store_ranking
[0m08:54:32.382996 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m08:54:32.383224 [debug] [Thread-1 (]: Began executing node model.sumup.customer_store_ranking
[0m08:54:32.384341 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m08:54:32.384463 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  
  --Question 1) 

SELECT
    store_name,
    --SUM(amount_eur) AS total_amount
    amount_eur
FROM
    "postgres"."analytics_analytics"."int_transaction" 
WHERE status = 'accepted' and store_id = 3



--GROUP BY

--    store_name
--ORDER BY
--    total_amount DESC
--limit 10
  
  limit 5

[0m08:54:32.384580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:54:32.384767 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.006 seconds
[0m08:54:32.385152 [debug] [Thread-2 (]: On test.sumup.stg_transaction__amount_eur_is_positive.7336890e7d: Close
[0m08:54:32.385380 [debug] [Thread-2 (]: Finished running node test.sumup.stg_transaction__amount_eur_is_positive.7336890e7d
[0m08:54:32.388063 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m08:54:32.388480 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: Close
[0m08:54:32.388693 [debug] [Thread-1 (]: Finished running node model.sumup.customer_store_ranking
[0m08:54:32.389071 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:54:32.389177 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m08:54:32.389268 [debug] [MainThread]: Connection 'test.sumup.stg_transaction__amount_eur_is_positive.7336890e7d' was properly closed.
[0m08:54:32.389347 [debug] [MainThread]: Connection 'test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411' was properly closed.
[0m08:54:32.389426 [debug] [MainThread]: Connection 'model.sumup.int_transaction' was properly closed.
[0m08:54:32.390177 [debug] [MainThread]: Command end result
[0m08:54:32.407097 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:54:32.407776 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:54:32.410246 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andre/Desktop/sumup/sumup/target/run_results.json
[0m08:54:32.410364 [debug] [MainThread]: Excluded node 'device' from results
[0m08:54:32.410460 [debug] [MainThread]: Excluded node 'stg_device' from results
[0m08:54:32.410542 [debug] [MainThread]: Excluded node 'stg_store' from results
[0m08:54:32.410622 [debug] [MainThread]: Excluded node 'transaction' from results
[0m08:54:32.410703 [debug] [MainThread]: Excluded node 'stg_transaction' from results
[0m08:54:32.410783 [debug] [MainThread]: Excluded node 'not_null_stg_transaction_card_number' from results
[0m08:54:32.410862 [debug] [MainThread]: Excluded node 'dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13' from results
[0m08:54:32.410941 [debug] [MainThread]: Excluded node 'not_null_stg_transaction_amount_eur' from results
[0m08:54:32.411020 [debug] [MainThread]: Excluded node 'int_transaction' from results
[0m08:54:32.411097 [debug] [MainThread]: Excluded node 'stg_transaction__amount_eur_is_positive' from results
[0m08:54:32.412739 [info ] [MainThread]: Previewing node 'store':
|  id | name                 | address              | city                | country        | created_at          | ... |
| --- | -------------------- | -------------------- | ------------------- | -------------- | ------------------- | --- |
|   1 | Vulputate Risus PC   | Ap #124-1954 Adip... | Santa Inês          | Belgium        | 03/24/2023 4:52:21  | ... |
|   2 | Dui Fusce Associates | Ap #768-3045 Sed,... | Patarrá             | Poland         | 08/22/2023 3:45:35  | ... |
|   3 | Nec Ante Ltd         | 4587 Tincidunt Av... | Gaspé               | Costa Rica     | 11/17/2022 10:32:56 | ... |
|   4 | At Auctor Limited    | 1962 Lorem Avenue    | Siquirres           | Nigeria        | 12/15/2023 1:13:46  | ... |
|   5 | Ac Turpis Limited    | Ap #844-1075 A, Av.  | Mazenzele           | Ireland        | 04/13/2023 11:58:34 | ... |
|   6 | Mauris Nulla Inte... | Ap #621-7833 Ut A... | Móstoles            | India          | 01/27/2023 11:50:22 | ... |
|   7 | Mauris Morbi PC      | P.O. Box 475, 771... | Sapele              | Mexico         | 10/27/2022 2:11:01  | ... |
|   8 | In LLP               | 6182 Consequat Rd.   | Oaxaca              | Indonesia      | 04/19/2022 1:53:18  | ... |
|   9 | Magna Corporation    | Ap #356-9872 Mus.... | Dutse               | Belgium        | 12/04/2023 7:25:49  | ... |
|  10 | At Libero Limited    | Ap #822-4123 Nec Av. | Białystok           | India          | 10/02/2023 11:58:22 | ... |
|  11 | Lectus Rutrum Cor... | 287-7966 In Rd.      | Hoogeveen           | Brazil         | 11/08/2022 3:52:10  | ... |
|  12 | Eu Nibh LLC          | Ap #207-7061 Puru... | João Pessoa         | Australia      | 08/20/2022 10:27:04 | ... |
|  13 | At LLP               | Ap #981-5468 Id St.  | Chimbote            | France         | 08/05/2022 9:38:03  | ... |
|  14 | In Magna Phasellu... | P.O. Box 189, 877... | Ödemiş              | India          | 02/16/2023 3:29:06  | ... |
|  15 | Interdum Ligula PC   | 845-2200 Eros. St.   | Allentown           | Belgium        | 10/12/2023 4:26:02  | ... |
|  16 | Cum Sociis Natoqu... | 698-5310 Sagittis... | Shepparton          | Costa Rica     | 09/30/2022 9:59:02  | ... |
|  17 | Adipiscing Corp.     | 3529 Donec Avenue    | San Pablo           | Singapore      | 04/23/2023 4:59:49  | ... |
|  18 | Sapien Incorporated  | 7787 Mi Ave          | Brussel             | South Africa   | 05/23/2022 3:47:43  | ... |
|  19 | Magnis Dis Inc.      | 185-6396 Et Av.      | Florencia           | Netherlands    | 06/02/2022 7:59:07  | ... |
|  20 | Metus Aliquam Ass... | Ap #600-4448 Magn... | Steendorp           | Singapore      | 01/03/2023 12:52:05 | ... |
|  21 | Pede Suspendisse ... | P.O. Box 917, 847... | Cork                | Mexico         | 06/27/2022 11:53:36 | ... |
|  22 | Tincidunt Nunc In... | Ap #636-7983 Enim... | Jaén                | Netherlands    | 11/11/2023 11:06:57 | ... |
|  23 | Non LLP              | Ap #430-8283 Sapi... | Rankweil            | Italy          | 03/08/2023 10:26:09 | ... |
|  24 | Mollis Dui LLP       | Ap #779-1314 Mus.... | Baardegem           | United Kingdom | 06/20/2022 8:39:38  | ... |
|  25 | Nulla Magna Ltd      | Ap #953-3178 A Ave   | Pohang              | Colombia       | 07/08/2022 8:34:47  | ... |
|  26 | Ullamcorper Duis ... | Ap #144-5035 Ipsu... | Uribia              | Nigeria        | 10/16/2022 12:33:04 | ... |
|  27 | Duis Sit Incorpor... | Ap #927-6782 Lacu... | Sembawang           | South Korea    | 06/24/2023 12:17:25 | ... |
|  28 | Et Magna Incorpor... | 649-4506 Dolor. St.  | Srinagar            | Canada         | 07/29/2022 4:05:03  | ... |
|  29 | Sed Ltd              | 329-5885 Nibh. Ave   | Hebei               | South Africa   | 04/29/2023 1:57:52  | ... |
|  30 | Cursus Nunc Mauri... | Ap #205-6730 Mont... | San Juan del Río    | Austria        | 03/26/2023 7:06:54  | ... |
|  31 | Neque Tellus PC      | 5995 Mauris St.      | Canberra            | Brazil         | 05/12/2022 10:41:57 | ... |
|  32 | Augue Ut Lacus In... | Ap #352-2278 Ferm... | Seletar             | Vietnam        | 01/17/2023 10:20:59 | ... |
|  33 | Hendrerit Id Foun... | P.O. Box 646, 643... | Olivar              | Norway         | 07/17/2022 1:43:35  | ... |
|  34 | Et Netus Corporation | 3508 Euismod Street  | Port Blair          | Austria        | 04/23/2023 11:30:12 | ... |
|  35 | Ut Associates        | 460-3077 Tortor. Av. | Ribeirão Preto      | Indonesia      | 12/04/2023 11:26:21 | ... |
|  36 | Et Malesuada Company | Ap #817-7392 Nec Av. | Antalya             | Singapore      | 09/29/2023 4:42:51  | ... |
|  37 | Sit Industries       | Ap #939-7352 Et Av.  | Belfast             | China          | 03/31/2023 3:48:27  | ... |
|  38 | A Tortor Industries  | 228-2100 Ac Rd.      | Altmünster          | Nigeria        | 12/06/2023 7:00:02  | ... |
|  39 | Nisl Elementum Fo... | 894-4998 Netus Av.   | Canoas              | South Korea    | 09/22/2022 2:28:45  | ... |
|  40 | Lacus Etiam Inc.     | P.O. Box 974, 890... | Nagar               | Ukraine        | 06/13/2022 1:38:36  | ... |
|  41 | Nec LLC              | 4017 Sed Road        | Chungju             | Spain          | 02/01/2023 11:41:19 | ... |
|  42 | Volutpat Nunc Sit... | Ap #142-5475 Curs... | Zamora de Hidalgo   | Brazil         | 09/16/2022 2:25:22  | ... |
|  43 | Mollis Industries    | 411-5082 Amet Rd.    | Darwin              | Colombia       | 12/17/2023 7:13:27  | ... |
|  44 | Velit LLC            | Ap #598-2547 In Rd.  | Floreffe            | Chile          | 12/15/2023 10:55:37 | ... |
|  45 | Ut Institute         | Ap #854-8238 Vita... | Multan              | Vietnam        | 04/30/2023 11:31:11 | ... |
|  46 | Integer Mollis In... | P.O. Box 806, 735... | Tortel              | South Africa   | 05/20/2023 1:49:27  | ... |
|  47 | Lorem Foundation     | 689-251 In Av.       | Zamość              | Peru           | 09/04/2023 2:04:42  | ... |
|  48 | Aliquet Foundation   | Ap #927-6400 At Av.  | Tibet               | United Kingdom | 06/10/2022 10:07:24 | ... |
|  49 | Id Ante Nunc LLC     | 480-5234 Natoque Ave | Flekkefjord         | Netherlands    | 11/05/2022 11:02:23 | ... |
|  50 | Ac Company           | 8052 Cum Street      | Lauw                | France         | 01/28/2024 10:43:00 | ... |
|  51 | Mauris Aliquam PC    | 978-4890 Aliquam,... | Rosenheim           | Germany        | 01/21/2024 11:08:45 | ... |
|  52 | Volutpat Nunc PC     | P.O. Box 156, 329... | Kohima              | Italy          | 10/13/2023 8:36:19  | ... |
|  53 | Sed Incorporated     | Ap #627-8495 Aliq... | Kavaratti           | India          | 11/05/2023 9:40:54  | ... |
|  54 | Nisi Magna Ltd       | P.O. Box 155, 539... | Oaxaca              | Philippines    | 09/20/2022 1:10:32  | ... |
|  55 | Aliquam Corp.        | 803-8267 Imperdie... | Morelia             | Brazil         | 07/11/2022 8:59:50  | ... |
|  56 | Sit Amet Ornare C... | Ap #486-9555 Odio... | Frederikstad        | Netherlands    | 10/28/2023 7:17:16  | ... |
|  57 | Sapien Nunc Pulvi... | Ap #203-9131 Aliq... | Guadalupe           | Netherlands    | 02/25/2024 3:38:37  | ... |
|  58 | Tortor Dictum Eu ... | 674-2192 Nulla St.   | Fahler              | Germany        | 06/23/2023 3:27:05  | ... |
|  59 | Aliquam Vulputate... | Ap #221-5035 Elem... | Irapuato            | Brazil         | 08/01/2023 11:55:06 | ... |
|  60 | Eleifend Cras Ins... | 6862 Tincidunt, Rd.  | Dublin              | Indonesia      | 08/02/2022 5:48:41  | ... |
|  61 | Elementum Sem Corp.  | P.O. Box 850, 473... | Chandigarh          | Ukraine        | 06/02/2022 3:15:33  | ... |
|  62 | Semper Erat In In... | Ap #428-3415 Lacu... | Puerto Carreño      | United States  | 03/24/2024 2:36:58  | ... |
|  63 | Hendrerit Consect... | Ap #628-3480 Inte... | Việt Trì            | Austria        | 12/16/2022 1:58:59  | ... |
|  64 | Aliquet Magna LLP    | Ap #718-9112 Ligu... | Belfast             | Peru           | 11/26/2023 7:04:23  | ... |
|  65 | Mauris Sit Amet A... | Ap #397-6046 Fusc... | Ghanche             | South Africa   | 08/14/2023 2:29:39  | ... |
|  66 | Mauris A Institute   | 839-3744 Nullam A... | Olsztyn             | Ireland        | 09/30/2022 6:07:35  | ... |
|  67 | Nullam Vitae Corp.   | 680-4657 Donec St.   | Lagos               | Austria        | 12/19/2023 7:37:13  | ... |
|  68 | Lorem Vehicula Inc.  | 810-4532 Sapien S... | Chiclayo            | Peru           | 11/13/2023 11:40:22 | ... |
|  69 | Felis Purus Insti... | 975-9184 Ipsum. Av.  | Singkawang          | Netherlands    | 10/17/2022 4:40:23  | ... |
|  70 | Semper Institute     | P.O. Box 451, 734... | Piła                | Belgium        | 02/17/2024 10:47:27 | ... |
|  71 | Libero Lacus Corp.   | Ap #355-7187 Sapi... | Kirkcaldy           | United Kingdom | 01/16/2024 2:25:58  | ... |
|  72 | Dis Parturient Mo... | 5552 Vulputate Rd.   | Shanxi              | China          | 07/16/2023 4:32:40  | ... |
|  73 | Arcu Vestibulum Ltd  | 666-4076 Erat Street | Gorzów Wielkopolski | Ireland        | 01/21/2024 7:18:24  | ... |
|  74 | Dolor Nonummy Ac ... | 583-3427 Ac, Avenue  | Ziarat              | Poland         | 12/20/2022 11:20:39 | ... |
|  75 | Erat Neque Founda... | 596-1207 A St.       | Elbistan            | New Zealand    | 06/01/2022 12:35:13 | ... |
|  76 | Sed Corp.            | 610-8995 Quis St.    | Wonju               | United Kingdom | 08/07/2022 8:18:53  | ... |
|  77 | At Sem Molestie C... | Ap #139-3060 Sed Ave | Valenzuela          | Ukraine        | 08/31/2022 1:25:30  | ... |
|  78 | Ac Orci Ut PC        | Ap #322-7707 Ipsu... | Canlaon             | Indonesia      | 03/16/2023 4:04:07  | ... |
|  79 | Pede Ultrices Cor... | Ap #459-7576 Leo ... | Chimbote            | Australia      | 06/01/2023 9:14:28  | ... |
|  80 | Erat Industries      | 976-4028 Imperdie... | Zlatoust            | Netherlands    | 12/08/2022 6:55:14  | ... |
|  81 | Suspendisse Dui A... | Ap #246-6940 Tris... | Alençon             | Spain          | 11/13/2023 11:25:03 | ... |
|  82 | Blandit At Nisi Inc. | P.O. Box 539, 965... | Gore                | Brazil         | 01/28/2023 1:13:22  | ... |
|  83 | Iaculis Aliquet D... | 201-6042 Vehicula... | Sousa               | Belgium        | 06/21/2023 11:34:38 | ... |
|  84 | Quis LLP             | 7837 Sollicitudin... | Glasgow             | India          | 07/18/2023 10:43:50 | ... |
|  85 | Ultrices Posuere ... | 505-191 Torquent Rd. | Abbeville           | Ireland        | 10/30/2022 3:03:16  | ... |
|  86 | Nec Diam Corp.       | P.O. Box 560, 256... | Tczew               | India          | 01/03/2024 12:37:16 | ... |
|  87 | Luctus Ut Ltd        | Ap #924-9827 Soda... | Maryborough         | Belgium        | 11/14/2023 2:29:12  | ... |
|  88 | Aliquam Eros Turp... | Ap #533-3564 Eget... | Épernay             | Nigeria        | 10/14/2022 9:34:12  | ... |
|  89 | Vulputate Lacus I... | Ap #885-4676 Prim... | San Francisco       | United States  | 12/27/2022 9:14:34  | ... |
|  90 | Libero Est LLC       | Ap #930-1953 Cubi... | Bydgoszcz           | Nigeria        | 04/07/2023 8:08:01  | ... |
|  91 | Dignissim Lacus F... | 120-4773 Facilisi... | Dutse               | Germany        | 07/27/2023 9:38:06  | ... |
|  92 | Tempus Mauris Ltd    | Ap #179-4089 Phar... | Mỹ Tho              | France         | 07/01/2023 7:23:00  | ... |
|  93 | In Mi Institute      | 707-3480 Fringill... | Pskov               | Australia      | 05/21/2022 2:03:29  | ... |
|  94 | Quam Incorporated    | 283-6136 Sed Av.     | Khoái Châu          | United States  | 02/14/2024 10:46:30 | ... |
|  95 | Nullam Suscipit E... | Ap #859-7227 Pena... | Lagos               | Sweden         | 05/15/2023 6:21:29  | ... |
|  96 | Molestie Dapibus ... | Ap #533-548 Commo... | Huntly              | China          | 09/18/2022 9:45:57  | ... |
|  97 | Sem Ut Cursus Corp.  | 9686 Rutrum St.      | Sungei Kadut        | France         | 10/23/2022 5:12:41  | ... |
|  98 | Magna Suspendisse... | P.O. Box 238, 876... | Buenaventura        | Norway         | 03/18/2024 9:07:42  | ... |
|  99 | Vitae Nibh Donec ... | Ap #804-9661 Impe... | Denpasar            | New Zealand    | 08/14/2023 9:21:36  | ... |
| 100 | Non Leo PC           | 956-3578 Augue St.   | Inner Mongolia      | Chile          | 10/07/2023 8:46:37  | ... |

[0m08:54:32.413436 [info ] [MainThread]: Previewing node 'customer_store_ranking':
| store_name   | amount_eur |
| ------------ | ---------- |
| Nec Ante Ltd |       3.29 |
| Nec Ante Ltd |       1.25 |
| Nec Ante Ltd |       8.23 |
| Nec Ante Ltd |       7.14 |
| Nec Ante Ltd |       4.12 |

[0m08:54:32.414859 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 2.0356069, "process_in_blocks": "0", "process_kernel_time": 0.130475, "process_mem_max_rss": "140771328", "process_out_blocks": "0", "process_user_time": 2.358689}
[0m08:54:32.415016 [debug] [MainThread]: Command `dbt show` succeeded at 08:54:32.414984 after 2.04 seconds
[0m08:54:32.415141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105e5c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105a51d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc8440>]}
[0m08:54:32.415267 [debug] [MainThread]: Flushing usage events
[0m08:54:32.947487 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:55:29.291630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e74050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb3c50>]}


============================== 08:55:29.294573 | ea0b5c00-01cf-4b9e-9602-c05fb14a08eb ==============================
[0m08:55:29.294573 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:55:29.294840 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'indirect_selection': 'eager', 'partial_parse': 'False', 'introspect': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'use_colors': 'True', 'no_print': 'None', 'target_path': 'None', 'write_json': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'invocation_command': 'dbt show --no-partial-parse --select +customer_store_ranking', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'empty': 'None'}
[0m08:55:29.386440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea0b5c00-01cf-4b9e-9602-c05fb14a08eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd7950>]}
[0m08:55:29.409031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea0b5c00-01cf-4b9e-9602-c05fb14a08eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b4acf0>]}
[0m08:55:29.419182 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:55:29.469108 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:55:29.469506 [debug] [MainThread]: Partial parsing not enabled
[0m08:55:30.092955 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m08:55:30.093218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ea0b5c00-01cf-4b9e-9602-c05fb14a08eb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ca7e50>]}
[0m08:55:30.111669 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_expectations_expression_is_true_stg_transaction_card_number__NOT_REGEXP_LIKE_REPLACE_REPLACE_card_number_0_ (models/staging/stg_transaction.yml)
  macro 'dbt_macro__test_expression_is_true' takes no keyword argument 'column_name'
[0m08:55:30.111967 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:55:30.113999 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.8521498, "process_in_blocks": "0", "process_kernel_time": 0.118733, "process_mem_max_rss": "127336448", "process_out_blocks": "0", "process_user_time": 1.225005}
[0m08:55:30.114172 [debug] [MainThread]: Command `dbt show` failed at 08:55:30.114139 after 0.85 seconds
[0m08:55:30.114312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10625e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10625e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba7e70>]}
[0m08:55:30.114442 [debug] [MainThread]: Flushing usage events
[0m08:55:31.143423 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:56:02.950402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105274050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d33c50>]}


============================== 08:56:02.953113 | 8e0bc125-7968-4447-b4ee-d0c9321cbd89 ==============================
[0m08:56:02.953113 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:56:02.953383 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'debug': 'False', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'target_path': 'None', 'partial_parse': 'False', 'empty': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt show --no-partial-parse --select +customer_store_ranking', 'static_parser': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m08:56:03.043908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e0bc125-7968-4447-b4ee-d0c9321cbd89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106357950>]}
[0m08:56:03.066011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e0bc125-7968-4447-b4ee-d0c9321cbd89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108acacf0>]}
[0m08:56:03.077438 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:56:03.126104 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:56:03.126469 [debug] [MainThread]: Partial parsing not enabled
[0m08:56:03.748214 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m08:56:03.748474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8e0bc125-7968-4447-b4ee-d0c9321cbd89', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a7fe50>]}
[0m08:56:03.766066 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/staging/stg_transaction.yml:
  	test definition dictionary must have exactly one key, got [('name', 'fraud_check_high_frequency_declines'), ('tags', ['fraud']), ('warn_if', "SELECT \n  COUNT(t1.transaction_id) \nFROM {{ this }} t1 JOIN {{ this }} t2\n  ON t1.card_number_hashed = t2.card_number_hashed -- Same card\n  AND t1.transaction_id != t2.transaction_id      -- Different transactions\nWHERE t1.status = 'refused'\n  AND t2.status = 'refused'\n  -- Time check: Two declined transactions by the same card within 60 minutes\n  AND t2.happened_at_utc BETWEEN t1.happened_at_utc AND (t1.happened_at_utc + INTERVAL '60 minutes')\n  -- Only flag if it happens frequently (e.g., more than 2 refused attempts in the window)\nHAVING COUNT(t1.transaction_id) > 2")] instead (3 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m08:56:03.766405 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:56:03.768553 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.8471655, "process_in_blocks": "0", "process_kernel_time": 0.128917, "process_mem_max_rss": "126943232", "process_out_blocks": "0", "process_user_time": 1.238663}
[0m08:56:03.768727 [debug] [MainThread]: Command `dbt show` failed at 08:56:03.768693 after 0.85 seconds
[0m08:56:03.768883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9a99a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9a8b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c27e70>]}
[0m08:56:03.769014 [debug] [MainThread]: Flushing usage events
[0m08:56:04.277239 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:56:15.832587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108198050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fdb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fdbc50>]}


============================== 08:56:15.835048 | bca64b8a-4956-4e32-907c-59c29dd6b83f ==============================
[0m08:56:15.835048 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:56:15.835312 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'no_print': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'static_parser': 'True', 'printer_width': '80', 'introspect': 'True', 'version_check': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'False', 'invocation_command': 'dbt show --no-partial-parse --select +customer_store_ranking', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'use_colors': 'True', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'debug': 'False', 'fail_fast': 'False'}
[0m08:56:15.918488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bca64b8a-4956-4e32-907c-59c29dd6b83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082fb950>]}
[0m08:56:15.940312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bca64b8a-4956-4e32-907c-59c29dd6b83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e6ecf0>]}
[0m08:56:15.949603 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:56:15.994962 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:56:15.995324 [debug] [MainThread]: Partial parsing not enabled
[0m08:56:16.614850 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m08:56:16.615109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bca64b8a-4956-4e32-907c-59c29dd6b83f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fcbe50>]}
[0m08:56:16.671449 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m08:56:16.673580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bca64b8a-4956-4e32-907c-59c29dd6b83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0e48c0>]}
[0m08:56:16.716292 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:56:16.717801 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:56:16.719389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bca64b8a-4956-4e32-907c-59c29dd6b83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a23d7f0>]}
[0m08:56:16.719581 [info ] [MainThread]: Found 9 models, 3 seeds, 9 data tests, 714 macros
[0m08:56:16.719717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bca64b8a-4956-4e32-907c-59c29dd6b83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a45b2b0>]}
[0m08:56:16.720540 [info ] [MainThread]: 
[0m08:56:16.720677 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:56:16.720783 [info ] [MainThread]: 
[0m08:56:16.720974 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:56:16.722667 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m08:56:16.726702 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m08:56:16.728168 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m08:56:16.749525 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:56:16.749721 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:56:16.749881 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:56:16.750022 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m08:56:16.750145 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m08:56:16.750266 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m08:56:16.750385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:56:16.750492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:56:16.750600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:56:16.781716 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m08:56:16.781901 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m08:56:16.782032 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m08:56:16.782160 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:56:16.782281 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:56:16.782399 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:56:16.782526 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m08:56:16.782660 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:56:16.782798 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m08:56:16.790332 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m08:56:16.790450 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m08:56:16.790561 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m08:56:16.791153 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m08:56:16.791629 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:56:16.792055 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m08:56:16.792310 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m08:56:16.792420 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:56:16.792536 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m08:56:16.795377 [debug] [MainThread]: Using postgres connection "master"
[0m08:56:16.795504 [debug] [MainThread]: On master: BEGIN
[0m08:56:16.795600 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:56:16.800758 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:56:16.800871 [debug] [MainThread]: Using postgres connection "master"
[0m08:56:16.801013 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:56:16.807520 [debug] [MainThread]: SQL status: SELECT 5 in 0.006 seconds
[0m08:56:16.808300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bca64b8a-4956-4e32-907c-59c29dd6b83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2c7890>]}
[0m08:56:16.808454 [debug] [MainThread]: On master: ROLLBACK
[0m08:56:16.808656 [debug] [MainThread]: On master: Close
[0m08:56:16.809896 [debug] [Thread-1 (]: Began running node seed.sumup.device
[0m08:56:16.810041 [debug] [Thread-3 (]: Began running node seed.sumup.transaction
[0m08:56:16.810356 [debug] [Thread-2 (]: Began running node seed.sumup.store
[0m08:56:16.810221 [info ] [Thread-1 (]: 1 of 17 START seed file analytics.device ....................................... [RUN]
[0m08:56:16.810606 [info ] [Thread-3 (]: 3 of 17 START seed file analytics.transaction .................................. [RUN]
[0m08:56:16.810788 [info ] [Thread-2 (]: 2 of 17 START seed file analytics.store ........................................ [RUN]
[0m08:56:16.810954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now seed.sumup.device)
[0m08:56:16.811090 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now seed.sumup.transaction)
[0m08:56:16.811217 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now seed.sumup.store)
[0m08:56:16.811345 [debug] [Thread-1 (]: Began compiling node seed.sumup.device
[0m08:56:16.811463 [debug] [Thread-3 (]: Began compiling node seed.sumup.transaction
[0m08:56:16.811580 [debug] [Thread-2 (]: Began compiling node seed.sumup.store
[0m08:56:16.811713 [debug] [Thread-1 (]: Began executing node seed.sumup.device
[0m08:56:16.811845 [debug] [Thread-3 (]: Began executing node seed.sumup.transaction
[0m08:56:16.811968 [debug] [Thread-2 (]: Began executing node seed.sumup.store
[0m08:56:16.827785 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m08:56:16.827982 [debug] [Thread-1 (]: On seed.sumup.device: BEGIN
[0m08:56:16.828109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:56:16.829790 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m08:56:16.830028 [debug] [Thread-2 (]: On seed.sumup.store: BEGIN
[0m08:56:16.836436 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:56:16.842860 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m08:56:16.845874 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m08:56:16.846073 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m08:56:16.846234 [debug] [Thread-3 (]: On seed.sumup.transaction: BEGIN
[0m08:56:16.846368 [debug] [Thread-1 (]: On seed.sumup.device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.device"} */
truncate table "postgres"."analytics"."device"
[0m08:56:16.846507 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:56:16.848148 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.001 seconds
[0m08:56:16.863678 [debug] [Thread-2 (]: SQL status: BEGIN in 0.027 seconds
[0m08:56:16.863841 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m08:56:16.876365 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m08:56:16.884670 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m08:56:16.884800 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m08:56:16.884929 [debug] [Thread-2 (]: On seed.sumup.store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.store"} */
truncate table "postgres"."analytics"."store"
[0m08:56:16.885065 [debug] [Thread-1 (]: On seed.sumup.device: 
          insert into "postgres"."analytics"."device" ("id", "type", "store_id") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s...
[0m08:56:16.885198 [debug] [Thread-3 (]: On seed.sumup.transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.transaction"} */
truncate table "postgres"."analytics"."transaction"
[0m08:56:16.888248 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.003 seconds
[0m08:56:16.893700 [debug] [Thread-1 (]: SQL status: INSERT 0 200 in 0.008 seconds
[0m08:56:16.902023 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.sumup.device"
[0m08:56:16.902182 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0.017 seconds
[0m08:56:16.951714 [debug] [Thread-1 (]: On seed.sumup.device: COMMIT
[0m08:56:16.954694 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m08:56:16.964386 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m08:56:16.989429 [debug] [Thread-2 (]: On seed.sumup.store: 
          insert into "postgres"."analytics"."store" ("id", "name", "address", "city", "country", "created_at", "typology", "customer_id") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%...
[0m08:56:17.014443 [debug] [Thread-1 (]: On seed.sumup.device: COMMIT
[0m08:56:17.047476 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.014 seconds
[0m08:56:17.104907 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m08:56:17.117505 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.sumup.store"
[0m08:56:17.136810 [debug] [Thread-1 (]: On seed.sumup.device: Close
[0m08:56:17.193136 [debug] [Thread-2 (]: On seed.sumup.store: COMMIT
[0m08:56:17.198918 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m08:56:17.205354 [debug] [Thread-2 (]: On seed.sumup.store: COMMIT
[0m08:56:17.232608 [debug] [Thread-2 (]: SQL status: COMMIT in 0.021 seconds
[0m08:56:17.232918 [debug] [Thread-2 (]: On seed.sumup.store: Close
[0m08:56:17.245184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bca64b8a-4956-4e32-907c-59c29dd6b83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4ea410>]}
[0m08:56:17.257832 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bca64b8a-4956-4e32-907c-59c29dd6b83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6358b0>]}
[0m08:56:17.251444 [info ] [Thread-1 (]: 1 of 17 OK loaded seed file analytics.device ................................... [[32mINSERT 200[0m in 0.38s]
[0m08:56:17.258100 [info ] [Thread-2 (]: 2 of 17 OK loaded seed file analytics.store .................................... [[32mINSERT 100[0m in 0.43s]
[0m08:56:17.283400 [debug] [Thread-1 (]: Finished running node seed.sumup.device
[0m08:56:17.302106 [debug] [Thread-2 (]: Finished running node seed.sumup.store
[0m08:56:17.344780 [debug] [Thread-4 (]: Began running node model.sumup.stg_device
[0m08:56:17.351070 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.sumup.stg_device'
[0m08:56:17.351233 [debug] [Thread-4 (]: Began compiling node model.sumup.stg_device
[0m08:56:17.354404 [debug] [Thread-4 (]: Writing injected SQL for node "model.sumup.stg_device"
[0m08:56:17.360840 [debug] [Thread-1 (]: Began running node model.sumup.stg_store
[0m08:56:17.360992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.sumup.device, now model.sumup.stg_store)
[0m08:56:17.361135 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_store
[0m08:56:17.374418 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_store"
[0m08:56:17.387093 [debug] [Thread-4 (]: Began executing node model.sumup.stg_device
[0m08:56:17.402406 [debug] [Thread-4 (]: Using postgres connection "model.sumup.stg_device"
[0m08:56:17.408830 [debug] [Thread-4 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */

  
  

SELECT
    -- Primary Key
    id AS device_id,

    -- Foreign Key to stores (assuming this links the device to a specific store)
    store_id,

    -- Descriptive Attributes
    type as device_type
    
    -- Other fields, if any, standardized here
    -- e.g., CAST(status AS VARCHAR) AS device_status

    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-22 06:56:15.825079+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."device"
  
  limit 5

[0m08:56:17.409000 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:56:17.421357 [debug] [Thread-1 (]: Began executing node model.sumup.stg_store
[0m08:56:17.427597 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.019 seconds
[0m08:56:17.441227 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_store"
[0m08:56:17.465513 [debug] [Thread-4 (]: On model.sumup.stg_device: Close
[0m08:56:17.490183 [debug] [Thread-1 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */

  
  

SELECT
    -- Primary Key: Rename to be explicit
    id AS store_id,
    name AS store_name,

    -- Descriptive Attributes: Rename 'typology' for clarity
    typology AS store_typology,
    country,
    city
    
    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-22 06:56:15.825079+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."store"
  
  limit 5

[0m08:56:17.515366 [debug] [Thread-4 (]: Finished running node model.sumup.stg_device
[0m08:56:17.515504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:56:17.558968 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.043 seconds
[0m08:56:17.565855 [debug] [Thread-1 (]: On model.sumup.stg_store: Close
[0m08:56:17.578625 [debug] [Thread-1 (]: Finished running node model.sumup.stg_store
[0m08:56:17.804133 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m08:56:17.804282 [debug] [Thread-3 (]: On seed.sumup.transaction: 
          insert into "postgres"."analytics"."transaction" ("id", "device_id", "product_name", "product_sku", "category_name", "amount", "status", "card_number", "cvv", "created_at", "happened_at") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m08:56:17.833614 [debug] [Thread-3 (]: SQL status: INSERT 0 1500 in 0.029 seconds
[0m08:56:17.833997 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.sumup.transaction"
[0m08:56:17.835258 [debug] [Thread-3 (]: On seed.sumup.transaction: COMMIT
[0m08:56:17.835392 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m08:56:17.835514 [debug] [Thread-3 (]: On seed.sumup.transaction: COMMIT
[0m08:56:17.839173 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m08:56:17.839436 [debug] [Thread-3 (]: On seed.sumup.transaction: Close
[0m08:56:17.839647 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bca64b8a-4956-4e32-907c-59c29dd6b83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a87ef50>]}
[0m08:56:17.839857 [info ] [Thread-3 (]: 3 of 17 OK loaded seed file analytics.transaction .............................. [[32mINSERT 1500[0m in 1.03s]
[0m08:56:17.840065 [debug] [Thread-3 (]: Finished running node seed.sumup.transaction
[0m08:56:17.840363 [debug] [Thread-2 (]: Began running node model.sumup.stg_transaction
[0m08:56:17.840531 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.sumup.store, now model.sumup.stg_transaction)
[0m08:56:17.840668 [debug] [Thread-2 (]: Began compiling node model.sumup.stg_transaction
[0m08:56:17.841865 [debug] [Thread-2 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m08:56:17.842120 [debug] [Thread-2 (]: Began executing node model.sumup.stg_transaction
[0m08:56:17.843621 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:56:17.843779 [debug] [Thread-2 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  
  SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) AS amount_eur,
    LOWER(status) AS status,

    -- Card Information 
    REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '') AS card_number,
    CAST(cvv AS VARCHAR) AS cvv,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  
  limit 5

[0m08:56:17.843926 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:56:17.849153 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.005 seconds
[0m08:56:17.849873 [debug] [Thread-2 (]: On model.sumup.stg_transaction: Close
[0m08:56:17.850217 [debug] [Thread-2 (]: Finished running node model.sumup.stg_transaction
[0m08:56:17.850574 [debug] [Thread-4 (]: Began running node model.sumup.int_transaction
[0m08:56:17.850745 [debug] [Thread-3 (]: Began running node test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3
[0m08:56:17.850886 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.sumup.stg_device, now model.sumup.int_transaction)
[0m08:56:17.851019 [debug] [Thread-2 (]: Began running node test.sumup.dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed.1150af2be1
[0m08:56:17.851149 [debug] [Thread-1 (]: Began running node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m08:56:17.851296 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.sumup.transaction, now test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3)
[0m08:56:17.851430 [debug] [Thread-4 (]: Began compiling node model.sumup.int_transaction
[0m08:56:17.851556 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sumup.stg_transaction, now test.sumup.dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed.1150af2be1)
[0m08:56:17.851695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.stg_store, now test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad)
[0m08:56:17.851828 [debug] [Thread-3 (]: Began compiling node test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3
[0m08:56:17.853602 [debug] [Thread-4 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m08:56:17.853759 [debug] [Thread-2 (]: Began compiling node test.sumup.dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed.1150af2be1
[0m08:56:17.853892 [debug] [Thread-1 (]: Began compiling node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m08:56:17.855893 [debug] [Thread-3 (]: Writing injected SQL for node "test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3"
[0m08:56:17.858936 [debug] [Thread-1 (]: Writing injected SQL for node "test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad"
[0m08:56:17.859209 [debug] [Thread-4 (]: Began executing node model.sumup.int_transaction
[0m08:56:17.860523 [debug] [Thread-4 (]: Using postgres connection "model.sumup.int_transaction"
[0m08:56:17.860661 [debug] [Thread-3 (]: Began executing node test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3
[0m08:56:17.861124 [debug] [Thread-4 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

  
  

SELECT
    -- Primary and Foreign Keys
    transaction_id,
    t.device_id,

    -- Product Information
   
    CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA  AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data and Status
    amount_eur,
    status,

    --device data
    d.device_type,
    
    -- store_data
    d.store_id,
    store_name,
    store_typology,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction" t
LEFT JOIN "postgres"."analytics_staging"."stg_device" d ON t.device_id = d.device_id
LEFT JOIN "postgres"."analytics_staging"."stg_store" s ON d.store_id = s.store_id

-- Incremental Logic: Only select new records for subsequent runs

    WHERE t.created_at_utc > (SELECT MAX(created_at_utc) FROM "postgres"."analytics_analytics"."int_transaction")

  
  limit 5

[0m08:56:17.861269 [debug] [Thread-1 (]: Began executing node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m08:56:17.862389 [debug] [Thread-3 (]: Using postgres connection "test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3"
[0m08:56:17.862529 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:56:17.863767 [debug] [Thread-1 (]: Using postgres connection "test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad"
[0m08:56:17.863941 [debug] [Thread-3 (]: On test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3"} */

  
  





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        card_number
    ) >= 13 and length(
        card_number
    ) <= 25
)
 as expression


    from "postgres"."analytics_staging"."stg_transaction"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







  
  limit 5

[0m08:56:17.864166 [debug] [Thread-1 (]: On test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad"} */

  
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "postgres"."analytics_staging"."stg_transaction"
    group by status

)

select *
from all_values
where value_field not in (
    'accepted','refused','cancelled'
)



  
  limit 5

[0m08:56:17.864343 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:56:17.864487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:56:17.868623 [debug] [Thread-2 (]: Compilation Error in test dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed (models/staging/stg_transaction.yml)
  'dict object' has no attribute 'test_expect_column_values_to_not_be_null_percent'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m08:56:17.868855 [debug] [Thread-2 (]: Finished running node test.sumup.dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed.1150af2be1
[0m08:56:17.869022 [debug] [Thread-2 (]: Began running node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m08:56:17.869189 [debug] [Thread-7 (]: Marking all children of 'test.sumup.dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed.1150af2be1' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed (models/staging/stg_transaction.yml)
  'dict object' has no attribute 'test_expect_column_values_to_not_be_null_percent'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m08:56:17.869353 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sumup.dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed.1150af2be1, now test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411)
[0m08:56:17.869773 [debug] [Thread-2 (]: Began compiling node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m08:56:17.873036 [debug] [Thread-2 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411"
[0m08:56:17.873195 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.009 seconds
[0m08:56:17.873354 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m08:56:17.873867 [debug] [Thread-3 (]: On test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3: Close
[0m08:56:17.874040 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.012 seconds
[0m08:56:17.874483 [debug] [Thread-1 (]: On test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad: Close
[0m08:56:17.874768 [debug] [Thread-3 (]: Finished running node test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3
[0m08:56:17.874898 [debug] [Thread-2 (]: Began executing node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m08:56:17.875351 [debug] [Thread-4 (]: On model.sumup.int_transaction: Close
[0m08:56:17.875522 [debug] [Thread-3 (]: Began running node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m08:56:17.875762 [debug] [Thread-1 (]: Finished running node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m08:56:17.877160 [debug] [Thread-2 (]: Using postgres connection "test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411"
[0m08:56:17.877407 [debug] [Thread-4 (]: Finished running node model.sumup.int_transaction
[0m08:56:17.877545 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3, now test.sumup.not_null_stg_transaction_card_number.fb1135c280)
[0m08:56:17.877706 [debug] [Thread-1 (]: Began running node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m08:56:17.877856 [debug] [Thread-2 (]: On test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411"} */

  
  
    
    



select amount_eur
from "postgres"."analytics_staging"."stg_transaction"
where amount_eur is null



  
  limit 5

[0m08:56:17.878011 [debug] [Thread-4 (]: Began running node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m08:56:17.878168 [debug] [Thread-3 (]: Began compiling node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m08:56:17.878273 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:56:17.878450 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:56:17.879846 [debug] [Thread-3 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_card_number.fb1135c280"
[0m08:56:17.879948 [debug] [MainThread]: Connection 'test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad' was properly closed.
[0m08:56:17.880119 [debug] [MainThread]: Connection 'test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411' was properly closed.
[0m08:56:17.880221 [debug] [MainThread]: Connection 'test.sumup.not_null_stg_transaction_card_number.fb1135c280' was properly closed.
[0m08:56:17.880313 [debug] [MainThread]: Connection 'model.sumup.int_transaction' was properly closed.
[0m08:56:17.880634 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.sumup.not_null_stg_transaction_device_id.b84ae0844e'
[0m08:56:17.880768 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.sumup.not_null_stg_transaction_id.f3ec2fc021'
[0m08:56:17.880499 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test dbt_expectations_expect_column_values_to_not_be_null_percent_stg_transaction_0_99__cvv_hashed (models/staging/stg_transaction.yml)
    'dict object' has no attribute 'test_expect_column_values_to_not_be_null_percent'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m08:56:17.880941 [debug] [Thread-1 (]: Began compiling node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m08:56:17.881074 [debug] [Thread-3 (]: Began executing node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m08:56:17.881199 [debug] [Thread-4 (]: Began compiling node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m08:56:17.881404 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:56:17.882933 [debug] [Thread-1 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_device_id.b84ae0844e"
[0m08:56:17.885564 [debug] [Thread-4 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_id.f3ec2fc021"
[0m08:56:17.887182 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 2.0809507, "process_in_blocks": "0", "process_kernel_time": 0.141078, "process_mem_max_rss": "141737984", "process_out_blocks": "0", "process_user_time": 2.363852}
[0m08:56:17.887372 [debug] [MainThread]: Command `dbt show` failed at 08:56:17.887335 after 2.08 seconds
[0m08:56:17.887558 [debug] [MainThread]: Connection 'test.sumup.not_null_stg_transaction_device_id.b84ae0844e' was properly closed.
[0m08:56:17.887712 [debug] [Thread-1 (]: Began executing node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m08:56:17.887859 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.009 seconds
[0m08:56:17.887982 [debug] [MainThread]: Connection 'test.sumup.not_null_stg_transaction_id.f3ec2fc021' was properly closed.
[0m08:56:17.889466 [debug] [Thread-4 (]: Began executing node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m08:56:17.889961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109068440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b53f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a351790>]}
[0m08:56:17.891386 [debug] [MainThread]: Flushing usage events
[0m08:56:17.891605 [debug] [Thread-2 (]: Finished running node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m08:56:17.892088 [debug] [Thread-2 (]: Began running node test.sumup.not_null_stg_transaction_status.87ab6c4b42
[0m08:56:17.892500 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.sumup.not_null_stg_transaction_status.87ab6c4b42'
[0m08:56:17.892668 [debug] [Thread-2 (]: Began compiling node test.sumup.not_null_stg_transaction_status.87ab6c4b42
[0m08:56:17.894450 [debug] [Thread-2 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_status.87ab6c4b42"
[0m08:56:17.895513 [debug] [Thread-4 (]: Runtime Error in test not_null_stg_transaction_id (models/staging/stg_transaction.yml)
  connection never acquired for thread (72220, 6180827136), have []
[0m08:56:17.896180 [debug] [Thread-4 (]: Finished running node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m08:56:17.896406 [debug] [Thread-3 (]: Runtime Error in test not_null_stg_transaction_card_number (models/staging/stg_transaction.yml)
  connection never acquired for thread (72220, 6162853888), have [(72220, 6129201152), (72220, 6180827136)]
[0m08:56:17.896621 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_transaction_device_id (models/staging/stg_transaction.yml)
  connection never acquired for thread (72220, 6129201152), have []
[0m08:56:17.896790 [debug] [Thread-4 (]: Began running node test.sumup.unique_stg_transaction_id.f181c9397b
[0m08:56:17.897149 [debug] [Thread-7 (]: Marking all children of 'test.sumup.not_null_stg_transaction_id.f3ec2fc021' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transaction_id (models/staging/stg_transaction.yml)
  connection never acquired for thread (72220, 6180827136), have [].
[0m08:56:17.897377 [debug] [Thread-3 (]: Finished running node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m08:56:17.897694 [debug] [Thread-1 (]: Finished running node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m08:56:17.897838 [debug] [Thread-2 (]: Began executing node test.sumup.not_null_stg_transaction_status.87ab6c4b42
[0m08:56:17.898010 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.sumup.unique_stg_transaction_id.f181c9397b'
[0m08:56:17.898443 [debug] [Thread-7 (]: Marking all children of 'test.sumup.not_null_stg_transaction_card_number.fb1135c280' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transaction_card_number (models/staging/stg_transaction.yml)
  connection never acquired for thread (72220, 6162853888), have [(72220, 6129201152), (72220, 6180827136)].
[0m08:56:17.899836 [debug] [Thread-2 (]: Using postgres connection "test.sumup.not_null_stg_transaction_status.87ab6c4b42"
[0m08:56:17.899985 [debug] [Thread-4 (]: Began compiling node test.sumup.unique_stg_transaction_id.f181c9397b
[0m08:56:17.900179 [debug] [Thread-7 (]: Marking all children of 'test.sumup.not_null_stg_transaction_device_id.b84ae0844e' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transaction_device_id (models/staging/stg_transaction.yml)
  connection never acquired for thread (72220, 6129201152), have [].
[0m08:56:17.900327 [debug] [Thread-2 (]: On test.sumup.not_null_stg_transaction_status.87ab6c4b42: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.not_null_stg_transaction_status.87ab6c4b42"} */

  
  
    
    



select status
from "postgres"."analytics_staging"."stg_transaction"
where status is null



  
  limit 5

[0m08:56:17.902640 [debug] [Thread-4 (]: Writing injected SQL for node "test.sumup.unique_stg_transaction_id.f181c9397b"
[0m08:56:17.902804 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:56:17.903119 [debug] [Thread-4 (]: Began executing node test.sumup.unique_stg_transaction_id.f181c9397b
[0m08:56:17.904503 [debug] [Thread-4 (]: Using postgres connection "test.sumup.unique_stg_transaction_id.f181c9397b"
[0m08:56:17.904628 [debug] [Thread-4 (]: On test.sumup.unique_stg_transaction_id.f181c9397b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.unique_stg_transaction_id.f181c9397b"} */

  
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."analytics_staging"."stg_transaction"
where id is not null
group by id
having count(*) > 1



  
  limit 5

[0m08:56:17.904744 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:56:17.908647 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.006 seconds
[0m08:56:17.909077 [debug] [Thread-2 (]: On test.sumup.not_null_stg_transaction_status.87ab6c4b42: Close
[0m08:56:17.909306 [debug] [Thread-2 (]: Finished running node test.sumup.not_null_stg_transaction_status.87ab6c4b42
[0m08:56:17.912543 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 9:     id as unique_field,
            ^

[0m08:56:17.912685 [debug] [Thread-4 (]: On test.sumup.unique_stg_transaction_id.f181c9397b: Close
[0m08:56:17.913761 [debug] [Thread-4 (]: Database Error in test unique_stg_transaction_id (models/staging/stg_transaction.yml)
  column "id" does not exist
  LINE 9:     id as unique_field,
              ^
[0m08:56:17.913945 [debug] [Thread-4 (]: Finished running node test.sumup.unique_stg_transaction_id.f181c9397b
[0m08:56:17.914109 [debug] [Thread-7 (]: Marking all children of 'test.sumup.unique_stg_transaction_id.f181c9397b' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_transaction_id (models/staging/stg_transaction.yml)
  column "id" does not exist
  LINE 9:     id as unique_field,
              ^.
[0m08:56:18.426040 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:56:32.807656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a1c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088579d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108857c50>]}


============================== 08:56:32.810052 | fa25b490-25d8-4f69-bccf-d2cdd2988aa1 ==============================
[0m08:56:32.810052 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:56:32.810318 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'invocation_command': 'dbt show --no-partial-parse --select +customer_store_ranking', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'warn_error': 'None', 'no_print': 'None', 'partial_parse': 'False', 'use_colors': 'True', 'version_check': 'True', 'debug': 'False', 'target_path': 'None', 'introspect': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'profiles_dir': '/Users/andre/Desktop/sumup/sumup', 'printer_width': '80', 'log_path': '/Users/andre/Desktop/sumup/sumup/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True'}
[0m08:56:32.894637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa25b490-25d8-4f69-bccf-d2cdd2988aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b7f950>]}
[0m08:56:32.916996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa25b490-25d8-4f69-bccf-d2cdd2988aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086eecf0>]}
[0m08:56:32.926506 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:56:32.969531 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:56:32.969894 [debug] [MainThread]: Partial parsing not enabled
[0m08:56:33.611017 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m08:56:33.611282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fa25b490-25d8-4f69-bccf-d2cdd2988aa1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10984be50>]}
[0m08:56:33.664521 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sumup.core
[0m08:56:33.666628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa25b490-25d8-4f69-bccf-d2cdd2988aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10995c8c0>]}
[0m08:56:33.709166 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andre/Desktop/sumup/sumup/target/manifest.json
[0m08:56:33.710353 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andre/Desktop/sumup/sumup/target/semantic_manifest.json
[0m08:56:33.711556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa25b490-25d8-4f69-bccf-d2cdd2988aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ab97f0>]}
[0m08:56:33.711734 [info ] [MainThread]: Found 9 models, 3 seeds, 8 data tests, 714 macros
[0m08:56:33.711866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa25b490-25d8-4f69-bccf-d2cdd2988aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109caf450>]}
[0m08:56:33.712645 [info ] [MainThread]: 
[0m08:56:33.712784 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:56:33.712891 [info ] [MainThread]: 
[0m08:56:33.713085 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:56:33.714709 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_staging'
[0m08:56:33.718847 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics_analytics'
[0m08:56:33.720208 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_analytics'
[0m08:56:33.737365 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:56:33.737549 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:56:33.737700 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:56:33.737849 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m08:56:33.737970 [debug] [ThreadPool]: On list_postgres_analytics: BEGIN
[0m08:56:33.738093 [debug] [ThreadPool]: On list_postgres_analytics_analytics: BEGIN
[0m08:56:33.738218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:56:33.738326 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:56:33.738436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:56:33.755462 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m08:56:33.755639 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m08:56:33.755756 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m08:56:33.755868 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics"
[0m08:56:33.756001 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_analytics"
[0m08:56:33.756141 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m08:56:33.756275 [debug] [ThreadPool]: On list_postgres_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:56:33.756417 [debug] [ThreadPool]: On list_postgres_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m08:56:33.756565 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m08:56:33.760847 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m08:56:33.761002 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m08:56:33.761116 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m08:56:33.761715 [debug] [ThreadPool]: On list_postgres_analytics_analytics: ROLLBACK
[0m08:56:33.762189 [debug] [ThreadPool]: On list_postgres_analytics: ROLLBACK
[0m08:56:33.762636 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:56:33.762885 [debug] [ThreadPool]: On list_postgres_analytics_analytics: Close
[0m08:56:33.762990 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:56:33.763098 [debug] [ThreadPool]: On list_postgres_analytics: Close
[0m08:56:33.765737 [debug] [MainThread]: Using postgres connection "master"
[0m08:56:33.765847 [debug] [MainThread]: On master: BEGIN
[0m08:56:33.765937 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:56:33.770871 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:56:33.770977 [debug] [MainThread]: Using postgres connection "master"
[0m08:56:33.771106 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:56:33.774856 [debug] [MainThread]: SQL status: SELECT 5 in 0.004 seconds
[0m08:56:33.775603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa25b490-25d8-4f69-bccf-d2cdd2988aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b477d0>]}
[0m08:56:33.775752 [debug] [MainThread]: On master: ROLLBACK
[0m08:56:33.775950 [debug] [MainThread]: On master: Close
[0m08:56:33.777049 [debug] [Thread-2 (]: Began running node seed.sumup.store
[0m08:56:33.777200 [debug] [Thread-3 (]: Began running node seed.sumup.transaction
[0m08:56:33.777514 [debug] [Thread-1 (]: Began running node seed.sumup.device
[0m08:56:33.777386 [info ] [Thread-2 (]: 2 of 16 START seed file analytics.store ........................................ [RUN]
[0m08:56:33.777736 [info ] [Thread-3 (]: 3 of 16 START seed file analytics.transaction .................................. [RUN]
[0m08:56:33.777906 [info ] [Thread-1 (]: 1 of 16 START seed file analytics.device ....................................... [RUN]
[0m08:56:33.778061 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_analytics, now seed.sumup.store)
[0m08:56:33.778184 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics, now seed.sumup.transaction)
[0m08:56:33.778298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now seed.sumup.device)
[0m08:56:33.778417 [debug] [Thread-2 (]: Began compiling node seed.sumup.store
[0m08:56:33.778528 [debug] [Thread-3 (]: Began compiling node seed.sumup.transaction
[0m08:56:33.778633 [debug] [Thread-1 (]: Began compiling node seed.sumup.device
[0m08:56:33.778745 [debug] [Thread-2 (]: Began executing node seed.sumup.store
[0m08:56:33.778858 [debug] [Thread-3 (]: Began executing node seed.sumup.transaction
[0m08:56:33.778974 [debug] [Thread-1 (]: Began executing node seed.sumup.device
[0m08:56:33.793652 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m08:56:33.793853 [debug] [Thread-2 (]: On seed.sumup.store: BEGIN
[0m08:56:33.793983 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:56:33.802064 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m08:56:33.802303 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m08:56:33.811609 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m08:56:33.811746 [debug] [Thread-1 (]: On seed.sumup.device: BEGIN
[0m08:56:33.811875 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m08:56:33.811998 [debug] [Thread-3 (]: On seed.sumup.transaction: BEGIN
[0m08:56:33.812114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:56:33.812239 [debug] [Thread-2 (]: On seed.sumup.store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.store"} */
truncate table "postgres"."analytics"."store"
[0m08:56:33.812358 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:56:33.814833 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.002 seconds
[0m08:56:33.831203 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m08:56:33.831372 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m08:56:33.831496 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m08:56:33.850137 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m08:56:33.861309 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m08:56:33.861448 [debug] [Thread-1 (]: On seed.sumup.device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.device"} */
truncate table "postgres"."analytics"."device"
[0m08:56:33.861582 [debug] [Thread-3 (]: On seed.sumup.transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "seed.sumup.transaction"} */
truncate table "postgres"."analytics"."transaction"
[0m08:56:33.861718 [debug] [Thread-2 (]: On seed.sumup.store: 
          insert into "postgres"."analytics"."store" ("id", "name", "address", "city", "country", "created_at", "typology", "customer_id") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%...
[0m08:56:33.862965 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.001 seconds
[0m08:56:33.870494 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.009 seconds
[0m08:56:33.870630 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0.009 seconds
[0m08:56:33.885197 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.sumup.store"
[0m08:56:33.895698 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m08:56:33.920016 [debug] [Thread-1 (]: On seed.sumup.device: 
          insert into "postgres"."analytics"."device" ("id", "type", "store_id") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s...
[0m08:56:33.932505 [debug] [Thread-1 (]: SQL status: INSERT 0 200 in 0.006 seconds
[0m08:56:33.938168 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.sumup.device"
[0m08:56:33.956245 [debug] [Thread-2 (]: On seed.sumup.store: COMMIT
[0m08:56:33.969342 [debug] [Thread-1 (]: On seed.sumup.device: COMMIT
[0m08:56:33.969490 [debug] [Thread-2 (]: Using postgres connection "seed.sumup.store"
[0m08:56:33.988275 [debug] [Thread-1 (]: Using postgres connection "seed.sumup.device"
[0m08:56:34.006570 [debug] [Thread-2 (]: On seed.sumup.store: COMMIT
[0m08:56:34.050241 [debug] [Thread-1 (]: On seed.sumup.device: COMMIT
[0m08:56:34.082266 [debug] [Thread-2 (]: SQL status: COMMIT in 0.014 seconds
[0m08:56:34.108539 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m08:56:34.121658 [debug] [Thread-2 (]: On seed.sumup.store: Close
[0m08:56:34.146223 [debug] [Thread-1 (]: On seed.sumup.device: Close
[0m08:56:34.209608 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa25b490-25d8-4f69-bccf-d2cdd2988aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d77070>]}
[0m08:56:34.209752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa25b490-25d8-4f69-bccf-d2cdd2988aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e7e670>]}
[0m08:56:34.222361 [info ] [Thread-2 (]: 2 of 16 OK loaded seed file analytics.store .................................... [[32mINSERT 100[0m in 0.40s]
[0m08:56:34.247659 [info ] [Thread-1 (]: 1 of 16 OK loaded seed file analytics.device ................................... [[32mINSERT 200[0m in 0.41s]
[0m08:56:34.253864 [debug] [Thread-2 (]: Finished running node seed.sumup.store
[0m08:56:34.272082 [debug] [Thread-1 (]: Finished running node seed.sumup.device
[0m08:56:34.309548 [debug] [Thread-4 (]: Began running node model.sumup.stg_store
[0m08:56:34.309709 [debug] [Thread-2 (]: Began running node model.sumup.stg_device
[0m08:56:34.322066 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.sumup.stg_store'
[0m08:56:34.340787 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.sumup.store, now model.sumup.stg_device)
[0m08:56:34.359554 [debug] [Thread-4 (]: Began compiling node model.sumup.stg_store
[0m08:56:34.378245 [debug] [Thread-2 (]: Began compiling node model.sumup.stg_device
[0m08:56:34.406353 [debug] [Thread-4 (]: Writing injected SQL for node "model.sumup.stg_store"
[0m08:56:34.423162 [debug] [Thread-2 (]: Writing injected SQL for node "model.sumup.stg_device"
[0m08:56:34.471977 [debug] [Thread-2 (]: Began executing node model.sumup.stg_device
[0m08:56:34.481018 [debug] [Thread-2 (]: Using postgres connection "model.sumup.stg_device"
[0m08:56:34.487457 [debug] [Thread-2 (]: On model.sumup.stg_device: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_device"} */

  
  

SELECT
    -- Primary Key
    id AS device_id,

    -- Foreign Key to stores (assuming this links the device to a specific store)
    store_id,

    -- Descriptive Attributes
    type as device_type
    
    -- Other fields, if any, standardized here
    -- e.g., CAST(status AS VARCHAR) AS device_status

    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-22 06:56:32.798668+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."device"
  
  limit 5

[0m08:56:34.487613 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:56:34.500037 [debug] [Thread-4 (]: Began executing node model.sumup.stg_store
[0m08:56:34.505317 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.018 seconds
[0m08:56:34.519087 [debug] [Thread-4 (]: Using postgres connection "model.sumup.stg_store"
[0m08:56:34.537146 [debug] [Thread-2 (]: On model.sumup.stg_device: Close
[0m08:56:34.555317 [debug] [Thread-4 (]: On model.sumup.stg_store: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_store"} */

  
  

SELECT
    -- Primary Key: Rename to be explicit
    id AS store_id,
    name AS store_name,

    -- Descriptive Attributes: Rename 'typology' for clarity
    typology AS store_typology,
    country,
    city
    
    -- Add a load timestamp/date if available in the raw data or ingestion process
    -- '2025-10-22 06:56:32.798668+00:00'::TIMESTAMP_NTZ AS dbt_loaded_at

FROM "postgres"."analytics"."store"
  
  limit 5

[0m08:56:34.586608 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:56:34.593280 [debug] [Thread-2 (]: Finished running node model.sumup.stg_device
[0m08:56:34.606600 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.020 seconds
[0m08:56:34.613186 [debug] [Thread-4 (]: On model.sumup.stg_store: Close
[0m08:56:34.625473 [debug] [Thread-4 (]: Finished running node model.sumup.stg_store
[0m08:56:34.755906 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m08:56:34.756052 [debug] [Thread-3 (]: On seed.sumup.transaction: 
          insert into "postgres"."analytics"."transaction" ("id", "device_id", "product_name", "product_sku", "category_name", "amount", "status", "card_number", "cvv", "created_at", "happened_at") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m08:56:34.783824 [debug] [Thread-3 (]: SQL status: INSERT 0 1500 in 0.028 seconds
[0m08:56:34.784176 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.sumup.transaction"
[0m08:56:34.784923 [debug] [Thread-3 (]: On seed.sumup.transaction: COMMIT
[0m08:56:34.785057 [debug] [Thread-3 (]: Using postgres connection "seed.sumup.transaction"
[0m08:56:34.785180 [debug] [Thread-3 (]: On seed.sumup.transaction: COMMIT
[0m08:56:34.787157 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m08:56:34.787415 [debug] [Thread-3 (]: On seed.sumup.transaction: Close
[0m08:56:34.787623 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa25b490-25d8-4f69-bccf-d2cdd2988aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e5c1d0>]}
[0m08:56:34.787837 [info ] [Thread-3 (]: 3 of 16 OK loaded seed file analytics.transaction .............................. [[32mINSERT 1500[0m in 1.01s]
[0m08:56:34.788044 [debug] [Thread-3 (]: Finished running node seed.sumup.transaction
[0m08:56:34.788284 [debug] [Thread-1 (]: Began running node model.sumup.stg_transaction
[0m08:56:34.788466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.sumup.device, now model.sumup.stg_transaction)
[0m08:56:34.788629 [debug] [Thread-1 (]: Began compiling node model.sumup.stg_transaction
[0m08:56:34.789831 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.stg_transaction"
[0m08:56:34.790079 [debug] [Thread-1 (]: Began executing node model.sumup.stg_transaction
[0m08:56:34.791563 [debug] [Thread-1 (]: Using postgres connection "model.sumup.stg_transaction"
[0m08:56:34.791720 [debug] [Thread-1 (]: On model.sumup.stg_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.stg_transaction"} */

  
  SELECT
    -- Primary and Foreign Keys
    CAST(id AS INTEGER) AS transaction_id,
    CAST(device_id AS INTEGER) AS device_id,

    -- Product Information
   
    MD5(CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA ) AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data & Status
    -- Convert amount from cents (as typically stored for high precision) to Euros (€)
    CAST(amount AS NUMERIC) AS amount_eur,
    LOWER(status) AS status,

    -- Card Information 
    REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '') AS card_number,
    CAST(cvv AS VARCHAR) AS cvv,
    
    -- Date/Time Fields
    -- The original columns contained mixed date formats, ensuring they are cast to timestamps
    CAST(created_at AS TIMESTAMP) AS created_at_utc,
    CAST(happened_at AS TIMESTAMP) AS happened_at_utc

FROM "postgres"."analytics"."transaction"
  
  limit 5

[0m08:56:34.791873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:56:34.797502 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m08:56:34.798248 [debug] [Thread-1 (]: On model.sumup.stg_transaction: Close
[0m08:56:34.798577 [debug] [Thread-1 (]: Finished running node model.sumup.stg_transaction
[0m08:56:34.798893 [debug] [Thread-1 (]: Began running node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m08:56:34.799046 [debug] [Thread-4 (]: Began running node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m08:56:34.799193 [debug] [Thread-3 (]: Began running node test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3
[0m08:56:34.799363 [debug] [Thread-2 (]: Began running node model.sumup.int_transaction
[0m08:56:34.799511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.stg_transaction, now test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411)
[0m08:56:34.799674 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.sumup.stg_store, now test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad)
[0m08:56:34.799828 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.sumup.transaction, now test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3)
[0m08:56:34.799978 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sumup.stg_device, now model.sumup.int_transaction)
[0m08:56:34.800114 [debug] [Thread-1 (]: Began compiling node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m08:56:34.800251 [debug] [Thread-4 (]: Began compiling node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m08:56:34.800384 [debug] [Thread-3 (]: Began compiling node test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3
[0m08:56:34.800512 [debug] [Thread-2 (]: Began compiling node model.sumup.int_transaction
[0m08:56:34.804042 [debug] [Thread-1 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411"
[0m08:56:34.805511 [debug] [Thread-4 (]: Writing injected SQL for node "test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad"
[0m08:56:34.807330 [debug] [Thread-3 (]: Writing injected SQL for node "test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3"
[0m08:56:34.808688 [debug] [Thread-2 (]: Writing injected SQL for node "model.sumup.int_transaction"
[0m08:56:34.809053 [debug] [Thread-1 (]: Began executing node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m08:56:34.810381 [debug] [Thread-1 (]: Using postgres connection "test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411"
[0m08:56:34.810526 [debug] [Thread-4 (]: Began executing node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m08:56:34.810655 [debug] [Thread-2 (]: Began executing node model.sumup.int_transaction
[0m08:56:34.810789 [debug] [Thread-1 (]: On test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411"} */

  
  
    
    



select amount_eur
from "postgres"."analytics_staging"."stg_transaction"
where amount_eur is null



  
  limit 5

[0m08:56:34.810916 [debug] [Thread-3 (]: Began executing node test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3
[0m08:56:34.812066 [debug] [Thread-4 (]: Using postgres connection "test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad"
[0m08:56:34.813291 [debug] [Thread-2 (]: Using postgres connection "model.sumup.int_transaction"
[0m08:56:34.813413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:56:34.814525 [debug] [Thread-3 (]: Using postgres connection "test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3"
[0m08:56:34.814666 [debug] [Thread-4 (]: On test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad"} */

  
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "postgres"."analytics_staging"."stg_transaction"
    group by status

)

select *
from all_values
where value_field not in (
    'accepted','refused','cancelled'
)



  
  limit 5

[0m08:56:34.814828 [debug] [Thread-2 (]: On model.sumup.int_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.int_transaction"} */

  
  

SELECT
    -- Primary and Foreign Keys
    transaction_id,
    t.device_id,

    -- Product Information
   
    CONCAT(TRIM(LOWER(product_name)), '|' ,TRIM(LOWER(product_sku)))::BYTEA  AS product_id,
    product_name,
    product_sku, 
    category_name,

    -- Financial Data and Status
    amount_eur,
    status,

    --device data
    d.device_type,
    
    -- store_data
    d.store_id,
    store_name,
    store_typology,

    -- Card Information 
    MD5( REPLACE(REPLACE(CAST(card_number AS VARCHAR), ' ', ''), '-', '')) AS card_number_hashed,
    MD5( CAST(cvv AS VARCHAR)) AS cvv_hashed,
    
    -- Date/Time Fields
    created_at_utc,
    happened_at_utc

FROM "postgres"."analytics_staging"."stg_transaction" t
LEFT JOIN "postgres"."analytics_staging"."stg_device" d ON t.device_id = d.device_id
LEFT JOIN "postgres"."analytics_staging"."stg_store" s ON d.store_id = s.store_id

-- Incremental Logic: Only select new records for subsequent runs

    WHERE t.created_at_utc > (SELECT MAX(created_at_utc) FROM "postgres"."analytics_analytics"."int_transaction")

  
  limit 5

[0m08:56:34.815044 [debug] [Thread-3 (]: On test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3"} */

  
  





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        card_number
    ) >= 13 and length(
        card_number
    ) <= 25
)
 as expression


    from "postgres"."analytics_staging"."stg_transaction"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







  
  limit 5

[0m08:56:34.815198 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:56:34.815354 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:56:34.815484 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:56:34.822574 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m08:56:34.823002 [debug] [Thread-1 (]: On test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411: Close
[0m08:56:34.823136 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.008 seconds
[0m08:56:34.823395 [debug] [Thread-1 (]: Finished running node test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411
[0m08:56:34.823797 [debug] [Thread-3 (]: On test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3: Close
[0m08:56:34.823929 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.009 seconds
[0m08:56:34.824094 [debug] [Thread-1 (]: Began running node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m08:56:34.824502 [debug] [Thread-4 (]: On test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad: Close
[0m08:56:34.824710 [debug] [Thread-3 (]: Finished running node test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3
[0m08:56:34.824846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sumup.not_null_stg_transaction_amount_eur.f90ffbc411, now test.sumup.not_null_stg_transaction_card_number.fb1135c280)
[0m08:56:34.825068 [debug] [Thread-4 (]: Finished running node test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad
[0m08:56:34.825202 [debug] [Thread-3 (]: Began running node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m08:56:34.825343 [debug] [Thread-1 (]: Began compiling node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m08:56:34.825481 [debug] [Thread-4 (]: Began running node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m08:56:34.825631 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sumup.dbt_expectations_expect_column_value_lengths_to_be_between_stg_transaction_card_number__25__13.0fb060c9f3, now test.sumup.not_null_stg_transaction_device_id.b84ae0844e)
[0m08:56:34.827277 [debug] [Thread-1 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_card_number.fb1135c280"
[0m08:56:34.827417 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.sumup.accepted_values_stg_transaction_status__accepted__refused__cancelled.8dc15534ad, now test.sumup.not_null_stg_transaction_id.f3ec2fc021)
[0m08:56:34.827555 [debug] [Thread-3 (]: Began compiling node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m08:56:34.827717 [debug] [Thread-4 (]: Began compiling node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m08:56:34.829112 [debug] [Thread-3 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_device_id.b84ae0844e"
[0m08:56:34.830571 [debug] [Thread-4 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_id.f3ec2fc021"
[0m08:56:34.830726 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.015 seconds
[0m08:56:34.830869 [debug] [Thread-1 (]: Began executing node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m08:56:34.831362 [debug] [Thread-2 (]: On model.sumup.int_transaction: Close
[0m08:56:34.832644 [debug] [Thread-1 (]: Using postgres connection "test.sumup.not_null_stg_transaction_card_number.fb1135c280"
[0m08:56:34.832787 [debug] [Thread-3 (]: Began executing node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m08:56:34.833035 [debug] [Thread-2 (]: Finished running node model.sumup.int_transaction
[0m08:56:34.833166 [debug] [Thread-4 (]: Began executing node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m08:56:34.833305 [debug] [Thread-1 (]: On test.sumup.not_null_stg_transaction_card_number.fb1135c280: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.not_null_stg_transaction_card_number.fb1135c280"} */

  
  
    
    



select card_number
from "postgres"."analytics_staging"."stg_transaction"
where card_number is null



  
  limit 5

[0m08:56:34.834445 [debug] [Thread-3 (]: Using postgres connection "test.sumup.not_null_stg_transaction_device_id.b84ae0844e"
[0m08:56:34.834589 [debug] [Thread-2 (]: Began running node test.sumup.not_null_stg_transaction_status.87ab6c4b42
[0m08:56:34.835912 [debug] [Thread-4 (]: Using postgres connection "test.sumup.not_null_stg_transaction_id.f3ec2fc021"
[0m08:56:34.836081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:56:34.836233 [debug] [Thread-3 (]: On test.sumup.not_null_stg_transaction_device_id.b84ae0844e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.not_null_stg_transaction_device_id.b84ae0844e"} */

  
  
    
    



select device_id
from "postgres"."analytics_staging"."stg_transaction"
where device_id is null



  
  limit 5

[0m08:56:34.836388 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sumup.int_transaction, now test.sumup.not_null_stg_transaction_status.87ab6c4b42)
[0m08:56:34.836535 [debug] [Thread-4 (]: On test.sumup.not_null_stg_transaction_id.f3ec2fc021: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.not_null_stg_transaction_id.f3ec2fc021"} */

  
  
    
    



select id
from "postgres"."analytics_staging"."stg_transaction"
where id is null



  
  limit 5

[0m08:56:34.836723 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:56:34.836861 [debug] [Thread-2 (]: Began compiling node test.sumup.not_null_stg_transaction_status.87ab6c4b42
[0m08:56:34.836994 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:56:34.838460 [debug] [Thread-2 (]: Writing injected SQL for node "test.sumup.not_null_stg_transaction_status.87ab6c4b42"
[0m08:56:34.838751 [debug] [Thread-2 (]: Began executing node test.sumup.not_null_stg_transaction_status.87ab6c4b42
[0m08:56:34.840108 [debug] [Thread-2 (]: Using postgres connection "test.sumup.not_null_stg_transaction_status.87ab6c4b42"
[0m08:56:34.840244 [debug] [Thread-2 (]: On test.sumup.not_null_stg_transaction_status.87ab6c4b42: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.not_null_stg_transaction_status.87ab6c4b42"} */

  
  
    
    



select status
from "postgres"."analytics_staging"."stg_transaction"
where status is null



  
  limit 5

[0m08:56:34.840394 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:56:34.841547 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.005 seconds
[0m08:56:34.842016 [debug] [Thread-3 (]: On test.sumup.not_null_stg_transaction_device_id.b84ae0844e: Close
[0m08:56:34.842167 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 10: select id
                ^

[0m08:56:34.842315 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m08:56:34.842555 [debug] [Thread-3 (]: Finished running node test.sumup.not_null_stg_transaction_device_id.b84ae0844e
[0m08:56:34.842711 [debug] [Thread-4 (]: On test.sumup.not_null_stg_transaction_id.f3ec2fc021: Close
[0m08:56:34.843136 [debug] [Thread-1 (]: On test.sumup.not_null_stg_transaction_card_number.fb1135c280: Close
[0m08:56:34.843293 [debug] [Thread-3 (]: Began running node test.sumup.unique_stg_transaction_id.f181c9397b
[0m08:56:34.843732 [debug] [Thread-1 (]: Finished running node test.sumup.not_null_stg_transaction_card_number.fb1135c280
[0m08:56:34.843871 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sumup.not_null_stg_transaction_device_id.b84ae0844e, now test.sumup.unique_stg_transaction_id.f181c9397b)
[0m08:56:34.844036 [debug] [Thread-1 (]: Began running node model.sumup.customer_store_ranking
[0m08:56:34.844193 [debug] [Thread-3 (]: Began compiling node test.sumup.unique_stg_transaction_id.f181c9397b
[0m08:56:34.844347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sumup.not_null_stg_transaction_card_number.fb1135c280, now model.sumup.customer_store_ranking)
[0m08:56:34.846585 [debug] [Thread-3 (]: Writing injected SQL for node "test.sumup.unique_stg_transaction_id.f181c9397b"
[0m08:56:34.846744 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.006 seconds
[0m08:56:34.846875 [debug] [Thread-1 (]: Began compiling node model.sumup.customer_store_ranking
[0m08:56:34.847360 [debug] [Thread-2 (]: On test.sumup.not_null_stg_transaction_status.87ab6c4b42: Close
[0m08:56:34.848451 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.customer_store_ranking"
[0m08:56:34.848727 [debug] [Thread-2 (]: Finished running node test.sumup.not_null_stg_transaction_status.87ab6c4b42
[0m08:56:34.848871 [debug] [Thread-3 (]: Began executing node test.sumup.unique_stg_transaction_id.f181c9397b
[0m08:56:34.850106 [debug] [Thread-3 (]: Using postgres connection "test.sumup.unique_stg_transaction_id.f181c9397b"
[0m08:56:34.850284 [debug] [Thread-3 (]: On test.sumup.unique_stg_transaction_id.f181c9397b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "test.sumup.unique_stg_transaction_id.f181c9397b"} */

  
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."analytics_staging"."stg_transaction"
where id is not null
group by id
having count(*) > 1



  
  limit 5

[0m08:56:34.850451 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:56:34.850624 [debug] [Thread-1 (]: Began executing node model.sumup.customer_store_ranking
[0m08:56:34.851983 [debug] [Thread-1 (]: Using postgres connection "model.sumup.customer_store_ranking"
[0m08:56:34.852147 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "sumup", "target_name": "dev", "node_id": "model.sumup.customer_store_ranking"} */

  
  --Question 1) 

SELECT
    store_name,
    --SUM(amount_eur) AS total_amount
    amount_eur
FROM
    "postgres"."analytics_analytics"."int_transaction" 
WHERE status = 'accepted' and store_id = 3



--GROUP BY

--    store_name
--ORDER BY
--    total_amount DESC
--limit 10
  
  limit 5

[0m08:56:34.852287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:56:34.853943 [debug] [Thread-4 (]: Database Error in test not_null_stg_transaction_id (models/staging/stg_transaction.yml)
  column "id" does not exist
  LINE 10: select id
                  ^
[0m08:56:34.854173 [debug] [Thread-4 (]: Finished running node test.sumup.not_null_stg_transaction_id.f3ec2fc021
[0m08:56:34.854365 [debug] [Thread-7 (]: Marking all children of 'test.sumup.not_null_stg_transaction_id.f3ec2fc021' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_transaction_id (models/staging/stg_transaction.yml)
  column "id" does not exist
  LINE 10: select id
                  ^.
[0m08:56:34.855341 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 9:     id as unique_field,
            ^

[0m08:56:34.855508 [debug] [Thread-3 (]: On test.sumup.unique_stg_transaction_id.f181c9397b: Close
[0m08:56:34.856350 [debug] [Thread-3 (]: Database Error in test unique_stg_transaction_id (models/staging/stg_transaction.yml)
  column "id" does not exist
  LINE 9:     id as unique_field,
              ^
[0m08:56:34.856567 [debug] [Thread-3 (]: Finished running node test.sumup.unique_stg_transaction_id.f181c9397b
[0m08:56:34.856755 [debug] [Thread-7 (]: Marking all children of 'test.sumup.unique_stg_transaction_id.f181c9397b' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_transaction_id (models/staging/stg_transaction.yml)
  column "id" does not exist
  LINE 9:     id as unique_field,
              ^.
[0m08:56:34.857154 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m08:56:34.857598 [debug] [Thread-1 (]: On model.sumup.customer_store_ranking: Close
[0m08:56:34.857819 [debug] [Thread-1 (]: Finished running node model.sumup.customer_store_ranking
[0m08:56:34.857961 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:56:34.858090 [debug] [MainThread]: Connection 'model.sumup.customer_store_ranking' was properly closed.
[0m08:56:34.858202 [debug] [MainThread]: Connection 'test.sumup.not_null_stg_transaction_status.87ab6c4b42' was properly closed.
[0m08:56:34.858305 [debug] [MainThread]: Connection 'test.sumup.unique_stg_transaction_id.f181c9397b' was properly closed.
[0m08:56:34.858398 [debug] [MainThread]: Connection 'test.sumup.not_null_stg_transaction_id.f3ec2fc021' was properly closed.
[0m08:56:34.858548 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in test unique_stg_transaction_id (models/staging/stg_transaction.yml)
    column "id" does not exist
    LINE 9:     id as unique_field,
                ^
[0m08:56:34.858769 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:56:34.860225 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 2.08034, "process_in_blocks": "0", "process_kernel_time": 0.137676, "process_mem_max_rss": "143228928", "process_out_blocks": "0", "process_user_time": 2.38616}
[0m08:56:34.860386 [debug] [MainThread]: Command `dbt show` failed at 08:56:34.860354 after 2.08 seconds
[0m08:56:34.860510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ec440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104533f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ba2ab0>]}
[0m08:56:34.860653 [debug] [MainThread]: Flushing usage events
[0m08:56:35.362009 [debug] [MainThread]: An error was encountered while trying to flush usage events
